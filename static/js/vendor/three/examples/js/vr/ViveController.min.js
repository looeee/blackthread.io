THREE.ViveController=function(t){THREE.Object3D.call(this);var e,i=this,r=[0,0],s=!1,n=!1,o=!1,a=!1;this.matrixAutoUpdate=!1,this.standingMatrix=new THREE.Matrix4,this.getGamepad=function(){return e},this.getButtonState=function(t){return"thumbpad"===t?s:"trigger"===t?n:"grips"===t?o:"menu"===t?a:void 0},this.update=function(){if(void 0!==(e=function(t){for(var e=navigator.getGamepads&&navigator.getGamepads(),i=0,r=0;i<e.length;i++){var s=e[i];if(s&&("OpenVR Gamepad"===s.id||s.id.startsWith("Oculus Touch")||s.id.startsWith("Spatial Controller"))){if(r===t)return s;r++}}}(t))&&void 0!==e.pose){if(null===e.pose)return;var p=e.pose;null!==p.position&&i.position.fromArray(p.position),null!==p.orientation&&i.quaternion.fromArray(p.orientation),i.matrix.compose(i.position,i.quaternion,i.scale),i.matrix.premultiply(i.standingMatrix),i.matrixWorldNeedsUpdate=!0,i.visible=!0,r[0]===e.axes[0]&&r[1]===e.axes[1]||(r[0]=e.axes[0],r[1]=e.axes[1],i.dispatchEvent({type:"axischanged",axes:r})),s!==e.buttons[0].pressed&&(s=e.buttons[0].pressed,i.dispatchEvent({type:s?"thumbpaddown":"thumbpadup",axes:r})),n!==e.buttons[1].pressed&&(n=e.buttons[1].pressed,i.dispatchEvent({type:n?"triggerdown":"triggerup"})),o!==e.buttons[2].pressed&&(o=e.buttons[2].pressed,i.dispatchEvent({type:o?"gripsdown":"gripsup"})),a!==e.buttons[3].pressed&&(a=e.buttons[3].pressed,i.dispatchEvent({type:a?"menudown":"menuup"}))}else i.visible=!1}},THREE.ViveController.prototype=Object.create(THREE.Object3D.prototype),THREE.ViveController.prototype.constructor=THREE.ViveController;