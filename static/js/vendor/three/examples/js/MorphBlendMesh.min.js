THREE.MorphBlendMesh=function(t,i){THREE.Mesh.call(this,t,i),this.animationsMap={},this.animationsList=[];var n=this.geometry.morphTargets.length,a="__default",e=n-1,r=n/1;this.createAnimation(a,0,e,r),this.setAnimationWeight(a,1)},THREE.MorphBlendMesh.prototype=Object.assign(Object.create(THREE.Mesh.prototype),{constructor:THREE.MorphBlendMesh,createAnimation:function(t,i,n,a){var e={start:i,end:n,length:n-i+1,fps:a,duration:(n-i)/a,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[t]=e,this.animationsList.push(e)},autoCreateAnimations:function(t){for(var i,n=/([a-z]+)_?(\d+)/i,a={},e=this.geometry,r=0,o=e.morphTargets.length;r<o;r++){var s=e.morphTargets[r].name.match(n);if(s&&s.length>1)a[m=s[1]]||(a[m]={start:1/0,end:-1/0}),r<(c=a[m]).start&&(c.start=r),r>c.end&&(c.end=r),i||(i=m)}for(var m in a){var c=a[m];this.createAnimation(m,c.start,c.end,t)}this.firstAnimation=i},setAnimationDirectionForward:function(t){var i=this.animationsMap[t];i&&(i.direction=1,i.directionBackwards=!1)},setAnimationDirectionBackward:function(t){var i=this.animationsMap[t];i&&(i.direction=-1,i.directionBackwards=!0)},setAnimationFPS:function(t,i){var n=this.animationsMap[t];n&&(n.fps=i,n.duration=(n.end-n.start)/n.fps)},setAnimationDuration:function(t,i){var n=this.animationsMap[t];n&&(n.duration=i,n.fps=(n.end-n.start)/n.duration)},setAnimationWeight:function(t,i){var n=this.animationsMap[t];n&&(n.weight=i)},setAnimationTime:function(t,i){var n=this.animationsMap[t];n&&(n.time=i)},getAnimationTime:function(t){var i=0,n=this.animationsMap[t];return n&&(i=n.time),i},getAnimationDuration:function(t){var i=-1,n=this.animationsMap[t];return n&&(i=n.duration),i},playAnimation:function(t){var i=this.animationsMap[t];i?(i.time=0,i.active=!0):console.warn("THREE.MorphBlendMesh: animation["+t+"] undefined in .playAnimation()")},stopAnimation:function(t){var i=this.animationsMap[t];i&&(i.active=!1)},update:function(t){for(var i=0,n=this.animationsList.length;i<n;i++){var a=this.animationsList[i];if(a.active){var e=a.duration/a.length;a.time+=a.direction*t,a.mirroredLoop?(a.time>a.duration||a.time<0)&&(a.direction*=-1,a.time>a.duration&&(a.time=a.duration,a.directionBackwards=!0),a.time<0&&(a.time=0,a.directionBackwards=!1)):(a.time=a.time%a.duration,a.time<0&&(a.time+=a.duration));var r=a.start+THREE.Math.clamp(Math.floor(a.time/e),0,a.length-1),o=a.weight;r!==a.currentFrame&&(this.morphTargetInfluences[a.lastFrame]=0,this.morphTargetInfluences[a.currentFrame]=1*o,this.morphTargetInfluences[r]=0,a.lastFrame=a.currentFrame,a.currentFrame=r);var s=a.time%e/e;a.directionBackwards&&(s=1-s),a.currentFrame!==a.lastFrame?(this.morphTargetInfluences[a.currentFrame]=s*o,this.morphTargetInfluences[a.lastFrame]=(1-s)*o):this.morphTargetInfluences[a.currentFrame]=o}}}});