THREE.AssimpJSONLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},THREE.AssimpJSONLoader.prototype={constructor:THREE.AssimpJSONLoader,crossOrigin:"Anonymous",load:function(e,r,a,t){var s=this,n=THREE.LoaderUtils.extractUrlBase(e);new THREE.FileLoader(this.manager).load(e,function(e){var a=JSON.parse(e),i=a.__metadata__;if(void 0!==i){if("assimp2json"!==i.format)return void t("THREE.AssimpJSONLoader: Not an assimp2json scene.");if(i.version<100&&i.version>=200)return void t("THREE.AssimpJSONLoader: Unsupported assimp2json file format version.")}r(s.parse(a,n))},a,t)},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e,r){function a(e,r){for(var a=new Array(e.length),t=0;t<e.length;++t)a[t]=r.call(this,e[t]);return a}var t=new THREE.TextureLoader(this.manager);t.setPath(r).setCrossOrigin(this.crossOrigin);var s=a(e.meshes,function(e){var r,a,t,s=new THREE.BufferGeometry,n=[],i=e.vertices||[],o=e.normals||[],c=e.texturecoords||[],m=e.colors||[];for(c=c[0]||[],r=0,a=e.faces.length;r<a;r++)t=e.faces[r],n.push(t[0],t[1],t[2]);return s.setIndex(n),s.addAttribute("position",new THREE.Float32BufferAttribute(i,3)),o.length>0&&s.addAttribute("normal",new THREE.Float32BufferAttribute(o,3)),c.length>0&&s.addAttribute("uv",new THREE.Float32BufferAttribute(c,2)),m.length>0&&s.addAttribute("color",new THREE.Float32BufferAttribute(m,3)),s.computeBoundingSphere(),s}),n=a(e.materials,function(e){var r=new THREE.MeshPhongMaterial;for(var a in e.properties){var s=e.properties[a],n=s.key,i=s.value;switch(n){case"$tex.file":var o=s.semantic;if(1===o||2===o||5===o||6===o){var c;switch(o){case 1:c="map";break;case 2:c="specularMap";break;case 5:c="bumpMap";break;case 6:c="normalMap"}var m=t.load(i);m.wrapS=m.wrapT=THREE.RepeatWrapping,r[c]=m}break;case"?mat.name":r.name=i;break;case"$clr.diffuse":r.color.fromArray(i);break;case"$clr.specular":r.specular.fromArray(i);break;case"$clr.emissive":r.emissive.fromArray(i);break;case"$mat.shininess":r.shininess=i;break;case"$mat.shadingm":r.flatShading=1===i;break;case"$mat.opacity":i<1&&(r.opacity=i,r.transparent=!0)}}return r});return function e(r,a,t,s){var n,i,o=new THREE.Object3D;for(o.name=a.name||"",o.matrix=(new THREE.Matrix4).fromArray(a.transformation).transpose(),o.matrix.decompose(o.position,o.quaternion,o.scale),n=0;a.meshes&&n<a.meshes.length;n++)i=a.meshes[n],o.add(new THREE.Mesh(t[i],s[r.meshes[i].materialindex]));for(n=0;a.children&&n<a.children.length;n++)o.add(e(r,a.children[n],t,s));return o}(e,e.rootnode,s,n)}};