THREE.KTXLoader=function(){this._parser=THREE.KTXLoader.parse},THREE.KTXLoader.prototype=Object.create(THREE.CompressedTextureLoader.prototype),THREE.KTXLoader.prototype.constructor=THREE.KTXLoader,THREE.KTXLoader.parse=function(e,t){var s=new KhronosTextureContainer(e,1);return{mipmaps:s.mipmaps(t),width:s.pixelWidth,height:s.pixelHeight,format:s.glInternalFormat,isCubemap:6===s.numberOfFaces,mipmapCount:s.numberOfMipmapLevels}};var KhronosTextureContainer=function(){function e(t,s,i,r){this.arrayBuffer=t;var n=new Uint8Array(this.arrayBuffer,0,12);if(171===n[0]&&75===n[1]&&84===n[2]&&88===n[3]&&32===n[4]&&49===n[5]&&49===n[6]&&187===n[7]&&13===n[8]&&10===n[9]&&26===n[10]&&10===n[11]){var a=new Int32Array(this.arrayBuffer,12,13),h=16909060===a[0];this.glType=h?this.switchEndainness(a[1]):a[1],this.glTypeSize=h?this.switchEndainness(a[2]):a[2],this.glFormat=h?this.switchEndainness(a[3]):a[3],this.glInternalFormat=h?this.switchEndainness(a[4]):a[4],this.glBaseInternalFormat=h?this.switchEndainness(a[5]):a[5],this.pixelWidth=h?this.switchEndainness(a[6]):a[6],this.pixelHeight=h?this.switchEndainness(a[7]):a[7],this.pixelDepth=h?this.switchEndainness(a[8]):a[8],this.numberOfArrayElements=h?this.switchEndainness(a[9]):a[9],this.numberOfFaces=h?this.switchEndainness(a[10]):a[10],this.numberOfMipmapLevels=h?this.switchEndainness(a[11]):a[11],this.bytesOfKeyValueData=h?this.switchEndainness(a[12]):a[12],0===this.glType?(this.numberOfMipmapLevels=Math.max(1,this.numberOfMipmapLevels),0!==this.pixelHeight&&0===this.pixelDepth?0===this.numberOfArrayElements?this.numberOfFaces===s?this.loadType=e.COMPRESSED_2D:console.warn("number of faces expected"+s+", but found "+this.numberOfFaces):console.warn("texture arrays not currently supported"):console.warn("only 2D textures currently supported")):console.warn("only compressed formats currently supported")}else console.error("texture missing KTX identifier")}return e.prototype.switchEndainness=function(e){return(255&e)<<24|(65280&e)<<8|e>>8&65280|e>>24&255},e.prototype.mipmaps=function(t){for(var s=[],i=e.HEADER_LEN+this.bytesOfKeyValueData,r=this.pixelWidth,n=this.pixelHeight,a=t?this.numberOfMipmapLevels:1,h=0;h<a;h++){for(var o=new Int32Array(this.arrayBuffer,i,1)[0],p=0;p<this.numberOfFaces;p++){var u=new Uint8Array(this.arrayBuffer,i+4,o);s.push({data:u,width:r,height:n}),i+=o+4,i+=3-(o+3)%4}r=Math.max(1,.5*r),n=Math.max(1,.5*n)}return s},e.HEADER_LEN=64,e.COMPRESSED_2D=0,e.COMPRESSED_3D=1,e.TEX_2D=2,e.TEX_3D=3,e}();