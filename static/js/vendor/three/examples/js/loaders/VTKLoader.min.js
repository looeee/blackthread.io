THREE.VTKLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager},Object.assign(THREE.VTKLoader.prototype,THREE.EventDispatcher.prototype,{load:function(t,e,r,a){var n=this,i=new THREE.FileLoader(n.manager);i.setResponseType("arraybuffer"),i.load(t,function(t){e(n.parse(t))},r,a)},parse:function(t){function e(t){for(var e="",r=new Uint8Array(t),a=0,n=r.length;n--;)e+=String.fromCharCode(r[a++]);return e}var r=THREE.LoaderUtils.decodeText(new Uint8Array(t,0,250)).split("\n");return-1!==r[0].indexOf("xml")?function(t){function e(t){var e,r,a,n,i,o,s="undefined"!=typeof Uint8Array?Uint8Array:Array,l=[],f=[],u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",p=u.length;for(e=0;e<p;e++)l[e]=u[e];for(e=0;e<p;++e)f[u.charCodeAt(e)]=e;if(f["-".charCodeAt(0)]=62,f["_".charCodeAt(0)]=63,(p=t.length)%4>0)throw new Error("Invalid string. Length must be a multiple of 4");o=new s(3*p/4-(i="="===t[p-2]?2:"="===t[p-1]?1:0)),a=i>0?p-4:p;var A=0;for(e=0,r=0;e<a;e+=4,r+=3)n=f[t.charCodeAt(e)]<<18|f[t.charCodeAt(e+1)]<<12|f[t.charCodeAt(e+2)]<<6|f[t.charCodeAt(e+3)],o[A++]=(16711680&n)>>16,o[A++]=(65280&n)>>8,o[A++]=255&n;return 2===i?(n=f[t.charCodeAt(e)]<<2|f[t.charCodeAt(e+1)]>>4,o[A++]=255&n):1===i&&(n=f[t.charCodeAt(e)]<<10|f[t.charCodeAt(e+1)]<<4|f[t.charCodeAt(e+2)]>>2,o[A++]=n>>8&255,o[A++]=255&n),o}function r(t,r){var a,i,o,s,l,f,u,p,A=0;if("UInt64"===n.attributes.header_type?A=8:"UInt32"===n.attributes.header_type&&(A=4),"binary"===t.attributes.format&&r){var d,y,h,c,b,w;if("Float32"===t.attributes.type)var v=new Float32Array;else"Int64"===t.attributes.type&&(v=new Int32Array);y=(d=e(t["#text"]))[0];for(var g=1;g<A-1;g++)y|=d[g]<<g*A;for(c=(y+3)*A,w=c+=c%3>0?3-c%3:0,(b=[]).push(w),h=3*A,g=0;g<y;g++){for(var x=d[g*A+h],I=1;I<A-1;I++)x|=d[g*A+h+I]<<8*I;w+=x,b.push(w)}for(g=0;g<b.length-1;g++)E=(E=new Zlib.Inflate(d.slice(b[g],b[g+1]),{resize:!0,verify:!0}).decompress()).buffer,"Float32"===t.attributes.type?(E=new Float32Array(E),f=E,p=void 0,u=(l=v).length,(p=new Float32Array(u+f.length)).set(l),p.set(f,u),v=p):"Int64"===t.attributes.type&&(E=new Int32Array(E),i=E,s=void 0,o=(a=v).length,(s=new Int32Array(o+i.length)).set(a),s.set(i,o),v=s);delete t["#text"],"Float32"===t.attributes.type?"binary"===t.attributes.format&&(r||(v=v.filter(function(t,e){if(0!==e)return!0}))):"Int64"===t.attributes.type&&"binary"===t.attributes.format&&(r||(v=v.filter(function(t,e){if(0!==e)return!0})),v=v.filter(function(t,e){if(e%2!=1)return!0}))}else{if("binary"!==t.attributes.format||r)if(t["#text"])var E=t["#text"].split(/\s+/).filter(function(t){if(""!==t)return t});else E=new Int32Array(0).buffer;else E=(E=e(t["#text"])).slice(A).buffer;delete t["#text"],"Float32"===t.attributes.type?v=new Float32Array(E):"Int32"===t.attributes.type?v=new Int32Array(E):"Int64"===t.attributes.type&&(v=new Int32Array(E),"binary"===t.attributes.format&&(v=v.filter(function(t,e){if(e%2!=1)return!0})))}return v}var a=null;if(window.DOMParser)try{a=(new DOMParser).parseFromString(t,"text/xml")}catch(t){a=null}else{if(!window.ActiveXObject)throw new Error("Cannot parse xml string!");try{if((a=new ActiveXObject("Microsoft.XMLDOM")).async=!1,!a.loadXML())throw new Error(a.parseError.reason+a.parseError.srcText)}catch(t){a=null}}var n=function t(e){var r={};if(1===e.nodeType){if(e.attributes&&e.attributes.length>0){r.attributes={};for(var a=0;a<e.attributes.length;a++){var n=e.attributes.item(a);r.attributes[n.nodeName]=n.nodeValue.trim()}}}else 3===e.nodeType&&(r=e.nodeValue.trim());if(e.hasChildNodes())for(var i=0;i<e.childNodes.length;i++){var o=e.childNodes.item(i),s=o.nodeName;if(void 0===r[s])""!==(f=t(o))&&(r[s]=f);else{if(void 0===r[s].push){var l=r[s];r[s]=[l]}var f;""!==(f=t(o))&&r[s].push(f)}}return r}(a.documentElement),i=[],o=[],s=[];if(n.PolyData){for(var l=n.PolyData.Piece,f=n.attributes.hasOwnProperty("compressor"),u=["PointData","Points","Strips","Polys"],p=0,A=u.length;p<A;){var d=l[u[p]];if(d&&d.DataArray){if("[object Array]"===Object.prototype.toString.call(d.DataArray))var y=d.DataArray;else y=[d.DataArray];for(var h=0,c=y.length;h<c;)"#text"in y[h]&&y[h]["#text"].length>0&&(y[h].text=r(y[h],f)),h++;switch(u[p]){case"PointData":var b=parseInt(l.attributes.NumberOfPoints),w=d.attributes.Normals;if(b>0)for(var v=0,g=y.length;v<g;v++)if(w===y[v].attributes.Name){var x=y[v].attributes.NumberOfComponents;(o=new Float32Array(b*x)).set(y[v].text,0)}break;case"Points":(b=parseInt(l.attributes.NumberOfPoints))>0&&(x=d.DataArray.attributes.NumberOfComponents,(i=new Float32Array(b*x)).set(d.DataArray.text,0));break;case"Strips":var I=parseInt(l.attributes.NumberOfStrips);if(I>0){var E=new Int32Array(d.DataArray[0].text.length),m=new Int32Array(d.DataArray[1].text.length);E.set(d.DataArray[0].text,0),m.set(d.DataArray[1].text,0);var T=I+E.length;s=new Uint32Array(3*T-9*I);var F=0;for(v=0,g=I;v<g;v++){for(var R=[],O=0,D=m[v],C=0;O<D-C;O++)R.push(E[O]),v>0&&(C=m[v-1]);var H=0;for(D=m[v],C=0;H<D-C-2;H++)H%2?(s[F++]=R[H],s[F++]=R[H+2],s[F++]=R[H+1]):(s[F++]=R[H],s[F++]=R[H+1],s[F++]=R[H+2]),v>0&&(C=m[v-1])}}break;case"Polys":var P=parseInt(l.attributes.NumberOfPolys);if(P>0){E=new Int32Array(d.DataArray[0].text.length),m=new Int32Array(d.DataArray[1].text.length),E.set(d.DataArray[0].text,0),m.set(d.DataArray[1].text,0),T=P+E.length,s=new Uint32Array(3*T-9*P),F=0;var N=0;for(v=0,g=P,C=0;v<g;){var S=[];for(O=0,D=m[v];O<D-C;)S.push(E[N++]),O++;for(H=1;H<D-C-1;)s[F++]=S[0],s[F++]=S[H],s[F++]=S[H+1],H++;C=m[++v-1]}}}}p++}var L=new THREE.BufferGeometry;return L.setIndex(new THREE.BufferAttribute(s,1)),L.addAttribute("position",new THREE.BufferAttribute(i,3)),o.length===i.length&&L.addAttribute("normal",new THREE.BufferAttribute(o,3)),L}}(e(t)):r[2].includes("ASCII")?function(t){var e,r,a=[],n=[],i=[],o=[],s=/(\-?\d+\.?[\d\-\+e]*)\s+(\-?\d+\.?[\d\-\+e]*)\s+(\-?\d+\.?[\d\-\+e]*)/g,l=/^(\d+)\s+([\s\d]*)/,f=/^POINTS /,u=/^POLYGONS /,p=/^TRIANGLE_STRIPS /,A=/^POINT_DATA[ ]+(\d+)/,d=/^CELL_DATA[ ]+(\d+)/,y=/^COLOR_SCALARS[ ]+(\w+)[ ]+3/,h=/^NORMALS[ ]+(\w+)[ ]+(\w+)/,c=!1,b=!1,w=!1,v=!1,g=!1,x=!1,I=!1,E=t.split("\n");for(var m in E){var T=E[m];if(c)for(;null!==(e=s.exec(T));){var F=parseFloat(e[1]),R=parseFloat(e[2]),O=parseFloat(e[3]);n.push(F,R,O)}else if(b){if(null!==(e=l.exec(T))){var D=parseInt(e[1]),C=e[2].split(/\s+/);if(D>=3)for(var H=parseInt(C[0]),P=1,N=0;N<D-2;++N)S=parseInt(C[P]),L=parseInt(C[P+1]),a.push(H,S,L),P++}}else if(w){if(null!==(e=l.exec(T))){var S,L;if(D=parseInt(e[1]),C=e[2].split(/\s+/),D>=3)for(N=0;N<D-2;N++)N%2==1?(H=parseInt(C[N]),S=parseInt(C[N+2]),L=parseInt(C[N+1]),a.push(H,S,L)):(H=parseInt(C[N]),S=parseInt(C[N+1]),L=parseInt(C[N+2]),a.push(H,S,L))}}else if(v||g)if(x)for(;null!==(e=s.exec(T));){var B=parseFloat(e[1]),U=parseFloat(e[2]),G=parseFloat(e[3]);i.push(B,U,G)}else if(I)for(;null!==(e=s.exec(T));){var M=parseFloat(e[1]),_=parseFloat(e[2]),j=parseFloat(e[3]);o.push(M,_,j)}null!==u.exec(T)?(b=!0,c=!1,w=!1):null!==f.exec(T)?(b=!1,c=!0,w=!1):null!==p.exec(T)?(b=!1,c=!1,w=!0):null!==A.exec(T)?(v=!0,c=!1,b=!1,w=!1):null!==d.exec(T)?(g=!0,c=!1,b=!1,w=!1):null!==y.exec(T)?(x=!0,I=!1,c=!1,b=!1,w=!1):null!==h.exec(T)&&(I=!0,x=!1,c=!1,b=!1,w=!1)}var V="point";if(i.length===a.length&&(V="cell"),"point"===V)(r=new THREE.BufferGeometry).setIndex(new THREE.BufferAttribute(new Uint32Array(a),1)),r.addAttribute("position",new THREE.BufferAttribute(new Float32Array(n),3)),i.length===n.length&&r.addAttribute("color",new THREE.BufferAttribute(new Float32Array(i),3)),o.length===n.length&&r.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(o),3));else{r=new THREE.Geometry;var k,X,K,Y,z=a.length/3,Z=n.length/3;for(N=0;N<Z;++N)F=n[3*N+0],R=n[3*N+1],O=n[3*N+2],r.vertices.push(new THREE.Vector3(F,R,O));for(m=0;m<z;++m)X=a[3*m+0],K=a[3*m+1],Y=a[3*m+2],r.faces.push(new THREE.Face3(X,K,Y));if(i.length===3*z)for(m=0;m<z;++m)k=r.faces[m],B=i[3*m+0],U=i[3*m+1],G=i[3*m+2],k.color=(new THREE.Color).setRGB(B,U,G)}return r}(e(t)):function(t){var e,r,a,n,i,o,s,l=new Uint8Array(t),f=new DataView(t),u=[],p=[],A=[],d=[],y=0;function h(t,e){for(var r=e,a=t[r],n=[];10!==a;)n.push(String.fromCharCode(a)),a=t[++r];return{start:e,end:r,next:r+1,parsedString:n.join("")}}for(;;){if(0===(s=(o=h(l,y)).parsedString).indexOf("POINTS")){for(d.push(s),e=4*(n=parseInt(s.split(" ")[1],10))*3,u=new Float32Array(3*n),r=o.next,a=0;a<n;a++)u[3*a]=f.getFloat32(r,!1),u[3*a+1]=f.getFloat32(r+4,!1),u[3*a+2]=f.getFloat32(r+8,!1),r+=12;o.next=o.next+e+1}else if(0===s.indexOf("TRIANGLE_STRIPS")){var c=parseInt(s.split(" ")[1],10);e=4*(x=parseInt(s.split(" ")[2],10)),A=new Uint32Array(3*x-9*c);var b=0;for(r=o.next,a=0;a<c;a++){var w=f.getInt32(r,!1),v=[];for(r+=4,i=0;i<w;i++)v.push(f.getInt32(r,!1)),r+=4;for(var g=0;g<w-2;g++)g%2?(A[b++]=v[g],A[b++]=v[g+2],A[b++]=v[g+1]):(A[b++]=v[g],A[b++]=v[g+1],A[b++]=v[g+2])}o.next=o.next+e+1}else if(0===s.indexOf("POLYGONS")){var x;for(c=parseInt(s.split(" ")[1],10),e=4*(x=parseInt(s.split(" ")[2],10)),A=new Uint32Array(3*x-9*c),b=0,r=o.next,a=0;a<c;a++){for(w=f.getInt32(r,!1),v=[],r+=4,i=0;i<w;i++)v.push(f.getInt32(r,!1)),r+=4;for(g=1;g<w-1;g++)A[b++]=v[0],A[b++]=v[g],A[b++]=v[g+1]}o.next=o.next+e+1}else if(0===s.indexOf("POINT_DATA")){for(n=parseInt(s.split(" ")[1],10),o=h(l,o.next),e=4*n*3,p=new Float32Array(3*n),r=o.next,a=0;a<n;a++)p[3*a]=f.getFloat32(r,!1),p[3*a+1]=f.getFloat32(r+4,!1),p[3*a+2]=f.getFloat32(r+8,!1),r+=12;o.next=o.next+e}if((y=o.next)>=l.byteLength)break}var I=new THREE.BufferGeometry;return I.setIndex(new THREE.BufferAttribute(A,1)),I.addAttribute("position",new THREE.BufferAttribute(u,3)),p.length===u.length&&I.addAttribute("normal",new THREE.BufferAttribute(p,3)),I}(t)}});