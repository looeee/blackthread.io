"use strict";THREE.GCodeLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager,this.splitLayer=!1},THREE.GCodeLoader.prototype.load=function(e,t,r,o){var a=this;new THREE.FileLoader(a.manager).load(e,function(e){t(a.parse(e))},r,o)},THREE.GCodeLoader.prototype.parse=function(e){var t={x:0,y:0,z:0,e:0,f:0,extruding:!1,relative:!1},r=[],o=void 0,a=new THREE.LineBasicMaterial({color:16711680});a.name="path";var i=new THREE.LineBasicMaterial({color:65280});function n(e){o={vertex:[],pathVertex:[],z:e.z},r.push(o)}function d(e,r){return t.relative?r:r-e}function s(e,r){return t.relative?e+r:r}i.name="extruded";for(var v,l,p=e.replace(/;.+/g,"").split("\n"),f=0;f<p.length;f++){var u=p[f].split(" "),x=u[0].toUpperCase(),E={};if(u.splice(1).forEach(function(e){if(void 0!==e[0]){var t=e[0].toLowerCase(),r=parseFloat(e.substring(1));E[t]=r}}),"G0"===x||"G1"===x){var c={x:void 0!==E.x?s(t.x,E.x):t.x,y:void 0!==E.y?s(t.y,E.y):t.y,z:void 0!==E.z?s(t.z,E.z):t.z,e:void 0!==E.e?s(t.e,E.e):t.e,f:void 0!==E.f?s(t.f,E.f):t.f};d(t.e,c.e)>0&&(c.extruding=d(t.e,c.e)>0,void 0!=o&&c.z==o.z||n(c)),v=t,l=c,void 0===o&&n(v),c.extruding?(o.vertex.push(v.x,v.y,v.z),o.vertex.push(l.x,l.y,l.z)):(o.pathVertex.push(v.x,v.y,v.z),o.pathVertex.push(l.x,l.y,l.z)),t=c}else if("G2"===x||"G3"===x)console.warn("THREE.GCodeLoader: Arc command not supported");else if("G90"===x)t.relative=!1;else if("G91"===x)t.relative=!0;else if("G92"===x){(c=t).x=void 0!==E.x?E.x:c.x,c.y=void 0!==E.y?E.y:c.y,c.z=void 0!==E.z?E.z:c.z,c.e=void 0!==E.e?E.e:c.e,t=c}else console.warn("THREE.GCodeLoader: Command not supported:"+x)}function h(e,t){var r=new THREE.BufferGeometry;r.addAttribute("position",new THREE.Float32BufferAttribute(e,3));var o=new THREE.LineSegments(r,t?i:a);o.name="layer"+f,y.add(o)}var y=new THREE.Group;if(y.name="gcode",this.splitLayer)for(f=0;f<r.length;f++){h((G=r[f]).vertex,!0),h(G.pathVertex,!1)}else{var z=[],g=[];for(f=0;f<r.length;f++){var G=r[f];z=z.concat(G.vertex),g=g.concat(G.pathVertex)}h(z,!0),h(g,!1)}return y.rotation.set(-Math.PI/2,0,0),y};