THREE.UTF8Loader=function(){},THREE.UTF8Loader.prototype.load=function(e,t,r){this.downloadModelJson(e,t,r)},THREE.UTF8Loader.BufferGeometryCreator=function(){},THREE.UTF8Loader.BufferGeometryCreator.prototype.create=function(e,t){var r,o,a=t.length/3,n=new THREE.BufferGeometry,d=new Float32Array(3*a*3),s=new Float32Array(3*a*3),c=new Float32Array(3*a*2),i=e.length;for(o=0,r=0;r<i;r+=8)d[o++]=e[r],d[o++]=e[r+1],d[o++]=e[r+2];for(o=0,r=3;r<i;r+=8)c[o++]=e[r],c[o++]=e[r+1];for(o=0,r=5;r<i;r+=8)s[o++]=e[r],s[o++]=e[r+1],s[o++]=e[r+2];return n.setIndex(new THREE.BufferAttribute(t,1)),n.addAttribute("position",new THREE.BufferAttribute(d,3)),n.addAttribute("normal",new THREE.BufferAttribute(s,3)),n.addAttribute("uv",new THREE.BufferAttribute(c,2)),n.computeBoundingSphere(),n};var DEFAULT_DECODE_PARAMS={decodeOffsets:[-4095,-4095,-4095,0,0,-511,-511,-511],decodeScales:[1/8191,1/8191,1/8191,1/1023,1/1023,1/1023,1/1023,1/1023]};function getHttpRequest(e,t,r){(new THREE.FileLoader).load(e,t,r)}function getJsonRequest(e,t){getHttpRequest(e,function(e){t(JSON.parse(e))},function(){})}function addListeners(e,t){for(var r in t)e.addEventListener(r,t[r])}THREE.UTF8Loader.prototype.decompressAttribsInner_=function(e,t,r,o,a,n,d,s){for(var c=0,i=t;i<r;i++){var f=e.charCodeAt(i);c+=f>>1^-(1&f),o[a]=s*(c+d),a+=n}},THREE.UTF8Loader.prototype.decompressIndices_=function(e,t,r,o,a){for(var n=0,d=0;d<r;d++){var s=e.charCodeAt(t++);o[a++]=n-s,0===s&&n++}},THREE.UTF8Loader.prototype.decompressAABBs_=function(e,t,r,o,a){for(var n=6*r,d=t+n,s=0,c=new Float32Array(n),i=t;i<d;i+=6){var f=e.charCodeAt(i+0)+o[0],h=e.charCodeAt(i+1)+o[1],E=e.charCodeAt(i+2)+o[2],l=e.charCodeAt(i+3)+1>>1,u=e.charCodeAt(i+4)+1>>1,A=e.charCodeAt(i+5)+1>>1;c[s++]=a[0]*(f+l),c[s++]=a[1]*(h+u),c[s++]=a[2]*(E+A),c[s++]=a[0]*l,c[s++]=a[1]*u,c[s++]=a[2]*A}return c},THREE.UTF8Loader.prototype.decompressMesh=function(e,t,r,o,a,n){for(var d=r.decodeScales.length,s=r.decodeOffsets,c=r.decodeScales,i=t.attribRange[0],f=t.attribRange[1],h=i,E=new Float32Array(d*f),l=0;l<d;l++){var u=h+f,A=c[l];A&&this.decompressAttribsInner_(e,h,u,E,l,d,s[l],A),h=u}var p=3*t.indexRange[1],T=new Uint16Array(p);this.decompressIndices_(e,h,p,T,0);var v=void 0,R=t.bboxes;R&&(v=this.decompressAABBs_(e,R,t.names.length,s,c)),n(o,a,E,T,v,t)},THREE.UTF8Loader.prototype.copyAttrib=function(e,t,r,o){for(var a=0;a<e;a++)r[a]=t[e*o+a]},THREE.UTF8Loader.prototype.decodeAttrib2=function(e,t,r,o,a,n,d,s,c,i){for(var f=0;f<5;f++){var h=e.charCodeAt(a+n*f+i),E=h>>1^-(1&h);c[f]+=E,s[t*i+f]=c[f],d[t*i+f]=o[f]*(c[f]+r[f])}},THREE.UTF8Loader.prototype.accumulateNormal=function(e,t,r,o,a){var n=o[8*e],d=o[8*e+1],s=o[8*e+2],c=o[8*t],i=o[8*t+1],f=o[8*t+2],h=o[8*r],E=o[8*r+1],l=o[8*r+2];c-=n,h-=n,n=(i-=d)*(l-=s)-(f-=s)*(E-=d),d=f*h-c*l,s=c*E-i*h,a[3*e]+=n,a[3*e+1]+=d,a[3*e+2]+=s,a[3*t]+=n,a[3*t+1]+=d,a[3*t+2]+=s,a[3*r]+=n,a[3*r+1]+=d,a[3*r+2]+=s},THREE.UTF8Loader.prototype.decompressMesh2=function(e,t,r,o,a,n){for(var d=r.decodeScales.length,s=r.decodeOffsets,c=r.decodeScales,i=t.attribRange[0],f=t.attribRange[1],h=t.codeRange[0],E=3*t.codeRange[2],l=new Uint16Array(E),u=new Int32Array(3*f),A=new Uint16Array(d),p=new Uint16Array(d*f),T=new Float32Array(d*f),v=0,R=0,y=0;y<E;y+=3){var m=e.charCodeAt(h++),b=Math.min(y,96);if(m<b){var w,H,g,F=m%3,C=y-(m-F);switch(F){case 0:w=l[C+2],H=l[C+1],g=l[C+0];break;case 1:w=l[C+0],H=l[C+2],g=l[C+1];break;case 2:w=l[C+1],H=l[C+0],g=l[C+2]}l[R++]=w,l[R++]=H;var L=v-(m=e.charCodeAt(h++));if(l[R++]=L,0===m){for(var U=0;U<5;U++){var M=e.charCodeAt(i+f*U+v),B=(M>>1^-(1&M))+p[d*w+U]+p[d*H+U]-p[d*g+U];A[U]=B,p[d*v+U]=B,T[d*v+U]=c[U]*(B+s[U])}v++}else this.copyAttrib(d,p,A,L);this.accumulateNormal(w,H,L,p,u)}else{var _=v-(m-b);l[R++]=_,m===b?this.decodeAttrib2(e,d,s,c,i,f,T,p,A,v++):this.copyAttrib(d,p,A,_);var O=v-(m=e.charCodeAt(h++));l[R++]=O,0===m?this.decodeAttrib2(e,d,s,c,i,f,T,p,A,v++):this.copyAttrib(d,p,A,O);var S=v-(m=e.charCodeAt(h++));if(l[R++]=S,0===m){for(U=0;U<5;U++)A[U]=(p[d*_+U]+p[d*O+U])/2;this.decodeAttrib2(e,d,s,c,i,f,T,p,A,v++)}else this.copyAttrib(d,p,A,S);this.accumulateNormal(_,O,S,p,u)}}for(y=0;y<f;y++){var D=u[3*y],P=u[3*y+1],I=u[3*y+2],k=511/Math.sqrt(D*D+P*P+I*I),q=e.charCodeAt(i+5*f+y),x=e.charCodeAt(i+6*f+y),J=e.charCodeAt(i+7*f+y);T[d*y+5]=k*D+(q>>1^-(1&q)),T[d*y+6]=k*P+(x>>1^-(1&x)),T[d*y+7]=k*I+(J>>1^-(1&J))}n(o,a,T,l,void 0,t)},THREE.UTF8Loader.prototype.downloadMesh=function(e,t,r,o,a){var n=this,d=0;getHttpRequest(e,function(e){!function(e){for(;d<r.length;){var s=r[d],c=s.indexRange;if(c){var i=c[0]+3*c[1];if(e.length<i)break;n.decompressMesh(e,s,o,t,d,a)}else{var f=s.codeRange;if(i=f[0]+f[1],e.length<i)break;n.decompressMesh2(e,s,o,t,d,a)}++d}}(e)})},THREE.UTF8Loader.prototype.downloadMeshes=function(e,t,r,o){for(var a in t){var n=t[a];this.downloadMesh(e+a,a,n,r,o)}},THREE.UTF8Loader.prototype.createMeshCallback=function(e,t,r){var o=0,a=0,n={},d={},s={},c=t.urls;for(var i in c)n[i]=c[i].length,d[i]=0,a++,s[i]=new THREE.Object3D;var f=new THREE.Object3D,h=new THREE.MTLLoader.MaterialCreator(e,t.options);h.setMaterials(t.materials),h.preload();var E=new THREE.UTF8Loader.BufferGeometryCreator;return function(e,t,c,i,l,u){var A=E.create(c,i),p=h.create(u.material),T=new THREE.Mesh(A,p);s[e].add(T),d[e]++,d[e]===n[e]&&(o++,f.add(s[e]),o===a&&r(f))}},THREE.UTF8Loader.prototype.downloadModel=function(e,t,r,o){var a=this.createMeshCallback(t,r,o);this.downloadMeshes(e,r.urls,r.decodeParams,a)},THREE.UTF8Loader.prototype.downloadModelJson=function(e,t,r){getJsonRequest(e,function(o){o.decodeParams||(r&&r.decodeParams?o.decodeParams=r.decodeParams:o.decodeParams=DEFAULT_DECODE_PARAMS),o.options=r;var a=e.substr(0,e.lastIndexOf("/")+1),n=a;r&&r.geometryBase&&"/"!==(a=r.geometryBase).charAt(a.length-1)&&(a+="/"),r&&r.materialBase&&"/"!==(n=r.materialBase).charAt(n.length-1)&&(n+="/"),this.downloadModel(a,n,o,t)}.bind(this))};