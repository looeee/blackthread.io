THREE.TempNode=function(e,t){THREE.GLNode.call(this,e),t=t||{},this.shared=void 0===t.shared||t.shared,this.unique=void 0!==t.unique&&t.unique},THREE.TempNode.prototype=Object.create(THREE.GLNode.prototype),THREE.TempNode.prototype.constructor=THREE.TempNode,THREE.TempNode.prototype.build=function(e,t,r,i){t=t||this.getType(e);var o=e.material;if(this.isShared(e,t)){var p=this.isUnique(e,t);p&&void 0===this.constructor.uuid&&(this.constructor.uuid=THREE.Math.generateUUID()),r=e.getUuid(r||this.getUuid(),!p);var s=o.getDataNode(r);if(e.parsing)return s.deps?(this.appendDepsNode(e,s,t),this.generate(e,d,r)):THREE.GLNode.prototype.build.call(this,e,t,r);if(p)return s.name=s.name||THREE.GLNode.prototype.build.call(this,e,t,r),s.name;if(!e.optimize||1==s.deps)return THREE.GLNode.prototype.build.call(this,e,t,r);r=this.getUuid(!1);var a=this.getTemp(e,r),d=s.output||this.getType(e);if(a)return e.format(a,d,t);a=THREE.TempNode.prototype.generate.call(this,e,t,r,s.output,i);var u=this.generate(e,d,r);return e.isShader("vertex")?o.addVertexNode(a+"="+u+";"):o.addFragmentNode(a+"="+u+";"),e.format(a,d,t)}return THREE.GLNode.prototype.build.call(this,e,t,r)},THREE.TempNode.prototype.isShared=function(e,t){return"sampler2D"!==t&&"samplerCube"!==t&&this.shared},THREE.TempNode.prototype.isUnique=function(e,t){return this.unique},THREE.TempNode.prototype.getUuid=function(e){var t=(e||void 0==e)&&this.constructor.uuid||this.uuid;return"string"==typeof this.scope&&(t=this.scope+"-"+t),t},THREE.TempNode.prototype.getTemp=function(e,t){t=t||this.uuid;var r=e.material;return e.isShader("vertex")&&r.vertexTemps[t]?r.vertexTemps[t].name:r.fragmentTemps[t]?r.fragmentTemps[t].name:void 0},THREE.TempNode.prototype.generate=function(e,t,r,i,o){return this.isShared(e,t)||console.error("THREE.TempNode is not shared!"),r=r||this.uuid,e.isShader("vertex")?e.material.getVertexTemp(r,i||this.getType(e),o).name:e.material.getFragmentTemp(r,i||this.getType(e),o).name};