("function"==typeof define?function(t){define("msgpack-js",t)}:"object"==typeof exports?function(t){module.exports=t()}:function(t){this.msgpack=t()})(function(){"use strict";var t={};function e(t,e,r){t.byteLength;for(var i=0,n=r.length;i<n;i++){var s=r.charCodeAt(i);if(s<128)t.setUint8(e++,s>>>0&127|0);else if(s<2048)t.setUint8(e++,s>>>6&31|192),t.setUint8(e++,s>>>0&63|128);else if(s<65536)t.setUint8(e++,s>>>12&15|224),t.setUint8(e++,s>>>6&63|128),t.setUint8(e++,s>>>0&63|128);else{if(!(s<1114112))throw new Error("bad codepoint "+s);t.setUint8(e++,s>>>18&7|240),t.setUint8(e++,s>>>12&63|128),t.setUint8(e++,s>>>6&63|128),t.setUint8(e++,s>>>0&63|128)}}}function r(t,e,r){for(var i="",n=e,s=e+r;n<s;n++){var f=t.getUint8(n);if(0!=(128&f))if(192!=(224&f))if(224!=(240&f)){if(240!=(248&f))throw new Error("Invalid byte "+f.toString(16));i+=String.fromCharCode((7&f)<<18|(63&t.getUint8(++n))<<12|(63&t.getUint8(++n))<<6|(63&t.getUint8(++n))<<0)}else i+=String.fromCharCode((15&f)<<12|(63&t.getUint8(++n))<<6|(63&t.getUint8(++n))<<0);else i+=String.fromCharCode((31&f)<<6|63&t.getUint8(++n));else i+=String.fromCharCode(f)}return i}function i(t){for(var e=0,r=0,i=t.length;r<i;r++){var n=t.charCodeAt(r);if(n<128)e+=1;else if(n<2048)e+=2;else if(n<65536)e+=3;else{if(!(n<1114112))throw new Error("bad codepoint "+n);e+=4}}return e}function n(t,e){this.offset=e||0,this.view=t}return t.inspect=function(t){if(void 0===t)return"undefined";var e,r;t instanceof ArrayBuffer?(r="ArrayBuffer",e=new DataView(t)):t instanceof DataView&&(r="DataView",e=t);if(!e)return JSON.stringify(t);for(var i=[],n=0;n<t.byteLength;n++){if(n>20){i.push("...");break}var s=e.getUint8(n).toString(16);1===s.length&&(s="0"+s),i.push(s)}return"<"+r+" "+i.join(" ")+">"},t.utf8Write=e,t.utf8Read=r,t.utf8ByteCount=i,t.encode=function(t){var r=new ArrayBuffer(function t(e){var r=typeof e;if("string"===r){var n=i(e);if(n<32)return 1+n;if(n<256)return 2+n;if(n<65536)return 3+n;if(n<4294967296)return 5+n}if(e instanceof ArrayBuffer){var n=e.byteLength;if(n<256)return 2+n;if(n<65536)return 3+n;if(n<4294967296)return 5+n}if("number"===r){if(e<<0!==e)return 9;if(e>=0){if(e<128)return 1;if(e<256)return 2;if(e<65536)return 3;if(e<4294967296)return 5;if(e<0x10000000000000000)return 9;throw new Error("Number too big 0x"+e.toString(16))}if(e>=-32)return 1;if(e>=-128)return 2;if(e>=-32768)return 3;if(e>=-2147483648)return 5;if(e>=-0x8000000000000000)return 9;throw new Error("Number too small -0x"+e.toString(16).substr(1))}if("undefined"===r)return 3;if("boolean"===r||null===e)return 1;if("object"===r){var s=0;if(Array.isArray(e)){n=e.length;for(var f=0;f<n;f++)s+=t(e[f])}else{var o=Object.keys(e);n=o.length;for(var f=0;f<n;f++){var h=o[f];s+=t(h)+t(e[h])}}if(n<16)return 1+s;if(n<65536)return 3+s;if(n<4294967296)return 5+s;throw new Error("Array or object too long 0x"+n.toString(16))}throw new Error("Unknown type "+r)}(t));return function t(r,n,s){var f=typeof r;if("string"===f){var o=i(r);if(o<32)return n.setUint8(s,160|o),e(n,s+1,r),1+o;if(o<256)return n.setUint8(s,217),n.setUint8(s+1,o),e(n,s+2,r),2+o;if(o<65536)return n.setUint8(s,218),n.setUint16(s+1,o),e(n,s+3,r),3+o;if(o<4294967296)return n.setUint8(s,219),n.setUint32(s+1,o),e(n,s+5,r),5+o}if(r instanceof ArrayBuffer){var o=r.byteLength;if(o<256)return n.setUint8(s,196),n.setUint8(s+1,o),new Uint8Array(n.buffer).set(new Uint8Array(r),s+2),2+o;if(o<65536)return n.setUint8(s,197),n.setUint16(s+1,o),new Uint8Array(n.buffer).set(new Uint8Array(r),s+3),3+o;if(o<4294967296)return n.setUint8(s,198),n.setUint32(s+1,o),new Uint8Array(n.buffer).set(new Uint8Array(r),s+5),5+o}if("number"===f){if(r<<0!==r)return n.setUint8(s,203),n.setFloat64(s+1,r),9;if(r>=0){if(r<128)return n.setUint8(s,r),1;if(r<256)return n.setUint8(s,204),n.setUint8(s+1,r),2;if(r<65536)return n.setUint8(s,205),n.setUint16(s+1,r),3;if(r<4294967296)return n.setUint8(s,206),n.setUint32(s+1,r),5;throw new Error("Number too big 0x"+r.toString(16))}if(r>=-32)return n.setInt8(s,r),1;if(r>=-128)return n.setUint8(s,208),n.setInt8(s+1,r),2;if(r>=-32768)return n.setUint8(s,209),n.setInt16(s+1,r),3;if(r>=-2147483648)return n.setUint8(s,210),n.setInt32(s+1,r),5;throw new Error("Number too small -0x"+(-r).toString(16).substr(1))}if("undefined"===f)return n.setUint8(s,212),n.setUint8(s+1,0),n.setUint8(s+2,0),3;if(null===r)return n.setUint8(s,192),1;if("boolean"===f)return n.setUint8(s,r?195:194),1;if("object"===f){var h=0,u=Array.isArray(r);if(u)o=r.length;else{var a=Object.keys(r);o=a.length}if(o<16?(n.setUint8(s,o|(u?144:128)),h=1):o<65536?(n.setUint8(s,u?220:222),n.setUint16(s+1,o),h=3):o<4294967296&&(n.setUint8(s,u?221:223),n.setUint32(s+1,o),h=5),u)for(var U=0;U<o;U++)h+=t(r[U],n,s+h);else for(var U=0;U<o;U++){var w=a[U];h+=t(w,n,s+h),h+=t(r[w],n,s+h)}return h}throw new Error("Unknown type "+f)}(t,new DataView(r),0),r},t.decode=function(t){var e=new n(new DataView(t)),r=e.parse();if(e.offset!==t.byteLength)throw new Error(t.byteLength-e.offset+" trailing bytes");return r},n.prototype.map=function(t){for(var e={},r=0;r<t;r++){e[this.parse()]=this.parse()}return e},n.prototype.bin=function(t){var e=new ArrayBuffer(t);return new Uint8Array(e).set(new Uint8Array(this.view.buffer,this.offset,t),0),this.offset+=t,e},n.prototype.str=function(t){var e=r(this.view,this.offset,t);return this.offset+=t,e},n.prototype.array=function(t){for(var e=new Array(t),r=0;r<t;r++)e[r]=this.parse();return e},n.prototype.parse=function(){var t,e,r=this.view.getUint8(this.offset);if(160==(224&r))return e=31&r,this.offset++,this.str(e);if(128==(240&r))return e=15&r,this.offset++,this.map(e);if(144==(240&r))return e=15&r,this.offset++,this.array(e);if(0==(128&r))return this.offset++,r;if(224==(224&r))return t=this.view.getInt8(this.offset),this.offset++,t;if(212!==r||0!==this.view.getUint8(this.offset+1)){switch(r){case 217:return e=this.view.getUint8(this.offset+1),this.offset+=2,this.str(e);case 218:return e=this.view.getUint16(this.offset+1),this.offset+=3,this.str(e);case 219:return e=this.view.getUint32(this.offset+1),this.offset+=5,this.str(e);case 196:return e=this.view.getUint8(this.offset+1),this.offset+=2,this.bin(e);case 197:return e=this.view.getUint16(this.offset+1),this.offset+=3,this.bin(e);case 198:return e=this.view.getUint32(this.offset+1),this.offset+=5,this.bin(e);case 192:return this.offset++,null;case 194:return this.offset++,!1;case 195:return this.offset++,!0;case 204:return t=this.view.getUint8(this.offset+1),this.offset+=2,t;case 205:return t=this.view.getUint16(this.offset+1),this.offset+=3,t;case 206:return t=this.view.getUint32(this.offset+1),this.offset+=5,t;case 207:return t=4294967296*this.view.getUint32(this.offset+1)+this.view.getUint32(this.offset+5),this.offset+=9,t;case 208:return t=this.view.getInt8(this.offset+1),this.offset+=2,t;case 209:return t=this.view.getInt16(this.offset+1),this.offset+=3,t;case 210:return t=this.view.getInt32(this.offset+1),this.offset+=5,t;case 211:return t=4294967296*this.view.getInt32(this.offset+1)+this.view.getUint32(this.offset+5),this.offset+=9,t;case 222:return e=this.view.getUint16(this.offset+1),this.offset+=3,this.map(e);case 223:return e=this.view.getUint32(this.offset+1),this.offset+=5,this.map(e);case 220:return e=this.view.getUint16(this.offset+1),this.offset+=3,this.array(e);case 221:return e=this.view.getUint32(this.offset+1),this.offset+=5,this.array(e);case 202:return t=this.view.getFloat32(this.offset+1),this.offset+=5,t;case 203:return t=this.view.getFloat64(this.offset+1),this.offset+=9,t}throw new Error("Unknown type 0x"+r.toString(16))}this.offset+=3},t});