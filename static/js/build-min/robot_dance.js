this.robot_dance=this.robot_dance||{},function(){"use strict";function t(t,e){return e={exports:{}},t(e,e.exports),e.exports}function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):Math.log(t+Math.sqrt(t*t+1)):t}function n(t){var e,n;this.promise=new t(function(t,r){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=r}),this.resolve=Ka(e),this.reject=Ka(n)}function r(t,e){var n=arguments.length<3?t:arguments[2],i,o;return Ua(t)===n?t[e]:(i=pc.f(t,e))?Ia(i,"value")?i.value:void 0!==i.get?i.get.call(n):void 0:Da(o=Qc(t))?r(o,e,n):void 0}function i(t,e,n){var r=arguments.length<4?t:arguments[3],o=pc.f(Ua(t),e),a,s;if(!o){if(Da(s=Qc(t)))return i(s,e,n,r);o=Ya(0)}return Ia(o,"value")?!(!1===o.writable||!Da(r))&&(a=pc.f(r,e)||Ya(0),a.value=n,Wa.f(r,e,a),!0):void 0!==o.set&&(o.set.call(r,n),!0)}function o(t,e,n,r,i,a,s,c){for(var u=i,h=0,l=!!s&&$a(s,c,3),d,p;h<r;){if(h in n){if(d=l?l(n[h],h,e):n[h],p=!1,Da(d)&&(p=void 0!==(p=d[Lf])?!!p:Xs(d)),p&&a>0)u=o(t,e,d,Rs(d.length),u,a-1)-1;else{if(u>=9007199254740991)throw TypeError();t[u]=d}u++}h++}return u}function a(t,e,n){t[e]||Object[iv](t,e,{writable:!0,configurable:!0,value:n})}function s(){}function c(t,e){this.x=t||0,this.y=e||0}function u(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function h(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._w=void 0!==r?r:1}function l(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}function d(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function p(t,e,n,r,i,o,a,s,u,h){Object.defineProperty(this,"id",{value:Iy++}),this.uuid=Ry.generateUUID(),this.name="",this.image=void 0!==t?t:p.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:p.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:pg,this.wrapT=void 0!==r?r:pg,this.magFilter=void 0!==i?i:yg,this.minFilter=void 0!==o?o:bg,this.anisotropy=void 0!==u?u:1,this.format=void 0!==a?a:Fg,this.type=void 0!==s?s:wg,this.offset=new c(0,0),this.repeat=new c(1,1),this.center=new c(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new d,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==h?h:wy,this.version=0,this.onUpdate=null}function f(t,e,n,r){this.x=t||0,this.y=e||0,this.z=n||0,this.w=void 0!==r?r:1}function m(t,e,n){this.uuid=Ry.generateUUID(),this.width=t,this.height=e,this.scissor=new f(0,0,t,e),this.scissorTest=!1,this.viewport=new f(0,0,t,e),void 0===(n=n||{}).minFilter&&(n.minFilter=yg),this.texture=new p(void 0,void 0,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function v(t,e,n){m.call(this,t,e,n),this.activeCubeFace=0,this.activeMipMapLevel=0}function g(t,e,n,r,i,o,a,s,c,u,h,l){p.call(this,null,o,a,s,c,u,r,i,h,l),this.image={data:t,width:e,height:n},this.magFilter=void 0!==c?c:mg,this.minFilter=void 0!==u?u:mg,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function y(t,e,n,r,i,o,a,s,c,u){t=void 0!==t?t:[],e=void 0!==e?e:og,p.call(this,t,e,n,r,i,o,a,s,c,u),this.flipY=!1}function x(){this.seq=[],this.map={}}function b(t,e,n){var r=t[0];if(r<=0||r>0)return t;var i=e*n,o=Ny[i];if(void 0===o&&(o=new Float32Array(i),Ny[i]=o),0!==e){r.toArray(o,0);for(var a=1,s=0;a!==e;++a)s+=n,t[a].toArray(o,s)}return o}function w(t,e){var n=Fy[e];void 0===n&&(n=new Int32Array(e),Fy[e]=n);for(var r=0;r!==e;++r)n[r]=t.allocTextureUnit();return n}function _(t,e){t.uniform1f(this.addr,e)}function S(t,e){t.uniform1i(this.addr,e)}function M(t,e){void 0===e.x?t.uniform2fv(this.addr,e):t.uniform2f(this.addr,e.x,e.y)}function E(t,e){void 0!==e.x?t.uniform3f(this.addr,e.x,e.y,e.z):void 0!==e.r?t.uniform3f(this.addr,e.r,e.g,e.b):t.uniform3fv(this.addr,e)}function T(t,e){void 0===e.x?t.uniform4fv(this.addr,e):t.uniform4f(this.addr,e.x,e.y,e.z,e.w)}function L(t,e){t.uniformMatrix2fv(this.addr,!1,e.elements||e)}function A(t,e){void 0===e.elements?t.uniformMatrix3fv(this.addr,!1,e):(Uy.set(e.elements),t.uniformMatrix3fv(this.addr,!1,Uy))}function P(t,e){void 0===e.elements?t.uniformMatrix4fv(this.addr,!1,e):(Dy.set(e.elements),t.uniformMatrix4fv(this.addr,!1,Dy))}function R(t,e,n){var r=n.allocTextureUnit();t.uniform1i(this.addr,r),n.setTexture2D(e||Cy,r)}function I(t,e,n){var r=n.allocTextureUnit();t.uniform1i(this.addr,r),n.setTextureCube(e||Oy,r)}function C(t,e){t.uniform2iv(this.addr,e)}function O(t,e){t.uniform3iv(this.addr,e)}function N(t,e){t.uniform4iv(this.addr,e)}function F(t){switch(t){case 5126:return _;case 35664:return M;case 35665:return E;case 35666:return T;case 35674:return L;case 35675:return A;case 35676:return P;case 35678:case 36198:return R;case 35680:return I;case 5124:case 35670:return S;case 35667:case 35671:return C;case 35668:case 35672:return O;case 35669:case 35673:return N}}function D(t,e){t.uniform1fv(this.addr,e)}function U(t,e){t.uniform1iv(this.addr,e)}function B(t,e){t.uniform2fv(this.addr,b(e,this.size,2))}function z(t,e){t.uniform3fv(this.addr,b(e,this.size,3))}function G(t,e){t.uniform4fv(this.addr,b(e,this.size,4))}function k(t,e){t.uniformMatrix2fv(this.addr,!1,b(e,this.size,4))}function j(t,e){t.uniformMatrix3fv(this.addr,!1,b(e,this.size,9))}function V(t,e){t.uniformMatrix4fv(this.addr,!1,b(e,this.size,16))}function H(t,e,n){var r=e.length,i=w(n,r);t.uniform1iv(this.addr,i);for(var o=0;o!==r;++o)n.setTexture2D(e[o]||Cy,i[o])}function W(t,e,n){var r=e.length,i=w(n,r);t.uniform1iv(this.addr,i);for(var o=0;o!==r;++o)n.setTextureCube(e[o]||Oy,i[o])}function Y(t){switch(t){case 5126:return D;case 35664:return B;case 35665:return z;case 35666:return G;case 35674:return k;case 35675:return j;case 35676:return V;case 35678:return H;case 35680:return W;case 5124:case 35670:return U;case 35667:case 35671:return C;case 35668:case 35672:return O;case 35669:case 35673:return N}}function X(t,e,n){this.id=t,this.addr=n,this.setValue=F(e.type)}function q(t,e,n){this.id=t,this.addr=n,this.size=e.size,this.setValue=Y(e.type)}function Z(t){this.id=t,x.call(this)}function J(t,e){t.seq.push(e),t.map[e.id]=e}function Q(t,e,n){var r=t.name,i=r.length;for(By.lastIndex=0;;){var o=By.exec(r),a=By.lastIndex,s=o[1],c="]"===o[2],u=o[3];if(c&&(s|=0),void 0===u||"["===u&&a+2===i){J(n,void 0===u?new X(s,t,e):new q(s,t,e));break}var h,l=n.map[s];void 0===l&&J(n,l=new Z(s)),n=l}}function K(t,e,n){x.call(this),this.renderer=n;for(var r=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),i=0;i<r;++i){var o=t.getActiveUniform(e,i),a=o.name,s;Q(o,t.getUniformLocation(e,a),this)}}function $(t,e,n){return void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}function tt(t,e,n,r,i,o,a,s,c){p.call(this,t,e,n,r,i,o,a,s,c),this.needsUpdate=!0}function et(t,e,n,r,i){function o(){var t=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),n=new Uint16Array([0,1,2,0,2,3]);c=e.createBuffer(),u=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,c),e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,u),e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW),d=a(),p={position:e.getAttribLocation(d,"position"),uv:e.getAttribLocation(d,"uv")},f={uvOffset:e.getUniformLocation(d,"uvOffset"),uvScale:e.getUniformLocation(d,"uvScale"),rotation:e.getUniformLocation(d,"rotation"),center:e.getUniformLocation(d,"center"),scale:e.getUniformLocation(d,"scale"),color:e.getUniformLocation(d,"color"),map:e.getUniformLocation(d,"map"),opacity:e.getUniformLocation(d,"opacity"),modelViewMatrix:e.getUniformLocation(d,"modelViewMatrix"),projectionMatrix:e.getUniformLocation(d,"projectionMatrix"),fogType:e.getUniformLocation(d,"fogType"),fogDensity:e.getUniformLocation(d,"fogDensity"),fogNear:e.getUniformLocation(d,"fogNear"),fogFar:e.getUniformLocation(d,"fogFar"),fogColor:e.getUniformLocation(d,"fogColor"),fogDepth:e.getUniformLocation(d,"fogDepth"),alphaTest:e.getUniformLocation(d,"alphaTest")};var r=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");r.width=8,r.height=8;var i=r.getContext("2d");i.fillStyle="white",i.fillRect(0,0,8,8),m=new tt(r)}function a(){var t=e.createProgram(),n=e.createShader(e.VERTEX_SHADER),r=e.createShader(e.FRAGMENT_SHADER);return e.shaderSource(n,["precision "+i.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 center;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float fogDepth;","void main() {","\tvUV = uvOffset + uv * uvScale;","\tvec2 alignedPosition = ( position - center ) * scale;","\tvec2 rotatedPosition;","\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","\tvec4 mvPosition;","\tmvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","\tmvPosition.xy += rotatedPosition;","\tgl_Position = projectionMatrix * mvPosition;","\tfogDepth = - mvPosition.z;","}"].join("\n")),e.shaderSource(r,["precision "+i.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","varying float fogDepth;","void main() {","\tvec4 texture = texture2D( map, vUV );","\tgl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","\tif ( gl_FragColor.a < alphaTest ) discard;","\tif ( fogType > 0 ) {","\t\tfloat fogFactor = 0.0;","\t\tif ( fogType == 1 ) {","\t\t\tfogFactor = smoothstep( fogNear, fogFar, fogDepth );","\t\t} else {","\t\t\tconst float LOG2 = 1.442695;","\t\t\tfogFactor = exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 );","\t\t\tfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","\t\t}","\t\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );","\t}","}"].join("\n")),e.compileShader(n),e.compileShader(r),e.attachShader(t,n),e.attachShader(t,r),e.linkProgram(t),t}function s(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:e.id-t.id}var c,u,d,p,f,m,v=new l,g=new h,y=new l;this.render=function(i,a,h){if(0!==i.length){void 0===d&&o(),n.useProgram(d),n.initAttributes(),n.enableAttribute(p.position),n.enableAttribute(p.uv),n.disableUnusedAttributes(),n.disable(e.CULL_FACE),n.enable(e.BLEND),e.bindBuffer(e.ARRAY_BUFFER,c),e.vertexAttribPointer(p.position,2,e.FLOAT,!1,16,0),e.vertexAttribPointer(p.uv,2,e.FLOAT,!1,16,8),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,u),e.uniformMatrix4fv(f.projectionMatrix,!1,h.projectionMatrix.elements),n.activeTexture(e.TEXTURE0),e.uniform1i(f.map,0);var l=0,x=0,b=a.fog;b?(e.uniform3f(f.fogColor,b.color.r,b.color.g,b.color.b),b.isFog?(e.uniform1f(f.fogNear,b.near),e.uniform1f(f.fogFar,b.far),e.uniform1i(f.fogType,1),l=1,x=1):b.isFogExp2&&(e.uniform1f(f.fogDensity,b.density),e.uniform1i(f.fogType,2),l=2,x=2)):(e.uniform1i(f.fogType,0),l=0,x=0);for(var w=0,_=i.length;w<_;w++){var S;(S=i[w]).modelViewMatrix.multiplyMatrices(h.matrixWorldInverse,S.matrixWorld),S.z=-S.modelViewMatrix.elements[14]}i.sort(s);for(var M=[],E=[],w=0,_=i.length;w<_;w++){var S,T=(S=i[w]).material;if(!1!==T.visible){S.onBeforeRender(t,a,h,void 0,T,void 0),e.uniform1f(f.alphaTest,T.alphaTest),e.uniformMatrix4fv(f.modelViewMatrix,!1,S.modelViewMatrix.elements),S.matrixWorld.decompose(v,g,y),M[0]=y.x,M[1]=y.y,E[0]=S.center.x-.5,E[1]=S.center.y-.5;var L=0;a.fog&&T.fog&&(L=x),l!==L&&(e.uniform1i(f.fogType,L),l=L),null!==T.map?(e.uniform2f(f.uvOffset,T.map.offset.x,T.map.offset.y),e.uniform2f(f.uvScale,T.map.repeat.x,T.map.repeat.y)):(e.uniform2f(f.uvOffset,0,0),e.uniform2f(f.uvScale,1,1)),e.uniform1f(f.opacity,T.opacity),e.uniform3f(f.color,T.color.r,T.color.g,T.color.b),e.uniform1f(f.rotation,T.rotation),e.uniform2fv(f.center,E),e.uniform2fv(f.scale,M),n.setBlending(T.blending,T.blendEquation,T.blendSrc,T.blendDst,T.blendEquationAlpha,T.blendSrcAlpha,T.blendDstAlpha,T.premultipliedAlpha),n.buffers.depth.setTest(T.depthTest),n.buffers.depth.setMask(T.depthWrite),n.buffers.color.setMask(T.colorWrite),r.setTexture2D(T.map||m,0),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0),S.onAfterRender(t,a,h,void 0,T,void 0)}}n.enable(e.CULL_FACE),n.reset()}}}function nt(){Object.defineProperty(this,"id",{value:Wb++}),this.uuid=Ry.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=wv,this.side=pv,this.flatShading=!1,this.vertexColors=gv,this.opacity=1,this.transparent=!1,this.blendSrc=Fv,this.blendDst=Dv,this.blendEquation=Tv,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Wv,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this.userData={},this.needsUpdate=!0}function rt(t){nt.call(this),this.type="MeshDepthMaterial",this.depthPacking=Ay,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(t)}function it(t){nt.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new l,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.lights=!1,this.setValues(t)}function ot(t,e){this.min=void 0!==t?t:new l(1/0,1/0,1/0),this.max=void 0!==e?e:new l(-1/0,-1/0,-1/0)}function at(t,e){this.center=void 0!==t?t:new l,this.radius=void 0!==e?e:0}function st(t,e){this.normal=void 0!==t?t:new l(1,0,0),this.constant=void 0!==e?e:0}function ct(t,e,n,r,i,o){this.planes=[void 0!==t?t:new st,void 0!==e?e:new st,void 0!==n?n:new st,void 0!==r?r:new st,void 0!==i?i:new st,void 0!==o?o:new st]}function ut(t,e,n){function r(e,n,r,i,o,a){var s=e.geometry,c=null,u=x,h=e.customDepthMaterial;if(r&&(u=b,h=e.customDistanceMaterial),h)c=h;else{var l=!1;n.morphTargets&&(s&&s.isBufferGeometry?l=s.morphAttributes&&s.morphAttributes.position&&s.morphAttributes.position.length>0:s&&s.isGeometry&&(l=s.morphTargets&&s.morphTargets.length>0)),e.isSkinnedMesh&&!1===n.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",e);var d=e.isSkinnedMesh&&n.skinning,p=0;l&&(p|=v),d&&(p|=g),c=u[p]}if(t.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length){var f=c.uuid,m=n.uuid,y=w[f];void 0===y&&(y={},w[f]=y);var S=y[m];void 0===S&&(S=c.clone(),y[m]=S),c=S}return c.visible=n.visible,c.wireframe=n.wireframe,c.side=null!=n.shadowSide?n.shadowSide:_[n.side],c.clipShadows=n.clipShadows,c.clippingPlanes=n.clippingPlanes,c.clipIntersection=n.clipIntersection,c.wireframeLinewidth=n.wireframeLinewidth,c.linewidth=n.linewidth,r&&c.isMeshDistanceMaterial&&(c.referencePosition.copy(i),c.nearDistance=o,c.farDistance=a),c}function i(n,a,s,c){if(!1!==n.visible){var u;if(n.layers.test(a.layers)&&(n.isMesh||n.isLine||n.isPoints)&&n.castShadow&&(!n.frustumCulled||o.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,n.matrixWorld);var h=e.update(n),l=n.material;if(Array.isArray(l))for(var d=h.groups,f=0,m=d.length;f<m;f++){var v=d[f],g=l[v.materialIndex];if(g&&g.visible){var y=r(n,g,c,p,s.near,s.far);t.renderBufferDirect(s,null,h,y,n,v)}}else if(l.visible){var y=r(n,l,c,p,s.near,s.far);t.renderBufferDirect(s,null,h,y,n,null)}}for(var x=n.children,b=0,w=x.length;b<w;b++)i(x[b],a,s,c)}}for(var o=new ct,a=new u,s=new c,h=new c(n,n),d=new l,p=new l,v=1,g=2,y=1+(v|g),x=new Array(y),b=new Array(y),w={},_={0:fv,1:pv,2:mv},S=[new l(1,0,0),new l(-1,0,0),new l(0,0,1),new l(0,0,-1),new l(0,1,0),new l(0,-1,0)],M=[new l(0,1,0),new l(0,1,0),new l(0,1,0),new l(0,1,0),new l(0,0,1),new l(0,0,-1)],E=[new f,new f,new f,new f,new f,new f],T=0;T!==y;++T){var L=0!=(T&v),A=0!=(T&g),P=new rt({depthPacking:Py,morphTargets:L,skinning:A});x[T]=P;var R=new it({morphTargets:L,skinning:A});b[T]=R}var I=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=lv,this.render=function(e,n,r){if(!1!==I.enabled&&(!1!==I.autoUpdate||!1!==I.needsUpdate)&&0!==e.length){var c=t.context,u=t.state;u.disable(c.BLEND),u.buffers.color.setClear(1,1,1,1),u.buffers.depth.setTest(!0),u.setScissorTest(!1);for(var l,f=0,v=e.length;f<v;f++){var g=e[f],y=g.shadow,x=g&&g.isPointLight;if(void 0!==y){var b=y.camera;if(s.copy(y.mapSize),s.min(h),x){var w=s.x,_=s.y;E[0].set(2*w,_,w,_),E[1].set(0,_,w,_),E[2].set(3*w,_,w,_),E[3].set(w,_,w,_),E[4].set(3*w,0,w,_),E[5].set(w,0,w,_),s.x*=4,s.y*=2}if(null===y.map){var T={minFilter:mg,magFilter:mg,format:Fg};y.map=new m(s.x,s.y,T),y.map.texture.name=g.name+".shadowMap",b.updateProjectionMatrix()}y.isSpotLightShadow&&y.update(g);var L=y.map,A=y.matrix;p.setFromMatrixPosition(g.matrixWorld),b.position.copy(p),x?(l=6,A.makeTranslation(-p.x,-p.y,-p.z)):(l=1,d.setFromMatrixPosition(g.target.matrixWorld),b.lookAt(d),b.updateMatrixWorld(),A.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),A.multiply(b.projectionMatrix),A.multiply(b.matrixWorldInverse)),t.setRenderTarget(L),t.clear();for(var P=0;P<l;P++){if(x){d.copy(b.position),d.add(S[P]),b.up.copy(M[P]),b.lookAt(d),b.updateMatrixWorld();var R=E[P];u.viewport(R)}a.multiplyMatrices(b.projectionMatrix,b.matrixWorldInverse),o.setFromMatrix(a),i(n,r,b,x)}}else console.warn("THREE.WebGLShadowMap:",g,"has no shadow.")}I.needsUpdate=!1}}}function ht(t){function e(e,n){var r=e.array,i=e.dynamic?t.DYNAMIC_DRAW:t.STATIC_DRAW,o=t.createBuffer();t.bindBuffer(n,o),t.bufferData(n,r,i),e.onUploadCallback();var a=t.FLOAT;return r instanceof Float32Array?a=t.FLOAT:r instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):r instanceof Uint16Array?a=t.UNSIGNED_SHORT:r instanceof Int16Array?a=t.SHORT:r instanceof Uint32Array?a=t.UNSIGNED_INT:r instanceof Int32Array?a=t.INT:r instanceof Int8Array?a=t.BYTE:r instanceof Uint8Array&&(a=t.UNSIGNED_BYTE),{buffer:o,type:a,bytesPerElement:r.BYTES_PER_ELEMENT,version:e.version}}function n(e,n,r){var i=n.array,o=n.updateRange;t.bindBuffer(r,e),!1===n.dynamic?t.bufferData(r,i,t.STATIC_DRAW):-1===o.count?t.bufferSubData(r,0,i):0===o.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(t.bufferSubData(r,o.offset*i.BYTES_PER_ELEMENT,i.subarray(o.offset,o.offset+o.count)),o.count=-1)}function r(t){return t.isInterleavedBufferAttribute&&(t=t.data),a[t.uuid]}function i(e){e.isInterleavedBufferAttribute&&(e=e.data);var n=a[e.uuid];n&&(t.deleteBuffer(n.buffer),delete a[e.uuid])}function o(t,r){t.isInterleavedBufferAttribute&&(t=t.data);var i=a[t.uuid];void 0===i?a[t.uuid]=e(t,r):i.version<t.version&&(n(i.buffer,t,r),i.version=t.version)}var a={};return{get:r,remove:i,update:o}}function lt(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._order=r||lt.DefaultOrder}function dt(){this.mask=1}function pt(){function t(){i.setFromEuler(r,!1)}function e(){r.setFromQuaternion(i,void 0,!1)}Object.defineProperty(this,"id",{value:Yb++}),this.uuid=Ry.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=pt.DefaultUp.clone();var n=new l,r=new lt,i=new h,o=new l(1,1,1);r.onChange(t),i.onChange(e),Object.defineProperties(this,{position:{enumerable:!0,value:n},rotation:{enumerable:!0,value:r},quaternion:{enumerable:!0,value:i},scale:{enumerable:!0,value:o},modelViewMatrix:{value:new u},normalMatrix:{value:new d}}),this.matrix=new u,this.matrixWorld=new u,this.matrixAutoUpdate=pt.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new dt,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function ft(){pt.call(this),this.type="Camera",this.matrixWorldInverse=new u,this.projectionMatrix=new u}function mt(t,e,n,r,i,o){ft.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=r,this.near=void 0!==i?i:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}function vt(t,e,n,r,i,o){this.a=t,this.b=e,this.c=n,this.normal=r&&r.isVector3?r:new l,this.vertexNormals=Array.isArray(r)?r:[],this.color=i&&i.isColor?i:new $,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0!==o?o:0}function gt(){Object.defineProperty(this,"id",{value:Xb+=2}),this.uuid=Ry.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function yt(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.uuid=Ry.generateUUID(),this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===n,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function xt(t,e,n){yt.call(this,new Int8Array(t),e,n)}function bt(t,e,n){yt.call(this,new Uint8Array(t),e,n)}function wt(t,e,n){yt.call(this,new Uint8ClampedArray(t),e,n)}function _t(t,e,n){yt.call(this,new Int16Array(t),e,n)}function St(t,e,n){yt.call(this,new Uint16Array(t),e,n)}function Mt(t,e,n){yt.call(this,new Int32Array(t),e,n)}function Et(t,e,n){yt.call(this,new Uint32Array(t),e,n)}function Tt(t,e,n){yt.call(this,new Float32Array(t),e,n)}function Lt(t,e,n){yt.call(this,new Float64Array(t),e,n)}function At(){this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function Pt(t){if(0===t.length)return-1/0;for(var e=t[0],n=1,r=t.length;n<r;++n)t[n]>e&&(e=t[n]);return e}function Rt(){Object.defineProperty(this,"id",{value:qb+=2}),this.uuid=Ry.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0}}function It(t,e,n,r,i,o){gt.call(this),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:i,depthSegments:o},this.fromBufferGeometry(new Ct(t,e,n,r,i,o)),this.mergeVertices()}function Ct(t,e,n,r,i,o){function a(t,e,n,r,i,o,a,m,v,g,y){var x=o/v,b=a/g,w=o/2,_=a/2,S=m/2,M=v+1,E=g+1,T=0,L=0,A,P,R=new l;for(P=0;P<E;P++){var I=P*b-_;for(A=0;A<M;A++){var C=A*x-w;R[t]=C*r,R[e]=I*i,R[n]=S,u.push(R.x,R.y,R.z),R[t]=0,R[e]=0,R[n]=m>0?1:-1,h.push(R.x,R.y,R.z),d.push(A/v),d.push(1-P/g),T+=1}}for(P=0;P<g;P++)for(A=0;A<v;A++){var O=p+A+M*P,N=p+A+M*(P+1),F=p+(A+1)+M*(P+1),D=p+(A+1)+M*P;c.push(O,N,D),c.push(N,F,D),L+=6}s.addGroup(f,L,y),f+=L,p+=T}Rt.call(this),this.type="BoxBufferGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:i,depthSegments:o};var s=this;t=t||1,e=e||1,n=n||1,r=Math.floor(r)||1,i=Math.floor(i)||1;var c=[],u=[],h=[],d=[],p=0,f=0;a("z","y","x",-1,-1,n,e,t,o=Math.floor(o)||1,i,0),a("z","y","x",1,-1,n,e,-t,o,i,1),a("x","z","y",1,1,t,n,e,r,o,2),a("x","z","y",1,-1,t,n,-e,r,o,3),a("x","y","z",1,-1,t,e,n,r,i,4),a("x","y","z",-1,-1,t,e,-n,r,i,5),this.setIndex(c),this.addAttribute("position",new Tt(u,3)),this.addAttribute("normal",new Tt(h,3)),this.addAttribute("uv",new Tt(d,2))}function Ot(t,e,n,r){gt.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r},this.fromBufferGeometry(new Nt(t,e,n,r)),this.mergeVertices()}function Nt(t,e,n,r){Rt.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r};var i=(t=t||1)/2,o=(e=e||1)/2,a=Math.floor(n)||1,s=Math.floor(r)||1,c=a+1,u=s+1,h=t/a,l=e/s,d,p,f=[],m=[],v=[],g=[];for(p=0;p<u;p++){var y=p*l-o;for(d=0;d<c;d++){var x=d*h-i;m.push(x,-y,0),v.push(0,0,1),g.push(d/a),g.push(1-p/s)}}for(p=0;p<s;p++)for(d=0;d<a;d++){var b=d+c*p,w=d+c*(p+1),_=d+1+c*(p+1),S=d+1+c*p;f.push(b,w,S),f.push(w,_,S)}this.setIndex(f),this.addAttribute("position",new Tt(m,3)),this.addAttribute("normal",new Tt(v,3)),this.addAttribute("uv",new Tt(g,2))}function Ft(t){nt.call(this),this.type="MeshBasicMaterial",this.color=new $(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Jv,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(t)}function Dt(t){nt.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function Ut(t,e){this.origin=void 0!==t?t:new l,this.direction=void 0!==e?e:new l}function Bt(t,e){this.start=void 0!==t?t:new l,this.end=void 0!==e?e:new l}function zt(t,e,n){this.a=void 0!==t?t:new l,this.b=void 0!==e?e:new l,this.c=void 0!==n?n:new l}function Gt(t,e){pt.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new Rt,this.material=void 0!==e?e:new Ft({color:16777215*Math.random()}),this.drawMode=yy,this.updateMorphTargets()}function kt(t,e,n,r){function i(e,r,i,l){var d=r.background;null===d?o(a,s):d&&d.isColor&&(o(d,1),l=!0),(t.autoClear||l)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),d&&d.isCubeTexture?(void 0===h&&((h=new Gt(new Ct(1,1,1),new Dt({uniforms:Hb.cube.uniforms,vertexShader:Hb.cube.vertexShader,fragmentShader:Hb.cube.fragmentShader,side:fv,depthTest:!0,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),h.geometry.removeAttribute("uv"),h.onBeforeRender=function(t,e,n){this.matrixWorld.copyPosition(n.matrixWorld)},n.update(h.geometry)),h.material.uniforms.tCube.value=d,e.push(h,h.geometry,h.material,0,null)):d&&d.isTexture&&(void 0===c&&(c=new mt(-1,1,1,-1,0,1),u=new Gt(new Nt(2,2),new Ft({depthTest:!1,depthWrite:!1,fog:!1})),n.update(u.geometry)),u.material.map=d,t.renderBufferDirect(c,null,u.geometry,u.material,u,null))}function o(t,n){e.buffers.color.setClear(t.r,t.g,t.b,n,r)}var a=new $(0),s=0,c,u,h;return{getClearColor:function t(){return a},setClearColor:function t(e,n){a.set(e),o(a,s=void 0!==n?n:1)},getClearAlpha:function t(){return s},setClearAlpha:function t(e){o(a,s=e)},render:i}}function jt(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program&&e.program&&t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function Vt(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function Ht(){function t(){i=0,o.length=0,a.length=0}function e(t,e,n,s,c){var u=r[i];void 0===u?(u={id:t.id,object:t,geometry:e,material:n,program:n.program,renderOrder:t.renderOrder,z:s,group:c},r[i]=u):(u.id=t.id,u.object=t,u.geometry=e,u.material=n,u.program=n.program,u.renderOrder=t.renderOrder,u.z=s,u.group=c),(!0===n.transparent?a:o).push(u),i++}function n(){o.length>1&&o.sort(jt),a.length>1&&a.sort(Vt)}var r=[],i=0,o=[],a=[];return{opaque:o,transparent:a,init:t,push:e,sort:n}}function Wt(){function t(t,e){var r=t.id+","+e.id,i=n[r];return void 0===i&&(i=new Ht,n[r]=i),i}function e(){n={}}var n={};return{get:t,dispose:e}}function Yt(t,e){return Math.abs(e[1])-Math.abs(t[1])}function Xt(t){function e(e,i,o,a){var s=e.morphTargetInfluences,c=s.length,u=n[i.id];if(void 0===u){u=[];for(var h=0;h<c;h++)u[h]=[h,0];n[i.id]=u}for(var l=o.morphTargets&&i.morphAttributes.position,d=o.morphNormals&&i.morphAttributes.normal,h=0;h<c;h++){var p;0!==(p=u[h])[1]&&(l&&i.removeAttribute("morphTarget"+h),d&&i.removeAttribute("morphNormal"+h))}for(var h=0;h<c;h++){var p;(p=u[h])[0]=h,p[1]=s[h]}u.sort(Yt);for(var h=0;h<8;h++){var p;if(p=u[h]){var f=p[0],m=p[1];if(m){l&&i.addAttribute("morphTarget"+h,l[f]),d&&i.addAttribute("morphNormal"+h,d[f]),r[h]=m;continue}}r[h]=0}a.getUniforms().setValue(t,"morphTargetInfluences",r)}var n={},r=new Float32Array(8);return{update:e}}function qt(t,e,n){function r(t){s=t}function i(t){c=t.type,u=t.bytesPerElement}function o(e,r){t.drawElements(s,r,c,e*u),n.calls++,n.vertices+=r,s===t.TRIANGLES?n.faces+=r/3:s===t.POINTS&&(n.points+=r)}function a(r,i,o){var a=e.get("ANGLE_instanced_arrays");null!==a?(a.drawElementsInstancedANGLE(s,o,c,i*u,r.maxInstancedCount),n.calls++,n.vertices+=o*r.maxInstancedCount,s===t.TRIANGLES?n.faces+=r.maxInstancedCount*o/3:s===t.POINTS&&(n.points+=r.maxInstancedCount*o)):console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}var s,c,u;this.setMode=r,this.setIndex=i,this.render=o,this.renderInstances=a}function Zt(t,e,n){function r(t){a=t}function i(e,r){t.drawArrays(a,e,r),n.calls++,n.vertices+=r,a===t.TRIANGLES?n.faces+=r/3:a===t.POINTS&&(n.points+=r)}function o(r,i,o){var s=e.get("ANGLE_instanced_arrays");if(null!==s){var c=r.attributes.position;c.isInterleavedBufferAttribute?(o=c.data.count,s.drawArraysInstancedANGLE(a,0,o,r.maxInstancedCount)):s.drawArraysInstancedANGLE(a,i,o,r.maxInstancedCount),n.calls++,n.vertices+=o*r.maxInstancedCount,a===t.TRIANGLES?n.faces+=r.maxInstancedCount*o/3:a===t.POINTS&&(n.points+=r.maxInstancedCount*o)}else console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}var a;this.setMode=r,this.render=i,this.renderInstances=o}function Jt(t,e,n){function r(t){var i=t.target,o=s[i.id];null!==o.index&&e.remove(o.index);for(var a in o.attributes)e.remove(o.attributes[a]);i.removeEventListener("dispose",r),delete s[i.id];var u=c[i.id];u&&(e.remove(u),delete c[i.id]),(u=c[o.id])&&(e.remove(u),delete c[o.id]),n.geometries--}function i(t,e){var i=s[e.id];return i||(e.addEventListener("dispose",r),e.isBufferGeometry?i=e:e.isGeometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new Rt).setFromObject(t)),i=e._bufferGeometry),s[e.id]=i,n.geometries++,i)}function o(n){var r=n.index,i=n.attributes;null!==r&&e.update(r,t.ELEMENT_ARRAY_BUFFER);for(var o in i)e.update(i[o],t.ARRAY_BUFFER);var a=n.morphAttributes;for(var o in a)for(var s=a[o],c=0,u=s.length;c<u;c++)e.update(s[c],t.ARRAY_BUFFER)}function a(n){var r=c[n.id];if(r)return r;var i=[],o=n.index,a=n.attributes;if(null!==o)for(var s,u=0,h=(s=o.array).length;u<h;u+=3){var l=s[u+0],d=s[u+1],p=s[u+2];i.push(l,d,d,p,p,l)}else for(var s,u=0,h=(s=a.position.array).length/3-1;u<h;u+=3){var l=u+0,d=u+1,p=u+2;i.push(l,d,d,p,p,l)}return r=new(Pt(i)>65535?Et:St)(i,1),e.update(r,t.ELEMENT_ARRAY_BUFFER),c[n.id]=r,r}var s={},c={};return{get:i,update:o,getWireframeAttribute:a}}function Qt(){var t={};return{get:function e(n){if(void 0!==t[n.id])return t[n.id];var r;switch(n.type){case"DirectionalLight":r={direction:new l,color:new $,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new c};break;case"SpotLight":r={position:new l,direction:new l,color:new $,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new c};break;case"PointLight":r={position:new l,color:new $,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new c,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":r={direction:new l,skyColor:new $,groundColor:new $};break;case"RectAreaLight":r={color:new $,position:new l,halfWidth:new l,halfHeight:new l}}return t[n.id]=r,r}}}function Kt(){function t(t,a,s){for(var c=0,u=0,h=0,l=0,d=0,p=0,f=0,m=0,v=s.matrixWorldInverse,g=0,y=t.length;g<y;g++){var x=t[g],b=x.color,w=x.intensity,_=x.distance,S=x.shadow&&x.shadow.map?x.shadow.map.texture:null;if(x.isAmbientLight)c+=b.r*w,u+=b.g*w,h+=b.b*w;else if(x.isDirectionalLight){var M;if((M=e.get(x)).color.copy(x.color).multiplyScalar(x.intensity),M.direction.setFromMatrixPosition(x.matrixWorld),r.setFromMatrixPosition(x.target.matrixWorld),M.direction.sub(r),M.direction.transformDirection(v),M.shadow=x.castShadow,x.castShadow){var E=x.shadow;M.shadowBias=E.bias,M.shadowRadius=E.radius,M.shadowMapSize=E.mapSize}n.directionalShadowMap[l]=S,n.directionalShadowMatrix[l]=x.shadow.matrix,n.directional[l]=M,l++}else if(x.isSpotLight){var M;if((M=e.get(x)).position.setFromMatrixPosition(x.matrixWorld),M.position.applyMatrix4(v),M.color.copy(b).multiplyScalar(w),M.distance=_,M.direction.setFromMatrixPosition(x.matrixWorld),r.setFromMatrixPosition(x.target.matrixWorld),M.direction.sub(r),M.direction.transformDirection(v),M.coneCos=Math.cos(x.angle),M.penumbraCos=Math.cos(x.angle*(1-x.penumbra)),M.decay=0===x.distance?0:x.decay,M.shadow=x.castShadow,x.castShadow){var E=x.shadow;M.shadowBias=E.bias,M.shadowRadius=E.radius,M.shadowMapSize=E.mapSize}n.spotShadowMap[p]=S,n.spotShadowMatrix[p]=x.shadow.matrix,n.spot[p]=M,p++}else if(x.isRectAreaLight){var M;(M=e.get(x)).color.copy(b).multiplyScalar(w),M.position.setFromMatrixPosition(x.matrixWorld),M.position.applyMatrix4(v),o.identity(),i.copy(x.matrixWorld),i.premultiply(v),o.extractRotation(i),M.halfWidth.set(.5*x.width,0,0),M.halfHeight.set(0,.5*x.height,0),M.halfWidth.applyMatrix4(o),M.halfHeight.applyMatrix4(o),n.rectArea[f]=M,f++}else if(x.isPointLight){var M;if((M=e.get(x)).position.setFromMatrixPosition(x.matrixWorld),M.position.applyMatrix4(v),M.color.copy(x.color).multiplyScalar(x.intensity),M.distance=x.distance,M.decay=0===x.distance?0:x.decay,M.shadow=x.castShadow,x.castShadow){var E=x.shadow;M.shadowBias=E.bias,M.shadowRadius=E.radius,M.shadowMapSize=E.mapSize,M.shadowCameraNear=E.camera.near,M.shadowCameraFar=E.camera.far}n.pointShadowMap[d]=S,n.pointShadowMatrix[d]=x.shadow.matrix,n.point[d]=M,d++}else if(x.isHemisphereLight){var M;(M=e.get(x)).direction.setFromMatrixPosition(x.matrixWorld),M.direction.transformDirection(v),M.direction.normalize(),M.skyColor.copy(x.color).multiplyScalar(w),M.groundColor.copy(x.groundColor).multiplyScalar(w),n.hemi[m]=M,m++}}n.ambient[0]=c,n.ambient[1]=u,n.ambient[2]=h,n.directional.length=l,n.spot.length=p,n.rectArea.length=f,n.point.length=d,n.hemi.length=m,n.hash=l+","+d+","+p+","+f+","+m+","+a.length}var e=new Qt,n={hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},r=new l,i=new u,o=new u;return{setup:t,state:n}}function $t(t,e){function n(n){var r=e.frame,o=n.geometry,a=t.get(n,o);return i[a.id]!==r&&(o.isGeometry&&a.updateFromObject(n),t.update(a),i[a.id]=r),a}function r(){i={}}var i={};return{update:n,dispose:r}}function te(t){for(var e=t.split("\n"),n=0;n<e.length;n++)e[n]=n+1+": "+e[n];return e.join("\n")}function ee(t,e,n){var r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),!1===t.getShaderParameter(r,t.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==t.getShaderInfoLog(r)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",e===t.VERTEX_SHADER?"vertex":"fragment",t.getShaderInfoLog(r),te(n)),r}function ne(t){switch(t){case wy:return["Linear","( value )"];case _y:return["sRGB","( value )"];case My:return["RGBE","( value )"];case Ey:return["RGBM","( value, 7.0 )"];case Ty:return["RGBM","( value, 16.0 )"];case Ly:return["RGBD","( value, 256.0 )"];case Sy:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+t)}}function re(t,e){var n=ne(e);return"vec4 "+t+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function ie(t,e){var n=ne(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function oe(t,e){var n;switch(e){case tg:n="Linear";break;case eg:n="Reinhard";break;case ng:n="Uncharted2";break;case rg:n="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+e)}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function ae(t,e,n){var r;return[(t=t||{}).derivatives||e.envMapCubeUV||e.bumpMap||e.normalMap||e.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(t.fragDepth||e.logarithmicDepthBuffer)&&n.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",t.drawBuffers&&n.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(t.shaderTextureLOD||e.envMap)&&n.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(ue).join("\n")}function se(t){var e=[];for(var n in t){var r=t[n];!1!==r&&e.push("#define "+n+" "+r)}return e.join("\n")}function ce(t,e){for(var n={},r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),i=0;i<r;i++){var o,a=t.getActiveAttrib(e,i).name;n[a]=t.getAttribLocation(e,a)}return n}function ue(t){return""!==t}function he(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights)}function le(t){function e(t,e){var n=Vb[e];if(void 0===n)throw new Error("Can not resolve #include <"+e+">");return le(n)}var n=/^[ \t]*#include +<([\w\d.]+)>/gm;return t.replace(n,e)}function de(t){function e(t,e,n,r){for(var i="",o=parseInt(e);o<parseInt(n);o++)i+=r.replace(/\[ i \]/g,"[ "+o+" ]");return i}var n=/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;return t.replace(n,e)}function pe(t,e,n,r,i,o){var a=t.context,s=r.defines,c=i.vertexShader,u=i.fragmentShader,h="SHADOWMAP_TYPE_BASIC";o.shadowMapType===lv?h="SHADOWMAP_TYPE_PCF":o.shadowMapType===dv&&(h="SHADOWMAP_TYPE_PCF_SOFT");var l="ENVMAP_TYPE_CUBE",d="ENVMAP_MODE_REFLECTION",p="ENVMAP_BLENDING_MULTIPLY";if(o.envMap){switch(r.envMap.mapping){case og:case ag:l="ENVMAP_TYPE_CUBE";break;case hg:case lg:l="ENVMAP_TYPE_CUBE_UV";break;case sg:case cg:l="ENVMAP_TYPE_EQUIREC";break;case ug:l="ENVMAP_TYPE_SPHERE"}switch(r.envMap.mapping){case ag:case cg:d="ENVMAP_MODE_REFRACTION"}switch(r.combine){case Jv:p="ENVMAP_BLENDING_MULTIPLY";break;case Qv:p="ENVMAP_BLENDING_MIX";break;case Kv:p="ENVMAP_BLENDING_ADD"}}var f=t.gammaFactor>0?t.gammaFactor:1,m=ae(r.extensions,o,e),v=se(s),g=a.createProgram(),y,x;r.isRawShaderMaterial?((y=[v].filter(ue).join("\n")).length>0&&(y+="\n"),(x=[m,v].filter(ue).join("\n")).length>0&&(x+="\n")):(y=["precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+i.name,v,o.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+f,"#define MAX_BONES "+o.maxBones,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+d:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.displacementMap&&o.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexColors?"#define USE_COLOR":"",o.flatShading?"#define FLAT_SHADED":"",o.skinning?"#define USE_SKINNING":"",o.useVertexTexture?"#define BONE_TEXTURE":"",o.morphTargets?"#define USE_MORPHTARGETS":"",o.morphNormals&&!1===o.flatShading?"#define USE_MORPHNORMALS":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+o.numClippingPlanes,o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+h:"",o.sizeAttenuation?"#define USE_SIZEATTENUATION":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&e.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(ue).join("\n"),x=[m,"precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+i.name,v,o.alphaTest?"#define ALPHATEST "+o.alphaTest:"","#define GAMMA_FACTOR "+f,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+l:"",o.envMap?"#define "+d:"",o.envMap?"#define "+p:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexColors?"#define USE_COLOR":"",o.gradientMap?"#define USE_GRADIENTMAP":"",o.flatShading?"#define FLAT_SHADED":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+o.numClippingPlanes,"#define UNION_CLIPPING_PLANES "+(o.numClippingPlanes-o.numClipIntersection),o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+h:"",o.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",o.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&e.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",o.envMap&&e.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",o.toneMapping!==$v?"#define TONE_MAPPING":"",o.toneMapping!==$v?Vb.tonemapping_pars_fragment:"",o.toneMapping!==$v?oe("toneMapping",o.toneMapping):"",o.dithering?"#define DITHERING":"",o.outputEncoding||o.mapEncoding||o.envMapEncoding||o.emissiveMapEncoding?Vb.encodings_pars_fragment:"",o.mapEncoding?re("mapTexelToLinear",o.mapEncoding):"",o.envMapEncoding?re("envMapTexelToLinear",o.envMapEncoding):"",o.emissiveMapEncoding?re("emissiveMapTexelToLinear",o.emissiveMapEncoding):"",o.outputEncoding?ie("linearToOutputTexel",o.outputEncoding):"",o.depthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(ue).join("\n")),c=he(c=le(c),o),u=he(u=le(u),o),r.isShaderMaterial||(c=de(c),u=de(u));var b=y+c,w=x+u,_=ee(a,a.VERTEX_SHADER,b),S=ee(a,a.FRAGMENT_SHADER,w);a.attachShader(g,_),a.attachShader(g,S),void 0!==r.index0AttributeName?a.bindAttribLocation(g,0,r.index0AttributeName):!0===o.morphTargets&&a.bindAttribLocation(g,0,"position"),a.linkProgram(g);var M=a.getProgramInfoLog(g).trim(),E=a.getShaderInfoLog(_).trim(),T=a.getShaderInfoLog(S).trim(),L=!0,A=!0;!1===a.getProgramParameter(g,a.LINK_STATUS)?(L=!1,console.error("THREE.WebGLProgram: shader error: ",a.getError(),"gl.VALIDATE_STATUS",a.getProgramParameter(g,a.VALIDATE_STATUS),"gl.getProgramInfoLog",M,E,T)):""!==M?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",M):""!==E&&""!==T||(A=!1),A&&(this.diagnostics={runnable:L,material:r,programLog:M,vertexShader:{log:E,prefix:y},fragmentShader:{log:T,prefix:x}}),a.deleteShader(_),a.deleteShader(S);var P;this.getUniforms=function(){return void 0===P&&(P=new K(a,g,t)),P};var R;return this.getAttributes=function(){return void 0===R&&(R=ce(a,g)),R},this.destroy=function(){a.deleteProgram(g),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function t(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function t(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=Zb++,this.code=n,this.usedTimes=1,this.program=g,this.vertexShader=_,this.fragmentShader=S,this}function fe(t,e,n){function r(t){var e,r=t.skeleton.bones;if(n.floatVertexTextures)return 1024;var i=n.maxVertexUniforms,o=Math.floor((i-20)/4),a=Math.min(o,r.length);return a<r.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+r.length+" bones. This GPU supports "+a+"."),0):a}function i(t,e){var n;return t?t.isTexture?n=t.encoding:t.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),n=t.texture.encoding):n=wy,n===wy&&e&&(n=Sy),n}var o=[],a={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow"},s=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];this.getParameters=function(e,o,s,c,u,h,l){var d=a[e.type],p=l.isSkinnedMesh?r(l):0,f=n.precision;null!==e.precision&&(f=n.getMaxPrecision(e.precision))!==e.precision&&console.warn("THREE.WebGLProgram.getParameters:",e.precision,"not supported, using",f,"instead.");var m=t.getRenderTarget(),v;return{shaderID:d,precision:f,supportsVertexTextures:n.vertexTextures,outputEncoding:i(m?m.texture:null,t.gammaOutput),map:!!e.map,mapEncoding:i(e.map,t.gammaInput),envMap:!!e.envMap,envMapMode:e.envMap&&e.envMap.mapping,envMapEncoding:i(e.envMap,t.gammaInput),envMapCubeUV:!!e.envMap&&(e.envMap.mapping===hg||e.envMap.mapping===lg),lightMap:!!e.lightMap,aoMap:!!e.aoMap,emissiveMap:!!e.emissiveMap,emissiveMapEncoding:i(e.emissiveMap,t.gammaInput),bumpMap:!!e.bumpMap,normalMap:!!e.normalMap,displacementMap:!!e.displacementMap,roughnessMap:!!e.roughnessMap,metalnessMap:!!e.metalnessMap,specularMap:!!e.specularMap,alphaMap:!!e.alphaMap,gradientMap:!!e.gradientMap,combine:e.combine,vertexColors:e.vertexColors,fog:!!c,useFog:e.fog,fogExp:c&&c.isFogExp2,flatShading:e.flatShading,sizeAttenuation:e.sizeAttenuation,logarithmicDepthBuffer:n.logarithmicDepthBuffer,skinning:e.skinning&&p>0,maxBones:p,useVertexTexture:n.floatVertexTextures,morphTargets:e.morphTargets,morphNormals:e.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:o.directional.length,numPointLights:o.point.length,numSpotLights:o.spot.length,numRectAreaLights:o.rectArea.length,numHemiLights:o.hemi.length,numClippingPlanes:u,numClipIntersection:h,dithering:e.dithering,shadowMapEnabled:t.shadowMap.enabled&&l.receiveShadow&&s.length>0,shadowMapType:t.shadowMap.type,toneMapping:t.toneMapping,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:e.premultipliedAlpha,alphaTest:e.alphaTest,doubleSided:e.side===mv,flipSided:e.side===fv,depthPacking:void 0!==e.depthPacking&&e.depthPacking}},this.getProgramCode=function(e,n){var r=[];if(n.shaderID?r.push(n.shaderID):(r.push(e.fragmentShader),r.push(e.vertexShader)),void 0!==e.defines)for(var i in e.defines)r.push(i),r.push(e.defines[i]);for(var o=0;o<s.length;o++)r.push(n[s[o]]);return r.push(e.onBeforeCompile.toString()),r.push(t.gammaOutput),r.join()},this.acquireProgram=function(n,r,i,a){for(var s,c=0,u=o.length;c<u;c++){var h=o[c];if(h.code===a){++(s=h).usedTimes;break}}return void 0===s&&(s=new pe(t,e,a,n,r,i),o.push(s)),s},this.releaseProgram=function(t){if(0==--t.usedTimes){var e=o.indexOf(t);o[e]=o[o.length-1],o.pop(),t.destroy()}},this.programs=o}function me(t,e,n,r,i,o,a,s){function c(t,e){if(t.width>e||t.height>e){var n=e/Math.max(t.width,t.height),r=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");r.width=Math.floor(t.width*n),r.height=Math.floor(t.height*n);var i;return r.getContext("2d").drawImage(t,0,0,t.width,t.height,0,0,r.width,r.height),console.warn("THREE.WebGLRenderer: image is too big ("+t.width+"x"+t.height+"). Resized to "+r.width+"x"+r.height,t),r}return t}function u(t){return Ry.isPowerOfTwo(t.width)&&Ry.isPowerOfTwo(t.height)}function h(t){if(t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof ImageBitmap){var e=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");e.width=Ry.floorPowerOfTwo(t.width),e.height=Ry.floorPowerOfTwo(t.height);var n;return e.getContext("2d").drawImage(t,0,0,e.width,e.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+t.width+"x"+t.height+"). Resized to "+e.width+"x"+e.height,t),e}return t}function l(t){return t.wrapS!==pg||t.wrapT!==pg||t.minFilter!==mg&&t.minFilter!==yg}function d(t,e){return t.generateMipmaps&&e&&t.minFilter!==mg&&t.minFilter!==yg}function p(e){return e===mg||e===vg||e===gg?t.NEAREST:t.LINEAR}function f(t){var e=t.target;e.removeEventListener("dispose",f),v(e),e.isVideoTexture&&delete I[e.id],a.textures--}function m(t){var e=t.target;e.removeEventListener("dispose",m),g(e),a.textures--}function v(e){var n=r.get(e);if(e.image&&n.__image__webglTextureCube)t.deleteTexture(n.__image__webglTextureCube);else{if(void 0===n.__webglInit)return;t.deleteTexture(n.__webglTexture)}r.remove(e)}function g(e){var n=r.get(e),i=r.get(e.texture);if(e){if(void 0!==i.__webglTexture&&t.deleteTexture(i.__webglTexture),e.depthTexture&&e.depthTexture.dispose(),e.isWebGLRenderTargetCube)for(var o=0;o<6;o++)t.deleteFramebuffer(n.__webglFramebuffer[o]),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer[o]);else t.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer);r.remove(e.texture),r.remove(e)}}function y(e,i){var o=r.get(e);if(e.isVideoTexture&&P(e),e.version>0&&o.__version!==e.version){var a=e.image;if(void 0===a)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",e);else{if(!1!==a.complete)return void _(o,e,i);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",e)}}n.activeTexture(t.TEXTURE0+i),n.bindTexture(t.TEXTURE_2D,o.__webglTexture)}function x(e,s){var h=r.get(e);if(6===e.image.length)if(e.version>0&&h.__version!==e.version){h.__image__webglTextureCube||(e.addEventListener("dispose",f),h.__image__webglTextureCube=t.createTexture(),a.textures++),n.activeTexture(t.TEXTURE0+s),n.bindTexture(t.TEXTURE_CUBE_MAP,h.__image__webglTextureCube),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e.flipY);for(var l=e&&e.isCompressedTexture,p=e.image[0]&&e.image[0].isDataTexture,m=[],v=0;v<6;v++)m[v]=l||p?p?e.image[v].image:e.image[v]:c(e.image[v],i.maxCubemapSize);var g,y=u(m[0]),x=o.convert(e.format),b=o.convert(e.type);w(t.TEXTURE_CUBE_MAP,e,y);for(var v=0;v<6;v++)if(l)for(var _,S=m[v].mipmaps,M=0,E=S.length;M<E;M++)_=S[M],e.format!==Fg&&e.format!==Ng?n.getCompressedTextureFormats().indexOf(x)>-1?n.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+v,M,x,_.width,_.height,0,_.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+v,M,x,_.width,_.height,0,x,b,_.data);else p?n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+v,0,x,m[v].width,m[v].height,0,x,b,m[v].data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+v,0,x,x,b,m[v]);d(e,y)&&t.generateMipmap(t.TEXTURE_CUBE_MAP),h.__version=e.version,e.onUpdate&&e.onUpdate(e)}else n.activeTexture(t.TEXTURE0+s),n.bindTexture(t.TEXTURE_CUBE_MAP,h.__image__webglTextureCube)}function b(e,i){n.activeTexture(t.TEXTURE0+i),n.bindTexture(t.TEXTURE_CUBE_MAP,r.get(e).__webglTexture)}function w(n,a,s){var c;if(s?(t.texParameteri(n,t.TEXTURE_WRAP_S,o.convert(a.wrapS)),t.texParameteri(n,t.TEXTURE_WRAP_T,o.convert(a.wrapT)),t.texParameteri(n,t.TEXTURE_MAG_FILTER,o.convert(a.magFilter)),t.texParameteri(n,t.TEXTURE_MIN_FILTER,o.convert(a.minFilter))):(t.texParameteri(n,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(n,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),a.wrapS===pg&&a.wrapT===pg||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",a),t.texParameteri(n,t.TEXTURE_MAG_FILTER,p(a.magFilter)),t.texParameteri(n,t.TEXTURE_MIN_FILTER,p(a.minFilter)),a.minFilter!==mg&&a.minFilter!==yg&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",a)),c=e.get("EXT_texture_filter_anisotropic")){if(a.type===Lg&&null===e.get("OES_texture_float_linear"))return;if(a.type===Ag&&null===e.get("OES_texture_half_float_linear"))return;(a.anisotropy>1||r.get(a).__currentAnisotropy)&&(t.texParameterf(n,c.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,i.getMaxAnisotropy())),r.get(a).__currentAnisotropy=a.anisotropy)}}function _(e,r,s){void 0===e.__webglInit&&(e.__webglInit=!0,r.addEventListener("dispose",f),e.__webglTexture=t.createTexture(),a.textures++),n.activeTexture(t.TEXTURE0+s),n.bindTexture(t.TEXTURE_2D,e.__webglTexture),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,r.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,r.unpackAlignment);var p=c(r.image,i.maxTextureSize);l(r)&&!1===u(p)&&(p=h(p));var m=u(p),v=o.convert(r.format),g=o.convert(r.type);w(t.TEXTURE_2D,r,m);var y,x=r.mipmaps;if(r.isDepthTexture){var b=t.DEPTH_COMPONENT;if(r.type===Lg){if(!R)throw new Error("Float Depth Texture only supported in WebGL2.0");b=t.DEPTH_COMPONENT32F}else R&&(b=t.DEPTH_COMPONENT16);r.format===Bg&&b===t.DEPTH_COMPONENT&&r.type!==Mg&&r.type!==Tg&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=Mg,g=o.convert(r.type)),r.format===zg&&(b=t.DEPTH_STENCIL,r.type!==Cg&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=Cg,g=o.convert(r.type))),n.texImage2D(t.TEXTURE_2D,0,b,p.width,p.height,0,v,g,null)}else if(r.isDataTexture)if(x.length>0&&m){for(var _=0,S=x.length;_<S;_++)y=x[_],n.texImage2D(t.TEXTURE_2D,_,v,y.width,y.height,0,v,g,y.data);r.generateMipmaps=!1}else n.texImage2D(t.TEXTURE_2D,0,v,p.width,p.height,0,v,g,p.data);else if(r.isCompressedTexture)for(var _=0,S=x.length;_<S;_++)y=x[_],r.format!==Fg&&r.format!==Ng?n.getCompressedTextureFormats().indexOf(v)>-1?n.compressedTexImage2D(t.TEXTURE_2D,_,v,y.width,y.height,0,y.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(t.TEXTURE_2D,_,v,y.width,y.height,0,v,g,y.data);else if(x.length>0&&m){for(var _=0,S=x.length;_<S;_++)y=x[_],n.texImage2D(t.TEXTURE_2D,_,v,v,g,y);r.generateMipmaps=!1}else n.texImage2D(t.TEXTURE_2D,0,v,v,g,p);d(r,m)&&t.generateMipmap(t.TEXTURE_2D),e.__version=r.version,r.onUpdate&&r.onUpdate(r)}function S(e,i,a,s){var c=o.convert(i.texture.format),u=o.convert(i.texture.type);n.texImage2D(s,0,c,i.width,i.height,0,c,u,null),t.bindFramebuffer(t.FRAMEBUFFER,e),t.framebufferTexture2D(t.FRAMEBUFFER,a,s,r.get(i.texture).__webglTexture,0),t.bindFramebuffer(t.FRAMEBUFFER,null)}function M(e,n){t.bindRenderbuffer(t.RENDERBUFFER,e),n.depthBuffer&&!n.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,n.width,n.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e)):n.depthBuffer&&n.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,n.width,n.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,e)):t.renderbufferStorage(t.RENDERBUFFER,t.RGBA4,n.width,n.height),t.bindRenderbuffer(t.RENDERBUFFER,null)}function E(e,n){var i;if(n&&n.isWebGLRenderTargetCube)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(t.FRAMEBUFFER,e),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),y(n.depthTexture,0);var o=r.get(n.depthTexture).__webglTexture;if(n.depthTexture.format===Bg)t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,o,0);else{if(n.depthTexture.format!==zg)throw new Error("Unknown depthTexture format");t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,o,0)}}function T(e){var n=r.get(e),i=!0===e.isWebGLRenderTargetCube;if(e.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");E(n.__webglFramebuffer,e)}else if(i){n.__webglDepthbuffer=[];for(var o=0;o<6;o++)t.bindFramebuffer(t.FRAMEBUFFER,n.__webglFramebuffer[o]),n.__webglDepthbuffer[o]=t.createRenderbuffer(),M(n.__webglDepthbuffer[o],e)}else t.bindFramebuffer(t.FRAMEBUFFER,n.__webglFramebuffer),n.__webglDepthbuffer=t.createRenderbuffer(),M(n.__webglDepthbuffer,e);t.bindFramebuffer(t.FRAMEBUFFER,null)}function L(e){var i=r.get(e),o=r.get(e.texture);e.addEventListener("dispose",m),o.__webglTexture=t.createTexture(),a.textures++;var s=!0===e.isWebGLRenderTargetCube,c=u(e);if(s){i.__webglFramebuffer=[];for(var h=0;h<6;h++)i.__webglFramebuffer[h]=t.createFramebuffer()}else i.__webglFramebuffer=t.createFramebuffer();if(s){n.bindTexture(t.TEXTURE_CUBE_MAP,o.__webglTexture),w(t.TEXTURE_CUBE_MAP,e.texture,c);for(var h=0;h<6;h++)S(i.__webglFramebuffer[h],e,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+h);d(e.texture,c)&&t.generateMipmap(t.TEXTURE_CUBE_MAP),n.bindTexture(t.TEXTURE_CUBE_MAP,null)}else n.bindTexture(t.TEXTURE_2D,o.__webglTexture),w(t.TEXTURE_2D,e.texture,c),S(i.__webglFramebuffer,e,t.COLOR_ATTACHMENT0,t.TEXTURE_2D),d(e.texture,c)&&t.generateMipmap(t.TEXTURE_2D),n.bindTexture(t.TEXTURE_2D,null);e.depthBuffer&&T(e)}function A(e){var i=e.texture,o;if(d(i,u(e))){var a=e.isWebGLRenderTargetCube?t.TEXTURE_CUBE_MAP:t.TEXTURE_2D,s=r.get(i).__webglTexture;n.bindTexture(a,s),t.generateMipmap(a),n.bindTexture(a,null)}}function P(t){var e=t.id,n=s.frame;I[e]!==n&&(I[e]=n,t.update())}var R="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext,I={};this.setTexture2D=y,this.setTextureCube=x,this.setTextureCubeDynamic=b,this.setupRenderTarget=L,this.updateRenderTargetMipmap=A}function ve(){function t(t){var e=t.uuid,n=r[e];return void 0===n&&(n={},r[e]=n),n}function e(t){delete r[t.uuid]}function n(){r={}}var r={};return{get:t,remove:e,dispose:n}}function ge(t,e,n){function r(){var e=!1,n=new f,r=null,i=new f(0,0,0,0);return{setMask:function n(i){r===i||e||(t.colorMask(i,i,i,i),r=i)},setLocked:function t(n){e=n},setClear:function e(r,o,a,s,c){!0===c&&(r*=s,o*=s,a*=s),n.set(r,o,a,s),!1===i.equals(n)&&(t.clearColor(r,o,a,s),i.copy(n))},reset:function t(){e=!1,r=null,i.set(-1,0,0,0)}}}function i(){var e=!1,n=null,r=null,i=null;return{setTest:function e(n){n?l(t.DEPTH_TEST):d(t.DEPTH_TEST)},setMask:function r(i){n===i||e||(t.depthMask(i),n=i)},setFunc:function e(n){if(r!==n){if(n)switch(n){case jv:t.depthFunc(t.NEVER);break;case Vv:t.depthFunc(t.ALWAYS);break;case Hv:t.depthFunc(t.LESS);break;case Wv:t.depthFunc(t.LEQUAL);break;case Yv:t.depthFunc(t.EQUAL);break;case Xv:t.depthFunc(t.GEQUAL);break;case qv:t.depthFunc(t.GREATER);break;case Zv:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}else t.depthFunc(t.LEQUAL);r=n}},setLocked:function t(n){e=n},setClear:function e(n){i!==n&&(t.clearDepth(n),i=n)},reset:function t(){e=!1,n=null,r=null,i=null}}}function o(){var e=!1,n=null,r=null,i=null,o=null,a=null,s=null,c=null,u=null;return{setTest:function e(n){n?l(t.STENCIL_TEST):d(t.STENCIL_TEST)},setMask:function r(i){n===i||e||(t.stencilMask(i),n=i)},setFunc:function e(n,a,s){r===n&&i===a&&o===s||(t.stencilFunc(n,a,s),r=n,i=a,o=s)},setOp:function e(n,r,i){a===n&&s===r&&c===i||(t.stencilOp(n,r,i),a=n,s=r,c=i)},setLocked:function t(n){e=n},setClear:function e(n){u!==n&&(t.clearStencil(n),u=n)},reset:function t(){e=!1,n=null,r=null,i=null,o=null,a=null,s=null,c=null,u=null}}}function a(e,n,r){var i=new Uint8Array(4),o=t.createTexture();t.bindTexture(e,o),t.texParameteri(e,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(e,t.TEXTURE_MAG_FILTER,t.NEAREST);for(var a=0;a<r;a++)t.texImage2D(n+a,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,i);return o}function s(){for(var t=0,e=N.length;t<e;t++)N[t]=0}function c(n){if(N[n]=1,0===F[n]&&(t.enableVertexAttribArray(n),F[n]=1),0!==D[n]){var r;e.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(n,0),D[n]=0}}function u(n,r){if(N[n]=1,0===F[n]&&(t.enableVertexAttribArray(n),F[n]=1),D[n]!==r){var i;e.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(n,r),D[n]=r}}function h(){for(var e=0,n=F.length;e!==n;++e)F[e]!==N[e]&&(t.disableVertexAttribArray(e),F[e]=0)}function l(e){!0!==U[e]&&(t.enable(e),U[e]=!0)}function d(e){!1!==U[e]&&(t.disable(e),U[e]=!1)}function p(){if(null===B&&(B=[],e.get("WEBGL_compressed_texture_pvrtc")||e.get("WEBGL_compressed_texture_s3tc")||e.get("WEBGL_compressed_texture_etc1")||e.get("WEBGL_compressed_texture_astc")))for(var n=t.getParameter(t.COMPRESSED_TEXTURE_FORMATS),r=0;r<n.length;r++)B.push(n[r]);return B}function m(e){return z!==e&&(t.useProgram(e),z=e,!0)}function v(e,r,i,o,a,s,c,u){if(e!==bv?l(t.BLEND):d(t.BLEND),e!==Ev){if(e!==G||u!==X)switch(e){case _v:u?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE,t.ONE,t.ONE)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE));break;case Sv:u?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.ONE_MINUS_SRC_COLOR));break;case Mv:u?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.SRC_COLOR));break;default:u?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA))}k=null,j=null,V=null,H=null,W=null,Y=null}else a=a||r,s=s||i,c=c||o,r===k&&a===H||(t.blendEquationSeparate(n.convert(r),n.convert(a)),k=r,H=a),i===j&&o===V&&s===W&&c===Y||(t.blendFuncSeparate(n.convert(i),n.convert(o),n.convert(s),n.convert(c)),j=i,V=o,W=s,Y=c);G=e,X=u}function g(e,n){e.side===mv?d(t.CULL_FACE):l(t.CULL_FACE);var r=e.side===fv;n&&(r=!r),y(r),!0===e.transparent?v(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha):v(bv),I.setFunc(e.depthFunc),I.setTest(e.depthTest),I.setMask(e.depthWrite),R.setMask(e.colorWrite),w(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)}function y(e){q!==e&&(e?t.frontFace(t.CW):t.frontFace(t.CCW),q=e)}function x(e){e!==sv?(l(t.CULL_FACE),e!==Z&&(e===cv?t.cullFace(t.BACK):e===uv?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):d(t.CULL_FACE),Z=e}function b(e){e!==J&&(et&&t.lineWidth(e),J=e)}function w(e,n,r){e?(l(t.POLYGON_OFFSET_FILL),Q===n&&K===r||(t.polygonOffset(n,r),Q=n,K=r)):d(t.POLYGON_OFFSET_FILL)}function _(e){e?l(t.SCISSOR_TEST):d(t.SCISSOR_TEST)}function S(e){void 0===e&&(e=t.TEXTURE0+$-1),nt!==e&&(t.activeTexture(e),nt=e)}function M(e,n){null===nt&&S();var r=rt[nt];void 0===r&&(r={type:void 0,texture:void 0},rt[nt]=r),r.type===e&&r.texture===n||(t.bindTexture(e,n||at[e]),r.type=e,r.texture=n)}function E(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}}function T(){try{t.texImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}}function L(e){!1===it.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),it.copy(e))}function A(e){!1===ot.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),ot.copy(e))}function P(){for(var e=0;e<F.length;e++)1===F[e]&&(t.disableVertexAttribArray(e),F[e]=0);U={},B=null,nt=null,rt={},z=null,G=null,q=null,Z=null,R.reset(),I.reset(),C.reset()}var R=new r,I=new i,C=new o,O=t.getParameter(t.MAX_VERTEX_ATTRIBS),N=new Uint8Array(O),F=new Uint8Array(O),D=new Uint8Array(O),U={},B=null,z=null,G=null,k=null,j=null,V=null,H=null,W=null,Y=null,X=!1,q=null,Z=null,J=null,Q=null,K=null,$=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS),tt=parseFloat(/^WebGL\ ([0-9])/.exec(t.getParameter(t.VERSION))[1]),et=parseFloat(tt)>=1,nt=null,rt={},it=new f,ot=new f,at={};return at[t.TEXTURE_2D]=a(t.TEXTURE_2D,t.TEXTURE_2D,1),at[t.TEXTURE_CUBE_MAP]=a(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),R.setClear(0,0,0,1),I.setClear(1),C.setClear(0),l(t.DEPTH_TEST),I.setFunc(Wv),y(!1),x(cv),l(t.CULL_FACE),l(t.BLEND),v(wv),{buffers:{color:R,depth:I,stencil:C},initAttributes:s,enableAttribute:c,enableAttributeAndDivisor:u,disableUnusedAttributes:h,enable:l,disable:d,getCompressedTextureFormats:p,useProgram:m,setBlending:v,setMaterial:g,setFlipSided:y,setCullFace:x,setLineWidth:b,setPolygonOffset:w,setScissorTest:_,activeTexture:S,bindTexture:M,compressedTexImage2D:E,texImage2D:T,scissor:L,viewport:A,reset:P}}function ye(t,e,n){function r(){if(void 0!==o)return o;var n=e.get("EXT_texture_filter_anisotropic");return o=null!==n?t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function i(e){if("highp"===e){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var o,a=void 0!==n.precision?n.precision:"highp",s=i(a);s!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",s,"instead."),a=s);var c=!0===n.logarithmicDepthBuffer,u=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),h=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),l=t.getParameter(t.MAX_TEXTURE_SIZE),d=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),p=t.getParameter(t.MAX_VERTEX_ATTRIBS),f=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),m=t.getParameter(t.MAX_VARYING_VECTORS),v=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),g=h>0,y=!!e.get("OES_texture_float"),x;return{getMaxAnisotropy:r,getMaxPrecision:i,precision:a,logarithmicDepthBuffer:c,maxTextures:u,maxVertexTextures:h,maxTextureSize:l,maxCubemapSize:d,maxAttributes:p,maxVertexUniforms:f,maxVaryings:m,maxFragmentUniforms:v,vertexTextures:g,floatFragmentTextures:y,floatVertexTextures:g&&y}}function xe(t,e,n,r){ft.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==r?r:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function be(t){xe.call(this),this.cameras=t||[]}function we(t){function e(){if(null!==r&&r.isPresenting){var e=r.getEyeParameters("left"),i=e.renderWidth,o=e.renderHeight;d=t.getPixelRatio(),l=t.getSize(),t.setDrawingBufferSize(2*i,o,1)}else n.enabled&&t.setDrawingBufferSize(l.width,l.height,d)}var n=this,r=null,i=null,o=null;"undefined"!=typeof window&&"VRFrameData"in window&&(i=new window.VRFrameData);var a=new u,s=new xe;s.bounds=new f(0,0,.5,1),s.layers.enable(1);var c=new xe;c.bounds=new f(.5,0,.5,1),c.layers.enable(2);var h=new be([s,c]);h.layers.enable(1),h.layers.enable(2);var l,d;"undefined"!=typeof window&&window.addEventListener("vrdisplaypresentchange",e,!1),this.enabled=!1,this.getDevice=function(){return r},this.setDevice=function(t){void 0!==t&&(r=t)},this.setPoseTarget=function(t){void 0!==t&&(o=t)},this.getCamera=function(t){if(null===r)return t;r.depthNear=t.near,r.depthFar=t.far,r.getFrameData(i);var e=i.pose,n=null!==o?o:t;if(null!==e.position?n.position.fromArray(e.position):n.position.set(0,0,0),null!==e.orientation&&n.quaternion.fromArray(e.orientation),n.updateMatrixWorld(),!1===r.isPresenting)return t;s.near=t.near,c.near=t.near,s.far=t.far,c.far=t.far,h.matrixWorld.copy(t.matrixWorld),h.matrixWorldInverse.copy(t.matrixWorldInverse),s.matrixWorldInverse.fromArray(i.leftViewMatrix),c.matrixWorldInverse.fromArray(i.rightViewMatrix);var u=n.parent;null!==u&&(a.getInverse(u.matrixWorld),s.matrixWorldInverse.multiply(a),c.matrixWorldInverse.multiply(a)),s.matrixWorld.getInverse(s.matrixWorldInverse),c.matrixWorld.getInverse(c.matrixWorldInverse),s.projectionMatrix.fromArray(i.leftProjectionMatrix),c.projectionMatrix.fromArray(i.rightProjectionMatrix),h.projectionMatrix.copy(s.projectionMatrix);var l=r.getLayers();if(l.length){var d=l[0];null!==d.leftBounds&&4===d.leftBounds.length&&s.bounds.fromArray(d.leftBounds),null!==d.rightBounds&&4===d.rightBounds.length&&c.bounds.fromArray(d.rightBounds)}return h},this.submitFrame=function(){r&&r.isPresenting&&r.submitFrame()},this.dispose=function(){"undefined"!=typeof window&&window.removeEventListener("vrdisplaypresentchange",e)}}function _e(t){var e={};return{get:function n(r){if(void 0!==e[r])return e[r];var i;switch(r){case"WEBGL_depth_texture":i=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":i=t.getExtension("WEBGL_compressed_texture_etc1");break;default:i=t.getExtension(r)}return null===i&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),e[r]=i,i}}}function Se(){function t(){u.value!==r&&(u.value=r,u.needsUpdate=i>0),n.numPlanes=i,n.numIntersection=0}function e(t,e,r,i){var o=null!==t?t.length:0,a=null;if(0!==o){if(a=u.value,!0!==i||null===a){var h=r+4*o,l=e.matrixWorldInverse;c.getNormalMatrix(l),(null===a||a.length<h)&&(a=new Float32Array(h));for(var d=0,p=r;d!==o;++d,p+=4)s.copy(t[d]).applyMatrix4(l,c),s.normal.toArray(a,p),a[p+3]=s.constant}u.value=a,u.needsUpdate=!0}return n.numPlanes=o,a}var n=this,r=null,i=0,o=!1,a=!1,s=new st,c=new d,u={value:null,needsUpdate:!1};this.uniform=u,this.numPlanes=0,this.numIntersection=0,this.init=function(t,n,a){var s=0!==t.length||n||0!==i||o;return o=n,r=e(t,a,0),i=t.length,s},this.beginShadows=function(){a=!0,e(null)},this.endShadows=function(){a=!1,t()},this.setState=function(n,s,c,h,l,d){if(!o||null===n||0===n.length||a&&!c)a?e(null):t();else{var p=a?0:i,f=4*p,m=l.clippingState||null;u.value=m,m=e(n,h,f,d);for(var v=0;v!==f;++v)m[v]=r[v];l.clippingState=m,this.numIntersection=s?this.numPlanes:0,this.numPlanes+=p}}}function Me(t,e){function n(n){var r;if(n===dg)return t.REPEAT;if(n===pg)return t.CLAMP_TO_EDGE;if(n===fg)return t.MIRRORED_REPEAT;if(n===mg)return t.NEAREST;if(n===vg)return t.NEAREST_MIPMAP_NEAREST;if(n===gg)return t.NEAREST_MIPMAP_LINEAR;if(n===yg)return t.LINEAR;if(n===xg)return t.LINEAR_MIPMAP_NEAREST;if(n===bg)return t.LINEAR_MIPMAP_LINEAR;if(n===wg)return t.UNSIGNED_BYTE;if(n===Pg)return t.UNSIGNED_SHORT_4_4_4_4;if(n===Rg)return t.UNSIGNED_SHORT_5_5_5_1;if(n===Ig)return t.UNSIGNED_SHORT_5_6_5;if(n===_g)return t.BYTE;if(n===Sg)return t.SHORT;if(n===Mg)return t.UNSIGNED_SHORT;if(n===Eg)return t.INT;if(n===Tg)return t.UNSIGNED_INT;if(n===Lg)return t.FLOAT;if(n===Ag&&null!==(r=e.get("OES_texture_half_float")))return r.HALF_FLOAT_OES;if(n===Og)return t.ALPHA;if(n===Ng)return t.RGB;if(n===Fg)return t.RGBA;if(n===Dg)return t.LUMINANCE;if(n===Ug)return t.LUMINANCE_ALPHA;if(n===Bg)return t.DEPTH_COMPONENT;if(n===zg)return t.DEPTH_STENCIL;if(n===Tv)return t.FUNC_ADD;if(n===Lv)return t.FUNC_SUBTRACT;if(n===Av)return t.FUNC_REVERSE_SUBTRACT;if(n===Iv)return t.ZERO;if(n===Cv)return t.ONE;if(n===Ov)return t.SRC_COLOR;if(n===Nv)return t.ONE_MINUS_SRC_COLOR;if(n===Fv)return t.SRC_ALPHA;if(n===Dv)return t.ONE_MINUS_SRC_ALPHA;if(n===Uv)return t.DST_ALPHA;if(n===Bv)return t.ONE_MINUS_DST_ALPHA;if(n===zv)return t.DST_COLOR;if(n===Gv)return t.ONE_MINUS_DST_COLOR;if(n===kv)return t.SRC_ALPHA_SATURATE;if((n===Gg||n===kg||n===jg||n===Vg)&&null!==(r=e.get("WEBGL_compressed_texture_s3tc"))){if(n===Gg)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===kg)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===jg)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Vg)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((n===Hg||n===Wg||n===Yg||n===Xg)&&null!==(r=e.get("WEBGL_compressed_texture_pvrtc"))){if(n===Hg)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===Wg)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===Yg)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===Xg)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===qg&&null!==(r=e.get("WEBGL_compressed_texture_etc1")))return r.COMPRESSED_RGB_ETC1_WEBGL;if((n===Zg||n===Jg||n===Qg||n===Kg||n===$g||n===ty||n===ey||n===ny||n===ry||n===iy||n===oy||n===ay||n===sy||n===cy)&&null!==(r=e.get("WEBGL_compressed_texture_astc")))return n;if((n===Pv||n===Rv)&&null!==(r=e.get("EXT_blend_minmax"))){if(n===Pv)return r.MIN_EXT;if(n===Rv)return r.MAX_EXT}return n===Cg&&null!==(r=e.get("WEBGL_depth_texture"))?r.UNSIGNED_INT_24_8_WEBGL:0}return{convert:n}}function Ee(t){function e(){Tt.frame++,Tt.calls=0,Tt.vertices=0,Tt.faces=0,Tt.points=0}function n(){return null===$?mt:1}function r(){(Pt=new _e(Lt)).get("WEBGL_depth_texture"),Pt.get("OES_texture_float"),Pt.get("OES_texture_float_linear"),Pt.get("OES_texture_half_float"),Pt.get("OES_texture_half_float_linear"),Pt.get("OES_standard_derivatives"),Pt.get("OES_element_index_uint"),Pt.get("ANGLE_instanced_arrays"),Qt=new Me(Lt,Pt),Rt=new ye(Lt,Pt,t),(It=new ge(Lt,Pt,Qt)).scissor(st.copy(gt).multiplyScalar(mt)),It.viewport(at.copy(vt).multiplyScalar(mt)),Ct=new ve,Ot=new me(Lt,Pt,It,Ct,Rt,Qt,Et,Tt),Nt=new ht(Lt),Ft=new Jt(Lt,Nt,Et),Dt=new $t(Ft,Tt),jt=new Xt(Lt),Bt=new fe(J,Pt,Rt),Ut=new Kt,zt=new Wt,Gt=new kt(J,It,Ft,V),Vt=new Zt(Lt,Pt,Tt),Ht=new qt(Lt,Pt,Tt),Yt=new et(J,Lt,It,Ot,Rt),J.info.programs=Bt.programs,J.context=Lt,J.capabilities=Rt,J.extensions=Pt,J.properties=Ct,J.renderLists=zt,J.state=It}function i(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),Q=!0}function o(){console.log("THREE.WebGLRenderer: Context Restored."),Q=!1,r()}function a(t){var e=t.target;e.removeEventListener("dispose",a),s(e)}function s(t){c(t),Ct.remove(t)}function c(t){var e=Ct.get(t).program;t.program=void 0,void 0!==e&&Bt.releaseProgram(e)}function h(t,e,n){t.render(function(t){J.renderBufferImmediate(t,e,n)})}function d(t,e,n,r){if(n&&n.isInstancedBufferGeometry&&null===Pt.get("ANGLE_instanced_arrays"))console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{void 0===r&&(r=0),It.initAttributes();var i=n.attributes,o=e.getAttributes(),a=t.defaultAttributeValues;for(var s in o){var c=o[s];if(c>=0){var u=i[s];if(void 0!==u){var h=u.normalized,l=u.itemSize,d=Nt.get(u);if(void 0===d)continue;var p=d.buffer,f=d.type,m=d.bytesPerElement;if(u.isInterleavedBufferAttribute){var v=u.data,g=v.stride,y=u.offset;v&&v.isInstancedInterleavedBuffer?(It.enableAttributeAndDivisor(c,v.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=v.meshPerAttribute*v.count)):It.enableAttribute(c),Lt.bindBuffer(Lt.ARRAY_BUFFER,p),Lt.vertexAttribPointer(c,l,f,h,g*m,(r*g+y)*m)}else u.isInstancedBufferAttribute?(It.enableAttributeAndDivisor(c,u.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=u.meshPerAttribute*u.count)):It.enableAttribute(c),Lt.bindBuffer(Lt.ARRAY_BUFFER,p),Lt.vertexAttribPointer(c,l,f,h,0,r*l*m)}else if(void 0!==a){var x=a[s];if(void 0!==x)switch(x.length){case 2:Lt.vertexAttrib2fv(c,x);break;case 3:Lt.vertexAttrib3fv(c,x);break;case 4:Lt.vertexAttrib4fv(c,x);break;default:Lt.vertexAttrib1fv(c,x)}}}}It.disableUnusedAttributes()}}function p(){if(!ne){var t=te.getDevice();t&&t.isPresenting?t.requestAnimationFrame(m):window.requestAnimationFrame(m),ne=!0}}function m(t){null!==re&&re(t);var e=te.getDevice();e&&e.isPresenting?e.requestAnimationFrame(m):window.requestAnimationFrame(m)}function v(t,e,n){if(!1!==t.visible){var r;if(t.layers.test(e.layers))if(t.isLight)Y.push(t),t.castShadow&&X.push(t);else if(t.isSprite)t.frustumCulled&&!xt.intersectsSprite(t)||Z.push(t);else if(t.isImmediateRenderObject)n&&Mt.setFromMatrixPosition(t.matrixWorld).applyMatrix4(St),q.push(t,null,t.material,Mt.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.update(),!t.frustumCulled||xt.intersectsObject(t))){n&&Mt.setFromMatrixPosition(t.matrixWorld).applyMatrix4(St);var i=Dt.update(t),o=t.material;if(Array.isArray(o))for(var a=i.groups,s=0,c=a.length;s<c;s++){var u=a[s],h=o[u.materialIndex];h&&h.visible&&q.push(t,i,h,Mt.z,u)}else o.visible&&q.push(t,i,o,Mt.z,null)}for(var l=t.children,s=0,c=l.length;s<c;s++)v(l[s],e,n)}}function y(t,e,n,r){for(var i=0,o=t.length;i<o;i++){var a=t[i],s=a.object,c=a.geometry,u=void 0===r?a.material:r,h=a.group;if(n.isArrayCamera){ot=n;for(var l=n.cameras,d=0,p=l.length;d<p;d++){var f=l[d];if(s.layers.test(f.layers)){var m=f.bounds,v=m.x*pt,g=m.y*ft,y=m.z*pt,b=m.w*ft;It.viewport(at.set(v,g,y,b).multiplyScalar(mt)),x(s,e,f,c,u,h)}}}else ot=null,x(s,e,n,c,u,h)}}function x(t,e,n,r,i,o){if(t.onBeforeRender(J,e,n,r,i,o),t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject){var a=t.isMesh&&t.matrixWorld.determinant()<0;It.setMaterial(i,a);var s=w(n,e.fog,i,t);rt="",h(t,s,i)}else J.renderBufferDirect(n,e.fog,r,i,t,o);t.onAfterRender(J,e,n,r,i,o)}function b(t,e,n){var r=Ct.get(t),i=Bt.getParameters(t,Ut.state,X,e,bt.numPlanes,bt.numIntersection,n),o=Bt.getProgramCode(t,i),s=r.program,u=!0;if(void 0===s)t.addEventListener("dispose",a);else if(s.code!==o)c(t);else{if(void 0!==i.shaderID)return;u=!1}if(u){if(i.shaderID){var h=Hb[i.shaderID];r.shader={name:t.type,uniforms:ky.clone(h.uniforms),vertexShader:h.vertexShader,fragmentShader:h.fragmentShader}}else r.shader={name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader};t.onBeforeCompile(r.shader),s=Bt.acquireProgram(t,r.shader,i,o),r.program=s,t.program=s}var l=s.getAttributes();if(t.morphTargets){t.numSupportedMorphTargets=0;for(var d=0;d<J.maxMorphTargets;d++)l["morphTarget"+d]>=0&&t.numSupportedMorphTargets++}if(t.morphNormals){t.numSupportedMorphNormals=0;for(var d=0;d<J.maxMorphNormals;d++)l["morphNormal"+d]>=0&&t.numSupportedMorphNormals++}var p=r.shader.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(r.numClippingPlanes=bt.numPlanes,r.numIntersection=bt.numIntersection,p.clippingPlanes=bt.uniform),r.fog=e,r.lightsHash=Ut.state.hash,t.lights&&(p.ambientLightColor.value=Ut.state.ambient,p.directionalLights.value=Ut.state.directional,p.spotLights.value=Ut.state.spot,p.rectAreaLights.value=Ut.state.rectArea,p.pointLights.value=Ut.state.point,p.hemisphereLights.value=Ut.state.hemi,p.directionalShadowMap.value=Ut.state.directionalShadowMap,p.directionalShadowMatrix.value=Ut.state.directionalShadowMatrix,p.spotShadowMap.value=Ut.state.spotShadowMap,p.spotShadowMatrix.value=Ut.state.spotShadowMatrix,p.pointShadowMap.value=Ut.state.pointShadowMap,p.pointShadowMatrix.value=Ut.state.pointShadowMatrix);var f=r.program.getUniforms(),m=K.seqWithValue(f.seq,p);r.uniformsList=m}function w(t,e,n,r){dt=0;var i=Ct.get(n);if(wt&&(_t||t!==it)){var o=t===it&&n.id===nt;bt.setState(n.clippingPlanes,n.clipIntersection,n.clipShadows,t,i,o)}!1===n.needsUpdate&&(void 0===i.program?n.needsUpdate=!0:n.fog&&i.fog!==e?n.needsUpdate=!0:n.lights&&i.lightsHash!==Ut.state.hash?n.needsUpdate=!0:void 0===i.numClippingPlanes||i.numClippingPlanes===bt.numPlanes&&i.numIntersection===bt.numIntersection||(n.needsUpdate=!0)),n.needsUpdate&&(b(n,e,r),n.needsUpdate=!1);var a=!1,s=!1,c=!1,u=i.program,h=u.getUniforms(),l=i.shader.uniforms;if(It.useProgram(u.program)&&(a=!0,s=!0,c=!0),n.id!==nt&&(nt=n.id,s=!0),a||t!==it){if(h.setValue(Lt,"projectionMatrix",t.projectionMatrix),Rt.logarithmicDepthBuffer&&h.setValue(Lt,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),it!==(ot||t)&&(it=ot||t,s=!0,c=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshStandardMaterial||n.envMap){var d=h.map.cameraPosition;void 0!==d&&d.setValue(Lt,Mt.setFromMatrixPosition(t.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.skinning)&&h.setValue(Lt,"viewMatrix",t.matrixWorldInverse)}if(n.skinning){h.setOptional(Lt,r,"bindMatrix"),h.setOptional(Lt,r,"bindMatrixInverse");var p=r.skeleton;if(p){var f=p.bones;if(Rt.floatVertexTextures){if(void 0===p.boneTexture){var m=Math.sqrt(4*f.length);m=Ry.ceilPowerOfTwo(m),m=Math.max(m,4);var v=new Float32Array(m*m*4);v.set(p.boneMatrices);var y=new g(v,m,m,Fg,Lg);p.boneMatrices=v,p.boneTexture=y,p.boneTextureSize=m}h.setValue(Lt,"boneTexture",p.boneTexture),h.setValue(Lt,"boneTextureSize",p.boneTextureSize)}else h.setOptional(Lt,p,"boneMatrices")}}return s&&(h.setValue(Lt,"toneMappingExposure",J.toneMappingExposure),h.setValue(Lt,"toneMappingWhitePoint",J.toneMappingWhitePoint),n.lights&&F(l,c),e&&n.fog&&T(l,e),n.isMeshBasicMaterial?_(l,n):n.isMeshLambertMaterial?(_(l,n),L(l,n)):n.isMeshPhongMaterial?(_(l,n),n.isMeshToonMaterial?P(l,n):A(l,n)):n.isMeshStandardMaterial?(_(l,n),n.isMeshPhysicalMaterial?I(l,n):R(l,n)):n.isMeshDepthMaterial?(_(l,n),C(l,n)):n.isMeshDistanceMaterial?(_(l,n),O(l,n)):n.isMeshNormalMaterial?(_(l,n),N(l,n)):n.isLineBasicMaterial?(S(l,n),n.isLineDashedMaterial&&M(l,n)):n.isPointsMaterial?E(l,n):n.isShadowMaterial&&(l.color.value=n.color,l.opacity.value=n.opacity),void 0!==l.ltc_1&&(l.ltc_1.value=Gy.LTC_1),void 0!==l.ltc_2&&(l.ltc_2.value=Gy.LTC_2),K.upload(Lt,i.uniformsList,l,J)),h.setValue(Lt,"modelViewMatrix",r.modelViewMatrix),h.setValue(Lt,"normalMatrix",r.normalMatrix),h.setValue(Lt,"modelMatrix",r.matrixWorld),u}function _(t,e){t.opacity.value=e.opacity,e.color&&(t.diffuse.value=e.color),e.emissive&&t.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity),e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.specularMap&&(t.specularMap.value=e.specularMap),e.envMap&&(t.envMap.value=e.envMap,t.flipEnvMap.value=e.envMap&&e.envMap.isCubeTexture?-1:1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.aoMap&&(t.aoMap.value=e.aoMap,t.aoMapIntensity.value=e.aoMapIntensity);var n;if(e.map?n=e.map:e.specularMap?n=e.specularMap:e.displacementMap?n=e.displacementMap:e.normalMap?n=e.normalMap:e.bumpMap?n=e.bumpMap:e.roughnessMap?n=e.roughnessMap:e.metalnessMap?n=e.metalnessMap:e.alphaMap?n=e.alphaMap:e.emissiveMap&&(n=e.emissiveMap),void 0!==n){if(n.isWebGLRenderTarget&&(n=n.texture),!0===n.matrixAutoUpdate){var r=n.offset,i=n.repeat,o=n.rotation,a=n.center;n.matrix.setUvTransform(r.x,r.y,i.x,i.y,o,a.x,a.y)}t.uvTransform.value.copy(n.matrix)}}function S(t,e){t.diffuse.value=e.color,t.opacity.value=e.opacity}function M(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}function E(t,e){if(t.diffuse.value=e.color,t.opacity.value=e.opacity,t.size.value=e.size*mt,t.scale.value=.5*ft,t.map.value=e.map,null!==e.map){if(!0===e.map.matrixAutoUpdate){var n=e.map.offset,r=e.map.repeat,i=e.map.rotation,o=e.map.center;e.map.matrix.setUvTransform(n.x,n.y,r.x,r.y,i,o.x,o.y)}t.uvTransform.value.copy(e.map.matrix)}}function T(t,e){t.fogColor.value=e.color,e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)}function L(t,e){e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)}function A(t,e){t.specular.value=e.specular,t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function P(t,e){A(t,e),e.gradientMap&&(t.gradientMap.value=e.gradientMap)}function R(t,e){t.roughness.value=e.roughness,t.metalness.value=e.metalness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),e.envMap&&(t.envMapIntensity.value=e.envMapIntensity)}function I(t,e){t.clearCoat.value=e.clearCoat,t.clearCoatRoughness.value=e.clearCoatRoughness,R(t,e)}function C(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function O(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance}function N(t,e){e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function F(t,e){t.ambientLightColor.needsUpdate=e,t.directionalLights.needsUpdate=e,t.pointLights.needsUpdate=e,t.spotLights.needsUpdate=e,t.rectAreaLights.needsUpdate=e,t.hemisphereLights.needsUpdate=e}function D(){var t=dt;return t>=Rt.maxTextures&&console.warn("THREE.WebGLRenderer: Trying to use "+t+" texture units while this GPU supports only "+Rt.maxTextures),dt+=1,t}console.log("THREE.WebGLRenderer",ov);var U=void 0!==(t=t||{}).canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),B=void 0!==t.context?t.context:null,z=void 0!==t.alpha&&t.alpha,G=void 0===t.depth||t.depth,k=void 0===t.stencil||t.stencil,j=void 0!==t.antialias&&t.antialias,V=void 0===t.premultipliedAlpha||t.premultipliedAlpha,H=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,W=void 0!==t.powerPreference?t.powerPreference:"default",Y=[],X=[],q=null,Z=[];this.domElement=U,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=tg,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var J=this,Q=!1,$=null,tt=null,nt=-1,rt="",it=null,ot=null,at=new f,st=new f,lt=null,dt=0,pt=U.width,ft=U.height,mt=1,vt=new f(0,0,pt,ft),gt=new f(0,0,pt,ft),yt=!1,xt=new ct,bt=new Se,wt=!1,_t=!1,St=new u,Mt=new l,Et={geometries:0,textures:0},Tt={frame:0,calls:0,vertices:0,faces:0,points:0};this.info={render:Tt,memory:Et,programs:null,autoReset:!0,reset:e};var Lt;try{var At={alpha:z,depth:G,stencil:k,antialias:j,premultipliedAlpha:V,preserveDrawingBuffer:H,powerPreference:W};if(U.addEventListener("webglcontextlost",i,!1),U.addEventListener("webglcontextrestored",o,!1),null===(Lt=B||U.getContext("webgl",At)||U.getContext("experimental-webgl",At)))throw null!==U.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===Lt.getShaderPrecisionFormat&&(Lt.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(t){console.error("THREE.WebGLRenderer: "+t.message)}var Pt,Rt,It,Ct,Ot,Nt,Ft,Dt,Ut,Bt,zt,Gt,jt,Vt,Ht,Yt,Qt;r();var te=new we(J);this.vr=te;var ee=new ut(J,Dt,Rt.maxTextureSize);this.shadowMap=ee,this.getContext=function(){return Lt},this.getContextAttributes=function(){return Lt.getContextAttributes()},this.forceContextLoss=function(){var t=Pt.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){var t=Pt.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return mt},this.setPixelRatio=function(t){void 0!==t&&(mt=t,this.setSize(pt,ft,!1))},this.getSize=function(){return{width:pt,height:ft}},this.setSize=function(t,e,n){var r=te.getDevice();r&&r.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(pt=t,ft=e,U.width=t*mt,U.height=e*mt,!1!==n&&(U.style.width=t+"px",U.style.height=e+"px"),this.setViewport(0,0,t,e))},this.getDrawingBufferSize=function(){return{width:pt*mt,height:ft*mt}},this.setDrawingBufferSize=function(t,e,n){pt=t,ft=e,mt=n,U.width=t*n,U.height=e*n,this.setViewport(0,0,t,e)},this.getCurrentViewport=function(){return at},this.setViewport=function(t,e,n,r){vt.set(t,ft-e-r,n,r),It.viewport(at.copy(vt).multiplyScalar(mt))},this.setScissor=function(t,e,n,r){gt.set(t,ft-e-r,n,r),It.scissor(st.copy(gt).multiplyScalar(mt))},this.setScissorTest=function(t){It.setScissorTest(yt=t)},this.getClearColor=function(){return Gt.getClearColor()},this.setClearColor=function(){Gt.setClearColor.apply(Gt,arguments)},this.getClearAlpha=function(){return Gt.getClearAlpha()},this.setClearAlpha=function(){Gt.setClearAlpha.apply(Gt,arguments)},this.clear=function(t,e,n){var r=0;(void 0===t||t)&&(r|=Lt.COLOR_BUFFER_BIT),(void 0===e||e)&&(r|=Lt.DEPTH_BUFFER_BIT),(void 0===n||n)&&(r|=Lt.STENCIL_BUFFER_BIT),Lt.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(t,e,n,r){this.setRenderTarget(t),this.clear(e,n,r)},this.dispose=function(){U.removeEventListener("webglcontextlost",i,!1),U.removeEventListener("webglcontextrestored",o,!1),zt.dispose(),Ct.dispose(),Dt.dispose(),te.dispose()},this.renderBufferImmediate=function(t,e,n){It.initAttributes();var r=Ct.get(t);t.hasPositions&&!r.position&&(r.position=Lt.createBuffer()),t.hasNormals&&!r.normal&&(r.normal=Lt.createBuffer()),t.hasUvs&&!r.uv&&(r.uv=Lt.createBuffer()),t.hasColors&&!r.color&&(r.color=Lt.createBuffer());var i=e.getAttributes();if(t.hasPositions&&(Lt.bindBuffer(Lt.ARRAY_BUFFER,r.position),Lt.bufferData(Lt.ARRAY_BUFFER,t.positionArray,Lt.DYNAMIC_DRAW),It.enableAttribute(i.position),Lt.vertexAttribPointer(i.position,3,Lt.FLOAT,!1,0,0)),t.hasNormals){if(Lt.bindBuffer(Lt.ARRAY_BUFFER,r.normal),!n.isMeshPhongMaterial&&!n.isMeshStandardMaterial&&!n.isMeshNormalMaterial&&!0===n.flatShading)for(var o=0,a=3*t.count;o<a;o+=9){var s=t.normalArray,c=(s[o+0]+s[o+3]+s[o+6])/3,u=(s[o+1]+s[o+4]+s[o+7])/3,h=(s[o+2]+s[o+5]+s[o+8])/3;s[o+0]=c,s[o+1]=u,s[o+2]=h,s[o+3]=c,s[o+4]=u,s[o+5]=h,s[o+6]=c,s[o+7]=u,s[o+8]=h}Lt.bufferData(Lt.ARRAY_BUFFER,t.normalArray,Lt.DYNAMIC_DRAW),It.enableAttribute(i.normal),Lt.vertexAttribPointer(i.normal,3,Lt.FLOAT,!1,0,0)}t.hasUvs&&n.map&&(Lt.bindBuffer(Lt.ARRAY_BUFFER,r.uv),Lt.bufferData(Lt.ARRAY_BUFFER,t.uvArray,Lt.DYNAMIC_DRAW),It.enableAttribute(i.uv),Lt.vertexAttribPointer(i.uv,2,Lt.FLOAT,!1,0,0)),t.hasColors&&n.vertexColors!==gv&&(Lt.bindBuffer(Lt.ARRAY_BUFFER,r.color),Lt.bufferData(Lt.ARRAY_BUFFER,t.colorArray,Lt.DYNAMIC_DRAW),It.enableAttribute(i.color),Lt.vertexAttribPointer(i.color,3,Lt.FLOAT,!1,0,0)),It.disableUnusedAttributes(),Lt.drawArrays(Lt.TRIANGLES,0,t.count),t.count=0},this.renderBufferDirect=function(t,e,r,i,o,a){var s=o.isMesh&&o.matrixWorld.determinant()<0;It.setMaterial(i,s);var c=w(t,e,i,o),u=r.id+"_"+c.id+"_"+(!0===i.wireframe),h=!1;u!==rt&&(rt=u,h=!0),o.morphTargetInfluences&&(jt.update(o,r,i,c),h=!0);var l=r.index,p=r.attributes.position,f=1;!0===i.wireframe&&(l=Ft.getWireframeAttribute(r),f=2);var m,v=Vt;null!==l&&(m=Nt.get(l),(v=Ht).setIndex(m)),h&&(d(i,c,r),null!==l&&Lt.bindBuffer(Lt.ELEMENT_ARRAY_BUFFER,m.buffer));var g=1/0;null!==l?g=l.count:void 0!==p&&(g=p.count);var y=r.drawRange.start*f,x=r.drawRange.count*f,b=null!==a?a.start*f:0,_=null!==a?a.count*f:1/0,S=Math.max(y,b),M=Math.min(g,y+x,b+_)-1,E=Math.max(0,M-S+1);if(0!==E){if(o.isMesh)if(!0===i.wireframe)It.setLineWidth(i.wireframeLinewidth*n()),v.setMode(Lt.LINES);else switch(o.drawMode){case yy:v.setMode(Lt.TRIANGLES);break;case xy:v.setMode(Lt.TRIANGLE_STRIP);break;case by:v.setMode(Lt.TRIANGLE_FAN)}else if(o.isLine){var T=i.linewidth;void 0===T&&(T=1),It.setLineWidth(T*n()),o.isLineSegments?v.setMode(Lt.LINES):o.isLineLoop?v.setMode(Lt.LINE_LOOP):v.setMode(Lt.LINE_STRIP)}else o.isPoints&&v.setMode(Lt.POINTS);r&&r.isInstancedBufferGeometry?r.maxInstancedCount>0&&v.renderInstances(r,S,E):v.render(S,E)}},this.compile=function(t,e){Y.length=0,X.length=0,t.traverse(function(t){t.isLight&&(Y.push(t),t.castShadow&&X.push(t))}),Ut.setup(Y,X,e),t.traverse(function(e){if(e.material)if(Array.isArray(e.material))for(var n=0;n<e.material.length;n++)b(e.material[n],t.fog,e);else b(e.material,t.fog,e)})};var ne=!1,re=null;this.animate=function(t){re=t,p()},this.render=function(t,e,n,r){if(e&&e.isCamera){if(!Q){rt="",nt=-1,it=null,!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),te.enabled&&(e=te.getCamera(e)),t.onBeforeRender(J,t,e,n),St.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),xt.setFromMatrix(St),Y.length=0,X.length=0,Z.length=0,_t=this.localClippingEnabled,wt=bt.init(this.clippingPlanes,_t,e),(q=zt.get(t,e)).init(),v(t,e,J.sortObjects),!0===J.sortObjects&&q.sort(),wt&&bt.beginShadows(),ee.render(X,t,e),Ut.setup(Y,X,e),wt&&bt.endShadows(),this.info.autoReset&&this.info.reset(),void 0===n&&(n=null),this.setRenderTarget(n),Gt.render(q,t,e,r);var i=q.opaque,o=q.transparent;if(t.overrideMaterial){var a=t.overrideMaterial;i.length&&y(i,t,e,a),o.length&&y(o,t,e,a)}else i.length&&y(i,t,e),o.length&&y(o,t,e);Yt.render(Z,t,e),n&&Ot.updateRenderTargetMipmap(n),It.buffers.depth.setTest(!0),It.buffers.depth.setMask(!0),It.buffers.color.setMask(!0),It.setPolygonOffset(!1),t.onAfterRender(J,t,e),te.enabled&&te.submitFrame(),q=null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFaceCulling=function(t,e){It.setCullFace(t),It.setFlipSided(e===hv)},this.allocTextureUnit=D,this.setTexture2D=function(){var t=!1;return function e(n,r){n&&n.isWebGLRenderTarget&&(t||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),t=!0),n=n.texture),Ot.setTexture2D(n,r)}}(),this.setTexture=function(){var t=!1;return function e(n,r){t||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),t=!0),Ot.setTexture2D(n,r)}}(),this.setTextureCube=function(){var t=!1;return function e(n,r){n&&n.isWebGLRenderTargetCube&&(t||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),t=!0),n=n.texture),n&&n.isCubeTexture||Array.isArray(n.image)&&6===n.image.length?Ot.setTextureCube(n,r):Ot.setTextureCubeDynamic(n,r)}}(),this.getRenderTarget=function(){return $},this.setRenderTarget=function(t){$=t,t&&void 0===Ct.get(t).__webglFramebuffer&&Ot.setupRenderTarget(t);var e=null,n=!1;if(t){var r=Ct.get(t).__webglFramebuffer;t.isWebGLRenderTargetCube?(e=r[t.activeCubeFace],n=!0):e=r,at.copy(t.viewport),st.copy(t.scissor),lt=t.scissorTest}else at.copy(vt).multiplyScalar(mt),st.copy(gt).multiplyScalar(mt),lt=yt;if(tt!==e&&(Lt.bindFramebuffer(Lt.FRAMEBUFFER,e),tt=e),It.viewport(at),It.scissor(st),It.setScissorTest(lt),n){var i=Ct.get(t.texture);Lt.framebufferTexture2D(Lt.FRAMEBUFFER,Lt.COLOR_ATTACHMENT0,Lt.TEXTURE_CUBE_MAP_POSITIVE_X+t.activeCubeFace,i.__webglTexture,t.activeMipMapLevel)}},this.readRenderTargetPixels=function(t,e,n,r,i,o){if(t&&t.isWebGLRenderTarget){var a=Ct.get(t).__webglFramebuffer;if(a){var s=!1;a!==tt&&(Lt.bindFramebuffer(Lt.FRAMEBUFFER,a),s=!0);try{var c=t.texture,u=c.format,h=c.type;if(u!==Fg&&Qt.convert(u)!==Lt.getParameter(Lt.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(h===wg||Qt.convert(h)===Lt.getParameter(Lt.IMPLEMENTATION_COLOR_READ_TYPE)||h===Lg&&(Pt.get("OES_texture_float")||Pt.get("WEBGL_color_buffer_float"))||h===Ag&&Pt.get("EXT_color_buffer_half_float")))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");Lt.checkFramebufferStatus(Lt.FRAMEBUFFER)===Lt.FRAMEBUFFER_COMPLETE?e>=0&&e<=t.width-r&&n>=0&&n<=t.height-i&&Lt.readPixels(e,n,r,i,Qt.convert(u),Qt.convert(h),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{s&&Lt.bindFramebuffer(Lt.FRAMEBUFFER,tt)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(t,e,n){var r=e.image.width,i=e.image.height,o=Qt.convert(e.format);this.setTexture2D(e,0),Lt.copyTexImage2D(Lt.TEXTURE_2D,n||0,o,t.x,t.y,r,i,0)}}function Te(t,e){this.name="",this.color=new $(t),this.density=void 0!==e?e:25e-5}function Le(t,e,n){this.name="",this.color=new $(t),this.near=void 0!==e?e:1,this.far=void 0!==n?n:1e3}function Ae(){pt.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function Pe(t){nt.call(this),this.type="SpriteMaterial",this.color=new $(16777215),this.map=null,this.rotation=0,this.fog=!1,this.lights=!1,this.setValues(t)}function Re(t){pt.call(this),this.type="Sprite",this.material=void 0!==t?t:new Pe,this.center=new c(.5,.5)}function Ie(){pt.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function Ce(t,e){if(t=t||[],this.bones=t.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new u)}}function Oe(){pt.call(this),this.type="Bone"}function Ne(t,e){Gt.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new u,this.bindMatrixInverse=new u;var n,r=new Ce(this.initBones());this.bind(r,this.matrixWorld),this.normalizeSkinWeights()}function Fe(t){nt.call(this),this.type="LineBasicMaterial",this.color=new $(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(t)}function De(t,e,n){if(1===n)return console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new Ue(t,e);pt.call(this),this.type="Line",this.geometry=void 0!==t?t:new Rt,this.material=void 0!==e?e:new Fe({color:16777215*Math.random()})}function Ue(t,e){De.call(this,t,e),this.type="LineSegments"}function Be(t,e){De.call(this,t,e),this.type="LineLoop"}function ze(t){nt.call(this),this.type="PointsMaterial",this.color=new $(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.lights=!1,this.setValues(t)}function Ge(t,e){pt.call(this),this.type="Points",this.geometry=void 0!==t?t:new Rt,this.material=void 0!==e?e:new ze({color:16777215*Math.random()})}function ke(){pt.call(this),this.type="Group"}function je(t,e,n,r,i,o,a,s,c){p.call(this,t,e,n,r,i,o,a,s,c),this.generateMipmaps=!1}function Ve(t,e,n,r,i,o,a,s,c,u,h,l){p.call(this,null,o,a,s,c,u,r,i,h,l),this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}function He(t,e,n,r,i,o,a,s,c,u){if((u=void 0!==u?u:Bg)!==Bg&&u!==zg)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&u===Bg&&(n=Mg),void 0===n&&u===zg&&(n=Cg),p.call(this,null,r,i,o,a,s,u,n,c),this.image={width:t,height:e},this.magFilter=void 0!==a?a:mg,this.minFilter=void 0!==s?s:mg,this.flipY=!1,this.generateMipmaps=!1}function We(t){Rt.call(this),this.type="WireframeGeometry";var e=[],n,r,i,o,a,s=[0,0],c={},u,h,d,p,f=["a","b","c"],m;if(t&&t.isGeometry){var v=t.faces;for(n=0,i=v.length;n<i;n++){var g=v[n];for(r=0;r<3;r++)h=g[f[r]],d=g[f[(r+1)%3]],s[0]=Math.min(h,d),s[1]=Math.max(h,d),void 0===c[p=s[0]+","+s[1]]&&(c[p]={index1:s[0],index2:s[1]})}for(p in c)u=c[p],m=t.vertices[u.index1],e.push(m.x,m.y,m.z),m=t.vertices[u.index2],e.push(m.x,m.y,m.z)}else if(t&&t.isBufferGeometry){var y,x,b,w,_,S,M,E;if(m=new l,null!==t.index){for(y=t.attributes.position,x=t.index,0===(b=t.groups).length&&(b=[{start:0,count:x.count,materialIndex:0}]),o=0,a=b.length;o<a;++o)for(n=_=(w=b[o]).start,i=_+(S=w.count);n<i;n+=3)for(r=0;r<3;r++)h=x.getX(n+r),d=x.getX(n+(r+1)%3),s[0]=Math.min(h,d),s[1]=Math.max(h,d),void 0===c[p=s[0]+","+s[1]]&&(c[p]={index1:s[0],index2:s[1]});for(p in c)u=c[p],m.fromBufferAttribute(y,u.index1),e.push(m.x,m.y,m.z),m.fromBufferAttribute(y,u.index2),e.push(m.x,m.y,m.z)}else for(n=0,i=(y=t.attributes.position).count/3;n<i;n++)for(r=0;r<3;r++)M=3*n+r,m.fromBufferAttribute(y,M),e.push(m.x,m.y,m.z),E=3*n+(r+1)%3,m.fromBufferAttribute(y,E),e.push(m.x,m.y,m.z)}this.addAttribute("position",new Tt(e,3))}function Ye(t,e,n){gt.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:n},this.fromBufferGeometry(new Xe(t,e,n)),this.mergeVertices()}function Xe(t,e,n){Rt.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:e,stacks:n};var r=[],i=[],o=[],a=[],s=1e-5,c=new l,u=new l,h=new l,d=new l,p=new l,f,m,v=e+1;for(f=0;f<=n;f++){var g=f/n;for(m=0;m<=e;m++){var y=m/e;u=t(y,g,u),i.push(u.x,u.y,u.z),y-1e-5>=0?(h=t(y-1e-5,g,h),d.subVectors(u,h)):(h=t(y+1e-5,g,h),d.subVectors(h,u)),g-1e-5>=0?(h=t(y,g-1e-5,h),p.subVectors(u,h)):(h=t(y,g+1e-5,h),p.subVectors(h,u)),c.crossVectors(d,p).normalize(),o.push(c.x,c.y,c.z),a.push(y,g)}}for(f=0;f<n;f++)for(m=0;m<e;m++){var x=f*v+m,b=f*v+m+1,w=(f+1)*v+m+1,_=(f+1)*v+m;r.push(x,b,_),r.push(b,w,_)}this.setIndex(r),this.addAttribute("position",new Tt(i,3)),this.addAttribute("normal",new Tt(o,3)),this.addAttribute("uv",new Tt(a,2))}function qe(t,e,n,r){gt.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r},this.fromBufferGeometry(new Ze(t,e,n,r)),this.mergeVertices()}function Ze(t,e,n,r){function i(t){for(var n=new l,r=new l,i=new l,a=0;a<e.length;a+=3)d(e[a+0],n),d(e[a+1],r),d(e[a+2],i),o(n,r,i,t)}function o(t,e,n,r){var i=Math.pow(2,r),o=[],a,s;for(a=0;a<=i;a++){o[a]=[];var c=t.clone().lerp(n,a/i),u=e.clone().lerp(n,a/i),l=i-a;for(s=0;s<=l;s++)o[a][s]=0===s&&a===i?c:c.clone().lerp(u,s/l)}for(a=0;a<i;a++)for(s=0;s<2*(i-a)-1;s++){var d=Math.floor(s/2);s%2==0?(h(o[a][d+1]),h(o[a+1][d]),h(o[a][d])):(h(o[a][d+1]),h(o[a+1][d+1]),h(o[a+1][d]))}}function a(t){for(var e=new l,n=0;n<g.length;n+=3)e.x=g[n+0],e.y=g[n+1],e.z=g[n+2],e.normalize().multiplyScalar(t),g[n+0]=e.x,g[n+1]=e.y,g[n+2]=e.z}function s(){for(var t=new l,e=0;e<g.length;e+=3){t.x=g[e+0],t.y=g[e+1],t.z=g[e+2];var n=m(t)/2/Math.PI+.5,r=v(t)/Math.PI+.5;y.push(n,1-r)}p(),u()}function u(){for(var t=0;t<y.length;t+=6){var e=y[t+0],n=y[t+2],r=y[t+4],i=Math.max(e,n,r),o=Math.min(e,n,r);i>.9&&o<.1&&(e<.2&&(y[t+0]+=1),n<.2&&(y[t+2]+=1),r<.2&&(y[t+4]+=1))}}function h(t){g.push(t.x,t.y,t.z)}function d(e,n){var r=3*e;n.x=t[r+0],n.y=t[r+1],n.z=t[r+2]}function p(){for(var t=new l,e=new l,n=new l,r=new l,i=new c,o=new c,a=new c,s=0,u=0;s<g.length;s+=9,u+=6){t.set(g[s+0],g[s+1],g[s+2]),e.set(g[s+3],g[s+4],g[s+5]),n.set(g[s+6],g[s+7],g[s+8]),i.set(y[u+0],y[u+1]),o.set(y[u+2],y[u+3]),a.set(y[u+4],y[u+5]),r.copy(t).add(e).add(n).divideScalar(3);var h=m(r);f(i,u+0,t,h),f(o,u+2,e,h),f(a,u+4,n,h)}}function f(t,e,n,r){r<0&&1===t.x&&(y[e]=t.x-1),0===n.x&&0===n.z&&(y[e]=r/2/Math.PI+.5)}function m(t){return Math.atan2(t.z,-t.x)}function v(t){return Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))}Rt.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r},n=n||1;var g=[],y=[];i(r=r||0),a(n),s(),this.addAttribute("position",new Tt(g,3)),this.addAttribute("normal",new Tt(g.slice(),3)),this.addAttribute("uv",new Tt(y,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}function Je(t,e){gt.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Qe(t,e)),this.mergeVertices()}function Qe(t,e){var n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];Ze.call(this,n,r,t,e),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Ke(t,e){gt.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new $e(t,e)),this.mergeVertices()}function $e(t,e){var n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];Ze.call(this,n,r,t,e),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:e}}function tn(t,e){gt.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new en(t,e)),this.mergeVertices()}function en(t,e){var n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],i=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];Ze.call(this,r,i,t,e),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:e}}function nn(t,e){gt.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new rn(t,e)),this.mergeVertices()}function rn(t,e){var n=(1+Math.sqrt(5))/2,r=1/n,i=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];Ze.call(this,i,o,t,e),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:e}}function on(t,e,n,r,i,o){gt.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:i},void 0!==o&&console.warn("THREE.TubeGeometry: taper has been removed.");var a=new an(t,e,n,r,i);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals,this.fromBufferGeometry(a),this.mergeVertices()}function an(t,e,n,r,i){function o(){for(v=0;v<e;v++)a(v);a(!1===i?e:0),u(),s()}function a(i){m=t.getPointAt(i/e,m);var o=h.normals[i],a=h.binormals[i];for(g=0;g<=r;g++){var s=g/r*Math.PI*2,c=Math.sin(s),u=-Math.cos(s);p.x=u*o.x+c*a.x,p.y=u*o.y+c*a.y,p.z=u*o.z+c*a.z,p.normalize(),x.push(p.x,p.y,p.z),d.x=m.x+n*p.x,d.y=m.y+n*p.y,d.z=m.z+n*p.z,y.push(d.x,d.y,d.z)}}function s(){for(g=1;g<=e;g++)for(v=1;v<=r;v++){var t=(r+1)*(g-1)+(v-1),n=(r+1)*g+(v-1),i=(r+1)*g+v,o=(r+1)*(g-1)+v;w.push(t,n,o),w.push(n,i,o)}}function u(){for(v=0;v<=e;v++)for(g=0;g<=r;g++)f.x=v/e,f.y=g/r,b.push(f.x,f.y)}Rt.call(this),this.type="TubeBufferGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:i},e=e||64,n=n||1,r=r||8,i=i||!1;var h=t.computeFrenetFrames(e,i);this.tangents=h.tangents,this.normals=h.normals,this.binormals=h.binormals;var d=new l,p=new l,f=new c,m=new l,v,g,y=[],x=[],b=[],w=[];o(),this.setIndex(w),this.addAttribute("position",new Tt(y,3)),this.addAttribute("normal",new Tt(x,3)),this.addAttribute("uv",new Tt(b,2))}function sn(t,e,n,r,i,o,a){gt.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:i,q:o},void 0!==a&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new cn(t,e,n,r,i,o)),this.mergeVertices()}function cn(t,e,n,r,i,o){function a(t,e,n,r,i){var o=Math.cos(t),a=Math.sin(t),s=n/e*t,c=Math.cos(s);i.x=r*(2+c)*.5*o,i.y=r*(2+c)*a*.5,i.z=r*Math.sin(s)*.5}Rt.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:i,q:o},t=t||1,e=e||.4,n=Math.floor(n)||64,r=Math.floor(r)||8,i=i||2,o=o||3;var s=[],c=[],u=[],h=[],d,p,f=new l,m=new l,v=new l,g=new l,y=new l,x=new l,b=new l;for(d=0;d<=n;++d){var w=d/n*i*Math.PI*2;for(a(w,i,o,t,v),a(w+.01,i,o,t,g),x.subVectors(g,v),b.addVectors(g,v),y.crossVectors(x,b),b.crossVectors(y,x),y.normalize(),b.normalize(),p=0;p<=r;++p){var _=p/r*Math.PI*2,S=-e*Math.cos(_),M=e*Math.sin(_);f.x=v.x+(S*b.x+M*y.x),f.y=v.y+(S*b.y+M*y.y),f.z=v.z+(S*b.z+M*y.z),c.push(f.x,f.y,f.z),m.subVectors(f,v).normalize(),u.push(m.x,m.y,m.z),h.push(d/n),h.push(p/r)}}for(p=1;p<=n;p++)for(d=1;d<=r;d++){var E=(r+1)*(p-1)+(d-1),T=(r+1)*p+(d-1),L=(r+1)*p+d,A=(r+1)*(p-1)+d;s.push(E,T,A),s.push(T,L,A)}this.setIndex(s),this.addAttribute("position",new Tt(c,3)),this.addAttribute("normal",new Tt(u,3)),this.addAttribute("uv",new Tt(h,2))}function un(t,e,n,r,i){gt.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:i},this.fromBufferGeometry(new hn(t,e,n,r,i)),this.mergeVertices()}function hn(t,e,n,r,i){Rt.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:i},t=t||1,e=e||.4,n=Math.floor(n)||8,r=Math.floor(r)||6,i=i||2*Math.PI;var o=[],a=[],s=[],c=[],u=new l,h=new l,d=new l,p,f;for(p=0;p<=n;p++)for(f=0;f<=r;f++){var m=f/r*i,v=p/n*Math.PI*2;h.x=(t+e*Math.cos(v))*Math.cos(m),h.y=(t+e*Math.cos(v))*Math.sin(m),h.z=e*Math.sin(v),a.push(h.x,h.y,h.z),u.x=t*Math.cos(m),u.y=t*Math.sin(m),d.subVectors(h,u).normalize(),s.push(d.x,d.y,d.z),c.push(f/r),c.push(p/n)}for(p=1;p<=n;p++)for(f=1;f<=r;f++){var g=(r+1)*p+f-1,y=(r+1)*(p-1)+f-1,x=(r+1)*(p-1)+f,b=(r+1)*p+f;o.push(g,y,b),o.push(y,x,b)}this.setIndex(o),this.addAttribute("position",new Tt(a,3)),this.addAttribute("normal",new Tt(s,3)),this.addAttribute("uv",new Tt(c,2))}function ln(t,e,n,r,i){var o,a;if(i===Bn(t,e,n,r)>0)for(o=e;o<n;o+=r)a=Fn(o,t[o],t[o+1],a);else for(o=n-r;o>=e;o-=r)a=Fn(o,t[o],t[o+1],a);return a&&Pn(a,a.next)&&(Dn(a),a=a.next),a}function dn(t,e){if(!t)return t;e||(e=t);var n=t,r;do{if(r=!1,n.steiner||!Pn(n,n.next)&&0!==An(n.prev,n,n.next))n=n.next;else{if(Dn(n),(n=e=n.prev)===n.next)break;r=!0}}while(r||n!==e);return e}function pn(t,e,n,r,i,o,a){if(t){!a&&o&&_n(t,r,i,o);for(var s=t,c,u;t.prev!==t.next;)if(c=t.prev,u=t.next,o?mn(t,r,i,o):fn(t))e.push(c.i/n),e.push(t.i/n),e.push(u.i/n),Dn(t),t=u.next,s=u.next;else if((t=u)===s){a?1===a?pn(t=vn(t,e,n),e,n,r,i,o,2):2===a&&gn(t,e,n,r,i,o):pn(dn(t),e,n,r,i,o,1);break}}}function fn(t){var e=t.prev,n=t,r=t.next;if(An(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(Tn(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&An(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function mn(t,e,n,r){var i=t.prev,o=t,a=t.next;if(An(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,c=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,u=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,h=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,l=Mn(s,c,e,n,r),d=Mn(u,h,e,n,r),p=t.nextZ;p&&p.z<=d;){if(p!==t.prev&&p!==t.next&&Tn(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&An(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(p=t.prevZ;p&&p.z>=l;){if(p!==t.prev&&p!==t.next&&Tn(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&An(p.prev,p,p.next)>=0)return!1;p=p.prevZ}return!0}function vn(t,e,n){var r=t;do{var i=r.prev,o=r.next.next;!Pn(i,o)&&Rn(i,r,r.next,o)&&Cn(i,o)&&Cn(o,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(o.i/n),Dn(r),Dn(r.next),r=t=o),r=r.next}while(r!==t);return r}function gn(t,e,n,r,i,o){var a=t;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&Ln(a,s)){var c=Nn(a,s);return a=dn(a,a.next),c=dn(c,c.next),pn(a,e,n,r,i,o),void pn(c,e,n,r,i,o)}s=s.next}a=a.next}while(a!==t)}function yn(t,e,n,r){var i=[],o,a,s,c,u;for(o=0,a=e.length;o<a;o++)(u=ln(t,s=e[o]*r,c=o<a-1?e[o+1]*r:t.length,r,!1))===u.next&&(u.steiner=!0),i.push(En(u));for(i.sort(xn),o=0;o<i.length;o++)bn(i[o],n),n=dn(n,n.next);return n}function xn(t,e){return t.x-e.x}function bn(t,e){if(e=wn(t,e)){var n=Nn(e,t);dn(n,n.next)}}function wn(t,e){var n=e,r=t.x,i=t.y,o=-1/0,a;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var s=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=r&&s>o){if(o=s,s===r){if(i===n.y)return n;if(i===n.next.y)return n.next}a=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!a)return null;if(r===o)return a.prev;var c=a,u=a.x,h=a.y,l=1/0,d;for(n=a.next;n!==c;)r>=n.x&&n.x>=u&&r!==n.x&&Tn(i<h?r:o,i,u,h,i<h?o:r,i,n.x,n.y)&&((d=Math.abs(i-n.y)/(r-n.x))<l||d===l&&n.x>a.x)&&Cn(n,t)&&(a=n,l=d),n=n.next;return a}function _n(t,e,n,r){var i=t;do{null===i.z&&(i.z=Mn(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,Sn(i)}function Sn(t){var e,n,r,i,o,a,s,c,u=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,r=n,s=0,e=0;e<u&&(s++,r=r.nextZ);e++);for(c=u;s>0||c>0&&r;)0!==s&&(0===c||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,c--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,u*=2}while(a>1);return t}function Mn(t,e,n,r,i){return t=32767*(t-n)*i,e=32767*(e-r)*i,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1}function En(t){var e=t,n=t;do{e.x<n.x&&(n=e),e=e.next}while(e!==t);return n}function Tn(t,e,n,r,i,o,a,s){return(i-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(r-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function Ln(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!In(t,e)&&Cn(t,e)&&Cn(e,t)&&On(t,e)}function An(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Pn(t,e){return t.x===e.x&&t.y===e.y}function Rn(t,e,n,r){return!!(Pn(t,e)&&Pn(n,r)||Pn(t,r)&&Pn(n,e))||An(t,e,n)>0!=An(t,e,r)>0&&An(n,r,t)>0!=An(n,r,e)>0}function In(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Rn(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function Cn(t,e){return An(t.prev,t,t.next)<0?An(t,e,t.next)>=0&&An(t,t.prev,e)>=0:An(t,e,t.prev)<0||An(t,t.next,e)<0}function On(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}function Nn(t,e){var n=new Un(t.i,t.x,t.y),r=new Un(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function Fn(t,e,n,r){var i=new Un(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function Dn(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Un(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Bn(t,e,n,r){for(var i=0,o=e,a=n-r;o<n;o+=r)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}function zn(t){var e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function Gn(t,e){for(var n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}function kn(t,e){gt.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},this.fromBufferGeometry(new jn(t,e)),this.mergeVertices()}function jn(t,e){void 0!==t&&(Rt.call(this),this.type="ExtrudeBufferGeometry",t=Array.isArray(t)?t:[t],this.addShapeList(t,e),this.computeVertexNormals())}function Vn(t,e){gt.call(this),this.type="TextGeometry",this.parameters={text:t,parameters:e},this.fromBufferGeometry(new Hn(t,e)),this.mergeVertices()}function Hn(t,e){var n=(e=e||{}).font;if(!n||!n.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new gt;var r=n.generateShapes(t,e.size,e.curveSegments);e.amount=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),jn.call(this,r,e),this.type="TextBufferGeometry"}function Wn(t,e,n,r,i,o,a){gt.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new Yn(t,e,n,r,i,o,a)),this.mergeVertices()}function Yn(t,e,n,r,i,o,a){Rt.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:a},t=t||1,e=Math.max(3,Math.floor(e)||8),n=Math.max(2,Math.floor(n)||6),r=void 0!==r?r:0,i=void 0!==i?i:2*Math.PI;var s=(o=void 0!==o?o:0)+(a=void 0!==a?a:Math.PI),c,u,h=0,d=[],p=new l,f=new l,m=[],v=[],g=[],y=[];for(u=0;u<=n;u++){var x=[],b=u/n;for(c=0;c<=e;c++){var w=c/e;p.x=-t*Math.cos(r+w*i)*Math.sin(o+b*a),p.y=t*Math.cos(o+b*a),p.z=t*Math.sin(r+w*i)*Math.sin(o+b*a),v.push(p.x,p.y,p.z),f.set(p.x,p.y,p.z).normalize(),g.push(f.x,f.y,f.z),y.push(w,1-b),x.push(h++)}d.push(x)}for(u=0;u<n;u++)for(c=0;c<e;c++){var _=d[u][c+1],S=d[u][c],M=d[u+1][c],E=d[u+1][c+1];(0!==u||o>0)&&m.push(_,S,E),(u!==n-1||s<Math.PI)&&m.push(S,M,E)}this.setIndex(m),this.addAttribute("position",new Tt(v,3)),this.addAttribute("normal",new Tt(g,3)),this.addAttribute("uv",new Tt(y,2))}function Xn(t,e,n,r,i,o){gt.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:o},this.fromBufferGeometry(new qn(t,e,n,r,i,o)),this.mergeVertices()}function qn(t,e,n,r,i,o){Rt.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:o},t=t||.5,e=e||1,i=void 0!==i?i:0,o=void 0!==o?o:2*Math.PI,n=void 0!==n?Math.max(3,n):8;var a=[],s=[],u=[],h=[],d,p=t,f=(e-t)/(r=void 0!==r?Math.max(1,r):1),m=new l,v=new c,g,y;for(g=0;g<=r;g++){for(y=0;y<=n;y++)d=i+y/n*o,m.x=p*Math.cos(d),m.y=p*Math.sin(d),s.push(m.x,m.y,m.z),u.push(0,0,1),v.x=(m.x/e+1)/2,v.y=(m.y/e+1)/2,h.push(v.x,v.y);p+=f}for(g=0;g<r;g++){var x=g*(n+1);for(y=0;y<n;y++){var b=d=y+x,w=d+n+1,_=d+n+2,S=d+1;a.push(b,w,S),a.push(w,_,S)}}this.setIndex(a),this.addAttribute("position",new Tt(s,3)),this.addAttribute("normal",new Tt(u,3)),this.addAttribute("uv",new Tt(h,2))}function Zn(t,e,n,r){gt.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},this.fromBufferGeometry(new Jn(t,e,n,r)),this.mergeVertices()}function Jn(t,e,n,r){Rt.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},e=Math.floor(e)||12,n=n||0,r=r||2*Math.PI,r=Ry.clamp(r,0,2*Math.PI);var i=[],o=[],a=[],s,u=1/e,h=new l,d=new c,p,f;for(p=0;p<=e;p++){var m=n+p*u*r,v=Math.sin(m),g=Math.cos(m);for(f=0;f<=t.length-1;f++)h.x=t[f].x*v,h.y=t[f].y,h.z=t[f].x*g,o.push(h.x,h.y,h.z),d.x=p/e,d.y=f/(t.length-1),a.push(d.x,d.y)}for(p=0;p<e;p++)for(f=0;f<t.length-1;f++){var y=s=f+p*t.length,x=s+t.length,b=s+t.length+1,w=s+1;i.push(y,x,w),i.push(x,b,w)}if(this.setIndex(i),this.addAttribute("position",new Tt(o,3)),this.addAttribute("uv",new Tt(a,2)),this.computeVertexNormals(),r===2*Math.PI){var _=this.attributes.normal.array,S=new l,M=new l,E=new l;for(s=e*t.length*3,p=0,f=0;p<t.length;p++,f+=3)S.x=_[f+0],S.y=_[f+1],S.z=_[f+2],M.x=_[s+f+0],M.y=_[s+f+1],M.z=_[s+f+2],E.addVectors(S,M).normalize(),_[f+0]=_[s+f+0]=E.x,_[f+1]=_[s+f+1]=E.y,_[f+2]=_[s+f+2]=E.z}}function Qn(t,e){gt.call(this),this.type="ShapeGeometry","object"===(void 0===e?"undefined":Kb(e))&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),e=e.curveSegments),this.parameters={shapes:t,curveSegments:e},this.fromBufferGeometry(new Kn(t,e)),this.mergeVertices()}function Kn(t,e){function n(t){var n,s,u,h=i.length/3,l=t.extractPoints(e),d=l.shape,p=l.holes;if(!1===Qb.isClockWise(d))for(d=d.reverse(),n=0,s=p.length;n<s;n++)u=p[n],!0===Qb.isClockWise(u)&&(p[n]=u.reverse());var f=Qb.triangulateShape(d,p);for(n=0,s=p.length;n<s;n++)u=p[n],d=d.concat(u);for(n=0,s=d.length;n<s;n++){var m=d[n];i.push(m.x,m.y,0),o.push(0,0,1),a.push(m.x,m.y)}for(n=0,s=f.length;n<s;n++){var v=f[n],g=v[0]+h,y=v[1]+h,x=v[2]+h;r.push(g,y,x),c+=3}}Rt.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:e},e=e||12;var r=[],i=[],o=[],a=[],s=0,c=0;if(!1===Array.isArray(t))n(t);else for(var u=0;u<t.length;u++)n(t[u]),this.addGroup(s,c,u),s+=c,c=0;this.setIndex(r),this.addAttribute("position",new Tt(i,3)),this.addAttribute("normal",new Tt(o,3)),this.addAttribute("uv",new Tt(a,2))}function $n(t,e){if(e.shapes=[],Array.isArray(t))for(var n=0,r=t.length;n<r;n++){var i=t[n];e.shapes.push(i.uuid)}else e.shapes.push(t.uuid);return e}function tr(t,e){Rt.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:e},e=void 0!==e?e:1;var n=[],r=Math.cos(Ry.DEG2RAD*e),i=[0,0],o={},a,s,c,u=["a","b","c"],h;t.isBufferGeometry?(h=new gt).fromBufferGeometry(t):h=t.clone(),h.mergeVertices(),h.computeFaceNormals();for(var l=h.vertices,d=h.faces,p=0,f=d.length;p<f;p++)for(var m=d[p],v=0;v<3;v++)a=m[u[v]],s=m[u[(v+1)%3]],i[0]=Math.min(a,s),i[1]=Math.max(a,s),void 0===o[c=i[0]+","+i[1]]?o[c]={index1:i[0],index2:i[1],face1:p,face2:void 0}:o[c].face2=p;for(c in o){var g=o[c];if(void 0===g.face2||d[g.face1].normal.dot(d[g.face2].normal)<=r){var y=l[g.index1];n.push(y.x,y.y,y.z),y=l[g.index2],n.push(y.x,y.y,y.z)}}this.addAttribute("position",new Tt(n,3))}function er(t,e,n,r,i,o,a,s){gt.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new nr(t,e,n,r,i,o,a,s)),this.mergeVertices()}function nr(t,e,n,r,i,o,a,s){function u(){var o,c,u=new l,h=new l,w=0,_=(e-t)/n;for(c=0;c<=i;c++){var S=[],M=c/i,E=M*(e-t)+t;for(o=0;o<=r;o++){var T=o/r,L=T*s+a,A=Math.sin(L),P=Math.cos(L);h.x=E*A,h.y=-M*n+x,h.z=E*P,f.push(h.x,h.y,h.z),u.set(A,_,P).normalize(),m.push(u.x,u.y,u.z),v.push(T,1-M),S.push(g++)}y.push(S)}for(o=0;o<r;o++)for(c=0;c<i;c++){var R=y[c][o],I=y[c+1][o],C=y[c+1][o+1],O=y[c][o+1];p.push(R,I,O),p.push(I,C,O),w+=6}d.addGroup(b,w,0),b+=w}function h(n){var i,o,u,h=new c,y=new l,w=0,_=!0===n?t:e,S=!0===n?1:-1;for(o=g,i=1;i<=r;i++)f.push(0,x*S,0),m.push(0,S,0),v.push(.5,.5),g++;for(u=g,i=0;i<=r;i++){var M,E=i/r*s+a,T=Math.cos(E),L=Math.sin(E);y.x=_*L,y.y=x*S,y.z=_*T,f.push(y.x,y.y,y.z),m.push(0,S,0),h.x=.5*T+.5,h.y=.5*L*S+.5,v.push(h.x,h.y),g++}for(i=0;i<r;i++){var A=o+i,P=u+i;!0===n?p.push(P,P+1,A):p.push(P+1,P,A),w+=3}d.addGroup(b,w,!0===n?1:2),b+=w}Rt.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s};var d=this;t=void 0!==t?t:1,e=void 0!==e?e:1,n=n||1,r=Math.floor(r)||8,i=Math.floor(i)||1,o=void 0!==o&&o,a=void 0!==a?a:0,s=void 0!==s?s:2*Math.PI;var p=[],f=[],m=[],v=[],g=0,y=[],x=n/2,b=0;u(),!1===o&&(t>0&&h(!0),e>0&&h(!1)),this.setIndex(p),this.addAttribute("position",new Tt(f,3)),this.addAttribute("normal",new Tt(m,3)),this.addAttribute("uv",new Tt(v,2))}function rr(t,e,n,r,i,o,a){er.call(this,0,t,e,n,r,i,o,a),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:a}}function ir(t,e,n,r,i,o,a){nr.call(this,0,t,e,n,r,i,o,a),this.type="ConeBufferGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:a}}function or(t,e,n,r){gt.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},this.fromBufferGeometry(new ar(t,e,n,r)),this.mergeVertices()}function ar(t,e,n,r){Rt.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},t=t||1,e=void 0!==e?Math.max(3,e):8,n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI;var i=[],o=[],a=[],s=[],u,h,d=new l,p=new c;for(o.push(0,0,0),a.push(0,0,1),s.push(.5,.5),h=0,u=3;h<=e;h++,u+=3){var f=n+h/e*r;d.x=t*Math.cos(f),d.y=t*Math.sin(f),o.push(d.x,d.y,d.z),a.push(0,0,1),p.x=(o[u]/t+1)/2,p.y=(o[u+1]/t+1)/2,s.push(p.x,p.y)}for(u=1;u<=e;u++)i.push(u,u+1,0);this.setIndex(i),this.addAttribute("position",new Tt(o,3)),this.addAttribute("normal",new Tt(a,3)),this.addAttribute("uv",new Tt(s,2))}function sr(t){nt.call(this),this.type="ShadowMaterial",this.color=new $(0),this.opacity=1,this.lights=!0,this.transparent=!0,this.setValues(t)}function cr(t){Dt.call(this,t),this.type="RawShaderMaterial"}function ur(t){nt.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new $(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new $(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new c(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function hr(t){ur.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(t)}function lr(t){nt.call(this),this.type="MeshPhongMaterial",this.color=new $(16777215),this.specular=new $(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new $(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new c(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Jv,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function dr(t){lr.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(t)}function pr(t){nt.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new c(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function fr(t){nt.call(this),this.type="MeshLambertMaterial",this.color=new $(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new $(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Jv,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function mr(t){Fe.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}function vr(t,e,n){var r=this,i=!1,o=0,a=0,s=void 0;this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){a++,!1===i&&void 0!==r.onStart&&r.onStart(t,o,a),i=!0},this.itemEnd=function(t){o++,void 0!==r.onProgress&&r.onProgress(t,o,a),o===a&&(i=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(t){void 0!==r.onError&&r.onError(t)},this.resolveURL=function(t){return s?s(t):t},this.setURLModifier=function(t){return s=t,this}}function gr(t){this.manager=void 0!==t?t:iw}function yr(t){this.manager=void 0!==t?t:iw,this._parser=null}function xr(t){this.manager=void 0!==t?t:iw,this._parser=null}function br(t){this.manager=void 0!==t?t:iw}function wr(t){this.manager=void 0!==t?t:iw}function _r(t){this.manager=void 0!==t?t:iw}function Sr(){this.type="Curve",this.arcLengthDivisions=200}function Mr(t,e,n,r,i,o,a,s){Sr.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=e||0,this.xRadius=n||1,this.yRadius=r||1,this.aStartAngle=i||0,this.aEndAngle=o||2*Math.PI,this.aClockwise=a||!1,this.aRotation=s||0}function Er(t,e,n,r,i,o){Mr.call(this,t,e,n,n,r,i,o),this.type="ArcCurve"}function Tr(){function t(t,o,a,s){e=t,n=a,r=-3*t+3*o-2*a-s,i=2*t-2*o+a+s}var e=0,n=0,r=0,i=0;return{initCatmullRom:function e(n,r,i,o,a){t(r,i,a*(i-n),a*(o-r))},initNonuniformCatmullRom:function e(n,r,i,o,a,s,c){var u=(r-n)/a-(i-n)/(a+s)+(i-r)/s,h=(i-r)/s-(o-r)/(s+c)+(o-i)/c;t(r,i,u*=s,h*=s)},calc:function t(o){var a=o*o,s;return e+n*o+r*a+i*(a*o)}}}function Lr(t,e,n,r){Sr.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=e||!1,this.curveType=n||"centripetal",this.tension=r||.5}function Ar(t,e,n,r,i){var o=.5*(r-e),a=.5*(i-n),s=t*t,c;return(2*n-2*r+o+a)*(t*s)+(-3*n+3*r-2*o-a)*s+o*t+n}function Pr(t,e){var n=1-t;return n*n*e}function Rr(t,e){return 2*(1-t)*t*e}function Ir(t,e){return t*t*e}function Cr(t,e,n,r){return Pr(t,e)+Rr(t,n)+Ir(t,r)}function Or(t,e){var n=1-t;return n*n*n*e}function Nr(t,e){var n=1-t;return 3*n*n*t*e}function Fr(t,e){return 3*(1-t)*t*t*e}function Dr(t,e){return t*t*t*e}function Ur(t,e,n,r,i){return Or(t,e)+Nr(t,n)+Fr(t,r)+Dr(t,i)}function Br(t,e,n,r){Sr.call(this),this.type="CubicBezierCurve",this.v0=t||new c,this.v1=e||new c,this.v2=n||new c,this.v3=r||new c}function zr(t,e,n,r){Sr.call(this),this.type="CubicBezierCurve3",this.v0=t||new l,this.v1=e||new l,this.v2=n||new l,this.v3=r||new l}function Gr(t,e){Sr.call(this),this.type="LineCurve",this.v1=t||new c,this.v2=e||new c}function kr(t,e){Sr.call(this),this.type="LineCurve3",this.v1=t||new l,this.v2=e||new l}function jr(t,e,n){Sr.call(this),this.type="QuadraticBezierCurve",this.v0=t||new c,this.v1=e||new c,this.v2=n||new c}function Vr(t,e,n){Sr.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new l,this.v1=e||new l,this.v2=n||new l}function Hr(t){Sr.call(this),this.type="SplineCurve",this.points=t||[]}function Wr(){Sr.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function Yr(t){Wr.call(this),this.type="Path",this.currentPoint=new c,t&&this.setFromPoints(t)}function Xr(t){Yr.call(this,t),this.uuid=Ry.generateUUID(),this.type="Shape",this.holes=[]}function qr(t,e){pt.call(this),this.type="Light",this.color=new $(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}function Zr(t,e,n){qr.call(this,t,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(pt.DefaultUp),this.updateMatrix(),this.groundColor=new $(e)}function Jr(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new c(512,512),this.map=null,this.matrix=new u}function Qr(){Jr.call(this,new xe(50,1,.5,500))}function Kr(t,e,n,r,i,o){qr.call(this,t,e),this.type="SpotLight",this.position.copy(pt.DefaultUp),this.updateMatrix(),this.target=new pt,Object.defineProperty(this,"power",{get:function t(){return this.intensity*Math.PI},set:function t(e){this.intensity=e/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==r?r:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==o?o:1,this.shadow=new Qr}function $r(t,e,n,r){qr.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function t(){return 4*this.intensity*Math.PI},set:function t(e){this.intensity=e/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==r?r:1,this.shadow=new Jr(new xe(90,1,.5,500))}function ti(){Jr.call(this,new mt(-5,5,5,-5,.5,500))}function ei(t,e){qr.call(this,t,e),this.type="DirectionalLight",this.position.copy(pt.DefaultUp),this.updateMatrix(),this.target=new pt,this.shadow=new ti}function ni(t,e){qr.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0}function ri(t,e,n,r){qr.call(this,t,e),this.type="RectAreaLight",this.width=void 0!==n?n:10,this.height=void 0!==r?r:10}function ii(t,e,n,r){fi.call(this,t,e,n,r)}function oi(t,e,n){fi.call(this,t,e,n)}function ai(t,e,n,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new e.constructor(n),this.sampleValues=e,this.valueSize=n}function si(t,e,n,r){ai.call(this,t,e,n,r)}function ci(t,e,n,r){fi.call(this,t,e,n,r)}function ui(t,e,n,r){fi.call(this,t,e,n,r)}function hi(t,e,n,r){fi.call(this,t,e,n,r)}function li(t,e,n,r){ai.call(this,t,e,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function di(t,e,n,r){ai.call(this,t,e,n,r)}function pi(t,e,n,r){ai.call(this,t,e,n,r)}function fi(t,e,n,r){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=lw.convertArray(e,this.TimeBufferType),this.values=lw.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation),this.validate(),this.optimize()}function mi(t,e,n,r){fi.call(this,t,e,n,r)}function vi(t,e,n){this.name=t,this.tracks=n,this.duration=void 0!==e?e:-1,this.uuid=Ry.generateUUID(),this.duration<0&&this.resetDuration(),this.optimize()}function gi(t){this.manager=void 0!==t?t:iw,this.textures={}}function yi(t){this.manager=void 0!==t?t:iw}function xi(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}}function bi(t){"boolean"==typeof t&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),t=void 0),this.manager=void 0!==t?t:iw,this.withCredentials=!1}function wi(t){this.manager=void 0!==t?t:iw,this.texturePath=""}function _i(){this.type="ShapePath",this.subPaths=[],this.currentPath=null}function Si(t){this.type="Font",this.data=t}function Mi(t,e,n,r){for(var i=String(t).split(""),o=e/r.resolution,a=(r.boundingBox.yMax-r.boundingBox.yMin+r.underlineThickness)*o,s=[],c=0,u=0,h=0;h<i.length;h++){var l=i[h];if("\n"===l)c=0,u-=a;else{var d=Ei(l,n,o,c,u,r);c+=d.offsetX,s.push(d.path)}}return s}function Ei(t,e,n,r,i,o){var a=o.glyphs[t]||o.glyphs["?"];if(a){var s=new _i,c,u,h,l,d,p,f,m;if(a.o)for(var v=a._cachedOutline||(a._cachedOutline=a.o.split(" ")),g=0,y=v.length;g<y;){var x;switch(v[g++]){case"m":c=v[g++]*n+r,u=v[g++]*n+i,s.moveTo(c,u);break;case"l":c=v[g++]*n+r,u=v[g++]*n+i,s.lineTo(c,u);break;case"q":h=v[g++]*n+r,l=v[g++]*n+i,d=v[g++]*n+r,p=v[g++]*n+i,s.quadraticCurveTo(d,p,h,l);break;case"b":h=v[g++]*n+r,l=v[g++]*n+i,d=v[g++]*n+r,p=v[g++]*n+i,f=v[g++]*n+r,m=v[g++]*n+i,s.bezierCurveTo(d,p,f,m,h,l)}}return{offsetX:a.ha*n,path:s}}}function Ti(t){this.manager=void 0!==t?t:iw}function Li(t){this.manager=void 0!==t?t:iw}function Ai(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new xe,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new xe,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function Pi(t,e,n){pt.call(this),this.type="CubeCamera";var r=90,i=1,o=new xe(90,1,t,e);o.up.set(0,-1,0),o.lookAt(new l(1,0,0)),this.add(o);var a=new xe(90,1,t,e);a.up.set(0,-1,0),a.lookAt(new l(-1,0,0)),this.add(a);var s=new xe(90,1,t,e);s.up.set(0,0,1),s.lookAt(new l(0,1,0)),this.add(s);var c=new xe(90,1,t,e);c.up.set(0,0,-1),c.lookAt(new l(0,-1,0)),this.add(c);var u=new xe(90,1,t,e);u.up.set(0,-1,0),u.lookAt(new l(0,0,1)),this.add(u);var h=new xe(90,1,t,e);h.up.set(0,-1,0),h.lookAt(new l(0,0,-1)),this.add(h);var d={format:Ng,magFilter:yg,minFilter:yg};this.renderTarget=new v(n,n,d),this.renderTarget.texture.name="CubeCamera",this.update=function(t,e){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget,r=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,n.activeCubeFace=0,t.render(e,o,n),n.activeCubeFace=1,t.render(e,a,n),n.activeCubeFace=2,t.render(e,s,n),n.activeCubeFace=3,t.render(e,c,n),n.activeCubeFace=4,t.render(e,u,n),n.texture.generateMipmaps=r,n.activeCubeFace=5,t.render(e,h,n),t.setRenderTarget(null)},this.clear=function(t,e,n,r){for(var i=this.renderTarget,o=0;o<6;o++)i.activeCubeFace=o,t.setRenderTarget(i),t.clear(e,n,r);t.setRenderTarget(null)}}function Ri(){pt.call(this),this.type="AudioListener",this.context=yw.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function Ii(t){pt.call(this),this.type="Audio",this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.startTime=0,this.offset=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function Ci(t){Ii.call(this,t),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function Oi(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function Ni(t,e,n){this.binding=t,this.valueSize=n;var r=Float64Array,i;switch(e){case"quaternion":i=this._slerp;break;case"string":case"bool":r=Array,i=this._select;break;default:i=this._lerp}this.buffer=new r(4*n),this._mixBufferRegion=i,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}function Fi(t,e,n){var r=n||Di.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,r)}function Di(t,e,n){this.path=e,this.parsedPath=n||Di.parseTrackName(e),this.node=Di.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function Ui(){this.uuid=Ry.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var e=0,n=arguments.length;e!==n;++e)t[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}}function Bi(t,e,n){this._mixer=t,this._clip=e,this._localRoot=n||null;for(var r=e.tracks,i=r.length,o=new Array(i),a={endingStart:my,endingEnd:my},s=0;s!==i;++s){var c=r[s].createInterpolant(null);o[s]=c,c.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(i),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=hy,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function zi(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function Gi(t){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}function ki(){Rt.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function ji(t,e,n,r){this.uuid=Ry.generateUUID(),this.data=t,this.itemSize=e,this.offset=n,this.normalized=!0===r}function Vi(t,e){this.uuid=Ry.generateUUID(),this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function Hi(t,e,n){Vi.call(this,t,e),this.meshPerAttribute=n||1}function Wi(t,e,n){yt.call(this,t,e),this.meshPerAttribute=n||1}function Yi(t,e,n,r){this.ray=new Ut(t,e),this.near=n||0,this.far=r||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function t(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Xi(t,e){return t.distance-e.distance}function qi(t,e,n,r){if(!1!==t.visible&&(t.raycast(e,n),!0===r))for(var i=t.children,o=0,a=i.length;o<a;o++)qi(i[o],e,n,!0)}function Zi(t){this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function Ji(t,e,n){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==n?n:0,this}function Qi(t,e,n){return this.radius=void 0!==t?t:1,this.theta=void 0!==e?e:0,this.y=void 0!==n?n:0,this}function Ki(t,e){this.min=void 0!==t?t:new c(1/0,1/0),this.max=void 0!==e?e:new c(-1/0,-1/0)}function $i(t){pt.call(this),this.material=t,this.render=function(){}}function to(t,e,n,r){this.object=t,this.size=void 0!==e?e:1;var i=void 0!==n?n:16711680,o=void 0!==r?r:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=3*s.faces.length:s&&s.isBufferGeometry&&(a=s.attributes.normal.count);var c=new Rt,u=new Tt(2*a*3,3);c.addAttribute("position",u),Ue.call(this,c,new Fe({color:i,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function eo(t,e){pt.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;for(var n=new Rt,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],i=0,o=1,a=32;i<32;i++,o++){var s=i/32*Math.PI*2,c=o/32*Math.PI*2;r.push(Math.cos(s),Math.sin(s),1,Math.cos(c),Math.sin(c),1)}n.addAttribute("position",new Tt(r,3));var u=new Fe({fog:!1});this.cone=new Ue(n,u),this.add(this.cone),this.update()}function no(t){var e=[];t&&t.isBone&&e.push(t);for(var n=0;n<t.children.length;n++)e.push.apply(e,no(t.children[n]));return e}function ro(t){for(var e=no(t),n=new Rt,r=[],i=[],o=new $(0,0,1),a=new $(0,1,0),s=0;s<e.length;s++){var c=e[s];c.parent&&c.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(o.r,o.g,o.b),i.push(a.r,a.g,a.b))}n.addAttribute("position",new Tt(r,3)),n.addAttribute("color",new Tt(i,3));var u=new Fe({vertexColors:xv,depthTest:!1,depthWrite:!1,transparent:!0});Ue.call(this,n,u),this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}function io(t,e,n){this.light=t,this.light.updateMatrixWorld(),this.color=n;var r=new Yn(e,4,2),i=new Ft({wireframe:!0,fog:!1});Gt.call(this,r,i),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function oo(t,e){pt.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;var n=new Fe({fog:!1}),r=new Rt;r.addAttribute("position",new yt(new Float32Array(15),3)),this.line=new De(r,n),this.add(this.line),this.update()}function ao(t,e,n){pt.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;var r=new $e(e);r.rotateY(.5*Math.PI),this.material=new Ft({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=xv);var i=r.getAttribute("position"),o=new Float32Array(3*i.count);r.addAttribute("color",new yt(o,3)),this.add(new Gt(r,this.material)),this.update()}function so(t,e,n,r){t=t||10,e=e||10,n=new $(void 0!==n?n:4473924),r=new $(void 0!==r?r:8947848);for(var i=e/2,o=t/e,a=t/2,s=[],c=[],u=0,h=0,l=-a;u<=e;u++,l+=o){s.push(-a,0,l,a,0,l),s.push(l,0,-a,l,0,a);var d=u===i?n:r;d.toArray(c,h),h+=3,d.toArray(c,h),h+=3,d.toArray(c,h),h+=3,d.toArray(c,h),h+=3}var p=new Rt;p.addAttribute("position",new Tt(s,3)),p.addAttribute("color",new Tt(c,3));var f=new Fe({vertexColors:xv});Ue.call(this,p,f)}function co(t,e,n,r,i,o){t=t||10,e=e||16,n=n||8,r=r||64,i=new $(void 0!==i?i:4473924),o=new $(void 0!==o?o:8947848);var a=[],s=[],c,u,h,l,d,p,f;for(l=0;l<=e;l++)h=l/e*(2*Math.PI),c=Math.sin(h)*t,u=Math.cos(h)*t,a.push(0,0,0),a.push(c,0,u),f=1&l?i:o,s.push(f.r,f.g,f.b),s.push(f.r,f.g,f.b);for(l=0;l<=n;l++)for(f=1&l?i:o,p=t-t/n*l,d=0;d<r;d++)h=d/r*(2*Math.PI),c=Math.sin(h)*p,u=Math.cos(h)*p,a.push(c,0,u),s.push(f.r,f.g,f.b),h=(d+1)/r*(2*Math.PI),c=Math.sin(h)*p,u=Math.cos(h)*p,a.push(c,0,u),s.push(f.r,f.g,f.b);var m=new Rt;m.addAttribute("position",new Tt(a,3)),m.addAttribute("color",new Tt(s,3));var v=new Fe({vertexColors:xv});Ue.call(this,m,v)}function uo(t,e,n,r){this.object=t,this.size=void 0!==e?e:1;var i=void 0!==n?n:16776960,o=void 0!==r?r:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=s.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var c=new Rt,u=new Tt(2*a*3,3);c.addAttribute("position",u),Ue.call(this,c,new Fe({color:i,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function ho(t,e,n){pt.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===e&&(e=1);var r=new Rt;r.addAttribute("position",new Tt([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));var i=new Fe({fog:!1});this.lightPlane=new De(r,i),this.add(this.lightPlane),(r=new Rt).addAttribute("position",new Tt([0,0,0,0,0,1],3)),this.targetLine=new De(r,i),this.add(this.targetLine),this.update()}function lo(t){function e(t,e,r){n(t,r),n(e,r)}function n(t,e){o.push(0,0,0),a.push(e.r,e.g,e.b),void 0===s[t]&&(s[t]=[]),s[t].push(o.length/3-1)}var r=new Rt,i=new Fe({color:16777215,vertexColors:yv}),o=[],a=[],s={},c=new $(16755200),u=new $(16711680),h=new $(43775),l=new $(16777215),d=new $(3355443);e("n1","n2",c),e("n2","n4",c),e("n4","n3",c),e("n3","n1",c),e("f1","f2",c),e("f2","f4",c),e("f4","f3",c),e("f3","f1",c),e("n1","f1",c),e("n2","f2",c),e("n3","f3",c),e("n4","f4",c),e("p","n1",u),e("p","n2",u),e("p","n3",u),e("p","n4",u),e("u1","u2",h),e("u2","u3",h),e("u3","u1",h),e("c","t",l),e("p","c",d),e("cn1","cn2",d),e("cn3","cn4",d),e("cf1","cf2",d),e("cf3","cf4",d),r.addAttribute("position",new Tt(o,3)),r.addAttribute("color",new Tt(a,3)),Ue.call(this,r,i),this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}function po(t,e){this.object=t,void 0===e&&(e=16776960);var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),i=new Rt;i.setIndex(new yt(n,1)),i.addAttribute("position",new yt(r,3)),Ue.call(this,i,new Fe({color:e})),this.matrixAutoUpdate=!1,this.update()}function fo(t,e){this.type="Box3Helper",this.box=t;var n=void 0!==e?e:16776960,r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],o=new Rt;o.setIndex(new yt(r,1)),o.addAttribute("position",new Tt(i,3)),Ue.call(this,o,new Fe({color:n})),this.geometry.computeBoundingSphere()}function mo(t,e,n){this.type="PlaneHelper",this.plane=t,this.size=void 0===e?1:e;var r=void 0!==n?n:16776960,i=[1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],o=new Rt;o.addAttribute("position",new Tt(i,3)),o.computeBoundingSphere(),De.call(this,o,new Fe({color:r}));var a=[1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],s=new Rt;s.addAttribute("position",new Tt(a,3)),s.computeBoundingSphere(),this.add(new Gt(s,new Ft({color:r,opacity:.2,transparent:!0,depthWrite:!1})))}function vo(t,e,n,r,i,o){pt.call(this),void 0===r&&(r=16776960),void 0===n&&(n=1),void 0===i&&(i=.2*n),void 0===o&&(o=.2*i),void 0===bw&&((bw=new Rt).addAttribute("position",new Tt([0,0,0,0,1,0],3)),(ww=new nr(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(e),this.line=new De(bw,new Fe({color:r})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Gt(ww,new Ft({color:r})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(n,i,o)}function go(t){var e=[0,0,0,t=t||1,0,0,0,0,0,0,t,0,0,0,0,0,0,t],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new Rt;r.addAttribute("position",new Tt(e,3)),r.addAttribute("color",new Tt(n,3));var i=new Fe({vertexColors:xv});Ue.call(this,r,i)}function yo(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Lr.call(this,t),this.type="catmullrom"}function xo(){var t=void 0,e=0,n=0;this.running=!1,this.paused=!1;var r=1,i=0,o=0;Object.defineProperties(this,{now:{get:function t(){return(performance||Date).now()}},timeScale:{get:function t(){return r},set:function t(e){i=this.totalTime,o=this.now,r=e}},unscaledTotalTime:{get:function t(){return this.running?this.now-n:0}},totalTime:{get:function t(){var e=(this.now-o)*this.timeScale;return this.running?i+e:0}},unscaledDelta:{get:function t(){var n=this.now-e;return e=this.now,n}},delta:{get:function t(){return this.unscaledDelta*this.timeScale}}}),this.start=function(){if(this.paused){var r=this.now-t;n+=r,e+=r,o+=r}else this.running||(n=e=o=this.now,i=0);this.running=!0,this.paused=!1},this.stop=function(){n=0,i=0,this.running=!1},this.pause=function(){t=this.now,this.paused=!0}}function bo(t){var e=this;void 0!==t&&(_w=t),this.autoRender=!0,this.autoResize=!0,this.frameCount=0,this.delta=0,this.isPlaying=!1,this.isPaused=!1,this.time=new xo;var n=function t(){Ew.setSize(_w.clientWidth,_w.clientHeight,!1)},r=function t(){Mw.aspect=_w.clientWidth/_w.clientHeight,Mw.updateProjectionMatrix()};this.onWindowResize=function(){};var i=function t(){e.autoResize?Mw&&("PerspectiveCamera"===Mw.type?(r(),n(),e.onWindowResize()):console.warn("App: AutoResize only works with PerspectiveCamera")):e.onWindowResize()};window.addEventListener("resize",i,!1),Object.defineProperties(this,{canvas:{get:function t(){return void 0===_w&&((_w=document.body.appendChild(document.createElement("canvas"))).style.position="absolute",_w.style.width=_w.style.height="100%"),_w},set:function t(e){_w=e}},camera:{get:function t(){return void 0===Mw&&(Mw=new xe(50,this.canvas.clientWidth/this.canvas.clientHeight,.1,1e3)),Mw},set:function t(e){Mw=e,r()}},scene:{get:function t(){return void 0===Sw&&(Sw=new Ae),Sw},set:function t(e){Sw=e}},renderer:{get:function t(){return void 0===Ew&&((Ew=new Ee({canvas:this.canvas,antialias:!0})).setPixelRatio(window.devicePixelRatio),Ew.setSize(this.canvas.clientWidth,this.canvas.clientHeight,!1)),Ew},set:function t(e){Ew=e,n()}},averageFrameTime:{get:function t(){return 0!==this.frameCount?this.time.unscaledTotalTime/this.frameCount:0}}}),this.play=function(){function t(){e.frameCount++,e.delta=e.time.delta,e.onUpdate(),e.controls&&e.controls.enableDamping&&e.controls.update(),e.autoRender&&e.renderer.render(e.scene,e.camera),Tw=requestAnimationFrame(function(){t()})}this.time.start(),this.isPlaying=!0,this.isPaused=!1,t()},this.pause=function(){this.isPaused=!0,this.time.pause(),cancelAnimationFrame(Tw)},this.stop=function(){this.isPlaying=!1,this.isPaused=!1,this.time.stop(),this.frameCount=0,cancelAnimationFrame(Tw)},this.onUpdate=function(){}}function wo(t,e){function n(){return 2*Math.PI/60/60*N.autoRotateSpeed}function r(){return Math.pow(.95,N.zoomSpeed)}function i(t){j.theta-=t}function o(t){j.phi-=t}function a(t){N.object instanceof xe?V/=t:N.object instanceof mt?(N.object.zoom=Math.max(N.minZoom,Math.min(N.maxZoom,N.object.zoom*t)),N.object.updateProjectionMatrix(),W=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),N.enableZoom=!1)}function s(t){N.object instanceof xe?V*=t:N.object instanceof mt?(N.object.zoom=Math.max(N.minZoom,Math.min(N.maxZoom,N.object.zoom/t)),N.object.updateProjectionMatrix(),W=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),N.enableZoom=!1)}function u(t){Y.set(t.clientX,t.clientY)}function d(t){K.set(t.clientX,t.clientY)}function p(t){Z.set(t.clientX,t.clientY)}function f(t){X.set(t.clientX,t.clientY),q.subVectors(X,Y);var e=N.domElement===document?N.domElement.body:N.domElement;i(2*Math.PI*q.x/e.clientWidth*N.rotateSpeed),o(2*Math.PI*q.y/e.clientHeight*N.rotateSpeed),Y.copy(X),N.update()}function m(t){$.set(t.clientX,t.clientY),tt.subVectors($,K),tt.y>0?a(r()):tt.y<0&&s(r()),K.copy($),N.update()}function v(t){J.set(t.clientX,t.clientY),Q.subVectors(J,Z),rt(Q.x,Q.y),Z.copy(J),N.update()}function g(t){t.deltaY<0?s(r()):t.deltaY>0&&a(r()),N.update()}function y(t){switch(t.keyCode){case N.keys.UP:rt(0,N.keyPanSpeed),N.update();break;case N.keys.BOTTOM:rt(0,-N.keyPanSpeed),N.update();break;case N.keys.LEFT:rt(N.keyPanSpeed,0),N.update();break;case N.keys.RIGHT:rt(-N.keyPanSpeed,0),N.update()}}function x(t){Y.set(t.touches[0].pageX,t.touches[0].pageY)}function b(t){var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,r=Math.sqrt(e*e+n*n);K.set(0,r)}function w(t){Z.set(t.touches[0].pageX,t.touches[0].pageY)}function _(t){X.set(t.touches[0].pageX,t.touches[0].pageY),q.subVectors(X,Y);var e=N.domElement===document?N.domElement.body:N.domElement;i(2*Math.PI*q.x/e.clientWidth*N.rotateSpeed),o(2*Math.PI*q.y/e.clientHeight*N.rotateSpeed),Y.copy(X),N.update()}function S(t){var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,i=Math.sqrt(e*e+n*n);$.set(0,i),tt.subVectors($,K),tt.y>0?s(r()):tt.y<0&&a(r()),K.copy($),N.update()}function M(t){J.set(t.touches[0].pageX,t.touches[0].pageY),Q.subVectors(J,Z),rt(Q.x,Q.y),Z.copy(J),N.update()}function E(t){if(!1!==N.enabled){if(t.preventDefault(),t.button===N.mouseButtons.ORBIT){if(!1===N.enableRotate)return;u(t),z=B.ROTATE}else if(t.button===N.mouseButtons.ZOOM){if(!1===N.enableZoom)return;d(t),z=B.DOLLY}else if(t.button===N.mouseButtons.PAN){if(!1===N.enablePan)return;p(t),z=B.PAN}z!==B.NONE&&(document.addEventListener("mousemove",T,!1),document.addEventListener("mouseup",L,!1),N.dispatchEvent(D))}}function T(t){if(!1!==N.enabled)if(t.preventDefault(),z===B.ROTATE){if(!1===N.enableRotate)return;f(t)}else if(z===B.DOLLY){if(!1===N.enableZoom)return;m(t)}else if(z===B.PAN){if(!1===N.enablePan)return;v(t)}}function L(t){!1!==N.enabled&&(document.removeEventListener("mousemove",T,!1),document.removeEventListener("mouseup",L,!1),N.dispatchEvent(U),z=B.NONE)}function A(t){!1===N.enabled||!1===N.enableZoom||z!==B.NONE&&z!==B.ROTATE||(t.preventDefault(),t.stopPropagation(),g(t),N.dispatchEvent(D),N.dispatchEvent(U))}function P(t){!1!==N.enabled&&!1!==N.enableKeys&&!1!==N.enablePan&&y(t)}function R(t){if(!1!==N.enabled){switch(t.touches.length){case 1:if(!1===N.enableRotate)return;x(t),z=B.TOUCH_ROTATE;break;case 2:if(!1===N.enableZoom)return;b(t),z=B.TOUCH_DOLLY;break;case 3:if(!1===N.enablePan)return;w(t),z=B.TOUCH_PAN;break;default:z=B.NONE}z!==B.NONE&&N.dispatchEvent(D)}}function I(t){if(!1!==N.enabled)switch(t.preventDefault(),t.stopPropagation(),t.touches.length){case 1:if(!1===N.enableRotate)return;if(z!==B.TOUCH_ROTATE)return;_(t);break;case 2:if(!1===N.enableZoom)return;if(z!==B.TOUCH_DOLLY)return;S(t);break;case 3:if(!1===N.enablePan)return;if(z!==B.TOUCH_PAN)return;M(t);break;default:z=B.NONE}}function C(t){!1!==N.enabled&&(N.dispatchEvent(U),z=B.NONE)}function O(t){t.preventDefault()}this.object=t,this.domElement=void 0!==e?e:document,this.enabled=!0,this.target=new l,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:av.LEFT,ZOOM:av.MIDDLE,PAN:av.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return k.phi},this.getAzimuthalAngle=function(){return k.theta},this.saveState=function(){N.target0.copy(N.target),N.position0.copy(N.object.position),N.zoom0=N.object.zoom},this.reset=function(){N.target.copy(N.target0),N.object.position.copy(N.position0),N.object.zoom=N.zoom0,N.object.updateProjectionMatrix(),N.dispatchEvent(F),N.update(),z=B.NONE},this.update=function(){var e=new l,r=(new h).setFromUnitVectors(t.up,new l(0,1,0)),o=r.clone().inverse(),a=new l,s=new h;return function t(){var c=N.object.position;return e.copy(c).sub(N.target),e.applyQuaternion(r),k.setFromVector3(e),N.autoRotate&&z===B.NONE&&i(n()),k.theta+=j.theta,k.phi+=j.phi,k.theta=Math.max(N.minAzimuthAngle,Math.min(N.maxAzimuthAngle,k.theta)),k.phi=Math.max(N.minPolarAngle,Math.min(N.maxPolarAngle,k.phi)),k.makeSafe(),k.radius*=V,k.radius=Math.max(N.minDistance,Math.min(N.maxDistance,k.radius)),N.target.add(H),e.setFromSpherical(k),e.applyQuaternion(o),c.copy(N.target).add(e),N.object.lookAt(N.target),!0===N.enableDamping?(j.theta*=1-N.dampingFactor,j.phi*=1-N.dampingFactor):j.set(0,0,0),V=1,H.set(0,0,0),!!(W||a.distanceToSquared(N.object.position)>G||8*(1-s.dot(N.object.quaternion))>G)&&(N.dispatchEvent(F),a.copy(N.object.position),s.copy(N.object.quaternion),W=!1,!0)}}(),this.dispose=function(){N.domElement.removeEventListener("contextmenu",O,!1),N.domElement.removeEventListener("mousedown",E,!1),N.domElement.removeEventListener("wheel",A,!1),N.domElement.removeEventListener("touchstart",R,!1),N.domElement.removeEventListener("touchend",C,!1),N.domElement.removeEventListener("touchmove",I,!1),document.removeEventListener("mousemove",T,!1),document.removeEventListener("mouseup",L,!1),window.removeEventListener("keydown",P,!1)};var N=this,F={type:"change"},D={type:"start"},U={type:"end"},B={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},z=B.NONE,G=1e-6,k=new Ji,j=new Ji,V=1,H=new l,W=!1,Y=new c,X=new c,q=new c,Z=new c,J=new c,Q=new c,K=new c,$=new c,tt=new c;this.rotateUp=o;var et=function(){var t=new l;return function e(n,r){t.setFromMatrixColumn(r,0),t.multiplyScalar(-n),H.add(t)}}(),nt=function(){var t=new l;return function e(n,r){t.setFromMatrixColumn(r,1),t.multiplyScalar(n),H.add(t)}}(),rt=function(){var t=new l;return function e(n,r){var i=N.domElement===document?N.domElement.body:N.domElement;if(N.object instanceof xe){var o=N.object.position;t.copy(o).sub(N.target);var a=t.length();a*=Math.tan(N.object.fov/2*Math.PI/180),et(2*n*a/i.clientHeight,N.object.matrix),nt(2*r*a/i.clientHeight,N.object.matrix)}else N.object instanceof mt?(et(n*(N.object.right-N.object.left)/N.object.zoom/i.clientWidth,N.object.matrix),nt(r*(N.object.top-N.object.bottom)/N.object.zoom/i.clientHeight,N.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),N.enablePan=!1)}}();N.pan=rt,N.dollyIn=a,N.dollyOut=s,N.domElement.addEventListener("contextmenu",O,!1),N.domElement.addEventListener("mousedown",E,!1),N.domElement.addEventListener("wheel",A,!1),N.domElement.addEventListener("touchstart",R,!1),N.domElement.addEventListener("touchend",C,!1),N.domElement.addEventListener("touchmove",I,!1),window.addEventListener("keydown",P,!1),this.update()}function _o(t){this.manager=void 0!==t?t:iw}function So(t){var e=new Map;if("Connections"in t){var n;t.Connections.connections.forEach(function(t){var n=t[0],r=t[1],i=t[2];e.has(n)||e.set(n,{parents:[],children:[]});var o={ID:r,relationship:i};e.get(n).parents.push(o),e.has(r)||e.set(r,{parents:[],children:[]});var a={ID:n,relationship:i};e.get(r).children.push(a)})}return e}function Mo(t){var e={},n={};if("Video"in t.Objects){var r=t.Objects.Video;for(var i in r){var o=r[i],a;if(e[a=parseInt(i)]=o.Filename,"Content"in o){var s=o.Content instanceof ArrayBuffer&&o.Content.byteLength>0,c="string"==typeof o.Content&&""!==o.Content;if(s||c){var u=Eo(r[i]);n[o.Filename]=u}}}}for(var a in e){var h=e[a];void 0!==n[h]?e[a]=n[h]:e[a]=e[a].split("\\").pop()}return e}function Eo(t){var e=t.Content,n=t.RelativeFilename||t.Filename,r=n.slice(n.lastIndexOf(".")+1).toLowerCase(),i=void 0;switch(r){case"bmp":i="image/bmp";break;case"jpg":case"jpeg":i="image/jpeg";break;case"png":i="image/png";break;case"tif":i="image/tiff";break;default:return void console.warn('FBXLoader: Image type "'+r+'" is not supported.')}if("string"==typeof e)return"data:"+i+";base64,"+e;var o=new Uint8Array(e);return window.URL.createObjectURL(new Blob([o],{type:i}))}function To(t,e,n,r){var i=new Map;if("Texture"in t.Objects){var o=t.Objects.Texture;for(var a in o){var s=Lo(o[a],e,n,r);i.set(parseInt(a),s)}}return i}function Lo(t,e,n,r){var i=Ao(t,e,n,r);i.ID=t.id,i.name=t.attrName;var o=t.WrapModeU,a=t.WrapModeV,s=void 0!==o?o.value:0,c=void 0!==a?a.value:0;if(i.wrapS=0===s?dg:pg,i.wrapT=0===c?dg:pg,"Scaling"in t){var u=t.Scaling.value;i.repeat.x=u[0],i.repeat.y=u[1]}return i}function Ao(t,e,n,r){var i=void 0,o=r.get(t.id).children;void 0!==o&&o.length>0&&void 0!==n[o[0].ID]&&(i=n[o[0].ID]);var a=e.path;0!==i.indexOf("blob:")&&0!==i.indexOf("data:")||e.setPath(void 0);var s=e.load(i);return e.setPath(a),s}function Po(t,e,n){var r=new Map;if("Material"in t.Objects){var i=t.Objects.Material;for(var o in i){var a=Ro(t,i[o],e,n);null!==a&&r.set(parseInt(o),a)}}return r}function Ro(t,e,n,r){var i=e.id,o=e.attrName,a=e.ShadingModel;if("object"===(void 0===a?"undefined":Kb(a))&&(a=a.value),!r.has(i))return null;var s=Io(t,e,n,i,r),c=void 0;switch(a.toLowerCase()){case"phong":c=new lr;break;case"lambert":c=new fr;break;default:console.warn('FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',a),c=new lr({color:3342591})}return c.setValues(s),c.name=o,c}function Io(t,e,n,r,i){var o={};return e.BumpFactor&&(o.bumpScale=e.BumpFactor.value),e.Diffuse&&(o.color=Ma(e.Diffuse)),e.DisplacementFactor&&(o.displacementScale=e.DisplacementFactor.value),e.ReflectionFactor&&(o.reflectivity=e.ReflectionFactor.value),e.Specular&&(o.specular=Ma(e.Specular)),e.Shininess&&(o.shininess=e.Shininess.value),e.Emissive&&(o.emissive=Ma(e.Emissive)),e.EmissiveFactor&&(o.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),e.Opacity&&(o.opacity=parseFloat(e.Opacity.value)),o.opacity<1&&(o.transparent=!0),i.get(r).children.forEach(function(e){var r=e.relationship;switch(r){case"Bump":o.bumpMap=n.get(e.ID);break;case"DiffuseColor":o.map=Co(t,n,e.ID,i);break;case"DisplacementColor":o.displacementMap=Co(t,n,e.ID,i);break;case"EmissiveColor":o.emissiveMap=Co(t,n,e.ID,i);break;case"NormalMap":o.normalMap=Co(t,n,e.ID,i);break;case"ReflectionColor":o.envMap=Co(t,n,e.ID,i),o.envMap.mapping=sg;break;case"SpecularColor":o.specularMap=Co(t,n,e.ID,i);break;case"TransparentColor":o.alphaMap=Co(t,n,e.ID,i),o.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("FBXLoader: %s map is not supported in three.js, skipping texture.",r)}}),o}function Co(t,e,n,r){return"LayeredTexture"in t.Objects&&n in t.Objects.LayeredTexture&&(console.warn("FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),n=r.get(n).children[0].ID),e.get(n)}function Oo(t,e){var n={};if("Deformer"in t.Objects){var r=t.Objects.Deformer;for(var i in r){var o;if("Skin"===r[i].attrType){var a=e.get(parseInt(i)),s=No(a,r);s.ID=i,a.parents.length>1&&console.warn("FBXLoader: skeleton attached to more than one geometry is not supported."),s.geometryID=a.parents[0].ID,n[i]=s}}}return n}function No(t,e){var n=[];return t.children.forEach(function(t){var r=e[t.ID];if("Cluster"===r.attrType){var i={ID:t.ID,indices:[],weights:[],transform:(new u).fromArray(r.Transform.a),transformLink:(new u).fromArray(r.TransformLink.a),linkMode:r.Mode};"Indexes"in r&&(i.indices=r.Indexes.a,i.weights=r.Weights.a),n.push(i)}}),{rawBones:n,bones:[]}}function Fo(t,e,n){var r=new Map;if("Geometry"in t.Objects){var i=t.Objects.Geometry;for(var o in i){var a,s=Do(t,e.get(parseInt(o)),i[o],n);r.set(parseInt(o),s)}}return r}function Do(t,e,n,r){switch(n.attrType){case"Mesh":return Uo(t,e,n,r);case"NurbsCurve":return Ho(n)}}function Uo(t,e,n,r){var i=e.parents.map(function(e){return t.Objects.Model[e.ID]});if(0!==i.length){var o=e.children.reduce(function(t,e){return void 0!==r[e.ID]&&(t=r[e.ID]),t},null),a=new u,s=i[0];if("GeometricRotation"in s){var c=s.GeometricRotation.value.map(Ry.degToRad);c[3]="ZYX",a.makeRotationFromEuler((new lt).fromArray(c))}return"GeometricTranslation"in s&&a.setPosition((new l).fromArray(s.GeometricTranslation.value)),Bo(t,e,n,o,a)}}function Bo(t,e,n,r,i){var o=n.Vertices.a,a=n.PolygonVertexIndex.a,s=[],c=[],u=[],h=[],l=[],d=[],p=[];if(n.LayerElementColor)var f=ko(n.LayerElementColor[0]);if(n.LayerElementMaterial)var m=jo(n.LayerElementMaterial[0]);if(n.LayerElementNormal)var v=zo(n.LayerElementNormal[0]);if(n.LayerElementUV)for(var g=[],y=0;n.LayerElementUV[y];)g.push(Go(n.LayerElementUV[y])),y++;var x={};null!==r&&r.rawBones.forEach(function(t,e){t.indices.forEach(function(n,r){void 0===x[n]&&(x[n]=[]),x[n].push({id:e,weight:t.weights[r]})})});var b=0,w=0,_=!1,S=[],M=[],E=[],T=[],L=[],A=[];a.forEach(function(t,e){var n=!1;t<0&&(t^=-1,a[e]=t,n=!0);var i=[],y=[];if(S.push(3*t,3*t+1,3*t+2),f){var P=Vo(e,b,t,f);E.push(P[0],P[1],P[2])}if(r){if(void 0!==x[t]&&x[t].forEach(function(t){y.push(t.weight),i.push(t.id)}),y.length>4){_||(console.warn("FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),_=!0);var R=[0,0,0,0],I=[0,0,0,0];y.forEach(function(t,e){var n=t,r=i[e];I.forEach(function(t,e,i){if(n>t){i[e]=n,n=t;var o=R[e];R[e]=r,r=o}})}),i=R,y=I}for(;y.length<4;)y.push(0),i.push(0);for(var C=0;C<4;++C)L.push(y[C]),A.push(i[C])}if(v){var P=Vo(e,b,t,v);M.push(P[0],P[1],P[2])}if(m&&"AllSame"!==m.mappingType)var O=Vo(e,b,t,m)[0];if(g&&g.forEach(function(n,r){var i=Vo(e,b,t,n);void 0===T[r]&&(T[r]=[]),T[r].push(i[0]),T[r].push(i[1])}),w++,n){for(var C=2;C<w;C++)s.push(o[S[0]]),s.push(o[S[1]]),s.push(o[S[2]]),s.push(o[S[3*(C-1)]]),s.push(o[S[3*(C-1)+1]]),s.push(o[S[3*(C-1)+2]]),s.push(o[S[3*C]]),s.push(o[S[3*C+1]]),s.push(o[S[3*C+2]]),r&&(d.push(L[0]),d.push(L[1]),d.push(L[2]),d.push(L[3]),d.push(L[4*(C-1)]),d.push(L[4*(C-1)+1]),d.push(L[4*(C-1)+2]),d.push(L[4*(C-1)+3]),d.push(L[4*C]),d.push(L[4*C+1]),d.push(L[4*C+2]),d.push(L[4*C+3]),p.push(A[0]),p.push(A[1]),p.push(A[2]),p.push(A[3]),p.push(A[4*(C-1)]),p.push(A[4*(C-1)+1]),p.push(A[4*(C-1)+2]),p.push(A[4*(C-1)+3]),p.push(A[4*C]),p.push(A[4*C+1]),p.push(A[4*C+2]),p.push(A[4*C+3])),f&&(u.push(E[0]),u.push(E[1]),u.push(E[2]),u.push(E[3*(C-1)]),u.push(E[3*(C-1)+1]),u.push(E[3*(C-1)+2]),u.push(E[3*C]),u.push(E[3*C+1]),u.push(E[3*C+2])),m&&"AllSame"!==m.mappingType&&(l.push(O),l.push(O),l.push(O)),v&&(c.push(M[0]),c.push(M[1]),c.push(M[2]),c.push(M[3*(C-1)]),c.push(M[3*(C-1)+1]),c.push(M[3*(C-1)+2]),c.push(M[3*C]),c.push(M[3*C+1]),c.push(M[3*C+2])),g&&g.forEach(function(t,e){void 0===h[e]&&(h[e]=[]),h[e].push(T[e][0]),h[e].push(T[e][1]),h[e].push(T[e][2*(C-1)]),h[e].push(T[e][2*(C-1)+1]),h[e].push(T[e][2*C]),h[e].push(T[e][2*C+1])});b++,w=0,S=[],M=[],E=[],T=[],L=[],A=[]}});var P=new Rt;P.name=n.name;var R=new Tt(s,3);if(i.applyToBufferAttribute(R),P.addAttribute("position",R),u.length>0&&P.addAttribute("color",new Tt(u,3)),r&&(P.addAttribute("skinIndex",new Tt(p,4)),P.addAttribute("skinWeight",new Tt(d,4)),P.FBX_Deformer=r),c.length>0&&P.addAttribute("normal",new Tt(c,3)),h.forEach(function(t,e){var n="uv"+(e+1).toString();0===e&&(n="uv"),P.addAttribute(n,new Tt(h[e],2))}),m&&"AllSame"!==m.mappingType){var I=l[0],C=0;if(l.forEach(function(t,e){t!==I&&(P.addGroup(C,e-C,I),I=t,C=e)}),P.groups.length>0){var O=P.groups[P.groups.length-1],N=O.start+O.count;N!==l.length&&P.addGroup(N,l.length-N,I)}0===P.groups.length&&P.addGroup(0,l.length,l[0])}return P}function zo(t){var e=t.MappingInformationType,n=t.ReferenceInformationType,r=t.Normals.a,i=[];return"IndexToDirect"===n&&("NormalIndex"in t?i=t.NormalIndex.a:"NormalsIndex"in t&&(i=t.NormalsIndex.a)),{dataSize:3,buffer:r,indices:i,mappingType:e,referenceType:n}}function Go(t){var e=t.MappingInformationType,n=t.ReferenceInformationType,r=t.UV.a,i=[];return"IndexToDirect"===n&&(i=t.UVIndex.a),{dataSize:2,buffer:r,indices:i,mappingType:e,referenceType:n}}function ko(t){var e=t.MappingInformationType,n=t.ReferenceInformationType,r=t.Colors.a,i=[];return"IndexToDirect"===n&&(i=t.ColorIndex.a),{dataSize:4,buffer:r,indices:i,mappingType:e,referenceType:n}}function jo(t){var e=t.MappingInformationType,n=t.ReferenceInformationType;if("NoMappingInformation"===e)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:n};for(var r=t.Materials.a,i=[],o=0;o<r.length;++o)i.push(o);return{dataSize:1,buffer:r,indices:i,mappingType:e,referenceType:n}}function Vo(t,e,n,r){return Aw[r.mappingType][r.referenceType](t,e,n,r)}function Ho(t){if(void 0===NURBSCurve)return console.error("FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new Rt;var e=parseInt(t.Order);if(isNaN(e))return console.error("FBXLoader: Invalid Order %s given for geometry ID: %s",t.Order,t.id),new Rt;for(var n=e-1,r=t.KnotVector.a,i=[],o=t.Points.a,a=0,s=o.length;a<s;a+=4)i.push((new f).fromArray(o,a));var c=void 0,u=void 0;if("Closed"===t.Form)i.push(i[0]);else if("Periodic"===t.Form){c=n,u=r.length-1-c;for(var a=0;a<n;++a)i.push(i[a])}var h,l=new NURBSCurve(n,r,i,c,u).getPoints(7*i.length),d=new Float32Array(3*l.length);l.forEach(function(t,e){t.toArray(d,3*e)});var p=new Rt;return p.addAttribute("position",new yt(d,3)),p}function Wo(t,e,n,r,i){var o=new ke,a=Yo(t,n,r,i,e),s=t.Objects.Model;return a.forEach(function(n){var r=s[n.ID];$o(t,n,r,e,o);var i;e.get(n.ID).parents.forEach(function(t){var e=a.get(t.ID);void 0!==e&&e.add(n)}),null===n.parent&&o.add(n)}),ea(t,n,r,a,e,o),ca(t,e,o),Ko(t,o),o}function Yo(t,e,n,r,i){var o=new Map,a=t.Objects.Model;for(var s in a){var c=parseInt(s),u=a[s],h=i.get(c),l=Xo(h,e,c,u.attrName);if(!l){switch(u.attrType){case"Camera":l=qo(t,h);break;case"Light":l=Zo(t,h);break;case"Mesh":l=Jo(t,h,n,r);break;case"NurbsCurve":l=Qo(h,n);break;case"LimbNode":case"Null":default:l=new ke}l.name=Di.sanitizeNodeName(u.attrName),l.ID=c}ta(t,l,u),o.set(c,l)}return o}function Xo(t,e,n,r){var i=null;return t.parents.forEach(function(t){var o=function o(a){var s=e[a];s.rawBones.forEach(function(e,o){if(e.ID===t.ID){var a=i;(i=new Oe).matrixWorld.copy(e.transformLink),i.name=Di.sanitizeNodeName(r),i.ID=n,s.bones[o]=i,null!==a&&i.add(a)}})};for(var a in e)o(a)}),i}function qo(t,e){var n=void 0,r=void 0;if(e.children.forEach(function(e){var n=t.Objects.NodeAttribute[e.ID];void 0!==n&&(r=n)}),void 0===r)n=new pt;else{var i=0;void 0!==r.CameraProjectionType&&1===r.CameraProjectionType.value&&(i=1);var o=1;void 0!==r.NearPlane&&(o=r.NearPlane.value/1e3);var a=1e3;void 0!==r.FarPlane&&(a=r.FarPlane.value/1e3);var s=window.innerWidth,c=window.innerHeight;void 0!==r.AspectWidth&&void 0!==r.AspectHeight&&(s=r.AspectWidth.value,c=r.AspectHeight.value);var u=s/c,h=45;switch(void 0!==r.FieldOfView&&(h=r.FieldOfView.value),i){case 0:n=new xe(h,u,o,a);break;case 1:n=new mt(-s/2,s/2,c/2,-c/2,o,a);break;default:console.warn("FBXLoader: Unknown camera type "+i+"."),n=new pt}}return n}function Zo(t,e){var n=void 0,r=void 0;if(e.children.forEach(function(e){var n=t.Objects.NodeAttribute[e.ID];void 0!==n&&(r=n)}),void 0===r)n=new pt;else{var i=void 0;i=void 0===r.LightType?0:r.LightType.value;var o=16777215;void 0!==r.Color&&(o=Ma(r.Color));var a=void 0===r.Intensity?1:r.Intensity.value/100;void 0!==r.CastLightOnObject&&0===r.CastLightOnObject.value&&(a=0);var s=0;void 0!==r.FarAttenuationEnd&&(s=void 0!==r.EnableFarAttenuation&&0===r.EnableFarAttenuation.value?0:r.FarAttenuationEnd.value/1e3);var c=1;switch(i){case 0:n=new $r(o,a,s,1);break;case 1:n=new ei(o,a);break;case 2:var u=Math.PI/3;void 0!==r.InnerAngle&&(u=Ry.degToRad(r.InnerAngle.value));var h=0;void 0!==r.OuterAngle&&(h=Ry.degToRad(r.OuterAngle.value),h=Math.max(h,1)),n=new Kr(o,a,s,u,h,1);break;default:console.warn("FBXLoader: Unknown light type "+r.LightType.value+", defaulting to a PointLight."),n=new $r(o,a)}void 0!==r.CastShadows&&1===r.CastShadows.value&&(n.castShadow=!0)}return n}function Jo(t,e,n,r){var i=void 0,o=null,a=null,s=[];return e.children.forEach(function(t){n.has(t.ID)&&(o=n.get(t.ID)),r.has(t.ID)&&s.push(r.get(t.ID))}),s.length>1?a=s:s.length>0?a=s[0]:(a=new lr({color:13421772}),s.push(a)),"color"in o.attributes&&s.forEach(function(t){t.vertexColors=xv}),o.FBX_Deformer?(s.forEach(function(t){t.skinning=!0}),i=new Ne(o,a)):i=new Gt(o,a),i}function Qo(t,e){var n,r;return new De(t.children.reduce(function(t,n){return e.has(n.ID)&&(t=e.get(n.ID)),t},null),new Fe({color:3342591,linewidth:1}))}function Ko(t,e){if("GlobalSettings"in t&&"AmbientColor"in t.GlobalSettings){var n=t.GlobalSettings.AmbientColor.value,r=n[0],i=n[1],o=n[2];if(0!==r||0!==i||0!==o){var a=new $(r,i,o);e.add(new ni(a,1))}}}function $o(t,e,n,r,i){if("LookAtProperty"in n){var o;r.get(e.ID).children.forEach(function(n){if("LookAtProperty"===n.relationship){var r=t.Objects.Model[n.ID];if("Lcl_Translation"in r){var o=r.Lcl_Translation.value;void 0!==e.target?(e.target.position.fromArray(o),i.add(e.target)):e.lookAt((new l).fromArray(o))}}})}}function ta(t,e,n){if("RotationOrder"in n){var r=["XYZ","XZY","YZX","ZXY","YXZ","ZYX","SphericXYZ"],i=parseInt(n.RotationOrder.value,10);i>0&&i<6?console.warn("FBXLoader: unsupported Euler Order: %s. Currently only XYZ order is supported. Animations and rotations may be incorrect.",r[i]):6===i&&console.warn("FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect.")}if("Lcl_Translation"in n&&e.position.fromArray(n.Lcl_Translation.value),"Lcl_Rotation"in n){var o=n.Lcl_Rotation.value.map(Ry.degToRad);o.push("ZYX"),e.rotation.fromArray(o)}if("Lcl_Scaling"in n&&e.scale.fromArray(n.Lcl_Scaling.value),"PreRotation"in n){var a=n.PreRotation.value.map(Ry.degToRad);a[3]="ZYX";var s=(new lt).fromArray(a);s=(new h).setFromEuler(s);var c=(new h).setFromEuler(e.rotation);s.multiply(c),e.rotation.setFromQuaternion(s,"ZYX")}}function ea(t,e,n,r,i){var o=na(t);for(var a in e){var s=e[a],c;i.get(parseInt(s.ID)).parents.forEach(function(t){if(n.has(t.ID)){var e=t.ID,a;i.get(e).parents.forEach(function(t){if(r.has(t.ID)){var e;r.get(t.ID).bind(new Ce(s.bones),o[t.ID])}})}})}}function na(t){var e={};if("Pose"in t.Objects){var n=t.Objects.Pose;for(var r in n)if("BindPose"===n[r].attrType){var i=n[r].PoseNode;Array.isArray(i)?i.forEach(function(t){e[t.Node]=(new u).fromArray(t.Matrix.a)}):e[i.Node]=(new u).fromArray(i.Matrix.a)}}return e}function ra(t,e){if(void 0!==t.Objects.AnimationCurve){var n=ia(t);oa(t,e,n);var r,i;return sa(t,e,aa(t,e,n))}}function ia(t){var e=t.Objects.AnimationCurveNode,n=new Map;for(var r in e){var i=e[r];if(null!==i.attrName.match(/S|R|T/)){var o={id:i.id,attr:i.attrName,curves:{}};n.set(o.id,o)}}return n}function oa(t,e,n){var r=t.Objects.AnimationCurve;for(var i in r){var o={id:r[i].id,times:r[i].KeyTime.a.map(_a),values:r[i].KeyValueFloat.a},a=e.get(o.id);if(void 0!==a){var s=a.parents[0].ID,c=a.parents[0].relationship,u="";if(c.match(/X/))u="x";else if(c.match(/Y/))u="y";else{if(!c.match(/Z/))continue;u="z"}n.get(s).curves[u]=o}}}function aa(t,e,n){var r=t.Objects.AnimationLayer,i=new Map;for(var o in r){var a=[],s=e.get(parseInt(o));if(void 0!==s){var c;s.children.forEach(function(r,i){if(n.has(r.ID)){var o=n.get(r.ID);if(void 0===a[i]){var s=void 0;e.get(r.ID).parents.forEach(function(t){void 0!==t.relationship&&(s=t.ID)});var c=t.Objects.Model[s.toString()],u={modelName:Di.sanitizeNodeName(c.attrName),initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};"Lcl_Translation"in c&&(u.initialPosition=c.Lcl_Translation.value),"Lcl_Rotation"in c&&(u.initialRotation=c.Lcl_Rotation.value),"Lcl_Scaling"in c&&(u.initialScale=c.Lcl_Scaling.value),"PreRotation"in c&&(u.preRotations=c.PreRotation.value),a[i]=u}a[i][o.attr]=o}}),i.set(parseInt(o),a)}}return i}function sa(t,e,n){var r=t.Objects.AnimationStack,i={};for(var o in r){var a=e.get(parseInt(o)).children;a.length>1&&console.warn("FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");var s=n.get(a[0].ID);i[o]={name:r[o].attrName,layer:s}}return i}function ca(t,e,n){n.animations=[];var r=ra(t,e);if(void 0!==r)for(var i in r){var o,a=ua(r[i]);n.animations.push(a)}}function ua(t){var e=[];return t.layer.forEach(function(t){e=e.concat(ha(t))}),new vi(t.name,-1,e)}function ha(t){var e=[];if(void 0!==t.T&&Object.keys(t.T.curves).length>0){var n=la(t.modelName,t.T.curves,t.initialPosition,"position");void 0!==n&&e.push(n)}if(void 0!==t.R&&Object.keys(t.R.curves).length>0){var r=da(t.modelName,t.R.curves,t.initialRotation,t.preRotations);void 0!==r&&e.push(r)}if(void 0!==t.S&&Object.keys(t.S.curves).length>0){var i=la(t.modelName,t.S.curves,t.initialScale,"scale");void 0!==i&&e.push(i)}return e}function la(t,e,n,r){var i=fa(e),o;return new mi(t+"."+r,i,pa(i,e,n))}function da(t,e,n,r){void 0!==e.x&&(e.x.values=e.x.values.map(Ry.degToRad)),void 0!==e.y&&(e.y.values=e.y.values.map(Ry.degToRad)),void 0!==e.z&&(e.z.values=e.z.values.map(Ry.degToRad));var i=fa(e),o=pa(i,e,n);void 0!==r&&((r=r.map(Ry.degToRad)).push("ZYX"),r=(new lt).fromArray(r),r=(new h).setFromEuler(r));for(var a=new h,s=new lt,c=[],u=0;u<o.length;u+=3)s.set(o[u],o[u+1],o[u+2],"ZYX"),a.setFromEuler(s),void 0!==r&&a.premultiply(r),a.toArray(c,u/3*4);return new ci(t+".quaternion",i,c)}function pa(t,e,n){var r=n,i=[],o=-1,a=-1,s=-1;return t.forEach(function(t){if(e.x&&(o=e.x.times.indexOf(t)),e.y&&(a=e.y.times.indexOf(t)),e.z&&(s=e.z.times.indexOf(t)),-1!==o){var n=e.x.values[o];i.push(n),r[0]=n}else i.push(r[0]);if(-1!==a){var c=e.y.values[a];i.push(c),r[1]=c}else i.push(r[1]);if(-1!==s){var u=e.z.values[s];i.push(u),r[2]=u}else i.push(r[2])}),i}function fa(t){var e=[];return void 0!==t.x&&(e=e.concat(t.x.times)),void 0!==t.y&&(e=e.concat(t.y.times)),void 0!==t.z&&(e=e.concat(t.z.times)),e=e.sort(function(t,e){return t-e}).filter(function(t,e,n){return n.indexOf(t)==e})}function ma(){}function va(){}function ga(t,e){this.dv=new DataView(t),this.offset=0,this.littleEndian=void 0===e||e}function ya(){}function xa(t){var e="Kaydara FBX Binary  \0";return t.byteLength>=e.length&&e===Ea(t,0,e.length)}function ba(t){function e(e){var n=t[e-1];return t=t.slice(r+e),r++,n}for(var n=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"],r=0,i=0;i<n.length;++i){var o;if(e(1)===n[i])return!1}return!0}function wa(t){var e=/FBXVersion: (\d+)/,n=t.match(e);if(n){var r;return parseInt(n[1])}throw new Error("FBXLoader: Cannot find the version number for the file given.")}function _a(t){return t/46186158e3}function Sa(t){var e;return t.split(",").map(function(t){return parseFloat(t)})}function Ma(t){var e=new $;return"Color"===t.type?e.setScalar(t.value):e.fromArray(t.value)}function Ea(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=t.byteLength),pw.decodeText(new Uint8Array(t,e,n))}function Ta(t,e){for(var n=0,r=t.length,i=e.length;n<i;n++,r++)t[r]=e[n]}function La(t,e,n,r){for(var i=n,o=0;i<r;i++,o++)t[o]=e[i];return t}var Aa="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Pa=t(function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)}),Ra={}.hasOwnProperty,Ia=function(t,e){return Ra.call(t,e)},Ca=function(t){try{return!!t()}catch(t){return!0}},Oa=!Ca(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),Na=t(function(t){var e=t.exports={version:"2.5.1"};"number"==typeof __e&&(__e=e)}),Fa=Na.version,Da=function(t){return"object"==typeof t?null!==t:"function"==typeof t},Ua=function(t){if(!Da(t))throw TypeError(t+" is not an object!");return t},Ba=Pa.document,za=Da(Ba)&&Da(Ba.createElement),Ga=function(t){return za?Ba.createElement(t):{}},ka=!Oa&&!Ca(function(){return 7!=Object.defineProperty(Ga("div"),"a",{get:function(){return 7}}).a}),ja=function(t,e){if(!Da(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!Da(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!Da(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!Da(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")},Va=Object.defineProperty,Ha,Wa={f:Oa?Object.defineProperty:function t(e,n,r){if(Ua(e),n=ja(n,!0),Ua(r),ka)try{return Va(e,n,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[n]=r.value),e}},Ya=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},Xa=Oa?function(t,e,n){return Wa.f(t,e,Ya(1,n))}:function(t,e,n){return t[e]=n,t},qa=0,Za=Math.random(),Ja=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++qa+Za).toString(36))},Qa=t(function(t){var e=Ja("src"),n="toString",r=Function[n],i=(""+r).split(n);Na.inspectSource=function(t){return r.call(t)},(t.exports=function(t,n,r,o){var a="function"==typeof r;a&&(Ia(r,"name")||Xa(r,"name",n)),t[n]!==r&&(a&&(Ia(r,e)||Xa(r,e,t[n]?""+t[n]:i.join(String(n)))),t===Pa?t[n]=r:o?t[n]?t[n]=r:Xa(t,n,r):(delete t[n],Xa(t,n,r)))})(Function.prototype,n,function t(){return"function"==typeof this&&this[e]||r.call(this)})}),Ka=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t},$a=function(t,e,n){if(Ka(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}},ts="prototype",es=function(t,e,n){var r=t&es.F,i=t&es.G,o=t&es.S,a=t&es.P,s=t&es.B,c=i?Pa:o?Pa[e]||(Pa[e]={}):(Pa[e]||{})[ts],u=i?Na:Na[e]||(Na[e]={}),h=u[ts]||(u[ts]={}),l,d,p,f;i&&(n=e);for(l in n)p=((d=!r&&c&&void 0!==c[l])?c:n)[l],f=s&&d?$a(p,Pa):a&&"function"==typeof p?$a(Function.call,p):p,c&&Qa(c,l,p,t&es.U),u[l]!=p&&Xa(u,l,f),a&&h[l]!=p&&(h[l]=p)};Pa.core=Na,es.F=1,es.G=2,es.S=4,es.P=8,es.B=16,es.W=32,es.U=64,es.R=128;var ns=es,rs=t(function(t){var e=Ja("meta"),n=Wa.f,r=0,i=Object.isExtensible||function(){return!0},o=!Ca(function(){return i(Object.preventExtensions({}))}),a=function(t){n(t,e,{value:{i:"O"+ ++r,w:{}}})},s=function(t,n){if(!Da(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!Ia(t,e)){if(!i(t))return"F";if(!n)return"E";a(t)}return t[e].i},c=function(t,n){if(!Ia(t,e)){if(!i(t))return!0;if(!n)return!1;a(t)}return t[e].w},u=function(t){return o&&h.NEED&&i(t)&&!Ia(t,e)&&a(t),t},h=t.exports={KEY:e,NEED:!1,fastKey:s,getWeak:c,onFreeze:u}}),is=rs.KEY,os=rs.NEED,as=rs.fastKey,ss=rs.getWeak,cs=rs.onFreeze,us="__core-js_shared__",hs=Pa[us]||(Pa[us]={}),ls=function(t){return hs[t]||(hs[t]={})},ds=t(function(t){var e=ls("wks"),n=Pa.Symbol,r="function"==typeof n,i;(t.exports=function(t){return e[t]||(e[t]=r&&n[t]||(r?n:Ja)("Symbol."+t))}).store=e}),ps=Wa.f,fs=ds("toStringTag"),ms=function(t,e,n){t&&!Ia(t=n?t:t.prototype,fs)&&ps(t,fs,{configurable:!0,value:e})},vs,gs={f:ds},ys=!1,xs=Wa.f,bs=function(t){var e=Na.Symbol||(Na.Symbol=Pa.Symbol||{});"_"==t.charAt(0)||t in e||xs(e,t,{value:gs.f(t)})},ws={}.toString,_s=function(t){return ws.call(t).slice(8,-1)},Ss=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==_s(t)?t.split(""):Object(t)},Ms=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t},Es=function(t){return Ss(Ms(t))},Ts=Math.ceil,Ls=Math.floor,As=function(t){return isNaN(t=+t)?0:(t>0?Ls:Ts)(t)},Ps=Math.min,Rs=function(t){return t>0?Ps(As(t),9007199254740991):0},Is=Math.max,Cs=Math.min,Os=function(t,e){return(t=As(t))<0?Is(t+e,0):Cs(t,e)},Ns=function(t){return function(e,n,r){var i=Es(e),o=Rs(i.length),a=Os(r,o),s;if(t&&n!=n){for(;o>a;)if((s=i[a++])!=s)return!0}else for(;o>a;a++)if((t||a in i)&&i[a]===n)return t||a||0;return!t&&-1}},Fs=ls("keys"),Ds=function(t){return Fs[t]||(Fs[t]=Ja(t))},Us=Ns(!1),Bs=Ds("IE_PROTO"),zs=function(t,e){var n=Es(t),r=0,i=[],o;for(o in n)o!=Bs&&Ia(n,o)&&i.push(o);for(;e.length>r;)Ia(n,o=e[r++])&&(~Us(i,o)||i.push(o));return i},Gs="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),ks=Object.keys||function t(e){return zs(e,Gs)},js,Vs={f:Object.getOwnPropertySymbols},Hs,Ws={f:{}.propertyIsEnumerable},Ys=function(t){var e=ks(t),n=Vs.f;if(n)for(var r=n(t),i=Ws.f,o=0,a;r.length>o;)i.call(t,a=r[o++])&&e.push(a);return e},Xs=Array.isArray||function t(e){return"Array"==_s(e)},qs=Oa?Object.defineProperties:function t(e,n){Ua(e);for(var r=ks(n),i=r.length,o=0,a;i>o;)Wa.f(e,a=r[o++],n[a]);return e},Zs=Pa.document,Js=Zs&&Zs.documentElement,Qs=Ds("IE_PROTO"),Ks=function(){},$s="prototype",tc=function(){var t=Ga("iframe"),e=Gs.length,n="<",r=">",i;for(t.style.display="none",Js.appendChild(t),t.src="javascript:",(i=t.contentWindow.document).open(),i.write("<script>document.F=Object<\/script>"),i.close(),tc=i.F;e--;)delete tc[$s][Gs[e]];return tc()},ec=Object.create||function t(e,n){var r;return null!==e?(Ks[$s]=Ua(e),r=new Ks,Ks[$s]=null,r[Qs]=e):r=tc(),void 0===n?r:qs(r,n)},nc=Gs.concat("length","prototype"),rc,ic={f:Object.getOwnPropertyNames||function t(e){return zs(e,nc)}},oc=ic.f,ac={}.toString,sc="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],cc=function(t){try{return oc(t)}catch(t){return sc.slice()}},uc,hc={f:function t(e){return sc&&"[object Window]"==ac.call(e)?cc(e):oc(Es(e))}},lc=Object.getOwnPropertyDescriptor,dc,pc={f:Oa?lc:function t(e,n){if(e=Es(e),n=ja(n,!0),ka)try{return lc(e,n)}catch(t){}if(Ia(e,n))return Ya(!Ws.f.call(e,n),e[n])}},fc=rs.KEY,mc=pc.f,vc=Wa.f,gc=hc.f,yc=Pa.Symbol,xc=Pa.JSON,bc=xc&&xc.stringify,wc="prototype",_c=ds("_hidden"),Sc=ds("toPrimitive"),Mc={}.propertyIsEnumerable,Ec=ls("symbol-registry"),Tc=ls("symbols"),Lc=ls("op-symbols"),Ac=Object[wc],Pc="function"==typeof yc,Rc=Pa.QObject,Ic=!Rc||!Rc[wc]||!Rc[wc].findChild,Cc=Oa&&Ca(function(){return 7!=ec(vc({},"a",{get:function(){return vc(this,"a",{value:7}).a}})).a})?function(t,e,n){var r=mc(Ac,e);r&&delete Ac[e],vc(t,e,n),r&&t!==Ac&&vc(Ac,e,r)}:vc,Oc=function(t){var e=Tc[t]=ec(yc[wc]);return e._k=t,e},Nc=Pc&&"symbol"==typeof yc.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof yc},Fc=function t(e,n,r){return e===Ac&&Fc(Lc,n,r),Ua(e),n=ja(n,!0),Ua(r),Ia(Tc,n)?(r.enumerable?(Ia(e,_c)&&e[_c][n]&&(e[_c][n]=!1),r=ec(r,{enumerable:Ya(0,!1)})):(Ia(e,_c)||vc(e,_c,Ya(1,{})),e[_c][n]=!0),Cc(e,n,r)):vc(e,n,r)},Dc=function t(e,n){Ua(e);for(var r=Ys(n=Es(n)),i=0,o=r.length,a;o>i;)Fc(e,a=r[i++],n[a]);return e},Uc=function t(e,n){return void 0===n?ec(e):Dc(ec(e),n)},Bc=function t(e){var n=Mc.call(this,e=ja(e,!0));return!(this===Ac&&Ia(Tc,e)&&!Ia(Lc,e))&&(!(n||!Ia(this,e)||!Ia(Tc,e)||Ia(this,_c)&&this[_c][e])||n)},zc=function t(e,n){if(e=Es(e),n=ja(n,!0),e!==Ac||!Ia(Tc,n)||Ia(Lc,n)){var r=mc(e,n);return!r||!Ia(Tc,n)||Ia(e,_c)&&e[_c][n]||(r.enumerable=!0),r}},Gc=function t(e){for(var n=gc(Es(e)),r=[],i=0,o;n.length>i;)Ia(Tc,o=n[i++])||o==_c||o==fc||r.push(o);return r},kc=function t(e){for(var n=e===Ac,r=gc(n?Lc:Es(e)),i=[],o=0,a;r.length>o;)!Ia(Tc,a=r[o++])||n&&!Ia(Ac,a)||i.push(Tc[a]);return i};Pc||(Qa((yc=function t(){if(this instanceof yc)throw TypeError("Symbol is not a constructor!");var e=Ja(arguments.length>0?arguments[0]:void 0),n=function(t){this===Ac&&n.call(Lc,t),Ia(this,_c)&&Ia(this[_c],e)&&(this[_c][e]=!1),Cc(this,e,Ya(1,t))};return Oa&&Ic&&Cc(Ac,e,{configurable:!0,set:n}),Oc(e)})[wc],"toString",function t(){return this._k}),pc.f=zc,Wa.f=Fc,ic.f=hc.f=Gc,Ws.f=Bc,Vs.f=kc,Oa&&Qa(Ac,"propertyIsEnumerable",Bc,!0),gs.f=function(t){return Oc(ds(t))}),ns(ns.G+ns.W+ns.F*!Pc,{Symbol:yc});for(var jc="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),Vc=0;jc.length>Vc;)ds(jc[Vc++]);for(var Hc=ks(ds.store),Wc=0;Hc.length>Wc;)bs(Hc[Wc++]);ns(ns.S+ns.F*!Pc,"Symbol",{for:function(t){return Ia(Ec,t+="")?Ec[t]:Ec[t]=yc(t)},keyFor:function t(e){if(!Nc(e))throw TypeError(e+" is not a symbol!");for(var n in Ec)if(Ec[n]===e)return n},useSetter:function(){Ic=!0},useSimple:function(){Ic=!1}}),ns(ns.S+ns.F*!Pc,"Object",{create:Uc,defineProperty:Fc,defineProperties:Dc,getOwnPropertyDescriptor:zc,getOwnPropertyNames:Gc,getOwnPropertySymbols:kc}),xc&&ns(ns.S+ns.F*(!Pc||Ca(function(){var t=yc();return"[null]"!=bc([t])||"{}"!=bc({a:t})||"{}"!=bc(Object(t))})),"JSON",{stringify:function t(e){if(void 0!==e&&!Nc(e)){for(var n=[e],r=1,i,o;arguments.length>r;)n.push(arguments[r++]);return"function"==typeof(i=n[1])&&(o=i),!o&&Xs(i)||(i=function(t,e){if(o&&(e=o.call(this,t,e)),!Nc(e))return e}),n[1]=i,bc.apply(xc,n)}}}),yc[wc][Sc]||Xa(yc[wc],Sc,yc[wc].valueOf),ms(yc,"Symbol"),ms(Math,"Math",!0),ms(Pa.JSON,"JSON",!0),ns(ns.S,"Object",{create:ec}),ns(ns.S+ns.F*!Oa,"Object",{defineProperty:Wa.f}),ns(ns.S+ns.F*!Oa,"Object",{defineProperties:qs});var Yc=function(t,e){var n=(Na.Object||{})[t]||Object[t],r={};r[t]=e(n),ns(ns.S+ns.F*Ca(function(){n(1)}),"Object",r)},Xc=pc.f;Yc("getOwnPropertyDescriptor",function(){return function t(e,n){return Xc(Es(e),n)}});var qc=function(t){return Object(Ms(t))},Zc=Ds("IE_PROTO"),Jc=Object.prototype,Qc=Object.getPrototypeOf||function(t){return t=qc(t),Ia(t,Zc)?t[Zc]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?Jc:null};Yc("getPrototypeOf",function(){return function t(e){return Qc(qc(e))}}),Yc("keys",function(){return function t(e){return ks(qc(e))}}),Yc("getOwnPropertyNames",function(){return hc.f});var Kc=rs.onFreeze;Yc("freeze",function(t){return function e(n){return t&&Da(n)?t(Kc(n)):n}});var $c=rs.onFreeze;Yc("seal",function(t){return function e(n){return t&&Da(n)?t($c(n)):n}});var tu=rs.onFreeze;Yc("preventExtensions",function(t){return function e(n){return t&&Da(n)?t(tu(n)):n}}),Yc("isFrozen",function(t){return function e(n){return!Da(n)||!!t&&t(n)}}),Yc("isSealed",function(t){return function e(n){return!Da(n)||!!t&&t(n)}}),Yc("isExtensible",function(t){return function e(n){return!!Da(n)&&(!t||t(n))}});var eu=Object.assign,nu=!eu||Ca(function(){var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach(function(t){e[t]=t}),7!=eu({},t)[n]||Object.keys(eu({},e)).join("")!=r})?function t(e,n){for(var r=qc(e),i=arguments.length,o=1,a=Vs.f,s=Ws.f;i>o;)for(var c=Ss(arguments[o++]),u=a?ks(c).concat(a(c)):ks(c),h=u.length,l=0,d;h>l;)s.call(c,d=u[l++])&&(r[d]=c[d]);return r}:eu;ns(ns.S+ns.F,"Object",{assign:nu});var ru=Object.is||function t(e,n){return e===n?0!==e||1/e==1/n:e!=e&&n!=n};ns(ns.S,"Object",{is:ru});var iu=function(t,e){if(Ua(t),!Da(e)&&null!==e)throw TypeError(e+": can't set as prototype!")},ou={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,n){try{(n=$a(Function.call,pc.f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function t(r,i){return iu(r,i),e?r.__proto__=i:n(r,i),r}}({},!1):void 0),check:iu};ns(ns.S,"Object",{setPrototypeOf:ou.set});var au=ds("toStringTag"),su="Arguments"==_s(function(){return arguments}()),cu=function(t,e){try{return t[e]}catch(t){}},uu=function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=cu(e=Object(t),au))?n:su?_s(e):"Object"==(r=_s(e))&&"function"==typeof e.callee?"Arguments":r},hu={};hu[ds("toStringTag")]="z",hu+""!="[object z]"&&Qa(Object.prototype,"toString",function t(){return"[object "+uu(this)+"]"},!0);var lu=function(t,e,n){var r=void 0===n;switch(e.length){case 0:return r?t():t.call(n);case 1:return r?t(e[0]):t.call(n,e[0]);case 2:return r?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return r?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return r?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)},du=[].slice,pu={},fu=function(t,e,n){if(!(e in pu)){for(var r=[],i=0;i<e;i++)r[i]="a["+i+"]";pu[e]=Function("F,a","return new F("+r.join(",")+")")}return pu[e](t,n)},mu=Function.bind||function t(e){var n=Ka(this),r=du.call(arguments,1),i=function(){var t=r.concat(du.call(arguments));return this instanceof i?fu(n,t.length,t):lu(n,t,e)};return Da(n.prototype)&&(i.prototype=n.prototype),i};ns(ns.P,"Function",{bind:mu});var vu=Wa.f,gu=Function.prototype,yu=/^\s*function ([^ (]*)/,xu="name";xu in gu||Oa&&vu(gu,xu,{configurable:!0,get:function(){try{return(""+this).match(yu)[1]}catch(t){return""}}});var bu=ds("hasInstance"),wu=Function.prototype;bu in wu||Wa.f(wu,bu,{value:function(t){if("function"!=typeof this||!Da(t))return!1;if(!Da(this.prototype))return t instanceof this;for(;t=Qc(t);)if(this.prototype===t)return!0;return!1}});var _u="\t\n\v\f\r \u2028\u2029\ufeff",Su="["+_u+"]",Mu="",Eu=RegExp("^"+Su+Su+"*"),Tu=RegExp(Su+Su+"*$"),Lu=function(t,e,n){var r={},i=Ca(function(){return!!_u[t]()||""!=""[t]()}),o=r[t]=i?e(Au):_u[t];n&&(r[n]=o),ns(ns.P+ns.F*i,"String",r)},Au=Lu.trim=function(t,e){return t=String(Ms(t)),1&e&&(t=t.replace(Eu,"")),2&e&&(t=t.replace(Tu,"")),t},Pu=Lu,Ru=Pa.parseInt,Iu=Pu.trim,Cu=/^[-+]?0[xX]/,Ou=8!==Ru(_u+"08")||22!==Ru(_u+"0x16")?function t(e,n){var r=Iu(String(e),3);return Ru(r,n>>>0||(Cu.test(r)?16:10))}:Ru;ns(ns.G+ns.F*(parseInt!=Ou),{parseInt:Ou});var Nu=Pa.parseFloat,Fu=Pu.trim,Du=1/Nu(_u+"-0")!=-1/0?function t(e){var n=Fu(String(e),3),r=Nu(n);return 0===r&&"-"==n.charAt(0)?-0:r}:Nu;ns(ns.G+ns.F*(parseFloat!=Du),{parseFloat:Du});var Uu=ou.set,Bu=function(t,e,n){var r=e.constructor,i;return r!==n&&"function"==typeof r&&(i=r.prototype)!==n.prototype&&Da(i)&&Uu&&Uu(t,i),t},zu=ic.f,Gu=pc.f,ku=Wa.f,ju=Pu.trim,Vu="Number",Hu=Pa[Vu],Wu=Hu,Yu=Hu.prototype,Xu=_s(ec(Yu))==Vu,qu="trim"in String.prototype,Zu=function(t){var e=ja(t,!1);if("string"==typeof e&&e.length>2){var n=(e=qu?e.trim():ju(e,3)).charCodeAt(0),r,i,o;if(43===n||45===n){if(88===(r=e.charCodeAt(2))||120===r)return NaN}else if(48===n){switch(e.charCodeAt(1)){case 66:case 98:i=2,o=49;break;case 79:case 111:i=8,o=55;break;default:return+e}for(var a=e.slice(2),s=0,c=a.length,u;s<c;s++)if((u=a.charCodeAt(s))<48||u>o)return NaN;return parseInt(a,i)}}return+e};if(!Hu(" 0o1")||!Hu("0b1")||Hu("+0x1")){Hu=function t(e){var n=arguments.length<1?0:e,r=this;return r instanceof Hu&&(Xu?Ca(function(){Yu.valueOf.call(r)}):_s(r)!=Vu)?Bu(new Wu(Zu(n)),r,Hu):Zu(n)};for(var Ju=Oa?zu(Wu):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),Qu=0,Ku;Ju.length>Qu;Qu++)Ia(Wu,Ku=Ju[Qu])&&!Ia(Hu,Ku)&&ku(Hu,Ku,Gu(Wu,Ku));Hu.prototype=Yu,Yu.constructor=Hu,Qa(Pa,Vu,Hu)}var $u=function(t,e){if("number"!=typeof t&&"Number"!=_s(t))throw TypeError(e);return+t},th=function t(e){var n=String(Ms(this)),r="",i=As(e);if(i<0||i==1/0)throw RangeError("Count can't be negative");for(;i>0;(i>>>=1)&&(n+=n))1&i&&(r+=n);return r},eh=1..toFixed,nh=Math.floor,rh=[0,0,0,0,0,0],ih="Number.toFixed: incorrect invocation!",oh="0",ah=function(t,e){for(var n=-1,r=e;++n<6;)r+=t*rh[n],rh[n]=r%1e7,r=nh(r/1e7)},sh=function(t){for(var e=6,n=0;--e>=0;)n+=rh[e],rh[e]=nh(n/t),n=n%t*1e7},ch=function(){for(var t=6,e="";--t>=0;)if(""!==e||0===t||0!==rh[t]){var n=String(rh[t]);e=""===e?n:e+th.call("0",7-n.length)+n}return e},uh=function(t,e,n){return 0===e?n:e%2==1?uh(t,e-1,n*t):uh(t*t,e/2,n)},hh=function(t){for(var e=0,n=t;n>=4096;)e+=12,n/=4096;for(;n>=2;)e+=1,n/=2;return e};ns(ns.P+ns.F*(!!eh&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!Ca(function(){eh.call({})})),"Number",{toFixed:function t(e){var n=$u(this,ih),r=As(e),i="",o="0",a,s,c,u;if(r<0||r>20)throw RangeError(ih);if(n!=n)return"NaN";if(n<=-1e21||n>=1e21)return String(n);if(n<0&&(i="-",n=-n),n>1e-21)if(a=hh(n*uh(2,69,1))-69,s=a<0?n*uh(2,-a,1):n/uh(2,a,1),s*=4503599627370496,(a=52-a)>0){for(ah(0,s),c=r;c>=7;)ah(1e7,0),c-=7;for(ah(uh(10,c,1),0),c=a-1;c>=23;)sh(1<<23),c-=23;sh(1<<c),ah(1,1),sh(2),o=ch()}else ah(0,s),ah(1<<-a,0),o=ch()+th.call("0",r);return o=r>0?i+((u=o.length)<=r?"0."+th.call("0",r-u)+o:o.slice(0,u-r)+"."+o.slice(u-r)):i+o}});var lh=1..toPrecision;ns(ns.P+ns.F*(Ca(function(){return"1"!==lh.call(1,void 0)})||!Ca(function(){lh.call({})})),"Number",{toPrecision:function t(e){var n=$u(this,"Number#toPrecision: incorrect invocation!");return void 0===e?lh.call(n):lh.call(n,e)}}),ns(ns.S,"Number",{EPSILON:Math.pow(2,-52)});var dh=Pa.isFinite;ns(ns.S,"Number",{isFinite:function t(e){return"number"==typeof e&&dh(e)}});var ph=Math.floor,fh=function t(e){return!Da(e)&&isFinite(e)&&ph(e)===e};ns(ns.S,"Number",{isInteger:fh}),ns(ns.S,"Number",{isNaN:function t(e){return e!=e}});var mh=Math.abs;ns(ns.S,"Number",{isSafeInteger:function t(e){return fh(e)&&mh(e)<=9007199254740991}}),ns(ns.S,"Number",{MAX_SAFE_INTEGER:9007199254740991}),ns(ns.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991}),ns(ns.S+ns.F*(Number.parseFloat!=Du),"Number",{parseFloat:Du}),ns(ns.S+ns.F*(Number.parseInt!=Ou),"Number",{parseInt:Ou});var vh=Math.log1p||function t(e){return(e=+e)>-1e-8&&e<1e-8?e-e*e/2:Math.log(1+e)},gh=Math.sqrt,yh=Math.acosh;ns(ns.S+ns.F*!(yh&&710==Math.floor(yh(Number.MAX_VALUE))&&yh(1/0)==1/0),"Math",{acosh:function t(e){return(e=+e)<1?NaN:e>94906265.62425156?Math.log(e)+Math.LN2:vh(e-1+gh(e-1)*gh(e+1))}});var xh=Math.asinh;ns(ns.S+ns.F*!(xh&&1/xh(0)>0),"Math",{asinh:e});var bh=Math.atanh;ns(ns.S+ns.F*!(bh&&1/bh(-0)<0),"Math",{atanh:function t(e){return 0==(e=+e)?e:Math.log((1+e)/(1-e))/2}});var wh=Math.sign||function t(e){return 0==(e=+e)||e!=e?e:e<0?-1:1};ns(ns.S,"Math",{cbrt:function t(e){return wh(e=+e)*Math.pow(Math.abs(e),1/3)}}),ns(ns.S,"Math",{clz32:function t(e){return(e>>>=0)?31-Math.floor(Math.log(e+.5)*Math.LOG2E):32}});var _h=Math.exp;ns(ns.S,"Math",{cosh:function t(e){return(_h(e=+e)+_h(-e))/2}});var Sh=Math.expm1,Mh=!Sh||Sh(10)>22025.465794806718||Sh(10)<22025.465794806718||-2e-17!=Sh(-2e-17)?function t(e){return 0==(e=+e)?e:e>-1e-6&&e<1e-6?e+e*e/2:Math.exp(e)-1}:Sh;ns(ns.S+ns.F*(Mh!=Math.expm1),"Math",{expm1:Mh});var Eh=Math.pow,Th=Eh(2,-52),Lh=Eh(2,-23),Ah=Eh(2,127)*(2-Lh),Ph=Eh(2,-126),Rh=function(t){return t+1/Th-1/Th},Ih=Math.fround||function t(e){var n=Math.abs(e),r=wh(e),i,o;return n<Ph?r*Rh(n/Ph/Lh)*Ph*Lh:(i=(1+Lh/Th)*n,(o=i-(i-n))>Ah||o!=o?r*(1/0):r*o)};ns(ns.S,"Math",{fround:Ih});var Ch=Math.abs;ns(ns.S,"Math",{hypot:function t(e,n){for(var r=0,i=0,o=arguments.length,a=0,s,c;i<o;)a<(s=Ch(arguments[i++]))?(r=r*(c=a/s)*c+1,a=s):r+=s>0?(c=s/a)*c:s;return a===1/0?1/0:a*Math.sqrt(r)}});var Oh=Math.imul;ns(ns.S+ns.F*Ca(function(){return-5!=Oh(4294967295,5)||2!=Oh.length}),"Math",{imul:function t(e,n){var r=65535,i=+e,o=+n,a=r&i,s=r&o;return 0|a*s+((r&i>>>16)*s+a*(r&o>>>16)<<16>>>0)}}),ns(ns.S,"Math",{log10:function t(e){return Math.log(e)*Math.LOG10E}}),ns(ns.S,"Math",{log1p:vh}),ns(ns.S,"Math",{log2:function t(e){return Math.log(e)/Math.LN2}}),ns(ns.S,"Math",{sign:wh});var Nh=Math.exp;ns(ns.S+ns.F*Ca(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function t(e){return Math.abs(e=+e)<1?(Mh(e)-Mh(-e))/2:(Nh(e-1)-Nh(-e-1))*(Math.E/2)}});var Fh=Math.exp;ns(ns.S,"Math",{tanh:function t(e){var n=Mh(e=+e),r=Mh(-e);return n==1/0?1:r==1/0?-1:(n-r)/(Fh(e)+Fh(-e))}}),ns(ns.S,"Math",{trunc:function t(e){return(e>0?Math.floor:Math.ceil)(e)}});var Dh=String.fromCharCode,Uh=String.fromCodePoint;ns(ns.S+ns.F*(!!Uh&&1!=Uh.length),"String",{fromCodePoint:function t(e){for(var n=[],r=arguments.length,i=0,o;r>i;){if(o=+arguments[i++],Os(o,1114111)!==o)throw RangeError(o+" is not a valid code point");n.push(o<65536?Dh(o):Dh(55296+((o-=65536)>>10),o%1024+56320))}return n.join("")}}),ns(ns.S,"String",{raw:function t(e){for(var n=Es(e.raw),r=Rs(n.length),i=arguments.length,o=[],a=0;r>a;)o.push(String(n[a++])),a<i&&o.push(String(arguments[a]));return o.join("")}}),Pu("trim",function(t){return function e(){return t(this,3)}});var Bh=function(t){return function(e,n){var r=String(Ms(e)),i=As(n),o=r.length,a,s;return i<0||i>=o?t?"":void 0:(a=r.charCodeAt(i))<55296||a>56319||i+1===o||(s=r.charCodeAt(i+1))<56320||s>57343?t?r.charAt(i):a:t?r.slice(i,i+2):s-56320+(a-55296<<10)+65536}},zh={},Gh={};Xa(Gh,ds("iterator"),function(){return this});var kh=function(t,e,n){t.prototype=ec(Gh,{next:Ya(1,n)}),ms(t,e+" Iterator")},jh=ds("iterator"),Vh=!([].keys&&"next"in[].keys()),Hh="@@iterator",Wh="keys",Yh="values",Xh=function(){return this},qh=function(t,e,n,r,i,o,a){kh(n,e,r);var s=function(t){if(!Vh&&t in l)return l[t];switch(t){case Wh:return function e(){return new n(this,t)};case Yh:return function e(){return new n(this,t)}}return function e(){return new n(this,t)}},c=e+" Iterator",u=i==Yh,h=!1,l=t.prototype,d=l[jh]||l[Hh]||i&&l[i],p=d||s(i),f=i?u?s("entries"):p:void 0,m="Array"==e?l.entries||d:d,v,g,y;if(m&&(y=Qc(m.call(new t)))!==Object.prototype&&y.next&&(ms(y,c,!0),Ia(y,jh)||Xa(y,jh,Xh)),u&&d&&d.name!==Yh&&(h=!0,p=function t(){return d.call(this)}),(Vh||h||!l[jh])&&Xa(l,jh,p),zh[e]=p,zh[c]=Xh,i)if(v={values:u?p:s(Yh),keys:o?p:s(Wh),entries:f},a)for(g in v)g in l||Qa(l,g,v[g]);else ns(ns.P+ns.F*(Vh||h),e,v);return v},Zh=Bh(!0);qh(String,"String",function(t){this._t=String(t),this._i=0},function(){var t=this._t,e=this._i,n;return e>=t.length?{value:void 0,done:!0}:(n=Zh(t,e),this._i+=n.length,{value:n,done:!1})});var Jh=Bh(!1);ns(ns.P,"String",{codePointAt:function t(e){return Jh(this,e)}});var Qh=ds("match"),Kh=function(t){var e;return Da(t)&&(void 0!==(e=t[Qh])?!!e:"RegExp"==_s(t))},$h=function(t,e,n){if(Kh(e))throw TypeError("String#"+n+" doesn't accept regex!");return String(Ms(t))},tl=ds("match"),el=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[tl]=!1,!"/./"[t](e)}catch(t){}}return!0},nl="endsWith",rl=""[nl];ns(ns.P+ns.F*el(nl),"String",{endsWith:function t(e){var n=$h(this,e,nl),r=arguments.length>1?arguments[1]:void 0,i=Rs(n.length),o=void 0===r?i:Math.min(Rs(r),i),a=String(e);return rl?rl.call(n,a,o):n.slice(o-a.length,o)===a}});var il="includes";ns(ns.P+ns.F*el(il),"String",{includes:function t(e){return!!~$h(this,e,il).indexOf(e,arguments.length>1?arguments[1]:void 0)}}),ns(ns.P,"String",{repeat:th});var ol="startsWith",al=""[ol];ns(ns.P+ns.F*el(ol),"String",{startsWith:function t(e){var n=$h(this,e,ol),r=Rs(Math.min(arguments.length>1?arguments[1]:void 0,n.length)),i=String(e);return al?al.call(n,i,r):n.slice(r,r+i.length)===i}});var sl=/"/g,cl=function(t,e,n,r){var i=String(Ms(t)),o="<"+e;return""!==n&&(o+=" "+n+'="'+String(r).replace(sl,"&quot;")+'"'),o+">"+i+"</"+e+">"},ul=function(t,e){var n={};n[t]=e(cl),ns(ns.P+ns.F*Ca(function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}),"String",n)};ul("anchor",function(t){return function e(n){return t(this,"a","name",n)}}),ul("big",function(t){return function e(){return t(this,"big","","")}}),ul("blink",function(t){return function e(){return t(this,"blink","","")}}),ul("bold",function(t){return function e(){return t(this,"b","","")}}),ul("fixed",function(t){return function e(){return t(this,"tt","","")}}),ul("fontcolor",function(t){return function e(n){return t(this,"font","color",n)}}),ul("fontsize",function(t){return function e(n){return t(this,"font","size",n)}}),ul("italics",function(t){return function e(){return t(this,"i","","")}}),ul("link",function(t){return function e(n){return t(this,"a","href",n)}}),ul("small",function(t){return function e(){return t(this,"small","","")}}),ul("strike",function(t){return function e(){return t(this,"strike","","")}}),ul("sub",function(t){return function e(){return t(this,"sub","","")}}),ul("sup",function(t){return function e(){return t(this,"sup","","")}}),ns(ns.S,"Date",{now:function(){return(new Date).getTime()}}),ns(ns.P+ns.F*Ca(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function t(e){var n=qc(this),r=ja(n);return"number"!=typeof r||isFinite(r)?n.toISOString():null}});var hl=Date.prototype.getTime,ll=Date.prototype.toISOString,dl=function(t){return t>9?t:"0"+t},pl=Ca(function(){return"0385-07-25T07:06:39.999Z"!=ll.call(new Date(-5e13-1))})||!Ca(function(){ll.call(new Date(NaN))})?function t(){if(!isFinite(hl.call(this)))throw RangeError("Invalid time value");var e=this,n=this.getUTCFullYear(),r=this.getUTCMilliseconds(),i=n<0?"-":n>9999?"+":"";return i+("00000"+Math.abs(n)).slice(i?-6:-4)+"-"+dl(this.getUTCMonth()+1)+"-"+dl(this.getUTCDate())+"T"+dl(this.getUTCHours())+":"+dl(this.getUTCMinutes())+":"+dl(this.getUTCSeconds())+"."+(r>99?r:"0"+dl(r))+"Z"}:ll;ns(ns.P+ns.F*(Date.prototype.toISOString!==pl),"Date",{toISOString:pl});var fl=Date.prototype,ml="Invalid Date",vl="toString",gl=fl[vl],yl=fl.getTime;new Date(NaN)+""!=ml&&Qa(fl,vl,function t(){var e=yl.call(this);return e==e?gl.call(this):ml});var xl="number",bl=function(t){if("string"!==t&&t!==xl&&"default"!==t)throw TypeError("Incorrect hint");return ja(Ua(this),t!=xl)},wl=ds("toPrimitive"),_l=Date.prototype;wl in _l||Xa(_l,wl,bl),ns(ns.S,"Array",{isArray:Xs});var Sl=function(t,e,n,r){try{return r?e(Ua(n)[0],n[1]):e(n)}catch(e){var i=t.return;throw void 0!==i&&Ua(i.call(t)),e}},Ml=ds("iterator"),El=Array.prototype,Tl=function(t){return void 0!==t&&(zh.Array===t||El[Ml]===t)},Ll=function(t,e,n){e in t?Wa.f(t,e,Ya(0,n)):t[e]=n},Al=ds("iterator"),Pl=Na.getIteratorMethod=function(t){if(void 0!=t)return t[Al]||t["@@iterator"]||zh[uu(t)]},Rl=ds("iterator"),Il=!1;try{var Cl;[7][Rl]().return=function(){Il=!0}}catch(t){}var Ol=function(t,e){if(!e&&!Il)return!1;var n=!1;try{var r=[7],i=r[Rl]();i.next=function(){return{done:n=!0}},r[Rl]=function(){return i},t(r)}catch(t){}return n};ns(ns.S+ns.F*!Ol(function(t){}),"Array",{from:function t(e){var n=qc(e),r="function"==typeof this?this:Array,i=arguments.length,o=i>1?arguments[1]:void 0,a=void 0!==o,s=0,c=Pl(n),u,h,l,d;if(a&&(o=$a(o,i>2?arguments[2]:void 0,2)),void 0==c||r==Array&&Tl(c))for(h=new r(u=Rs(n.length));u>s;s++)Ll(h,s,a?o(n[s],s):n[s]);else for(d=c.call(n),h=new r;!(l=d.next()).done;s++)Ll(h,s,a?Sl(d,o,[l.value,s],!0):l.value);return h.length=s,h}}),ns(ns.S+ns.F*Ca(function(){function t(){}return!(Array.of.call(t)instanceof t)}),"Array",{of:function t(){for(var e=0,n=arguments.length,r=new("function"==typeof this?this:Array)(n);n>e;)Ll(r,e,arguments[e++]);return r.length=n,r}});var Nl=function(t,e){return!!t&&Ca(function(){e?t.call(null,function(){},1):t.call(null)})},Fl=[].join;ns(ns.P+ns.F*(Ss!=Object||!Nl(Fl)),"Array",{join:function t(e){return Fl.call(Es(this),void 0===e?",":e)}});var Dl=[].slice;ns(ns.P+ns.F*Ca(function(){Js&&Dl.call(Js)}),"Array",{slice:function t(e,n){var r=Rs(this.length),i=_s(this);if(n=void 0===n?r:n,"Array"==i)return Dl.call(this,e,n);for(var o=Os(e,r),a=Os(n,r),s=Rs(a-o),c=Array(s),u=0;u<s;u++)c[u]="String"==i?this.charAt(o+u):this[o+u];return c}});var Ul=[].sort,Bl=[1,2,3];ns(ns.P+ns.F*(Ca(function(){Bl.sort(void 0)})||!Ca(function(){Bl.sort(null)})||!Nl(Ul)),"Array",{sort:function t(e){return void 0===e?Ul.call(qc(this)):Ul.call(qc(this),Ka(e))}});var zl=ds("species"),Gl=function(t){var e;return Xs(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!Xs(e.prototype)||(e=void 0),Da(e)&&null===(e=e[zl])&&(e=void 0)),void 0===e?Array:e},kl=function(t,e){return new(Gl(t))(e)},jl=function(t,e){var n=1==t,r=2==t,i=3==t,o=4==t,a=6==t,s=5==t||a,c=e||kl;return function(e,u,h){for(var l=qc(e),d=Ss(l),p=$a(u,h,3),f=Rs(d.length),m=0,v=n?c(e,f):r?c(e,0):void 0,g,y;f>m;m++)if((s||m in d)&&(g=d[m],y=p(g,m,l),t))if(n)v[m]=y;else if(y)switch(t){case 3:return!0;case 5:return g;case 6:return m;case 2:v.push(g)}else if(o)return!1;return a?-1:i||o?o:v}},Vl=jl(0),Hl=Nl([].forEach,!0);ns(ns.P+ns.F*!Hl,"Array",{forEach:function t(e){return Vl(this,e,arguments[1])}});var Wl=jl(1);ns(ns.P+ns.F*!Nl([].map,!0),"Array",{map:function t(e){return Wl(this,e,arguments[1])}});var Yl=jl(2);ns(ns.P+ns.F*!Nl([].filter,!0),"Array",{filter:function t(e){return Yl(this,e,arguments[1])}});var Xl=jl(3);ns(ns.P+ns.F*!Nl([].some,!0),"Array",{some:function t(e){return Xl(this,e,arguments[1])}});var ql=jl(4);ns(ns.P+ns.F*!Nl([].every,!0),"Array",{every:function t(e){return ql(this,e,arguments[1])}});var Zl=function(t,e,n,r,i){Ka(e);var o=qc(t),a=Ss(o),s=Rs(o.length),c=i?s-1:0,u=i?-1:1;if(n<2)for(;;){if(c in a){r=a[c],c+=u;break}if(c+=u,i?c<0:s<=c)throw TypeError("Reduce of empty array with no initial value")}for(;i?c>=0:s>c;c+=u)c in a&&(r=e(r,a[c],c,o));return r};ns(ns.P+ns.F*!Nl([].reduce,!0),"Array",{reduce:function t(e){return Zl(this,e,arguments.length,arguments[1],!1)}}),ns(ns.P+ns.F*!Nl([].reduceRight,!0),"Array",{reduceRight:function t(e){return Zl(this,e,arguments.length,arguments[1],!0)}});var Jl=Ns(!1),Ql=[].indexOf,Kl=!!Ql&&1/[1].indexOf(1,-0)<0;ns(ns.P+ns.F*(Kl||!Nl(Ql)),"Array",{indexOf:function t(e){return Kl?Ql.apply(this,arguments)||0:Jl(this,e,arguments[1])}});var $l=[].lastIndexOf,td=!!$l&&1/[1].lastIndexOf(1,-0)<0;ns(ns.P+ns.F*(td||!Nl($l)),"Array",{lastIndexOf:function t(e){if(td)return $l.apply(this,arguments)||0;var n=Es(this),r=Rs(n.length),i=r-1;for(arguments.length>1&&(i=Math.min(i,As(arguments[1]))),i<0&&(i=r+i);i>=0;i--)if(i in n&&n[i]===e)return i||0;return-1}});var ed=[].copyWithin||function t(e,n){var r=qc(this),i=Rs(r.length),o=Os(e,i),a=Os(n,i),s=arguments.length>2?arguments[2]:void 0,c=Math.min((void 0===s?i:Os(s,i))-a,i-o),u=1;for(a<o&&o<a+c&&(u=-1,a+=c-1,o+=c-1);c-- >0;)a in r?r[o]=r[a]:delete r[o],o+=u,a+=u;return r},nd=ds("unscopables"),rd=Array.prototype;void 0==rd[nd]&&Xa(rd,nd,{});var id=function(t){rd[nd][t]=!0};ns(ns.P,"Array",{copyWithin:ed}),id("copyWithin");var od=function t(e){for(var n=qc(this),r=Rs(n.length),i=arguments.length,o=Os(i>1?arguments[1]:void 0,r),a=i>2?arguments[2]:void 0,s=void 0===a?r:Os(a,r);s>o;)n[o++]=e;return n};ns(ns.P,"Array",{fill:od}),id("fill");var ad=jl(5),sd="find",cd=!0;sd in[]&&Array(1).find(function(){cd=!1}),ns(ns.P+ns.F*cd,"Array",{find:function t(e){return ad(this,e,arguments.length>1?arguments[1]:void 0)}}),id(sd);var ud=jl(6),hd="findIndex",ld=!0;hd in[]&&Array(1)[hd](function(){ld=!1}),ns(ns.P+ns.F*ld,"Array",{findIndex:function t(e){return ud(this,e,arguments.length>1?arguments[1]:void 0)}}),id(hd);var dd=ds("species"),pd=function(t){var e=Pa[t];Oa&&e&&!e[dd]&&Wa.f(e,dd,{configurable:!0,get:function(){return this}})};pd("Array");var fd=function(t,e){return{value:e,done:!!t}},md=qh(Array,"Array",function(t,e){this._t=Es(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,fd(1)):fd(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values");zh.Arguments=zh.Array,id("keys"),id("values"),id("entries");var vd=function(){var t=Ua(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e},gd=Wa.f,yd=ic.f,xd=Pa.RegExp,bd=xd,wd=xd.prototype,_d=/a/g,Sd=/a/g,Md=new xd(_d)!==_d;if(Oa&&(!Md||Ca(function(){return Sd[ds("match")]=!1,xd(_d)!=_d||xd(Sd)==Sd||"/a/i"!=xd(_d,"i")}))){xd=function t(e,n){var r=this instanceof xd,i=Kh(e),o=void 0===n;return!r&&i&&e.constructor===xd&&o?e:Bu(Md?new bd(i&&!o?e.source:e,n):bd((i=e instanceof xd)?e.source:e,i&&o?vd.call(e):n),r?this:wd,xd)};for(var Ed=function(t){t in xd||gd(xd,t,{configurable:!0,get:function(){return bd[t]},set:function(e){bd[t]=e}})},Td=yd(bd),Ld=0;Td.length>Ld;)Ed(Td[Ld++]);wd.constructor=xd,xd.prototype=wd,Qa(Pa,"RegExp",xd)}pd("RegExp"),Oa&&"g"!=/./g.flags&&Wa.f(RegExp.prototype,"flags",{configurable:!0,get:vd});var Ad="toString",Pd=/./[Ad],Rd=function(t){Qa(RegExp.prototype,Ad,t,!0)};Ca(function(){return"/a/b"!=Pd.call({source:"a",flags:"b"})})?Rd(function t(){var e=Ua(this);return"/".concat(e.source,"/","flags"in e?e.flags:!Oa&&e instanceof RegExp?vd.call(e):void 0)}):Pd.name!=Ad&&Rd(function t(){return Pd.call(this)});var Id=function(t,e,n){var r=ds(t),i=n(Ms,r,""[t]),o=i[0],a=i[1];Ca(function(){var e={};return e[r]=function(){return 7},7!=""[t](e)})&&(Qa(String.prototype,t,o),Xa(RegExp.prototype,r,2==e?function(t,e){return a.call(t,this,e)}:function(t){return a.call(t,this)}))};Id("match",1,function(t,e,n){return[function n(r){var i=t(this),o=void 0==r?void 0:r[e];return void 0!==o?o.call(r,i):new RegExp(r)[e](String(i))},n]}),Id("replace",2,function(t,e,n){return[function r(i,o){var a=t(this),s=void 0==i?void 0:i[e];return void 0!==s?s.call(i,a,o):n.call(String(a),i,o)},n]}),Id("search",1,function(t,e,n){return[function n(r){var i=t(this),o=void 0==r?void 0:r[e];return void 0!==o?o.call(r,i):new RegExp(r)[e](String(i))},n]}),Id("split",2,function(t,e,n){var r=Kh,i=n,o=[].push,a="split",s="length",c="lastIndex";if("c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length){var u=void 0===/()??/.exec("")[1];n=function(t,e){var n=String(this);if(void 0===t&&0===e)return[];if(!r(t))return i.call(n,t,e);var a=[],s=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),h=0,l=void 0===e?4294967295:e>>>0,d=new RegExp(t.source,s+"g"),p,f,m,v,g;for(u||(p=new RegExp("^"+d.source+"$(?!\\s)",s));(f=d.exec(n))&&!((m=f.index+f[0].length)>h&&(a.push(n.slice(h,f.index)),!u&&f.length>1&&f[0].replace(p,function(){for(g=1;g<arguments.length-2;g++)void 0===arguments[g]&&(f[g]=void 0)}),f.length>1&&f.index<n.length&&o.apply(a,f.slice(1)),v=f[0].length,h=m,a.length>=l));)d[c]===f.index&&d[c]++;return h===n.length?!v&&d.test("")||a.push(""):a.push(n.slice(h)),a.length>l?a.slice(0,l):a}}else"0".split(void 0,0).length&&(n=function(t,e){return void 0===t&&0===e?[]:i.call(this,t,e)});return[function r(i,o){var a=t(this),s=void 0==i?void 0:i[e];return void 0!==s?s.call(i,a,o):n.call(String(a),i,o)},n]});var Cd=function(t,e,n,r){if(!(t instanceof e)||void 0!==r&&r in t)throw TypeError(n+": incorrect invocation!");return t},Od=t(function(t){var e={},n={},r=t.exports=function(t,r,i,o,a){var s=a?function(){return t}:Pl(t),c=$a(i,o,r?2:1),u=0,h,l,d,p;if("function"!=typeof s)throw TypeError(t+" is not iterable!");if(Tl(s)){for(h=Rs(t.length);h>u;u++)if((p=r?c(Ua(l=t[u])[0],l[1]):c(t[u]))===e||p===n)return p}else for(d=s.call(t);!(l=d.next()).done;)if((p=Sl(d,c,l.value,r))===e||p===n)return p};r.BREAK=e,r.RETURN=n}),Nd=ds("species"),Fd=function(t,e){var n=Ua(t).constructor,r;return void 0===n||void 0==(r=Ua(n)[Nd])?e:Ka(r)},Dd=Pa.process,Ud=Pa.setImmediate,Bd=Pa.clearImmediate,zd=Pa.MessageChannel,Gd=Pa.Dispatch,kd=0,jd={},Vd="onreadystatechange",Hd,Wd,Yd,Xd=function(){var t=+this;if(jd.hasOwnProperty(t)){var e=jd[t];delete jd[t],e()}},qd=function(t){Xd.call(t.data)};Ud&&Bd||(Ud=function t(e){for(var n=[],r=1;arguments.length>r;)n.push(arguments[r++]);return jd[++kd]=function(){lu("function"==typeof e?e:Function(e),n)},Hd(kd),kd},Bd=function t(e){delete jd[e]},"process"==_s(Dd)?Hd=function(t){Dd.nextTick($a(Xd,t,1))}:Gd&&Gd.now?Hd=function(t){Gd.now($a(Xd,t,1))}:zd?(Yd=(Wd=new zd).port2,Wd.port1.onmessage=qd,Hd=$a(Yd.postMessage,Yd,1)):Pa.addEventListener&&"function"==typeof postMessage&&!Pa.importScripts?(Hd=function(t){Pa.postMessage(t+"","*")},Pa.addEventListener("message",qd,!1)):Hd=Vd in Ga("script")?function(t){Js.appendChild(Ga("script"))[Vd]=function(){Js.removeChild(this),Xd.call(t)}}:function(t){setTimeout($a(Xd,t,1),0)});var Zd={set:Ud,clear:Bd},Jd=Zd.set,Qd=Pa.MutationObserver||Pa.WebKitMutationObserver,Kd=Pa.process,$d=Pa.Promise,tp="process"==_s(Kd),ep=function(){var t,e,n,r=function(){var r,i;for(tp&&(r=Kd.domain)&&r.exit();t;){i=t.fn,t=t.next;try{i()}catch(r){throw t?n():e=void 0,r}}e=void 0,r&&r.enter()};if(tp)n=function(){Kd.nextTick(r)};else if(Qd){var i=!0,o=document.createTextNode("");new Qd(r).observe(o,{characterData:!0}),n=function(){o.data=i=!i}}else if($d&&$d.resolve){var a=$d.resolve();n=function(){a.then(r)}}else n=function(){Jd.call(Pa,r)};return function(r){var i={fn:r,next:void 0};e&&(e.next=i),t||(t=i,n()),e=i}},np,rp={f:function(t){return new n(t)}},ip=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}},op=function(t,e){if(Ua(t),Da(e)&&e.constructor===t)return e;var n=rp.f(t),r;return(0,n.resolve)(e),n.promise},ap=function(t,e,n){for(var r in e)Qa(t,r,e[r],n);return t},sp=Zd.set,cp=ep(),up="Promise",hp=Pa.TypeError,lp=Pa.process,dp=Pa[up],pp="process"==uu(lp),fp=function(){},mp,vp,gp,yp,xp=vp=rp.f,bp=!!function(){try{var t=dp.resolve(1),e=(t.constructor={})[ds("species")]=function(t){t(fp,fp)};return(pp||"function"==typeof PromiseRejectionEvent)&&t.then(fp)instanceof e}catch(t){}}(),wp=function(t){var e;return!(!Da(t)||"function"!=typeof(e=t.then))&&e},_p=function(t,e){if(!t._n){t._n=!0;var n=t._c;cp(function(){for(var r=t._v,i=1==t._s,o=0,a=function(e){var n=i?e.ok:e.fail,o=e.resolve,a=e.reject,s=e.domain,c,u;try{n?(i||(2==t._h&&Ep(t),t._h=1),!0===n?c=r:(s&&s.enter(),c=n(r),s&&s.exit()),c===e.promise?a(hp("Promise-chain cycle")):(u=wp(c))?u.call(c,o,a):o(c)):a(r)}catch(t){a(t)}};n.length>o;)a(n[o++]);t._c=[],t._n=!1,e&&!t._h&&Sp(t)})}},Sp=function(t){sp.call(Pa,function(){var e=t._v,n=Mp(t),r,i,o;if(n&&(r=ip(function(){pp?lp.emit("unhandledRejection",e,t):(i=Pa.onunhandledrejection)?i({promise:t,reason:e}):(o=Pa.console)&&o.error&&o.error("Unhandled promise rejection",e)}),t._h=pp||Mp(t)?2:1),t._a=void 0,n&&r.e)throw r.v})},Mp=function(t){if(1==t._h)return!1;for(var e=t._a||t._c,n=0,r;e.length>n;)if((r=e[n++]).fail||!Mp(r.promise))return!1;return!0},Ep=function(t){sp.call(Pa,function(){var e;pp?lp.emit("rejectionHandled",t):(e=Pa.onrejectionhandled)&&e({promise:t,reason:t._v})})},Tp=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),_p(e,!0))},Lp=function(t){var e=this,n;if(!e._d){e._d=!0,e=e._w||e;try{if(e===t)throw hp("Promise can't be resolved itself");(n=wp(t))?cp(function(){var r={_w:e,_d:!1};try{n.call(t,$a(Lp,r,1),$a(Tp,r,1))}catch(t){Tp.call(r,t)}}):(e._v=t,e._s=1,_p(e,!1))}catch(t){Tp.call({_w:e,_d:!1},t)}}};bp||(dp=function t(e){Cd(this,dp,up,"_h"),Ka(e),mp.call(this);try{e($a(Lp,this,1),$a(Tp,this,1))}catch(t){Tp.call(this,t)}},(mp=function t(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=ap(dp.prototype,{then:function t(e,n){var r=xp(Fd(this,dp));return r.ok="function"!=typeof e||e,r.fail="function"==typeof n&&n,r.domain=pp?lp.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&_p(this,!1),r.promise},catch:function(t){return this.then(void 0,t)}}),gp=function(){var t=new mp;this.promise=t,this.resolve=$a(Lp,t,1),this.reject=$a(Tp,t,1)},rp.f=xp=function(t){return t===dp||t===yp?new gp(t):vp(t)}),ns(ns.G+ns.W+ns.F*!bp,{Promise:dp}),ms(dp,up),pd(up),yp=Na[up],ns(ns.S+ns.F*!bp,up,{reject:function t(e){var n=xp(this),r;return(0,n.reject)(e),n.promise}}),ns(ns.S+ns.F*!bp,up,{resolve:function t(e){return op(this,e)}}),ns(ns.S+ns.F*!(bp&&Ol(function(t){dp.all(t).catch(fp)})),up,{all:function t(e){var n=this,r=xp(n),i=r.resolve,o=r.reject,a=ip(function(){var t=[],r=0,a=1;Od(e,!1,function(e){var s=r++,c=!1;t.push(void 0),a++,n.resolve(e).then(function(e){c||(c=!0,t[s]=e,--a||i(t))},o)}),--a||i(t)});return a.e&&o(a.v),r.promise},race:function t(e){var n=this,r=xp(n),i=r.reject,o=ip(function(){Od(e,!1,function(t){n.resolve(t).then(r.resolve,i)})});return o.e&&i(o.v),r.promise}});var Ap=function(t,e){if(!Da(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t},Pp=Wa.f,Rp=rs.fastKey,Ip=Oa?"_s":"size",Cp=function(t,e){var n=Rp(e),r;if("F"!==n)return t._i[n];for(r=t._f;r;r=r.n)if(r.k==e)return r},Op={getConstructor:function(t,e,n,r){var i=t(function(t,o){Cd(t,i,e,"_i"),t._t=e,t._i=ec(null),t._f=void 0,t._l=void 0,t[Ip]=0,void 0!=o&&Od(o,n,t[r],t)});return ap(i.prototype,{clear:function t(){for(var n=Ap(this,e),r=n._i,i=n._f;i;i=i.n)i.r=!0,i.p&&(i.p=i.p.n=void 0),delete r[i.i];n._f=n._l=void 0,n[Ip]=0},delete:function(t){var n=Ap(this,e),r=Cp(n,t);if(r){var i=r.n,o=r.p;delete n._i[r.i],r.r=!0,o&&(o.n=i),i&&(i.p=o),n._f==r&&(n._f=i),n._l==r&&(n._l=o),n[Ip]--}return!!r},forEach:function t(n){Ap(this,e);for(var r=$a(n,arguments.length>1?arguments[1]:void 0,3),i;i=i?i.n:this._f;)for(r(i.v,i.k,this);i&&i.r;)i=i.p},has:function t(n){return!!Cp(Ap(this,e),n)}}),Oa&&Pp(i.prototype,"size",{get:function(){return Ap(this,e)[Ip]}}),i},def:function(t,e,n){var r=Cp(t,e),i,o;return r?r.v=n:(t._l=r={i:o=Rp(e,!0),k:e,v:n,p:i=t._l,n:void 0,r:!1},t._f||(t._f=r),i&&(i.n=r),t[Ip]++,"F"!==o&&(t._i[o]=r)),t},getEntry:Cp,setStrong:function(t,e,n){qh(t,e,function(t,n){this._t=Ap(t,e),this._k=n,this._l=void 0},function(){for(var t=this,e=this._k,n=this._l;n&&n.r;)n=n.p;return this._t&&(this._l=n=n?n.n:this._t._f)?fd(0,"keys"==e?n.k:"values"==e?n.v:[n.k,n.v]):(this._t=void 0,fd(1))},n?"entries":"values",!n,!0),pd(e)}},Np=function(t,e,n,r,i,o){var a=Pa[t],s=a,c=i?"set":"add",u=s&&s.prototype,h={},l=function(t){var e=u[t];Qa(u,t,"delete"==t?function(t){return!(o&&!Da(t))&&e.call(this,0===t?0:t)}:"has"==t?function t(n){return!(o&&!Da(n))&&e.call(this,0===n?0:n)}:"get"==t?function t(n){return o&&!Da(n)?void 0:e.call(this,0===n?0:n)}:"add"==t?function t(n){return e.call(this,0===n?0:n),this}:function t(n,r){return e.call(this,0===n?0:n,r),this})};if("function"==typeof s&&(o||u.forEach&&!Ca(function(){(new s).entries().next()}))){var d=new s,p=d[c](o?{}:-0,1)!=d,f=Ca(function(){d.has(1)}),m=Ol(function(t){new s(t)}),v=!o&&Ca(function(){for(var t=new s,e=5;e--;)t[c](e,e);return!t.has(-0)});m||((s=e(function(e,n){Cd(e,s,t);var r=Bu(new a,e,s);return void 0!=n&&Od(n,i,r[c],r),r})).prototype=u,u.constructor=s),(f||v)&&(l("delete"),l("has"),i&&l("get")),(v||p)&&l(c),o&&u.clear&&delete u.clear}else s=r.getConstructor(e,t,i,c),ap(s.prototype,n),rs.NEED=!0;return ms(s,t),h[t]=s,ns(ns.G+ns.W+ns.F*(s!=a),h),o||r.setStrong(s,t,i),s},Fp="Map",Dp=Np("Map",function(t){return function e(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function t(e){var n=Op.getEntry(Ap(this,"Map"),e);return n&&n.v},set:function t(e,n){return Op.def(Ap(this,"Map"),0===e?0:e,n)}},Op,!0),Up="Set",Bp=Np("Set",function(t){return function e(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function t(e){return Op.def(Ap(this,"Set"),e=0===e?0:e,e)}},Op),zp=rs.getWeak,Gp=jl(5),kp=jl(6),jp=0,Vp=function(t){return t._l||(t._l=new Hp)},Hp=function(){this.a=[]},Wp=function(t,e){return Gp(t.a,function(t){return t[0]===e})};Hp.prototype={get:function(t){var e=Wp(this,t);if(e)return e[1]},has:function(t){return!!Wp(this,t)},set:function(t,e){var n=Wp(this,t);n?n[1]=e:this.a.push([t,e])},delete:function(t){var e=kp(this.a,function(e){return e[0]===t});return~e&&this.a.splice(e,1),!!~e}};var Yp={getConstructor:function(t,e,n,r){var i=t(function(t,o){Cd(t,i,e,"_i"),t._t=e,t._i=jp++,t._l=void 0,void 0!=o&&Od(o,n,t[r],t)});return ap(i.prototype,{delete:function(t){if(!Da(t))return!1;var n=zp(t);return!0===n?Vp(Ap(this,e)).delete(t):n&&Ia(n,this._i)&&delete n[this._i]},has:function t(n){if(!Da(n))return!1;var r=zp(n);return!0===r?Vp(Ap(this,e)).has(n):r&&Ia(r,this._i)}}),i},def:function(t,e,n){var r=zp(Ua(e),!0);return!0===r?Vp(t).set(e,n):r[t._i]=n,t},ufstore:Vp},Xp=t(function(t){var e=jl(0),n="WeakMap",r=rs.getWeak,i=Object.isExtensible,o=Yp.ufstore,a={},s,c=function(t){return function e(){return t(this,arguments.length>0?arguments[0]:void 0)}},u={get:function t(e){if(Da(e)){var i=r(e);return!0===i?o(Ap(this,n)).get(e):i?i[this._i]:void 0}},set:function t(e,r){return Yp.def(Ap(this,n),e,r)}},h=t.exports=Np(n,c,u,Yp,!0,!0);Ca(function(){return 7!=(new h).set((Object.freeze||Object)(a),7).get(a)})&&(s=Yp.getConstructor(c,n),nu(s.prototype,u),rs.NEED=!0,e(["delete","has","get","set"],function(t){var e=h.prototype,n=e[t];Qa(e,t,function(e,r){if(Da(e)&&!i(e)){this._f||(this._f=new s);var o=this._f[t](e,r);return"set"==t?this:o}return n.call(this,e,r)})}))}),qp="WeakSet";Np(qp,function(t){return function e(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function t(e){return Yp.def(Ap(this,qp),e,!0)}},Yp,!1,!0);for(var Zp=Ja("typed_array"),Jp=Ja("view"),Qp=!(!Pa.ArrayBuffer||!Pa.DataView),Kp=Qp,$p=0,tf=9,ef,nf="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");$p<9;)(ef=Pa[nf[$p++]])?(Xa(ef.prototype,Zp,!0),Xa(ef.prototype,Jp,!0)):Kp=!1;var rf={ABV:Qp,CONSTR:Kp,TYPED:Zp,VIEW:Jp},of=function(t){if(void 0===t)return 0;var e=As(t),n=Rs(e);if(e!==n)throw RangeError("Wrong length!");return n},af=t(function(t,e){function n(t,e,n){var r=Array(n),i=8*n-e-1,o=(1<<i)-1,a=o>>1,s=23===e?L(2,-24)-L(2,-77):0,c=0,u=t<0||0===t&&1/t<0?1:0,h,l,d;for((t=T(t))!=t||t===M?(l=t!=t?1:0,h=o):(h=A(P(t)/R),t*(d=L(2,-h))<1&&(h--,d*=2),(t+=h+a>=1?s/d:s*L(2,1-a))*d>=2&&(h++,d/=2),h+a>=o?(l=0,h=o):h+a>=1?(l=(t*d-1)*L(2,e),h+=a):(l=t*L(2,a-1)*L(2,e),h=0));e>=8;r[c++]=255&l,l/=256,e-=8);for(h=h<<e|l,i+=e;i>0;r[c++]=255&h,h/=256,i-=8);return r[--c]|=128*u,r}function r(t,e,n){var r=8*n-e-1,i=(1<<r)-1,o=i>>1,a=r-7,s=n-1,c=t[s--],u=127&c,h;for(c>>=7;a>0;u=256*u+t[s],s--,a-=8);for(h=u&(1<<-a)-1,u>>=-a,a+=e;a>0;h=256*h+t[s],s--,a-=8);if(0===u)u=1-o;else{if(u===i)return h?NaN:c?-M:M;h+=L(2,e),u-=o}return(c?-1:1)*h*L(2,u-e)}function i(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]}function o(t){return[255&t]}function a(t){return[255&t,t>>8&255]}function s(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function c(t){return n(t,52,8)}function u(t){return n(t,23,4)}function h(t,e,n){f(t[g],e,{get:function(){return this[n]}})}function l(t,e,n,r){var i,o=of(+n);if(o+e>t[F])throw S(x);var a=t[N]._b,s=o+t[D],c=a.slice(s,s+e);return r?c:c.reverse()}function d(t,e,n,r,i,o){var a,s=of(+n);if(s+e>t[F])throw S(x);for(var c=t[N]._b,u=s+t[D],h=r(+i),l=0;l<e;l++)c[u+l]=h[o?l:e-l-1]}var p=ic.f,f=Wa.f,m="ArrayBuffer",v="DataView",g="prototype",y="Wrong length!",x="Wrong index!",b=Pa[m],w=Pa[v],_=Pa.Math,S=Pa.RangeError,M=Pa.Infinity,E=b,T=_.abs,L=_.pow,A=_.floor,P=_.log,R=_.LN2,I="buffer",C="byteLength",O="byteOffset",N=Oa?"_b":I,F=Oa?"_l":C,D=Oa?"_o":O;if(rf.ABV){if(!Ca(function(){b(1)})||!Ca(function(){new b(-1)})||Ca(function(){return new b,new b(1.5),new b(NaN),b.name!=m})){for(var U=(b=function t(e){return Cd(this,b),new E(of(e))})[g]=E[g],B=p(E),z=0,G;B.length>z;)(G=B[z++])in b||Xa(b,G,E[G]);U.constructor=b}var k=new w(new b(2)),j=w[g].setInt8;k.setInt8(0,2147483648),k.setInt8(1,2147483649),!k.getInt8(0)&&k.getInt8(1)||ap(w[g],{setInt8:function t(e,n){j.call(this,e,n<<24>>24)},setUint8:function t(e,n){j.call(this,e,n<<24>>24)}},!0)}else b=function t(e){Cd(this,b,m);var n=of(e);this._b=od.call(Array(n),0),this[F]=n},w=function t(e,n,r){Cd(this,w,v),Cd(e,b,v);var i=e[F],o=As(n);if(o<0||o>i)throw S("Wrong offset!");if(r=void 0===r?i-o:Rs(r),o+r>i)throw S(y);this[N]=e,this[D]=o,this[F]=r},Oa&&(h(b,C,"_l"),h(w,I,"_b"),h(w,C,"_l"),h(w,O,"_o")),ap(w[g],{getInt8:function t(e){return l(this,1,e)[0]<<24>>24},getUint8:function t(e){return l(this,1,e)[0]},getInt16:function t(e){var n=l(this,2,e,arguments[1]);return(n[1]<<8|n[0])<<16>>16},getUint16:function t(e){var n=l(this,2,e,arguments[1]);return n[1]<<8|n[0]},getInt32:function t(e){return i(l(this,4,e,arguments[1]))},getUint32:function t(e){return i(l(this,4,e,arguments[1]))>>>0},getFloat32:function t(e){return r(l(this,4,e,arguments[1]),23,4)},getFloat64:function t(e){return r(l(this,8,e,arguments[1]),52,8)},setInt8:function t(e,n){d(this,1,e,o,n)},setUint8:function t(e,n){d(this,1,e,o,n)},setInt16:function t(e,n){d(this,2,e,a,n,arguments[2])},setUint16:function t(e,n){d(this,2,e,a,n,arguments[2])},setInt32:function t(e,n){d(this,4,e,s,n,arguments[2])},setUint32:function t(e,n){d(this,4,e,s,n,arguments[2])},setFloat32:function t(e,n){d(this,4,e,u,n,arguments[2])},setFloat64:function t(e,n){d(this,8,e,c,n,arguments[2])}});ms(b,m),ms(w,v),Xa(w[g],rf.VIEW,!0),e[m]=b,e[v]=w}),sf=Pa.ArrayBuffer,cf=af.ArrayBuffer,uf=af.DataView,hf=rf.ABV&&sf.isView,lf=cf.prototype.slice,df=rf.VIEW,pf="ArrayBuffer";ns(ns.G+ns.W+ns.F*(sf!==cf),{ArrayBuffer:cf}),ns(ns.S+ns.F*!rf.CONSTR,pf,{isView:function t(e){return hf&&hf(e)||Da(e)&&df in e}}),ns(ns.P+ns.U+ns.F*Ca(function(){return!new cf(2).slice(1,void 0).byteLength}),pf,{slice:function t(e,n){if(void 0!==lf&&void 0===n)return lf.call(Ua(this),e);for(var r=Ua(this).byteLength,i=Os(e,r),o=Os(void 0===n?r:n,r),a=new(Fd(this,cf))(Rs(o-i)),s=new uf(this),c=new uf(a),u=0;i<o;)c.setUint8(u++,s.getUint8(i++));return a}}),pd(pf),ns(ns.G+ns.W+ns.F*!rf.ABV,{DataView:af.DataView});var ff=t(function(t){if(Oa){var e=!1,n=Pa,r=Ca,i=ns,o=rf,a=af,s=$a,c=Cd,u=Ya,h=Xa,l=ap,d=As,p=Rs,f=of,m=Os,v=ja,g=Ia,y=uu,x=Da,b=qc,w=Tl,_=ec,S=Qc,M=ic.f,E=Pl,T=Ja,L=ds,A=jl,P=Ns,R=Fd,I=md,C=zh,O=Ol,N=pd,F=od,D=ed,U=Wa,B=pc,z=U.f,G=B.f,k=n.RangeError,j=n.TypeError,V=n.Uint8Array,H="ArrayBuffer",W="Shared"+H,Y="BYTES_PER_ELEMENT",X="prototype",q=Array[X],Z=a.ArrayBuffer,J=a.DataView,Q=A(0),K=A(2),$=A(3),tt=A(4),et=A(5),nt=A(6),rt=P(!0),it=P(!1),ot=I.values,at=I.keys,st=I.entries,ct=q.lastIndexOf,ut=q.reduce,ht=q.reduceRight,lt=q.join,dt=q.sort,pt=q.slice,ft=q.toString,mt=q.toLocaleString,vt=L("iterator"),gt=L("toStringTag"),yt=T("typed_constructor"),xt=T("def_constructor"),bt=o.CONSTR,wt=o.TYPED,_t=o.VIEW,St="Wrong length!",Mt=A(1,function(t,e){return Pt(R(t,t[xt]),e)}),Et=r(function(){return 1===new V(new Uint16Array([1]).buffer)[0]}),Tt=!!V&&!!V[X].set&&r(function(){new V(1).set({})}),Lt=function(t,e){var n=d(t);if(n<0||n%e)throw k("Wrong offset!");return n},At=function(t){if(x(t)&&wt in t)return t;throw j(t+" is not a typed array!")},Pt=function(t,e){if(!(x(t)&&yt in t))throw j("It is not a typed array constructor!");return new t(e)},Rt=function(t,e){return It(R(t,t[xt]),e)},It=function(t,e){for(var n=0,r=e.length,i=Pt(t,r);r>n;)i[n]=e[n++];return i},Ct=function(t,e,n){z(t,e,{get:function(){return this._d[n]}})},Ot=function t(e){var n=b(e),r=arguments.length,i=r>1?arguments[1]:void 0,o=void 0!==i,a=E(n),c,u,h,l,d,f;if(void 0!=a&&!w(a)){for(f=a.call(n),h=[],c=0;!(d=f.next()).done;c++)h.push(d.value);n=h}for(o&&r>2&&(i=s(i,arguments[2],2)),c=0,u=p(n.length),l=Pt(this,u);u>c;c++)l[c]=o?i(n[c],c):n[c];return l},Nt=function t(){for(var e=0,n=arguments.length,r=Pt(this,n);n>e;)r[e]=arguments[e++];return r},Ft=!!V&&r(function(){mt.call(new V(1))}),Dt=function t(){return mt.apply(Ft?pt.call(At(this)):At(this),arguments)},Ut={copyWithin:function t(e,n){return D.call(At(this),e,n,arguments.length>2?arguments[2]:void 0)},every:function t(e){return tt(At(this),e,arguments.length>1?arguments[1]:void 0)},fill:function t(e){return F.apply(At(this),arguments)},filter:function t(e){return Rt(this,K(At(this),e,arguments.length>1?arguments[1]:void 0))},find:function t(e){return et(At(this),e,arguments.length>1?arguments[1]:void 0)},findIndex:function t(e){return nt(At(this),e,arguments.length>1?arguments[1]:void 0)},forEach:function t(e){Q(At(this),e,arguments.length>1?arguments[1]:void 0)},indexOf:function t(e){return it(At(this),e,arguments.length>1?arguments[1]:void 0)},includes:function t(e){return rt(At(this),e,arguments.length>1?arguments[1]:void 0)},join:function t(e){return lt.apply(At(this),arguments)},lastIndexOf:function t(e){return ct.apply(At(this),arguments)},map:function t(e){return Mt(At(this),e,arguments.length>1?arguments[1]:void 0)},reduce:function t(e){return ut.apply(At(this),arguments)},reduceRight:function t(e){return ht.apply(At(this),arguments)},reverse:function t(){for(var e=this,n=At(this).length,r=Math.floor(n/2),i=0,o;i<r;)o=this[i],this[i++]=this[--n],this[n]=o;return this},some:function t(e){return $(At(this),e,arguments.length>1?arguments[1]:void 0)},sort:function t(e){return dt.call(At(this),e)},subarray:function t(e,n){var r=At(this),i=r.length,o=m(e,i);return new(R(r,r[xt]))(r.buffer,r.byteOffset+o*r.BYTES_PER_ELEMENT,p((void 0===n?i:m(n,i))-o))}},Bt=function t(e,n){return Rt(this,pt.call(At(this),e,n))},zt=function t(e){At(this);var n=Lt(arguments[1],1),r=this.length,i=b(e),o=p(i.length),a=0;if(o+n>r)throw k(St);for(;a<o;)this[n+a]=i[a++]},Gt={entries:function t(){return st.call(At(this))},keys:function t(){return at.call(At(this))},values:function t(){return ot.call(At(this))}},kt=function(t,e){return x(t)&&t[wt]&&"symbol"!=typeof e&&e in t&&String(+e)==String(e)},jt=function t(e,n){return kt(e,n=v(n,!0))?u(2,e[n]):G(e,n)},Vt=function t(e,n,r){return!(kt(e,n=v(n,!0))&&x(r)&&g(r,"value"))||g(r,"get")||g(r,"set")||r.configurable||g(r,"writable")&&!r.writable||g(r,"enumerable")&&!r.enumerable?z(e,n,r):(e[n]=r.value,e)};bt||(B.f=jt,U.f=Vt),i(i.S+i.F*!bt,"Object",{getOwnPropertyDescriptor:jt,defineProperty:Vt}),r(function(){ft.call({})})&&(ft=mt=function t(){return lt.call(this)});var Ht=l({},Ut);l(Ht,Gt),h(Ht,vt,Gt.values),l(Ht,{slice:Bt,set:zt,constructor:function(){},toString:ft,toLocaleString:Dt}),Ct(Ht,"buffer","b"),Ct(Ht,"byteOffset","o"),Ct(Ht,"byteLength","l"),Ct(Ht,"length","e"),z(Ht,gt,{get:function(){return this[wt]}}),t.exports=function(t,e,a,s){var u=t+((s=!!s)?"Clamped":"")+"Array",l="get"+t,d="set"+t,m=n[u],v=m||{},g=m&&S(m),b=!m||!o.ABV,w={},E=m&&m[X],T=function(t,n){var r=t._d;return r.v[l](n*e+r.o,Et)},L=function(t,n,r){var i=t._d;s&&(r=(r=Math.round(r))<0?0:r>255?255:255&r),i.v[d](n*e+i.o,r,Et)},A=function(t,e){z(t,e,{get:function(){return T(this,e)},set:function(t){return L(this,e,t)},enumerable:!0})};b?(m=a(function(t,n,r,i){c(t,m,u,"_d");var o=0,a=0,s,l,d,v;if(x(n)){if(!(n instanceof Z||(v=y(n))==H||v==W))return wt in n?It(m,n):Ot.call(m,n);s=n,a=Lt(r,e);var g=n.byteLength;if(void 0===i){if(g%e)throw k(St);if((l=g-a)<0)throw k(St)}else if((l=p(i)*e)+a>g)throw k(St);d=l/e}else d=f(n),s=new Z(l=d*e);for(h(t,"_d",{b:s,o:a,l:l,e:d,v:new J(s)});o<d;)A(t,o++)}),E=m[X]=_(Ht),h(E,"constructor",m)):r(function(){m(1)})&&r(function(){new m(-1)})&&O(function(t){new m,new m(null),new m(1.5),new m(t)},!0)||(m=a(function(t,n,r,i){c(t,m,u);var o;return x(n)?n instanceof Z||(o=y(n))==H||o==W?void 0!==i?new v(n,Lt(r,e),i):void 0!==r?new v(n,Lt(r,e)):new v(n):wt in n?It(m,n):Ot.call(m,n):new v(f(n))}),Q(g!==Function.prototype?M(v).concat(M(g)):M(v),function(t){t in m||h(m,t,v[t])}),m[X]=E,E.constructor=m);var P=E[vt],R=!!P&&("values"==P.name||void 0==P.name),I=Gt.values;h(m,yt,!0),h(E,wt,u),h(E,_t,!0),h(E,xt,m),(s?new m(1)[gt]==u:gt in E)||z(E,gt,{get:function(){return u}}),w[u]=m,i(i.G+i.W+i.F*(m!=v),w),i(i.S,u,{BYTES_PER_ELEMENT:e}),i(i.S+i.F*r(function(){v.of.call(m,1)}),u,{from:Ot,of:Nt}),Y in E||h(E,Y,e),i(i.P,u,Ut),N(u),i(i.P+i.F*Tt,u,{set:zt}),i(i.P+i.F*!R,u,Gt),E.toString!=ft&&(E.toString=ft),i(i.P+i.F*r(function(){new m(1).slice()}),u,{slice:Bt}),i(i.P+i.F*(r(function(){return[1,2].toLocaleString()!=new m([1,2]).toLocaleString()})||!r(function(){E.toLocaleString.call([1,2])})),u,{toLocaleString:Dt}),C[u]=R?P:I,R||h(E,vt,I)}}else t.exports=function(){}});ff("Int8",1,function(t){return function e(n,r,i){return t(this,n,r,i)}}),ff("Uint8",1,function(t){return function e(n,r,i){return t(this,n,r,i)}}),ff("Uint8",1,function(t){return function e(n,r,i){return t(this,n,r,i)}},!0),ff("Int16",2,function(t){return function e(n,r,i){return t(this,n,r,i)}}),ff("Uint16",2,function(t){return function e(n,r,i){return t(this,n,r,i)}}),ff("Int32",4,function(t){return function e(n,r,i){return t(this,n,r,i)}}),ff("Uint32",4,function(t){return function e(n,r,i){return t(this,n,r,i)}}),ff("Float32",4,function(t){return function e(n,r,i){return t(this,n,r,i)}}),ff("Float64",8,function(t){return function e(n,r,i){return t(this,n,r,i)}});var mf=(Pa.Reflect||{}).apply,vf=Function.apply;ns(ns.S+ns.F*!Ca(function(){mf(function(){})}),"Reflect",{apply:function t(e,n,r){var i=Ka(e),o=Ua(r);return mf?mf(i,n,o):vf.call(i,n,o)}});var gf=(Pa.Reflect||{}).construct,yf=Ca(function(){function t(){}return!(gf(function(){},[],t)instanceof t)}),xf=!Ca(function(){gf(function(){})});ns(ns.S+ns.F*(yf||xf),"Reflect",{construct:function t(e,n){Ka(e),Ua(n);var r=arguments.length<3?e:Ka(arguments[2]);if(xf&&!yf)return gf(e,n,r);if(e==r){switch(n.length){case 0:return new e;case 1:return new e(n[0]);case 2:return new e(n[0],n[1]);case 3:return new e(n[0],n[1],n[2]);case 4:return new e(n[0],n[1],n[2],n[3])}var i=[null];return i.push.apply(i,n),new(mu.apply(e,i))}var o=r.prototype,a=ec(Da(o)?o:Object.prototype),s=Function.apply.call(e,a,n);return Da(s)?s:a}}),ns(ns.S+ns.F*Ca(function(){Reflect.defineProperty(Wa.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function t(e,n,r){Ua(e),n=ja(n,!0),Ua(r);try{return Wa.f(e,n,r),!0}catch(t){return!1}}});var bf=pc.f;ns(ns.S,"Reflect",{deleteProperty:function t(e,n){var r=bf(Ua(e),n);return!(r&&!r.configurable)&&delete e[n]}});var wf=function(t){this._t=Ua(t),this._i=0;var e=this._k=[],n;for(n in t)e.push(n)};kh(wf,"Object",function(){var t=this,e=this._k,n;do{if(this._i>=e.length)return{value:void 0,done:!0}}while(!((n=e[this._i++])in this._t));return{value:n,done:!1}}),ns(ns.S,"Reflect",{enumerate:function t(e){return new wf(e)}}),ns(ns.S,"Reflect",{get:r}),ns(ns.S,"Reflect",{getOwnPropertyDescriptor:function t(e,n){return pc.f(Ua(e),n)}}),ns(ns.S,"Reflect",{getPrototypeOf:function t(e){return Qc(Ua(e))}}),ns(ns.S,"Reflect",{has:function t(e,n){return n in e}});var _f=Object.isExtensible;ns(ns.S,"Reflect",{isExtensible:function t(e){return Ua(e),!_f||_f(e)}});var Sf=Pa.Reflect,Mf=Sf&&Sf.ownKeys||function t(e){var n=ic.f(Ua(e)),r=Vs.f;return r?n.concat(r(e)):n};ns(ns.S,"Reflect",{ownKeys:Mf});var Ef=Object.preventExtensions;ns(ns.S,"Reflect",{preventExtensions:function t(e){Ua(e);try{return Ef&&Ef(e),!0}catch(t){return!1}}}),ns(ns.S,"Reflect",{set:i}),ou&&ns(ns.S,"Reflect",{setPrototypeOf:function t(e,n){ou.check(e,n);try{return ou.set(e,n),!0}catch(t){return!1}}});var Tf=Ns(!0);ns(ns.P,"Array",{includes:function t(e){return Tf(this,e,arguments.length>1?arguments[1]:void 0)}}),id("includes");var Lf=ds("isConcatSpreadable"),Af=o;ns(ns.P,"Array",{flatMap:function t(e){var n=qc(this),r,i;return Ka(e),r=Rs(n.length),i=kl(n,0),Af(i,n,n,r,0,1,e,arguments[1]),i}}),id("flatMap"),ns(ns.P,"Array",{flatten:function t(){var e=arguments[0],n=qc(this),r=Rs(n.length),i=kl(n,0);return Af(i,n,n,r,0,void 0===e?1:As(e)),i}}),id("flatten");var Pf=Bh(!0);ns(ns.P,"String",{at:function t(e){return Pf(this,e)}});var Rf=function(t,e,n,r){var i=String(Ms(t)),o=i.length,a=void 0===n?" ":String(n),s=Rs(e);if(s<=o||""==a)return i;var c=s-o,u=th.call(a,Math.ceil(c/a.length));return u.length>c&&(u=u.slice(0,c)),r?u+i:i+u};ns(ns.P,"String",{padStart:function t(e){return Rf(this,e,arguments.length>1?arguments[1]:void 0,!0)}}),ns(ns.P,"String",{padEnd:function t(e){return Rf(this,e,arguments.length>1?arguments[1]:void 0,!1)}}),Pu("trimLeft",function(t){return function e(){return t(this,1)}},"trimStart"),Pu("trimRight",function(t){return function e(){return t(this,2)}},"trimEnd");var If=RegExp.prototype,Cf=function(t,e){this._r=t,this._s=e};kh(Cf,"RegExp String",function t(){var e=this._r.exec(this._s);return{value:e,done:null===e}}),ns(ns.P,"String",{matchAll:function t(e){if(Ms(this),!Kh(e))throw TypeError(e+" is not a regexp!");var n=String(this),r="flags"in If?String(e.flags):vd.call(e),i=new RegExp(e.source,~r.indexOf("g")?r:"g"+r);return i.lastIndex=Rs(e.lastIndex),new Cf(i,n)}}),bs("asyncIterator"),bs("observable"),ns(ns.S,"Object",{getOwnPropertyDescriptors:function t(e){for(var n=Es(e),r=pc.f,i=Mf(n),o={},a=0,s,c;i.length>a;)void 0!==(c=r(n,s=i[a++]))&&Ll(o,s,c);return o}});var Of=Ws.f,Nf=function(t){return function(e){for(var n=Es(e),r=ks(n),i=r.length,o=0,a=[],s;i>o;)Of.call(n,s=r[o++])&&a.push(t?[s,n[s]]:n[s]);return a}},Ff=Nf(!1);ns(ns.S,"Object",{values:function t(e){return Ff(e)}});var Df=Nf(!0);ns(ns.S,"Object",{entries:function t(e){return Df(e)}});var Uf=!Ca(function(){var t=Math.random();__defineSetter__.call(null,t,function(){}),delete Pa[t]});Oa&&ns(ns.P+Uf,"Object",{__defineGetter__:function t(e,n){Wa.f(qc(this),e,{get:Ka(n),enumerable:!0,configurable:!0})}}),Oa&&ns(ns.P+Uf,"Object",{__defineSetter__:function t(e,n){Wa.f(qc(this),e,{set:Ka(n),enumerable:!0,configurable:!0})}});var Bf=pc.f;Oa&&ns(ns.P+Uf,"Object",{__lookupGetter__:function t(e){var n=qc(this),r=ja(e,!0),i;do{if(i=Bf(n,r))return i.get}while(n=Qc(n))}});var zf=pc.f;Oa&&ns(ns.P+Uf,"Object",{__lookupSetter__:function t(e){var n=qc(this),r=ja(e,!0),i;do{if(i=zf(n,r))return i.set}while(n=Qc(n))}});var Gf=function(t,e){var n=[];return Od(t,!1,n.push,n,e),n},kf=function(t){return function e(){if(uu(this)!=t)throw TypeError(t+"#toJSON isn't generic");return Gf(this)}};ns(ns.P+ns.R,"Map",{toJSON:kf("Map")}),ns(ns.P+ns.R,"Set",{toJSON:kf("Set")});var jf=function(t){ns(ns.S,t,{of:function t(){for(var e=arguments.length,n=Array(e);e--;)n[e]=arguments[e];return new this(n)}})};jf("Map"),jf("Set"),jf("WeakMap"),jf("WeakSet");var Vf=function(t){ns(ns.S,t,{from:function t(e){var n=arguments[1],r,i,o,a;return Ka(this),(r=void 0!==n)&&Ka(n),void 0==e?new this:(i=[],r?(o=0,a=$a(n,arguments[2],2),Od(e,!1,function(t){i.push(a(t,o++))})):Od(e,!1,i.push,i),new this(i))}})};Vf("Map"),Vf("Set"),Vf("WeakMap"),Vf("WeakSet"),ns(ns.G,{global:Pa}),ns(ns.S,"System",{global:Pa}),ns(ns.S,"Error",{isError:function t(e){return"Error"===_s(e)}}),ns(ns.S,"Math",{clamp:function t(e,n,r){return Math.min(r,Math.max(n,e))}}),ns(ns.S,"Math",{DEG_PER_RAD:Math.PI/180});var Hf=180/Math.PI;ns(ns.S,"Math",{degrees:function t(e){return e*Hf}});var Wf=Math.scale||function t(e,n,r,i,o){return 0===arguments.length||e!=e||n!=n||r!=r||i!=i||o!=o?NaN:e===1/0||e===-1/0?e:(e-n)*(o-i)/(r-n)+i};ns(ns.S,"Math",{fscale:function t(e,n,r,i,o){return Ih(Wf(e,n,r,i,o))}}),ns(ns.S,"Math",{iaddh:function t(e,n,r,i){var o=e>>>0,a,s=r>>>0;return(n>>>0)+(i>>>0)+((o&s|(o|s)&~(o+s>>>0))>>>31)|0}}),ns(ns.S,"Math",{isubh:function t(e,n,r,i){var o=e>>>0,a,s=r>>>0;return(n>>>0)-(i>>>0)-((~o&s|~(o^s)&o-s>>>0)>>>31)|0}}),ns(ns.S,"Math",{imulh:function t(e,n){var r=65535,i=+e,o=+n,a=65535&i,s=65535&o,c=i>>16,u=o>>16,h=(c*s>>>0)+(a*s>>>16);return c*u+(h>>16)+((a*u>>>0)+(65535&h)>>16)}}),ns(ns.S,"Math",{RAD_PER_DEG:180/Math.PI});var Yf=Math.PI/180;ns(ns.S,"Math",{radians:function t(e){return e*Yf}}),ns(ns.S,"Math",{scale:Wf}),ns(ns.S,"Math",{umulh:function t(e,n){var r=65535,i=+e,o=+n,a=65535&i,s=65535&o,c=i>>>16,u=o>>>16,h=(c*s>>>0)+(a*s>>>16);return c*u+(h>>>16)+((a*u>>>0)+(65535&h)>>>16)}}),ns(ns.S,"Math",{signbit:function t(e){return(e=+e)!=e?e:0==e?1/e==1/0:e>0}}),ns(ns.P+ns.R,"Promise",{finally:function(t){var e=Fd(this,Na.Promise||Pa.Promise),n="function"==typeof t;return this.then(n?function(n){return op(e,t()).then(function(){return n})}:t,n?function(n){return op(e,t()).then(function(){throw n})}:t)}}),ns(ns.S,"Promise",{try:function(t){var e=rp.f(this),n=ip(t);return(n.e?e.reject:e.resolve)(n.v),e.promise}});var Xf=ls("metadata"),qf=Xf.store||(Xf.store=new Xp),Zf=function(t,e,n){var r=qf.get(t);if(!r){if(!n)return;qf.set(t,r=new Dp)}var i=r.get(e);if(!i){if(!n)return;r.set(e,i=new Dp)}return i},Jf,Qf,Kf,$f,tm,em,nm={store:qf,map:Zf,has:function(t,e,n){var r=Zf(e,n,!1);return void 0!==r&&r.has(t)},get:function(t,e,n){var r=Zf(e,n,!1);return void 0===r?void 0:r.get(t)},set:function(t,e,n,r){Zf(n,r,!0).set(t,e)},keys:function(t,e){var n=Zf(t,e,!1),r=[];return n&&n.forEach(function(t,e){r.push(e)}),r},key:function(t){return void 0===t||"symbol"==typeof t?t:String(t)},exp:function(t){ns(ns.S,"Reflect",t)}},rm=nm.key,im=nm.set;nm.exp({defineMetadata:function t(e,n,r,i){im(e,n,Ua(r),rm(i))}});var om=nm.key,am=nm.map,sm=nm.store;nm.exp({deleteMetadata:function t(e,n){var r=arguments.length<3?void 0:om(arguments[2]),i=am(Ua(n),r,!1);if(void 0===i||!i.delete(e))return!1;if(i.size)return!0;var o=sm.get(n);return o.delete(r),!!o.size||sm.delete(n)}});var cm=nm.has,um=nm.get,hm=nm.key,lm=function(t,e,n){var r;if(cm(t,e,n))return um(t,e,n);var i=Qc(e);return null!==i?lm(t,i,n):void 0};nm.exp({getMetadata:function t(e,n){return lm(e,Ua(n),arguments.length<3?void 0:hm(arguments[2]))}});var dm=nm.keys,pm=nm.key,fm=function(t,e){var n=dm(t,e),r=Qc(t);if(null===r)return n;var i=fm(r,e);return i.length?n.length?Gf(new Bp(n.concat(i))):i:n};nm.exp({getMetadataKeys:function t(e){return fm(Ua(e),arguments.length<2?void 0:pm(arguments[1]))}});var mm=nm.get,vm=nm.key;nm.exp({getOwnMetadata:function t(e,n){return mm(e,Ua(n),arguments.length<3?void 0:vm(arguments[2]))}});var gm=nm.keys,ym=nm.key;nm.exp({getOwnMetadataKeys:function t(e){return gm(Ua(e),arguments.length<2?void 0:ym(arguments[1]))}});var xm=nm.has,bm=nm.key,wm=function(t,e,n){var r;if(xm(t,e,n))return!0;var i=Qc(e);return null!==i&&wm(t,i,n)};nm.exp({hasMetadata:function t(e,n){return wm(e,Ua(n),arguments.length<3?void 0:bm(arguments[2]))}});var _m=nm.has,Sm=nm.key;nm.exp({hasOwnMetadata:function t(e,n){return _m(e,Ua(n),arguments.length<3?void 0:Sm(arguments[2]))}});var Mm=nm.key,Em=nm.set;nm.exp({metadata:function t(e,n){return function t(r,i){Em(e,n,(void 0!==i?Ua:Ka)(r),Mm(i))}}});var Tm=ep(),Lm=Pa.process,Am="process"==_s(Lm);ns(ns.G,{asap:function t(e){var n=Am&&Lm.domain;Tm(n?n.bind(e):e)}});var Pm=ep(),Rm=ds("observable"),Im=Od.RETURN,Cm=function(t){return null==t?void 0:Ka(t)},Om=function(t){var e=t._c;e&&(t._c=void 0,e())},Nm=function(t){return void 0===t._o},Fm=function(t){Nm(t)||(t._o=void 0,Om(t))},Dm=function(t,e){Ua(t),this._c=void 0,this._o=t,t=new Um(this);try{var n=e(t),r=n;null!=n&&("function"==typeof n.unsubscribe?n=function(){r.unsubscribe()}:Ka(n),this._c=n)}catch(e){return void t.error(e)}Nm(this)&&Om(this)};Dm.prototype=ap({},{unsubscribe:function t(){Fm(this)}});var Um=function(t){this._s=t};Um.prototype=ap({},{next:function t(e){var n=this._s;if(!Nm(n)){var r=n._o;try{var i=Cm(r.next);if(i)return i.call(r,e)}catch(t){try{Fm(n)}finally{throw t}}}},error:function t(e){var n=this._s;if(Nm(n))throw e;var r=n._o;n._o=void 0;try{var i=Cm(r.error);if(!i)throw e;e=i.call(r,e)}catch(t){try{Om(n)}finally{throw t}}return Om(n),e},complete:function t(e){var n=this._s;if(!Nm(n)){var r=n._o;n._o=void 0;try{var i=Cm(r.complete);e=i?i.call(r,e):void 0}catch(t){try{Om(n)}finally{throw t}}return Om(n),e}}});var Bm=function t(e){Cd(this,Bm,"Observable","_f")._f=Ka(e)};ap(Bm.prototype,{subscribe:function t(e){return new Dm(e,this._f)},forEach:function t(e){var n=this;return new(Na.Promise||Pa.Promise)(function(t,r){Ka(e);var i=n.subscribe({next:function(t){try{return e(t)}catch(t){r(t),i.unsubscribe()}},error:r,complete:t})})}}),ap(Bm,{from:function t(e){var n="function"==typeof this?this:Bm,r=Cm(Ua(e)[Rm]);if(r){var i=Ua(r.call(e));return i.constructor===n?i:new n(function(t){return i.subscribe(t)})}return new n(function(t){var n=!1;return Pm(function(){if(!n){try{if(Od(e,!1,function(e){if(t.next(e),n)return Im})===Im)return}catch(e){if(n)throw e;return void t.error(e)}t.complete()}}),function(){n=!0}})},of:function t(){for(var e=0,n=arguments.length,r=Array(n);e<n;)r[e]=arguments[e++];return new("function"==typeof this?this:Bm)(function(t){var e=!1;return Pm(function(){if(!e){for(var n=0;n<r.length;++n)if(t.next(r[n]),e)return;t.complete()}}),function(){e=!0}})}}),Xa(Bm.prototype,Rm,function(){return this}),ns(ns.G,{Observable:Bm}),pd("Observable");var zm=Pa.navigator,Gm=[].slice,km=!!zm&&/MSIE .\./.test(zm.userAgent),jm=function(t){return function(e,n){var r=arguments.length>2,i=!!r&&Gm.call(arguments,2);return t(r?function(){("function"==typeof e?e:Function(e)).apply(this,i)}:e,n)}};ns(ns.G+ns.B+ns.F*km,{setTimeout:jm(Pa.setTimeout),setInterval:jm(Pa.setInterval)}),ns(ns.G+ns.B,{setImmediate:Zd.set,clearImmediate:Zd.clear});for(var Vm=ds("iterator"),Hm=ds("toStringTag"),Wm=zh.Array,Ym={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},Xm=ks(Ym),qm=0;qm<Xm.length;qm++){var Zm=Xm[qm],Jm=Ym[Zm],Qm=Pa[Zm],Km=Qm&&Qm.prototype,$m;if(Km&&(Km[Vm]||Xa(Km,Vm,Wm),Km[Hm]||Xa(Km,Hm,Zm),zh[Zm]=Wm,Jm))for($m in md)Km[$m]||Qa(Km,$m,md[$m],!0)}var tv=t(function(t){!function(e){function n(t,e,n,r){var o=e&&e.prototype instanceof i?e:i,a=Object.create(o.prototype),s=new p(r||[]);return a._invoke=u(t,n,s),a}function r(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}function i(){}function o(){}function a(){}function s(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function c(t){function n(e,i,o,a){var s=r(t[e],t,i);if("throw"!==s.type){var c=s.arg,u=c.value;return u&&"object"==typeof u&&g.call(u,"__await")?Promise.resolve(u.__await).then(function(t){n("next",t,o,a)},function(t){n("throw",t,o,a)}):Promise.resolve(u).then(function(t){c.value=t,o(c)},a)}a(s.arg)}function i(t,e){function r(){return new Promise(function(r,i){n(t,e,r,i)})}return o=o?o.then(r,r):r()}"object"==typeof e.process&&e.process.domain&&(n=e.process.domain.bind(n));var o;this._invoke=i}function u(t,e,n){var i=E;return function o(a,s){if(i===L)throw new Error("Generator is already running");if(i===A){if("throw"===a)throw s;return m()}for(n.method=a,n.arg=s;;){var c=n.delegate;if(c){var u=h(c,n);if(u){if(u===P)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===E)throw i=A,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=L;var l=r(t,e,n);if("normal"===l.type){if(i=n.done?A:T,l.arg===P)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=A,n.method="throw",n.arg=l.arg)}}}function h(t,e){var n=t.iterator[e.method];if(n===y){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=y,h(t,e),"throw"===e.method))return P;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return P}var i=r(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,P;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=y),e.delegate=null,P):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,P)}function l(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function d(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function p(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(l,this),this.reset(!0)}function f(t){if(t){var e=t[b];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,r=function e(){for(;++n<t.length;)if(g.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=y,e.done=!0,e};return r.next=r}}return{next:m}}function m(){return{value:y,done:!0}}var v=Object.prototype,g=v.hasOwnProperty,y,x="function"==typeof Symbol?Symbol:{},b=x.iterator||"@@iterator",w=x.asyncIterator||"@@asyncIterator",_=x.toStringTag||"@@toStringTag",S=!0,M=e.regeneratorRuntime;if(M)t.exports=M;else{(M=e.regeneratorRuntime=t.exports).wrap=n;var E="suspendedStart",T="suspendedYield",L="executing",A="completed",P={},R={};R[b]=function(){return this};var I=Object.getPrototypeOf,C=I&&I(I(f([])));C&&C!==v&&g.call(C,b)&&(R=C);var O=a.prototype=i.prototype=Object.create(R);o.prototype=O.constructor=a,a.constructor=o,a[_]=o.displayName="GeneratorFunction",M.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===o||"GeneratorFunction"===(e.displayName||e.name))},M.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,a):(t.__proto__=a,_ in t||(t[_]="GeneratorFunction")),t.prototype=Object.create(O),t},M.awrap=function(t){return{__await:t}},s(c.prototype),c.prototype[w]=function(){return this},M.AsyncIterator=c,M.async=function(t,e,r,i){var o=new c(n(t,e,r,i));return M.isGeneratorFunction(e)?o:o.next().then(function(t){return t.done?t.value:o.next()})},s(O),O[_]="Generator",O[b]=function(){return this},O.toString=function(){return"[object Generator]"},M.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},M.values=f,p.prototype={constructor:p,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=y,this.done=!1,this.delegate=null,this.method="next",this.arg=y,this.tryEntries.forEach(d),!t)for(var e in this)"t"===e.charAt(0)&&g.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=y)},stop:function(){this.done=!0;var t,e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){function e(e,r){return o.type="throw",o.arg=t,n.next=e,r&&(n.method="next",n.arg=y),!!r}if(this.done)throw t;for(var n=this,r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var a=g.call(i,"catchLoc"),s=g.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&g.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=e,i?(this.method="next",this.next=i.finallyLoc,P):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),P},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),d(n),P}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;d(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:f(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=y),P}}}}("object"==typeof Aa?Aa:"object"==typeof window?window:"object"==typeof self?self:Aa)}),ev,nv=function(t,e){var n=e===Object(e)?function(t){return e[t]}:e;return function(e){return String(e).replace(t,n)}}(/[\\^$*+?.()|[\]{}]/g,"\\$&");ns(ns.S,"RegExp",{escape:function t(e){return nv(e)}});var rv=Na.RegExp.escape;if(Aa._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");Aa._babelPolyfill=!0;var iv="defineProperty";a(String.prototype,"padLeft","".padStart),a(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(t){[][t]&&a(Array,t,Function.call.bind([][t]))}),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),void 0===Math.sign&&(Math.sign=function(t){return t<0?-1:t>0?1:+t}),"name"in Function.prototype==!1&&Object.defineProperty(Function.prototype,"name",{get:function t(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(t){if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(void 0!==r&&null!==r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}),Object.assign(s.prototype,{addEventListener:function t(e,n){void 0===this._listeners&&(this._listeners={});var r=this._listeners;void 0===r[e]&&(r[e]=[]),-1===r[e].indexOf(n)&&r[e].push(n)},hasEventListener:function t(e,n){if(void 0===this._listeners)return!1;var r=this._listeners;return void 0!==r[e]&&-1!==r[e].indexOf(n)},removeEventListener:function t(e,n){if(void 0!==this._listeners){var r,i=this._listeners[e];if(void 0!==i){var o=i.indexOf(n);-1!==o&&i.splice(o,1)}}},dispatchEvent:function t(e){if(void 0!==this._listeners){var n,r=this._listeners[e.type];if(void 0!==r){e.target=this;for(var i=r.slice(0),o=0,a=i.length;o<a;o++)i[o].call(this,e)}}}});var ov="90dev",av={LEFT:0,MIDDLE:1,RIGHT:2},sv=0,cv=1,uv=2,hv=0,lv=1,dv=2,pv=0,fv=1,mv=2,vv=1,gv=0,yv=1,xv=2,bv=0,wv=1,_v=2,Sv=3,Mv=4,Ev=5,Tv=100,Lv=101,Av=102,Pv=103,Rv=104,Iv=200,Cv=201,Ov=202,Nv=203,Fv=204,Dv=205,Uv=206,Bv=207,zv=208,Gv=209,kv=210,jv=0,Vv=1,Hv=2,Wv=3,Yv=4,Xv=5,qv=6,Zv=7,Jv=0,Qv=1,Kv=2,$v=0,tg=1,eg=2,ng=3,rg=4,ig=300,og=301,ag=302,sg=303,cg=304,ug=305,hg=306,lg=307,dg=1e3,pg=1001,fg=1002,mg=1003,vg=1004,gg=1005,yg=1006,xg=1007,bg=1008,wg=1009,_g=1010,Sg=1011,Mg=1012,Eg=1013,Tg=1014,Lg=1015,Ag=1016,Pg=1017,Rg=1018,Ig=1019,Cg=1020,Og=1021,Ng=1022,Fg=1023,Dg=1024,Ug=1025,Bg=1026,zg=1027,Gg=33776,kg=33777,jg=33778,Vg=33779,Hg=35840,Wg=35841,Yg=35842,Xg=35843,qg=36196,Zg=37808,Jg=37809,Qg=37810,Kg=37811,$g=37812,ty=37813,ey=37814,ny=37815,ry=37816,iy=37817,oy=37818,ay=37819,sy=37820,cy=37821,uy=2200,hy=2201,ly=2202,dy=2300,py=2301,fy=2302,my=2400,vy=2401,gy=2402,yy=0,xy=1,by=2,wy=3e3,_y=3001,Sy=3007,My=3002,Ey=3004,Ty=3005,Ly=3006,Ay=3200,Py=3201,Ry={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var t=[],e=0;e<256;e++)t[e]=(e<16?"0":"")+e.toString(16).toUpperCase();return function e(){var n=4294967295*Math.random()|0,r=4294967295*Math.random()|0,i=4294967295*Math.random()|0,o=4294967295*Math.random()|0;return t[255&n]+t[n>>8&255]+t[n>>16&255]+t[n>>24&255]+"-"+t[255&r]+t[r>>8&255]+"-"+t[r>>16&15|64]+t[r>>24&255]+"-"+t[63&i|128]+t[i>>8&255]+"-"+t[i>>16&255]+t[i>>24&255]+t[255&o]+t[o>>8&255]+t[o>>16&255]+t[o>>24&255]}}(),clamp:function t(e,n,r){return Math.max(n,Math.min(r,e))},euclideanModulo:function t(e,n){return(e%n+n)%n},mapLinear:function t(e,n,r,i,o){return i+(e-n)*(o-i)/(r-n)},lerp:function t(e,n,r){return(1-r)*e+r*n},smoothstep:function t(e,n,r){return e<=n?0:e>=r?1:(e=(e-n)/(r-n))*e*(3-2*e)},smootherstep:function t(e,n,r){return e<=n?0:e>=r?1:(e=(e-n)/(r-n))*e*e*(e*(6*e-15)+10)},randInt:function t(e,n){return e+Math.floor(Math.random()*(n-e+1))},randFloat:function t(e,n){return e+Math.random()*(n-e)},randFloatSpread:function t(e){return e*(.5-Math.random())},degToRad:function t(e){return e*Ry.DEG2RAD},radToDeg:function t(e){return e*Ry.RAD2DEG},isPowerOfTwo:function t(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function t(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function t(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}};Object.defineProperties(c.prototype,{width:{get:function t(){return this.x},set:function t(e){this.x=e}},height:{get:function t(){return this.y},set:function t(e){this.y=e}}}),Object.assign(c.prototype,{isVector2:!0,set:function t(e,n){return this.x=e,this.y=n,this},setScalar:function t(e){return this.x=e,this.y=e,this},setX:function t(e){return this.x=e,this},setY:function t(e){return this.y=e,this},setComponent:function t(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function t(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function t(){return new this.constructor(this.x,this.y)},copy:function t(e){return this.x=e.x,this.y=e.y,this},add:function t(e,n){return void 0!==n?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,n)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function t(e){return this.x+=e,this.y+=e,this},addVectors:function t(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this},addScaledVector:function t(e,n){return this.x+=e.x*n,this.y+=e.y*n,this},sub:function t(e,n){return void 0!==n?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,n)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function t(e){return this.x-=e,this.y-=e,this},subVectors:function t(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this},multiply:function t(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function t(e){return this.x*=e,this.y*=e,this},divide:function t(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function t(e){return this.multiplyScalar(1/e)},applyMatrix3:function t(e){var n=this.x,r=this.y,i=e.elements;return this.x=i[0]*n+i[3]*r+i[6],this.y=i[1]*n+i[4]*r+i[7],this},min:function t(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function t(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function t(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this},clampScalar:function(){var t=new c,e=new c;return function n(r,i){return t.set(r,r),e.set(i,i),this.clamp(t,e)}}(),clampLength:function t(e,n){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(n,r)))},floor:function t(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function t(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function t(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function t(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function t(){return this.x=-this.x,this.y=-this.y,this},dot:function t(e){return this.x*e.x+this.y*e.y},lengthSq:function t(){return this.x*this.x+this.y*this.y},length:function t(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function t(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function t(){return this.divideScalar(this.length()||1)},angle:function t(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},distanceTo:function t(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function t(e){var n=this.x-e.x,r=this.y-e.y;return n*n+r*r},manhattanDistanceTo:function t(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function t(e){return this.normalize().multiplyScalar(e)},lerp:function t(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this},lerpVectors:function t(e,n,r){return this.subVectors(n,e).multiplyScalar(r).add(e)},equals:function t(e){return e.x===this.x&&e.y===this.y},fromArray:function t(e,n){return void 0===n&&(n=0),this.x=e[n],this.y=e[n+1],this},toArray:function t(e,n){return void 0===e&&(e=[]),void 0===n&&(n=0),e[n]=this.x,e[n+1]=this.y,e},fromBufferAttribute:function t(e,n,r){return void 0!==r&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(n),this.y=e.getY(n),this},rotateAround:function t(e,n){var r=Math.cos(n),i=Math.sin(n),o=this.x-e.x,a=this.y-e.y;return this.x=o*r-a*i+e.x,this.y=o*i+a*r+e.y,this}}),Object.assign(u.prototype,{isMatrix4:!0,set:function t(e,n,r,i,o,a,s,c,u,h,l,d,p,f,m,v){var g=this.elements;return g[0]=e,g[4]=n,g[8]=r,g[12]=i,g[1]=o,g[5]=a,g[9]=s,g[13]=c,g[2]=u,g[6]=h,g[10]=l,g[14]=d,g[3]=p,g[7]=f,g[11]=m,g[15]=v,this},identity:function t(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function t(){return(new u).fromArray(this.elements)},copy:function t(e){var n=this.elements,r=e.elements;return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n[9]=r[9],n[10]=r[10],n[11]=r[11],n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15],this},copyPosition:function t(e){var n=this.elements,r=e.elements;return n[12]=r[12],n[13]=r[13],n[14]=r[14],this},extractBasis:function t(e,n,r){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this},makeBasis:function t(e,n,r){return this.set(e.x,n.x,r.x,0,e.y,n.y,r.y,0,e.z,n.z,r.z,0,0,0,0,1),this},extractRotation:function(){var t=new l;return function e(n){var r=this.elements,i=n.elements,o=1/t.setFromMatrixColumn(n,0).length(),a=1/t.setFromMatrixColumn(n,1).length(),s=1/t.setFromMatrixColumn(n,2).length();return r[0]=i[0]*o,r[1]=i[1]*o,r[2]=i[2]*o,r[4]=i[4]*a,r[5]=i[5]*a,r[6]=i[6]*a,r[8]=i[8]*s,r[9]=i[9]*s,r[10]=i[10]*s,this}}(),makeRotationFromEuler:function t(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var n=this.elements,r=e.x,i=e.y,o=e.z,a=Math.cos(r),s=Math.sin(r),c=Math.cos(i),u=Math.sin(i),h=Math.cos(o),l=Math.sin(o);if("XYZ"===e.order){var d=a*h,p=a*l,f=s*h,m=s*l;n[0]=c*h,n[4]=-c*l,n[8]=u,n[1]=p+f*u,n[5]=d-m*u,n[9]=-s*c,n[2]=m-d*u,n[6]=f+p*u,n[10]=a*c}else if("YXZ"===e.order){var v=c*h,g=c*l,y=u*h,x=u*l;n[0]=v+x*s,n[4]=y*s-g,n[8]=a*u,n[1]=a*l,n[5]=a*h,n[9]=-s,n[2]=g*s-y,n[6]=x+v*s,n[10]=a*c}else if("ZXY"===e.order){var v=c*h,g=c*l,y=u*h,x=u*l;n[0]=v-x*s,n[4]=-a*l,n[8]=y+g*s,n[1]=g+y*s,n[5]=a*h,n[9]=x-v*s,n[2]=-a*u,n[6]=s,n[10]=a*c}else if("ZYX"===e.order){var d=a*h,p=a*l,f=s*h,m=s*l;n[0]=c*h,n[4]=f*u-p,n[8]=d*u+m,n[1]=c*l,n[5]=m*u+d,n[9]=p*u-f,n[2]=-u,n[6]=s*c,n[10]=a*c}else if("YZX"===e.order){var b=a*c,w=a*u,_=s*c,S=s*u;n[0]=c*h,n[4]=S-b*l,n[8]=_*l+w,n[1]=l,n[5]=a*h,n[9]=-s*h,n[2]=-u*h,n[6]=w*l+_,n[10]=b-S*l}else if("XZY"===e.order){var b=a*c,w=a*u,_=s*c,S=s*u;n[0]=c*h,n[4]=-l,n[8]=u*h,n[1]=b*l+S,n[5]=a*h,n[9]=w*l-_,n[2]=_*l-w,n[6]=s*h,n[10]=S*l+b}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this},makeRotationFromQuaternion:function t(e){var n=this.elements,r=e._x,i=e._y,o=e._z,a=e._w,s=r+r,c=i+i,u=o+o,h=r*s,l=r*c,d=r*u,p=i*c,f=i*u,m=o*u,v=a*s,g=a*c,y=a*u;return n[0]=1-(p+m),n[4]=l-y,n[8]=d+g,n[1]=l+y,n[5]=1-(h+m),n[9]=f-v,n[2]=d-g,n[6]=f+v,n[10]=1-(h+p),n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this},lookAt:function(){var t=new l,e=new l,n=new l;return function r(i,o,a){var s=this.elements;return n.subVectors(i,o),0===n.lengthSq()&&(n.z=1),n.normalize(),t.crossVectors(a,n),0===t.lengthSq()&&(1===Math.abs(a.z)?n.x+=1e-4:n.z+=1e-4,n.normalize(),t.crossVectors(a,n)),t.normalize(),e.crossVectors(n,t),s[0]=t.x,s[4]=e.x,s[8]=n.x,s[1]=t.y,s[5]=e.y,s[9]=n.y,s[2]=t.z,s[6]=e.z,s[10]=n.z,this}}(),multiply:function t(e,n){return void 0!==n?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,n)):this.multiplyMatrices(this,e)},premultiply:function t(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function t(e,n){var r=e.elements,i=n.elements,o=this.elements,a=r[0],s=r[4],c=r[8],u=r[12],h=r[1],l=r[5],d=r[9],p=r[13],f=r[2],m=r[6],v=r[10],g=r[14],y=r[3],x=r[7],b=r[11],w=r[15],_=i[0],S=i[4],M=i[8],E=i[12],T=i[1],L=i[5],A=i[9],P=i[13],R=i[2],I=i[6],C=i[10],O=i[14],N=i[3],F=i[7],D=i[11],U=i[15];return o[0]=a*_+s*T+c*R+u*N,o[4]=a*S+s*L+c*I+u*F,o[8]=a*M+s*A+c*C+u*D,o[12]=a*E+s*P+c*O+u*U,o[1]=h*_+l*T+d*R+p*N,o[5]=h*S+l*L+d*I+p*F,o[9]=h*M+l*A+d*C+p*D,o[13]=h*E+l*P+d*O+p*U,o[2]=f*_+m*T+v*R+g*N,o[6]=f*S+m*L+v*I+g*F,o[10]=f*M+m*A+v*C+g*D,o[14]=f*E+m*P+v*O+g*U,o[3]=y*_+x*T+b*R+w*N,o[7]=y*S+x*L+b*I+w*F,o[11]=y*M+x*A+b*C+w*D,o[15]=y*E+x*P+b*O+w*U,this},multiplyScalar:function t(e){var n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this},applyToBufferAttribute:function(){var t=new l;return function e(n){for(var r=0,i=n.count;r<i;r++)t.x=n.getX(r),t.y=n.getY(r),t.z=n.getZ(r),t.applyMatrix4(this),n.setXYZ(r,t.x,t.y,t.z);return n}}(),determinant:function t(){var e=this.elements,n=e[0],r=e[4],i=e[8],o=e[12],a=e[1],s=e[5],c=e[9],u=e[13],h=e[2],l=e[6],d=e[10],p=e[14],f,m,v,g;return e[3]*(+o*c*l-i*u*l-o*s*d+r*u*d+i*s*p-r*c*p)+e[7]*(+n*c*p-n*u*d+o*a*d-i*a*p+i*u*h-o*c*h)+e[11]*(+n*u*l-n*s*p-o*a*l+r*a*p+o*s*h-r*u*h)+e[15]*(-i*s*h-n*c*l+n*s*d+i*a*l-r*a*d+r*c*h)},transpose:function t(){var e=this.elements,n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this},setPosition:function t(e){var n=this.elements;return n[12]=e.x,n[13]=e.y,n[14]=e.z,this},getInverse:function t(e,n){var r=this.elements,i=e.elements,o=i[0],a=i[1],s=i[2],c=i[3],u=i[4],h=i[5],l=i[6],d=i[7],p=i[8],f=i[9],m=i[10],v=i[11],g=i[12],y=i[13],x=i[14],b=i[15],w=f*x*d-y*m*d+y*l*v-h*x*v-f*l*b+h*m*b,_=g*m*d-p*x*d-g*l*v+u*x*v+p*l*b-u*m*b,S=p*y*d-g*f*d+g*h*v-u*y*v-p*h*b+u*f*b,M=g*f*l-p*y*l-g*h*m+u*y*m+p*h*x-u*f*x,E=o*w+a*_+s*S+c*M;if(0===E){var T="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===n)throw new Error(T);return console.warn(T),this.identity()}var L=1/E;return r[0]=w*L,r[1]=(y*m*c-f*x*c-y*s*v+a*x*v+f*s*b-a*m*b)*L,r[2]=(h*x*c-y*l*c+y*s*d-a*x*d-h*s*b+a*l*b)*L,r[3]=(f*l*c-h*m*c-f*s*d+a*m*d+h*s*v-a*l*v)*L,r[4]=_*L,r[5]=(p*x*c-g*m*c+g*s*v-o*x*v-p*s*b+o*m*b)*L,r[6]=(g*l*c-u*x*c-g*s*d+o*x*d+u*s*b-o*l*b)*L,r[7]=(u*m*c-p*l*c+p*s*d-o*m*d-u*s*v+o*l*v)*L,r[8]=S*L,r[9]=(g*f*c-p*y*c-g*a*v+o*y*v+p*a*b-o*f*b)*L,r[10]=(u*y*c-g*h*c+g*a*d-o*y*d-u*a*b+o*h*b)*L,r[11]=(p*h*c-u*f*c-p*a*d+o*f*d+u*a*v-o*h*v)*L,r[12]=M*L,r[13]=(p*y*s-g*f*s+g*a*m-o*y*m-p*a*x+o*f*x)*L,r[14]=(g*h*s-u*y*s-g*a*l+o*y*l+u*a*x-o*h*x)*L,r[15]=(u*f*s-p*h*s+p*a*l-o*f*l-u*a*m+o*h*m)*L,this},scale:function t(e){var n=this.elements,r=e.x,i=e.y,o=e.z;return n[0]*=r,n[4]*=i,n[8]*=o,n[1]*=r,n[5]*=i,n[9]*=o,n[2]*=r,n[6]*=i,n[10]*=o,n[3]*=r,n[7]*=i,n[11]*=o,this},getMaxScaleOnAxis:function t(){var e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,r,i))},makeTranslation:function t(e,n,r){return this.set(1,0,0,e,0,1,0,n,0,0,1,r,0,0,0,1),this},makeRotationX:function t(e){var n=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,n,-r,0,0,r,n,0,0,0,0,1),this},makeRotationY:function t(e){var n=Math.cos(e),r=Math.sin(e);return this.set(n,0,r,0,0,1,0,0,-r,0,n,0,0,0,0,1),this},makeRotationZ:function t(e){var n=Math.cos(e),r=Math.sin(e);return this.set(n,-r,0,0,r,n,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function t(e,n){var r=Math.cos(n),i=Math.sin(n),o=1-r,a=e.x,s=e.y,c=e.z,u=o*a,h=o*s;return this.set(u*a+r,u*s-i*c,u*c+i*s,0,u*s+i*c,h*s+r,h*c-i*a,0,u*c-i*s,h*c+i*a,o*c*c+r,0,0,0,0,1),this},makeScale:function t(e,n,r){return this.set(e,0,0,0,0,n,0,0,0,0,r,0,0,0,0,1),this},makeShear:function t(e,n,r){return this.set(1,n,r,0,e,1,r,0,e,n,1,0,0,0,0,1),this},compose:function t(e,n,r){return this.makeRotationFromQuaternion(n),this.scale(r),this.setPosition(e),this},decompose:function(){var t=new l,e=new u;return function n(r,i,o){var a=this.elements,s=t.set(a[0],a[1],a[2]).length(),c=t.set(a[4],a[5],a[6]).length(),u=t.set(a[8],a[9],a[10]).length(),h;this.determinant()<0&&(s=-s),r.x=a[12],r.y=a[13],r.z=a[14],e.copy(this);var l=1/s,d=1/c,p=1/u;return e.elements[0]*=l,e.elements[1]*=l,e.elements[2]*=l,e.elements[4]*=d,e.elements[5]*=d,e.elements[6]*=d,e.elements[8]*=p,e.elements[9]*=p,e.elements[10]*=p,i.setFromRotationMatrix(e),o.x=s,o.y=c,o.z=u,this}}(),makePerspective:function t(e,n,r,i,o,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var s=this.elements,c=2*o/(n-e),u=2*o/(r-i),h=(n+e)/(n-e),l=(r+i)/(r-i),d=-(a+o)/(a-o),p=-2*a*o/(a-o);return s[0]=c,s[4]=0,s[8]=h,s[12]=0,s[1]=0,s[5]=u,s[9]=l,s[13]=0,s[2]=0,s[6]=0,s[10]=d,s[14]=p,s[3]=0,s[7]=0,s[11]=-1,s[15]=0,this},makeOrthographic:function t(e,n,r,i,o,a){var s=this.elements,c=1/(n-e),u=1/(r-i),h=1/(a-o),l=(n+e)*c,d=(r+i)*u,p=(a+o)*h;return s[0]=2*c,s[4]=0,s[8]=0,s[12]=-l,s[1]=0,s[5]=2*u,s[9]=0,s[13]=-d,s[2]=0,s[6]=0,s[10]=-2*h,s[14]=-p,s[3]=0,s[7]=0,s[11]=0,s[15]=1,this},equals:function t(e){for(var n=this.elements,r=e.elements,i=0;i<16;i++)if(n[i]!==r[i])return!1;return!0},fromArray:function t(e,n){void 0===n&&(n=0);for(var r=0;r<16;r++)this.elements[r]=e[r+n];return this},toArray:function t(e,n){void 0===e&&(e=[]),void 0===n&&(n=0);var r=this.elements;return e[n]=r[0],e[n+1]=r[1],e[n+2]=r[2],e[n+3]=r[3],e[n+4]=r[4],e[n+5]=r[5],e[n+6]=r[6],e[n+7]=r[7],e[n+8]=r[8],e[n+9]=r[9],e[n+10]=r[10],e[n+11]=r[11],e[n+12]=r[12],e[n+13]=r[13],e[n+14]=r[14],e[n+15]=r[15],e}}),Object.assign(h,{slerp:function t(e,n,r,i){return r.copy(e).slerp(n,i)},slerpFlat:function t(e,n,r,i,o,a,s){var c=r[i+0],u=r[i+1],h=r[i+2],l=r[i+3],d=o[a+0],p=o[a+1],f=o[a+2],m=o[a+3];if(l!==m||c!==d||u!==p||h!==f){var v=1-s,g=c*d+u*p+h*f+l*m,y=g>=0?1:-1,x=1-g*g;if(x>Number.EPSILON){var b=Math.sqrt(x),w=Math.atan2(b,g*y);v=Math.sin(v*w)/b,s=Math.sin(s*w)/b}var _=s*y;if(c=c*v+d*_,u=u*v+p*_,h=h*v+f*_,l=l*v+m*_,v===1-s){var S=1/Math.sqrt(c*c+u*u+h*h+l*l);c*=S,u*=S,h*=S,l*=S}}e[n]=c,e[n+1]=u,e[n+2]=h,e[n+3]=l}}),Object.defineProperties(h.prototype,{x:{get:function t(){return this._x},set:function t(e){this._x=e,this.onChangeCallback()}},y:{get:function t(){return this._y},set:function t(e){this._y=e,this.onChangeCallback()}},z:{get:function t(){return this._z},set:function t(e){this._z=e,this.onChangeCallback()}},w:{get:function t(){return this._w},set:function t(e){this._w=e,this.onChangeCallback()}}}),Object.assign(h.prototype,{set:function t(e,n,r,i){return this._x=e,this._y=n,this._z=r,this._w=i,this.onChangeCallback(),this},clone:function t(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function t(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this.onChangeCallback(),this},setFromEuler:function t(e,n){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var r=e._x,i=e._y,o=e._z,a=e.order,s=Math.cos,c=Math.sin,u=s(r/2),h=s(i/2),l=s(o/2),d=c(r/2),p=c(i/2),f=c(o/2);return"XYZ"===a?(this._x=d*h*l+u*p*f,this._y=u*p*l-d*h*f,this._z=u*h*f+d*p*l,this._w=u*h*l-d*p*f):"YXZ"===a?(this._x=d*h*l+u*p*f,this._y=u*p*l-d*h*f,this._z=u*h*f-d*p*l,this._w=u*h*l+d*p*f):"ZXY"===a?(this._x=d*h*l-u*p*f,this._y=u*p*l+d*h*f,this._z=u*h*f+d*p*l,this._w=u*h*l-d*p*f):"ZYX"===a?(this._x=d*h*l-u*p*f,this._y=u*p*l+d*h*f,this._z=u*h*f-d*p*l,this._w=u*h*l+d*p*f):"YZX"===a?(this._x=d*h*l+u*p*f,this._y=u*p*l+d*h*f,this._z=u*h*f-d*p*l,this._w=u*h*l-d*p*f):"XZY"===a&&(this._x=d*h*l-u*p*f,this._y=u*p*l-d*h*f,this._z=u*h*f+d*p*l,this._w=u*h*l+d*p*f),!1!==n&&this.onChangeCallback(),this},setFromAxisAngle:function t(e,n){var r=n/2,i=Math.sin(r);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(r),this.onChangeCallback(),this},setFromRotationMatrix:function t(e){var n=e.elements,r=n[0],i=n[4],o=n[8],a=n[1],s=n[5],c=n[9],u=n[2],h=n[6],l=n[10],d=r+s+l,p;return d>0?(p=.5/Math.sqrt(d+1),this._w=.25/p,this._x=(h-c)*p,this._y=(o-u)*p,this._z=(a-i)*p):r>s&&r>l?(p=2*Math.sqrt(1+r-s-l),this._w=(h-c)/p,this._x=.25*p,this._y=(i+a)/p,this._z=(o+u)/p):s>l?(p=2*Math.sqrt(1+s-r-l),this._w=(o-u)/p,this._x=(i+a)/p,this._y=.25*p,this._z=(c+h)/p):(p=2*Math.sqrt(1+l-r-s),this._w=(a-i)/p,this._x=(o+u)/p,this._y=(c+h)/p,this._z=.25*p),this.onChangeCallback(),this},setFromUnitVectors:function(){var t=new l,e,n=1e-6;return function n(r,i){return void 0===t&&(t=new l),(e=r.dot(i)+1)<1e-6?(e=0,Math.abs(r.x)>Math.abs(r.z)?t.set(-r.y,r.x,0):t.set(0,-r.z,r.y)):t.crossVectors(r,i),this._x=t.x,this._y=t.y,this._z=t.z,this._w=e,this.normalize()}}(),inverse:function t(){return this.conjugate()},conjugate:function t(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function t(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function t(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function t(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function t(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this.onChangeCallback(),this},multiply:function t(e,n){return void 0!==n?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,n)):this.multiplyQuaternions(this,e)},premultiply:function t(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function t(e,n){var r=e._x,i=e._y,o=e._z,a=e._w,s=n._x,c=n._y,u=n._z,h=n._w;return this._x=r*h+a*s+i*u-o*c,this._y=i*h+a*c+o*s-r*u,this._z=o*h+a*u+r*c-i*s,this._w=a*h-r*s-i*c-o*u,this.onChangeCallback(),this},slerp:function t(e,n){if(0===n)return this;if(1===n)return this.copy(e);var r=this._x,i=this._y,o=this._z,a=this._w,s=a*e._w+r*e._x+i*e._y+o*e._z;if(s<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,s=-s):this.copy(e),s>=1)return this._w=a,this._x=r,this._y=i,this._z=o,this;var c=Math.sqrt(1-s*s);if(Math.abs(c)<.001)return this._w=.5*(a+this._w),this._x=.5*(r+this._x),this._y=.5*(i+this._y),this._z=.5*(o+this._z),this;var u=Math.atan2(c,s),h=Math.sin((1-n)*u)/c,l=Math.sin(n*u)/c;return this._w=a*h+this._w*l,this._x=r*h+this._x*l,this._y=i*h+this._y*l,this._z=o*h+this._z*l,this.onChangeCallback(),this},equals:function t(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function t(e,n){return void 0===n&&(n=0),this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this.onChangeCallback(),this},toArray:function t(e,n){return void 0===e&&(e=[]),void 0===n&&(n=0),e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e},onChange:function t(e){return this.onChangeCallback=e,this},onChangeCallback:function t(){}}),Object.assign(l.prototype,{isVector3:!0,set:function t(e,n,r){return this.x=e,this.y=n,this.z=r,this},setScalar:function t(e){return this.x=e,this.y=e,this.z=e,this},setX:function t(e){return this.x=e,this},setY:function t(e){return this.y=e,this},setZ:function t(e){return this.z=e,this},setComponent:function t(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function t(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function t(){return new this.constructor(this.x,this.y,this.z)},copy:function t(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function t(e,n){return void 0!==n?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,n)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function t(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function t(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this},addScaledVector:function t(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this},sub:function t(e,n){return void 0!==n?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,n)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function t(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function t(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this},multiply:function t(e,n){return void 0!==n?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,n)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function t(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function t(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this},applyEuler:function(){var t=new h;return function e(n){return n&&n.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(t.setFromEuler(n))}}(),applyAxisAngle:function(){var t=new h;return function e(n,r){return this.applyQuaternion(t.setFromAxisAngle(n,r))}}(),applyMatrix3:function t(e){var n=this.x,r=this.y,i=this.z,o=e.elements;return this.x=o[0]*n+o[3]*r+o[6]*i,this.y=o[1]*n+o[4]*r+o[7]*i,this.z=o[2]*n+o[5]*r+o[8]*i,this},applyMatrix4:function t(e){var n=this.x,r=this.y,i=this.z,o=e.elements,a=1/(o[3]*n+o[7]*r+o[11]*i+o[15]);return this.x=(o[0]*n+o[4]*r+o[8]*i+o[12])*a,this.y=(o[1]*n+o[5]*r+o[9]*i+o[13])*a,this.z=(o[2]*n+o[6]*r+o[10]*i+o[14])*a,this},applyQuaternion:function t(e){var n=this.x,r=this.y,i=this.z,o=e.x,a=e.y,s=e.z,c=e.w,u=c*n+a*i-s*r,h=c*r+s*n-o*i,l=c*i+o*r-a*n,d=-o*n-a*r-s*i;return this.x=u*c+d*-o+h*-s-l*-a,this.y=h*c+d*-a+l*-o-u*-s,this.z=l*c+d*-s+u*-a-h*-o,this},project:function(){var t=new u;return function e(n){return t.multiplyMatrices(n.projectionMatrix,t.getInverse(n.matrixWorld)),this.applyMatrix4(t)}}(),unproject:function(){var t=new u;return function e(n){return t.multiplyMatrices(n.matrixWorld,t.getInverse(n.projectionMatrix)),this.applyMatrix4(t)}}(),transformDirection:function t(e){var n=this.x,r=this.y,i=this.z,o=e.elements;return this.x=o[0]*n+o[4]*r+o[8]*i,this.y=o[1]*n+o[5]*r+o[9]*i,this.z=o[2]*n+o[6]*r+o[10]*i,this.normalize()},divide:function t(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function t(e){return this.multiplyScalar(1/e)},min:function t(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function t(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function t(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this},clampScalar:function(){var t=new l,e=new l;return function n(r,i){return t.set(r,r,r),e.set(i,i,i),this.clamp(t,e)}}(),clampLength:function t(e,n){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(n,r)))},floor:function t(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function t(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function t(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function t(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function t(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function t(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function t(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function t(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function t(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function t(){return this.divideScalar(this.length()||1)},setLength:function t(e){return this.normalize().multiplyScalar(e)},lerp:function t(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this},lerpVectors:function t(e,n,r){return this.subVectors(n,e).multiplyScalar(r).add(e)},cross:function t(e,n){return void 0!==n?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,n)):this.crossVectors(this,e)},crossVectors:function t(e,n){var r=e.x,i=e.y,o=e.z,a=n.x,s=n.y,c=n.z;return this.x=i*c-o*s,this.y=o*a-r*c,this.z=r*s-i*a,this},projectOnVector:function t(e){var n=e.dot(this)/e.lengthSq();return this.copy(e).multiplyScalar(n)},projectOnPlane:function(){var t=new l;return function e(n){return t.copy(this).projectOnVector(n),this.sub(t)}}(),reflect:function(){var t=new l;return function e(n){return this.sub(t.copy(n).multiplyScalar(2*this.dot(n)))}}(),angleTo:function t(e){var n=this.dot(e)/Math.sqrt(this.lengthSq()*e.lengthSq());return Math.acos(Ry.clamp(n,-1,1))},distanceTo:function t(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function t(e){var n=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return n*n+r*r+i*i},manhattanDistanceTo:function t(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function t(e){var n=Math.sin(e.phi)*e.radius;return this.x=n*Math.sin(e.theta),this.y=Math.cos(e.phi)*e.radius,this.z=n*Math.cos(e.theta),this},setFromCylindrical:function t(e){return this.x=e.radius*Math.sin(e.theta),this.y=e.y,this.z=e.radius*Math.cos(e.theta),this},setFromMatrixPosition:function t(e){var n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this},setFromMatrixScale:function t(e){var n=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=r,this.z=i,this},setFromMatrixColumn:function t(e,n){return this.fromArray(e.elements,4*n)},equals:function t(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function t(e,n){return void 0===n&&(n=0),this.x=e[n],this.y=e[n+1],this.z=e[n+2],this},toArray:function t(e,n){return void 0===e&&(e=[]),void 0===n&&(n=0),e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e},fromBufferAttribute:function t(e,n,r){return void 0!==r&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}}),Object.assign(d.prototype,{isMatrix3:!0,set:function t(e,n,r,i,o,a,s,c,u){var h=this.elements;return h[0]=e,h[1]=i,h[2]=s,h[3]=n,h[4]=o,h[5]=c,h[6]=r,h[7]=a,h[8]=u,this},identity:function t(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function t(){return(new this.constructor).fromArray(this.elements)},copy:function t(e){var n=this.elements,r=e.elements;return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],this},setFromMatrix4:function t(e){var n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this},applyToBufferAttribute:function(){var t=new l;return function e(n){for(var r=0,i=n.count;r<i;r++)t.x=n.getX(r),t.y=n.getY(r),t.z=n.getZ(r),t.applyMatrix3(this),n.setXYZ(r,t.x,t.y,t.z);return n}}(),multiply:function t(e){return this.multiplyMatrices(this,e)},premultiply:function t(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function t(e,n){var r=e.elements,i=n.elements,o=this.elements,a=r[0],s=r[3],c=r[6],u=r[1],h=r[4],l=r[7],d=r[2],p=r[5],f=r[8],m=i[0],v=i[3],g=i[6],y=i[1],x=i[4],b=i[7],w=i[2],_=i[5],S=i[8];return o[0]=a*m+s*y+c*w,o[3]=a*v+s*x+c*_,o[6]=a*g+s*b+c*S,o[1]=u*m+h*y+l*w,o[4]=u*v+h*x+l*_,o[7]=u*g+h*b+l*S,o[2]=d*m+p*y+f*w,o[5]=d*v+p*x+f*_,o[8]=d*g+p*b+f*S,this},multiplyScalar:function t(e){var n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this},determinant:function t(){var e=this.elements,n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],c=e[6],u=e[7],h=e[8];return n*a*h-n*s*u-r*o*h+r*s*c+i*o*u-i*a*c},getInverse:function t(e,n){e&&e.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var r=e.elements,i=this.elements,o=r[0],a=r[1],s=r[2],c=r[3],u=r[4],h=r[5],l=r[6],d=r[7],p=r[8],f=p*u-h*d,m=h*l-p*c,v=d*c-u*l,g=o*f+a*m+s*v;if(0===g){var y="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(!0===n)throw new Error(y);return console.warn(y),this.identity()}var x=1/g;return i[0]=f*x,i[1]=(s*d-p*a)*x,i[2]=(h*a-s*u)*x,i[3]=m*x,i[4]=(p*o-s*l)*x,i[5]=(s*c-h*o)*x,i[6]=v*x,i[7]=(a*l-d*o)*x,i[8]=(u*o-a*c)*x,this},transpose:function t(){var e,n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this},getNormalMatrix:function t(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function t(e){var n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this},setUvTransform:function t(e,n,r,i,o,a,s){var c=Math.cos(o),u=Math.sin(o);this.set(r*c,r*u,-r*(c*a+u*s)+a+e,-i*u,i*c,-i*(-u*a+c*s)+s+n,0,0,1)},scale:function t(e,n){var r=this.elements;return r[0]*=e,r[3]*=e,r[6]*=e,r[1]*=n,r[4]*=n,r[7]*=n,this},rotate:function t(e){var n=Math.cos(e),r=Math.sin(e),i=this.elements,o=i[0],a=i[3],s=i[6],c=i[1],u=i[4],h=i[7];return i[0]=n*o+r*c,i[3]=n*a+r*u,i[6]=n*s+r*h,i[1]=-r*o+n*c,i[4]=-r*a+n*u,i[7]=-r*s+n*h,this},translate:function t(e,n){var r=this.elements;return r[0]+=e*r[2],r[3]+=e*r[5],r[6]+=e*r[8],r[1]+=n*r[2],r[4]+=n*r[5],r[7]+=n*r[8],this},equals:function t(e){for(var n=this.elements,r=e.elements,i=0;i<9;i++)if(n[i]!==r[i])return!1;return!0},fromArray:function t(e,n){void 0===n&&(n=0);for(var r=0;r<9;r++)this.elements[r]=e[r+n];return this},toArray:function t(e,n){void 0===e&&(e=[]),void 0===n&&(n=0);var r=this.elements;return e[n]=r[0],e[n+1]=r[1],e[n+2]=r[2],e[n+3]=r[3],e[n+4]=r[4],e[n+5]=r[5],e[n+6]=r[6],e[n+7]=r[7],e[n+8]=r[8],e}});var Iy=0;p.DEFAULT_IMAGE=void 0,p.DEFAULT_MAPPING=300,p.prototype=Object.assign(Object.create(s.prototype),{constructor:p,isTexture:!0,clone:function t(){return(new this.constructor).copy(this)},copy:function t(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function t(e){function n(t){var e;if(t instanceof HTMLCanvasElement)e=t;else{(e=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).width=t.width,e.height=t.height;var n=e.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height)}return e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}var r=void 0===e||"string"==typeof e;if(!r&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var o=this.image;void 0===o.uuid&&(o.uuid=Ry.generateUUID()),r||void 0!==e.images[o.uuid]||(e.images[o.uuid]={uuid:o.uuid,url:n(o)}),i.image=o.uuid}return r||(e.textures[this.uuid]=i),i},dispose:function t(){this.dispatchEvent({type:"dispose"})},transformUv:function t(e){if(300===this.mapping){if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case dg:e.x=e.x-Math.floor(e.x);break;case pg:e.x=e.x<0?0:1;break;case fg:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case dg:e.y=e.y-Math.floor(e.y);break;case pg:e.y=e.y<0?0:1;break;case fg:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}this.flipY&&(e.y=1-e.y)}}}),Object.defineProperty(p.prototype,"needsUpdate",{set:function t(e){!0===e&&this.version++}}),Object.assign(f.prototype,{isVector4:!0,set:function t(e,n,r,i){return this.x=e,this.y=n,this.z=r,this.w=i,this},setScalar:function t(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function t(e){return this.x=e,this},setY:function t(e){return this.y=e,this},setZ:function t(e){return this.z=e,this},setW:function t(e){return this.w=e,this},setComponent:function t(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function t(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function t(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function t(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function t(e,n){return void 0!==n?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,n)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function t(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function t(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this},addScaledVector:function t(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this},sub:function t(e,n){return void 0!==n?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,n)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function t(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function t(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this},multiplyScalar:function t(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function t(e){var n=this.x,r=this.y,i=this.z,o=this.w,a=e.elements;return this.x=a[0]*n+a[4]*r+a[8]*i+a[12]*o,this.y=a[1]*n+a[5]*r+a[9]*i+a[13]*o,this.z=a[2]*n+a[6]*r+a[10]*i+a[14]*o,this.w=a[3]*n+a[7]*r+a[11]*i+a[15]*o,this},divideScalar:function t(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function t(e){this.w=2*Math.acos(e.w);var n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this},setAxisAngleFromRotationMatrix:function t(e){var n,r,i,o,a=.01,s=.1,c=e.elements,u=c[0],h=c[4],l=c[8],d=c[1],p=c[5],f=c[9],m=c[2],v=c[6],g=c[10];if(Math.abs(h-d)<.01&&Math.abs(l-m)<.01&&Math.abs(f-v)<.01){if(Math.abs(h+d)<.1&&Math.abs(l+m)<.1&&Math.abs(f+v)<.1&&Math.abs(u+p+g-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;var y=(u+1)/2,x=(p+1)/2,b=(g+1)/2,w=(h+d)/4,_=(l+m)/4,S=(f+v)/4;return y>x&&y>b?y<.01?(r=0,i=.707106781,o=.707106781):(i=w/(r=Math.sqrt(y)),o=_/r):x>b?x<.01?(r=.707106781,i=0,o=.707106781):(r=w/(i=Math.sqrt(x)),o=S/i):b<.01?(r=.707106781,i=.707106781,o=0):(r=_/(o=Math.sqrt(b)),i=S/o),this.set(r,i,o,n),this}var M=Math.sqrt((v-f)*(v-f)+(l-m)*(l-m)+(d-h)*(d-h));return Math.abs(M)<.001&&(M=1),this.x=(v-f)/M,this.y=(l-m)/M,this.z=(d-h)/M,this.w=Math.acos((u+p+g-1)/2),this},min:function t(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function t(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function t(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this.w=Math.max(e.w,Math.min(n.w,this.w)),this},clampScalar:function(){var t,e;return function n(r,i){return void 0===t&&(t=new f,e=new f),t.set(r,r,r,r),e.set(i,i,i,i),this.clamp(t,e)}}(),clampLength:function t(e,n){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(n,r)))},floor:function t(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function t(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function t(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function t(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function t(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function t(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function t(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function t(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function t(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function t(){return this.divideScalar(this.length()||1)},setLength:function t(e){return this.normalize().multiplyScalar(e)},lerp:function t(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this},lerpVectors:function t(e,n,r){return this.subVectors(n,e).multiplyScalar(r).add(e)},equals:function t(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function t(e,n){return void 0===n&&(n=0),this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this},toArray:function t(e,n){return void 0===e&&(e=[]),void 0===n&&(n=0),e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e},fromBufferAttribute:function t(e,n,r){return void 0!==r&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}}),m.prototype=Object.assign(Object.create(s.prototype),{constructor:m,isWebGLRenderTarget:!0,setSize:function t(e,n){this.width===e&&this.height===n||(this.width=e,this.height=n,this.dispose()),this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n)},clone:function t(){return(new this.constructor).copy(this)},copy:function t(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function t(){this.dispatchEvent({type:"dispose"})}}),v.prototype=Object.create(m.prototype),v.prototype.constructor=v,v.prototype.isWebGLRenderTargetCube=!0,g.prototype=Object.create(p.prototype),g.prototype.constructor=g,g.prototype.isDataTexture=!0,y.prototype=Object.create(p.prototype),y.prototype.constructor=y,y.prototype.isCubeTexture=!0,Object.defineProperty(y.prototype,"images",{get:function t(){return this.image},set:function t(e){this.image=e}});var Cy=new p,Oy=new y,Ny=[],Fy=[],Dy=new Float32Array(16),Uy=new Float32Array(9);Z.prototype.setValue=function(t,e){for(var n=this.seq,r=0,i=n.length;r!==i;++r){var o=n[r];o.setValue(t,e[o.id])}};var By=/([\w\d_]+)(\])?(\[|\.)?/g;K.prototype.setValue=function(t,e,n){var r=this.map[e];void 0!==r&&r.setValue(t,n,this.renderer)},K.prototype.setOptional=function(t,e,n){var r=e[n];void 0!==r&&this.setValue(t,n,r)},K.upload=function(t,e,n,r){for(var i=0,o=e.length;i!==o;++i){var a=e[i],s=n[a.id];!1!==s.needsUpdate&&a.setValue(t,s.value,r)}},K.seqWithValue=function(t,e){for(var n=[],r=0,i=t.length;r!==i;++r){var o=t[r];o.id in e&&n.push(o)}return n};var zy={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Object.assign($.prototype,{isColor:!0,r:1,g:1,b:1,set:function t(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setScalar:function t(e){return this.r=e,this.g=e,this.b=e,this},setHex:function t(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function t(e,n,r){return this.r=e,this.g=n,this.b=r,this},setHSL:function(){function t(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}return function e(n,r,i){if(n=Ry.euclideanModulo(n,1),r=Ry.clamp(r,0,1),i=Ry.clamp(i,0,1),0===r)this.r=this.g=this.b=i;else{var o=i<=.5?i*(1+r):i+r-i*r,a=2*i-o;this.r=t(a,o,n+1/3),this.g=t(a,o,n),this.b=t(a,o,n-1/3)}return this}}(),setStyle:function t(e){function n(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var r;if(r=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var i,o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(i=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(i[1],10))/255,this.g=Math.min(255,parseInt(i[2],10))/255,this.b=Math.min(255,parseInt(i[3],10))/255,n(i[5]),this;if(i=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(i[1],10))/100,this.g=Math.min(100,parseInt(i[2],10))/100,this.b=Math.min(100,parseInt(i[3],10))/100,n(i[5]),this;break;case"hsl":case"hsla":if(i=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a)){var s=parseFloat(i[1])/360,c=parseInt(i[2],10)/100,u=parseInt(i[3],10)/100;return n(i[5]),this.setHSL(s,c,u)}}}else if(r=/^\#([A-Fa-f0-9]+)$/.exec(e)){var h,l=(h=r[1]).length;if(3===l)return this.r=parseInt(h.charAt(0)+h.charAt(0),16)/255,this.g=parseInt(h.charAt(1)+h.charAt(1),16)/255,this.b=parseInt(h.charAt(2)+h.charAt(2),16)/255,this;if(6===l)return this.r=parseInt(h.charAt(0)+h.charAt(1),16)/255,this.g=parseInt(h.charAt(2)+h.charAt(3),16)/255,this.b=parseInt(h.charAt(4)+h.charAt(5),16)/255,this}if(e&&e.length>0){var h;void 0!==(h=zy[e])?this.setHex(h):console.warn("THREE.Color: Unknown color "+e)}return this},clone:function t(){return new this.constructor(this.r,this.g,this.b)},copy:function t(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function t(e,n){return void 0===n&&(n=2),this.r=Math.pow(e.r,n),this.g=Math.pow(e.g,n),this.b=Math.pow(e.b,n),this},copyLinearToGamma:function t(e,n){void 0===n&&(n=2);var r=n>0?1/n:1;return this.r=Math.pow(e.r,r),this.g=Math.pow(e.g,r),this.b=Math.pow(e.b,r),this},convertGammaToLinear:function t(){var e=this.r,n=this.g,r=this.b;return this.r=e*e,this.g=n*n,this.b=r*r,this},convertLinearToGamma:function t(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function t(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function t(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function t(e){var n=e||{h:0,s:0,l:0},r=this.r,i=this.g,o=this.b,a=Math.max(r,i,o),s=Math.min(r,i,o),c,u,h=(s+a)/2;if(s===a)c=0,u=0;else{var l=a-s;switch(u=h<=.5?l/(a+s):l/(2-a-s),a){case r:c=(i-o)/l+(i<o?6:0);break;case i:c=(o-r)/l+2;break;case o:c=(r-i)/l+4}c/=6}return n.h=c,n.s=u,n.l=h,n},getStyle:function t(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function t(e,n,r){var i=this.getHSL();return i.h+=e,i.s+=n,i.l+=r,this.setHSL(i.h,i.s,i.l),this},add:function t(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function t(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this},addScalar:function t(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function t(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function t(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function t(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function t(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this},equals:function t(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function t(e,n){return void 0===n&&(n=0),this.r=e[n],this.g=e[n+1],this.b=e[n+2],this},toArray:function t(e,n){return void 0===e&&(e=[]),void 0===n&&(n=0),e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e},toJSON:function t(){return this.getHex()}});var Gy={common:{diffuse:{value:new $(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new d},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new c(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new $(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new $(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new d}}},ky={merge:function t(e){for(var n={},r=0;r<e.length;r++){var i=this.clone(e[r]);for(var o in i)n[o]=i[o]}return n},clone:function t(e){var n={};for(var r in e){n[r]={};for(var i in e[r]){var o=e[r][i];o&&(o.isColor||o.isMatrix3||o.isMatrix4||o.isVector2||o.isVector3||o.isVector4||o.isTexture)?n[r][i]=o.clone():Array.isArray(o)?n[r][i]=o.slice():n[r][i]=o}}return n}},jy,Vy,Hy,Wy,Yy,Xy,qy,Zy,Jy,Qy,Ky,$y,tx,ex,nx,rx,ix,ox,ax,sx,cx,ux,hx,lx,dx,px,fx,mx,vx,gx,yx,xx,bx,wx,_x,Sx,Mx,Ex,Tx,Lx,Ax,Px,Rx,Ix,Cx,Ox,Nx,Fx,Dx,Ux,Bx,zx,Gx,kx,jx,Vx,Hx,Wx,Yx,Xx,qx,Zx,Jx,Qx,Kx,$x,tb,eb,nb,rb,ib,ob,ab,sb,cb,ub,hb,lb,db,pb,fb,mb,vb,gb,yb,xb,bb,wb,_b,Sb,Mb,Eb,Tb,Lb,Ab,Pb,Rb,Ib,Cb,Ob,Nb,Fb,Db,Ub,Bb,zb,Gb,kb,jb,Vb={alphamap_fragment:"#define GLSLIFY 1\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",alphamap_pars_fragment:"#define GLSLIFY 1\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",alphatest_fragment:"#define GLSLIFY 1\n#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",aomap_fragment:"#define GLSLIFY 1\n#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",aomap_pars_fragment:"#define GLSLIFY 1\n#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"#define GLSLIFY 1\nvec3 transformed = vec3( position );\n",beginnormal_vertex:"#define GLSLIFY 1\nvec3 objectNormal = vec3( normal );\n",bsdfs:"#define GLSLIFY 1\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t}\n\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",bumpmap_pars_fragment:"#define GLSLIFY 1\n#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",clipping_planes_fragment:"#define GLSLIFY 1\n#if NUM_CLIPPING_PLANES > 0\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; ++ i ) {\n\t\tvec4 plane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t\t\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; ++ i ) {\n\t\t\tvec4 plane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t\n\t#endif\n#endif\n",clipping_planes_pars_fragment:"#define GLSLIFY 1\n#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",clipping_planes_pars_vertex:"#define GLSLIFY 1\n#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",clipping_planes_vertex:"#define GLSLIFY 1\n#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",color_fragment:"#define GLSLIFY 1\n#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#define GLSLIFY 1\n#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",color_pars_vertex:"#define GLSLIFY 1\n#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#define GLSLIFY 1\n#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define GLSLIFY 1\n#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\n",cube_uv_reflection_fragment:"#define GLSLIFY 1\n#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",defaultnormal_vertex:"#define GLSLIFY 1\nvec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n",displacementmap_pars_vertex:"#define GLSLIFY 1\n#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",displacementmap_vertex:"#define GLSLIFY 1\n#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",emissivemap_fragment:"#define GLSLIFY 1\n#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",emissivemap_pars_fragment:"#define GLSLIFY 1\n#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",encodings_fragment:"#define GLSLIFY 1\n  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment:"#define GLSLIFY 1\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM            = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat D      = max( maxRange / maxRGB, 1.0 );\n\tD            = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract(Le);\n\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max(vRGB, 0.0), 1.0 );\n}\n",envmap_fragment:"#define GLSLIFY 1\n#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",envmap_pars_fragment:"#define GLSLIFY 1\n#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",envmap_pars_vertex:"#define GLSLIFY 1\n#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",envmap_vertex:"#define GLSLIFY 1\n#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",fog_vertex:"#define GLSLIFY 1\n#ifdef USE_FOG\nfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#define GLSLIFY 1\n#ifdef USE_FOG\n  varying float fogDepth;\n#endif\n",fog_fragment:"#define GLSLIFY 1\n#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",fog_pars_fragment:"#define GLSLIFY 1\n#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n",gradientmap_pars_fragment:"#define GLSLIFY 1\n#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n",lightmap_fragment:"#define GLSLIFY 1\n#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",lightmap_pars_fragment:"#define GLSLIFY 1\n#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"#define GLSLIFY 1\nvec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",lights_pars:"#define GLSLIFY 1\nuniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",lights_phong_fragment:"#define GLSLIFY 1\nBlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment:"#define GLSLIFY 1\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",lights_physical_fragment:"#define GLSLIFY 1\nPhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",lights_physical_pars_fragment:"#define GLSLIFY 1\nstruct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",lights_template:"#define GLSLIFY 1\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, 8 );\n\t#endif\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\n\t#ifndef STANDARD\n\t\tvec3 clearCoatRadiance = getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), 8 );\n\t#else\n\t\tvec3 clearCoatRadiance = vec3( 0.0 );\n\t#endif\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",logdepthbuf_fragment:"#define GLSLIFY 1\n#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#define GLSLIFY 1\n#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",logdepthbuf_pars_vertex:"#define GLSLIFY 1\n#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",logdepthbuf_vertex:"#define GLSLIFY 1\n#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif\n",map_fragment:"#define GLSLIFY 1\n#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",map_pars_fragment:"#define GLSLIFY 1\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",map_particle_fragment:"#define GLSLIFY 1\n#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",map_particle_pars_fragment:"#define GLSLIFY 1\n#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif\n",metalnessmap_fragment:"#define GLSLIFY 1\nfloat metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif\n",metalnessmap_pars_fragment:"#define GLSLIFY 1\n#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#define GLSLIFY 1\n#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",morphtarget_pars_vertex:"#define GLSLIFY 1\n#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#define GLSLIFY 1\n#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",normal_fragment:"#define GLSLIFY 1\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n#endif\n#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",normalmap_pars_fragment:"#define GLSLIFY 1\n#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",packing:"#define GLSLIFY 1\nvec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",premultiplied_alpha_fragment:"#define GLSLIFY 1\n#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",project_vertex:"#define GLSLIFY 1\nvec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n",dithering_fragment:"#define GLSLIFY 1\n#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif\n",dithering_pars_fragment:"#define GLSLIFY 1\n#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif\n",roughnessmap_fragment:"#define GLSLIFY 1\nfloat roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif\n",roughnessmap_pars_fragment:"#define GLSLIFY 1\n#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#define GLSLIFY 1\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",shadowmap_pars_vertex:"#define GLSLIFY 1\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",shadowmap_vertex:"#define GLSLIFY 1\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",shadowmask_pars_fragment:"#define GLSLIFY 1\nfloat getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",skinbase_vertex:"#define GLSLIFY 1\n#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#define GLSLIFY 1\n#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",skinning_vertex:"#define GLSLIFY 1\n#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif\n",skinnormal_vertex:"#define GLSLIFY 1\n#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",specularmap_fragment:"#define GLSLIFY 1\nfloat specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#define GLSLIFY 1\n#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#define GLSLIFY 1\n#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",tonemapping_pars_fragment:"#define GLSLIFY 1\n#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",uv_pars_fragment:"#define GLSLIFY 1\n#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#define GLSLIFY 1\n#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\n",uv_vertex:"#define GLSLIFY 1\n#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#define GLSLIFY 1\n#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#define GLSLIFY 1\n#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#define GLSLIFY 1\n#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#define GLSLIFY 1\n#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif\n",cube_frag:"#define GLSLIFY 1\nuniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",cube_vert:"#define GLSLIFY 1\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}\n",depth_frag:"#define GLSLIFY 1\n#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",depth_vert:"#define GLSLIFY 1\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",distanceRGBA_frag:"#define GLSLIFY 1\n#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}\n",distanceRGBA_vert:"#define GLSLIFY 1\n#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}\n",equirect_frag:"#define GLSLIFY 1\nuniform sampler2D tEquirect;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",equirect_vert:"#define GLSLIFY 1\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",linedashed_frag:"#define GLSLIFY 1\nuniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",linedashed_vert:"#define GLSLIFY 1\nuniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n",meshbasic_frag:"#define GLSLIFY 1\nuniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshbasic_vert:"#define GLSLIFY 1\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n",meshlambert_frag:"#define GLSLIFY 1\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshlambert_vert:"#define GLSLIFY 1\n#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphong_frag:"#define GLSLIFY 1\n#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphong_vert:"#define GLSLIFY 1\n#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphysical_frag:"#define GLSLIFY 1\n#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphysical_vert:"#define GLSLIFY 1\n#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",normal_frag:"#define GLSLIFY 1\n#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n",normal_vert:"#define GLSLIFY 1\n#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n",points_frag:"#define GLSLIFY 1\nuniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",points_vert:"#define GLSLIFY 1\nuniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",shadow_frag:"#define GLSLIFY 1\nuniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}\n",shadow_vert:"#define GLSLIFY 1\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n"},Hb={basic:{uniforms:ky.merge([Gy.common,Gy.specularmap,Gy.envmap,Gy.aomap,Gy.lightmap,Gy.fog]),vertexShader:Vb.meshbasic_vert,fragmentShader:Vb.meshbasic_frag},lambert:{uniforms:ky.merge([Gy.common,Gy.specularmap,Gy.envmap,Gy.aomap,Gy.lightmap,Gy.emissivemap,Gy.fog,Gy.lights,{emissive:{value:new $(0)}}]),vertexShader:Vb.meshlambert_vert,fragmentShader:Vb.meshlambert_frag},phong:{uniforms:ky.merge([Gy.common,Gy.specularmap,Gy.envmap,Gy.aomap,Gy.lightmap,Gy.emissivemap,Gy.bumpmap,Gy.normalmap,Gy.displacementmap,Gy.gradientmap,Gy.fog,Gy.lights,{emissive:{value:new $(0)},specular:{value:new $(1118481)},shininess:{value:30}}]),vertexShader:Vb.meshphong_vert,fragmentShader:Vb.meshphong_frag},standard:{uniforms:ky.merge([Gy.common,Gy.envmap,Gy.aomap,Gy.lightmap,Gy.emissivemap,Gy.bumpmap,Gy.normalmap,Gy.displacementmap,Gy.roughnessmap,Gy.metalnessmap,Gy.fog,Gy.lights,{emissive:{value:new $(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:Vb.meshphysical_vert,fragmentShader:Vb.meshphysical_frag},points:{uniforms:ky.merge([Gy.points,Gy.fog]),vertexShader:Vb.points_vert,fragmentShader:Vb.points_frag},dashed:{uniforms:ky.merge([Gy.common,Gy.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Vb.linedashed_vert,fragmentShader:Vb.linedashed_frag},depth:{uniforms:ky.merge([Gy.common,Gy.displacementmap]),vertexShader:Vb.depth_vert,fragmentShader:Vb.depth_frag},normal:{uniforms:ky.merge([Gy.common,Gy.bumpmap,Gy.normalmap,Gy.displacementmap,{opacity:{value:1}}]),vertexShader:Vb.normal_vert,fragmentShader:Vb.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Vb.cube_vert,fragmentShader:Vb.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Vb.equirect_vert,fragmentShader:Vb.equirect_frag},distanceRGBA:{uniforms:ky.merge([Gy.common,Gy.displacementmap,{referencePosition:{value:new l},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Vb.distanceRGBA_vert,fragmentShader:Vb.distanceRGBA_frag},shadow:{uniforms:ky.merge([Gy.lights,Gy.fog,{color:{value:new $(0)},opacity:{value:1}}]),vertexShader:Vb.shadow_vert,fragmentShader:Vb.shadow_frag}};Hb.physical={uniforms:ky.merge([Hb.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:Vb.meshphysical_vert,fragmentShader:Vb.meshphysical_frag},tt.prototype=Object.create(p.prototype),tt.prototype.constructor=tt;var Wb=0;nt.prototype=Object.assign(Object.create(s.prototype),{constructor:nt,isMaterial:!0,onBeforeCompile:function t(){},setValues:function t(e){if(void 0!==e)for(var n in e){var r=e[n];if(void 0!==r)if("shading"!==n){var i=this[n];void 0!==i?i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[n]="overdraw"===n?Number(r):r:console.warn("THREE."+this.type+": '"+n+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===r;else console.warn("THREE.Material: '"+n+"' parameter is undefined.")}},toJSON:function t(e){function n(t){var e=[];for(var n in t){var r=t[n];delete r.metadata,e.push(r)}return e}var r=void 0===e||"string"==typeof e;r&&(e={textures:{},images:{}});var i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearCoat&&(i.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(i.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,i.reflectivity=this.reflectivity),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(i.size=this.size),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==wv&&(i.blending=this.blending),!0===this.flatShading&&(i.flatShading=this.flatShading),this.side!==pv&&(i.side=this.side),this.vertexColors!==gv&&(i.vertexColors=this.vertexColors),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,0!==this.rotation&&(i.rotation=this.rotation),1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(i.morphTargets=!0),!0===this.skinning&&(i.skinning=!0),!1===this.visible&&(i.visible=!1),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),r){var o=n(e.textures),a=n(e.images);o.length>0&&(i.textures=o),a.length>0&&(i.images=a)}return i},clone:function t(){return(new this.constructor).copy(this)},copy:function t(e){this.name=e.name,this.fog=e.fog,this.lights=e.lights,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.overdraw=e.overdraw,this.visible=e.visible,this.userData=JSON.parse(JSON.stringify(e.userData)),this.clipShadows=e.clipShadows,this.clipIntersection=e.clipIntersection;var n=e.clippingPlanes,r=null;if(null!==n){var i=n.length;r=new Array(i);for(var o=0;o!==i;++o)r[o]=n[o].clone()}return this.clippingPlanes=r,this.shadowSide=e.shadowSide,this},dispose:function t(){this.dispatchEvent({type:"dispose"})}}),rt.prototype=Object.create(nt.prototype),rt.prototype.constructor=rt,rt.prototype.isMeshDepthMaterial=!0,rt.prototype.copy=function(t){return nt.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},it.prototype=Object.create(nt.prototype),it.prototype.constructor=it,it.prototype.isMeshDistanceMaterial=!0,it.prototype.copy=function(t){return nt.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this},Object.assign(ot.prototype,{isBox3:!0,set:function t(e,n){return this.min.copy(e),this.max.copy(n),this},setFromArray:function t(e){for(var n=1/0,r=1/0,i=1/0,o=-1/0,a=-1/0,s=-1/0,c=0,u=e.length;c<u;c+=3){var h=e[c],l=e[c+1],d=e[c+2];h<n&&(n=h),l<r&&(r=l),d<i&&(i=d),h>o&&(o=h),l>a&&(a=l),d>s&&(s=d)}return this.min.set(n,r,i),this.max.set(o,a,s),this},setFromBufferAttribute:function t(e){for(var n=1/0,r=1/0,i=1/0,o=-1/0,a=-1/0,s=-1/0,c=0,u=e.count;c<u;c++){var h=e.getX(c),l=e.getY(c),d=e.getZ(c);h<n&&(n=h),l<r&&(r=l),d<i&&(i=d),h>o&&(o=h),l>a&&(a=l),d>s&&(s=d)}return this.min.set(n,r,i),this.max.set(o,a,s),this},setFromPoints:function t(e){this.makeEmpty();for(var n=0,r=e.length;n<r;n++)this.expandByPoint(e[n]);return this},setFromCenterAndSize:function(){var t=new l;return function e(n,r){var i=t.copy(r).multiplyScalar(.5);return this.min.copy(n).sub(i),this.max.copy(n).add(i),this}}(),setFromObject:function t(e){return this.makeEmpty(),this.expandByObject(e)},clone:function t(){return(new this.constructor).copy(this)},copy:function t(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function t(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function t(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function t(e){var n=e||new l;return this.isEmpty()?n.set(0,0,0):n.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function t(e){var n=e||new l;return this.isEmpty()?n.set(0,0,0):n.subVectors(this.max,this.min)},expandByPoint:function t(e){return this.min.min(e),this.max.max(e),this},expandByVector:function t(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function t(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(){function t(t){var o=t.geometry;if(void 0!==o)if(o.isGeometry){var a=o.vertices;for(n=0,r=a.length;n<r;n++)i.copy(a[n]),i.applyMatrix4(t.matrixWorld),e.expandByPoint(i)}else if(o.isBufferGeometry){var s=o.attributes.position;if(void 0!==s)for(n=0,r=s.count;n<r;n++)i.fromBufferAttribute(s,n).applyMatrix4(t.matrixWorld),e.expandByPoint(i)}}var e,n,r,i=new l;return function n(r){return e=this,r.updateMatrixWorld(!0),r.traverse(t),this}}(),containsPoint:function t(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function t(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function t(e,n){var r;return(n||new l).set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function t(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:function(){var t=new l;return function e(n){return this.clampPoint(n.center,t),t.distanceToSquared(n.center)<=n.radius*n.radius}}(),intersectsPlane:function t(e){var n,r;return e.normal.x>0?(n=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),n<=e.constant&&r>=e.constant},intersectsTriangle:function(){function t(t){var i,o;for(i=0,o=t.length-3;i<=o;i+=3){s.fromArray(t,i);var a=u.x*Math.abs(s.x)+u.y*Math.abs(s.y)+u.z*Math.abs(s.z),c=e.dot(s),h=n.dot(s),l=r.dot(s);if(Math.max(-Math.max(c,h,l),Math.min(c,h,l))>a)return!1}return!0}var e=new l,n=new l,r=new l,i=new l,o=new l,a=new l,s=new l,c=new l,u=new l,h=new l;return function s(l){if(this.isEmpty())return!1;this.getCenter(c),u.subVectors(this.max,c),e.subVectors(l.a,c),n.subVectors(l.b,c),r.subVectors(l.c,c),i.subVectors(n,e),o.subVectors(r,n),a.subVectors(e,r);var d=[0,-i.z,i.y,0,-o.z,o.y,0,-a.z,a.y,i.z,0,-i.x,o.z,0,-o.x,a.z,0,-a.x,-i.y,i.x,0,-o.y,o.x,0,-a.y,a.x,0];return!!t(d)&&(d=[1,0,0,0,1,0,0,0,1],!!t(d)&&(h.crossVectors(i,o),d=[h.x,h.y,h.z],t(d)))}}(),clampPoint:function t(e,n){var r;return(n||new l).copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var t=new l;return function e(n){var r;return t.copy(n).clamp(this.min,this.max).sub(n).length()}}(),getBoundingSphere:function(){var t=new l;return function e(n){var r=n||new at;return this.getCenter(r.center),r.radius=.5*this.getSize(t).length(),r}}(),intersect:function t(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function t(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(){var t=[new l,new l,new l,new l,new l,new l,new l,new l];return function e(n){return this.isEmpty()?this:(t[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(n),t[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(n),t[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(n),t[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(n),t[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(n),t[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(n),t[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(n),t[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(n),this.setFromPoints(t),this)}}(),translate:function t(e){return this.min.add(e),this.max.add(e),this},equals:function t(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Object.assign(at.prototype,{set:function t(e,n){return this.center.copy(e),this.radius=n,this},setFromPoints:function(){var t=new ot;return function e(n,r){var i=this.center;void 0!==r?i.copy(r):t.setFromPoints(n).getCenter(i);for(var o=0,a=0,s=n.length;a<s;a++)o=Math.max(o,i.distanceToSquared(n[a]));return this.radius=Math.sqrt(o),this}}(),clone:function t(){return(new this.constructor).copy(this)},copy:function t(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function t(){return this.radius<=0},containsPoint:function t(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function t(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function t(e){var n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n},intersectsBox:function t(e){return e.intersectsSphere(this)},intersectsPlane:function t(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function t(e,n){var r=this.center.distanceToSquared(e),i=n||new l;return i.copy(e),r>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i},getBoundingBox:function t(e){var n=e||new ot;return n.set(this.center,this.center),n.expandByScalar(this.radius),n},applyMatrix4:function t(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function t(e){return this.center.add(e),this},equals:function t(e){return e.center.equals(this.center)&&e.radius===this.radius}}),Object.assign(st.prototype,{set:function t(e,n){return this.normal.copy(e),this.constant=n,this},setComponents:function t(e,n,r,i){return this.normal.set(e,n,r),this.constant=i,this},setFromNormalAndCoplanarPoint:function t(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this},setFromCoplanarPoints:function(){var t=new l,e=new l;return function n(r,i,o){var a=t.subVectors(o,i).cross(e.subVectors(r,i)).normalize();return this.setFromNormalAndCoplanarPoint(a,r),this}}(),clone:function t(){return(new this.constructor).copy(this)},copy:function t(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function t(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function t(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function t(e){return this.normal.dot(e)+this.constant},distanceToSphere:function t(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function t(e,n){var r;return(n||new l).copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(){var t=new l;return function e(n,r){var i=r||new l,o=n.delta(t),a=this.normal.dot(o);if(0!==a){var s=-(n.start.dot(this.normal)+this.constant)/a;if(!(s<0||s>1))return i.copy(o).multiplyScalar(s).add(n.start)}else if(0===this.distanceToPoint(n.start))return i.copy(n.start)}}(),intersectsLine:function t(e){var n=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return n<0&&r>0||r<0&&n>0},intersectsBox:function t(e){return e.intersectsPlane(this)},intersectsSphere:function t(e){return e.intersectsPlane(this)},coplanarPoint:function t(e){var n;return(e||new l).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var t=new l,e=new d;return function n(r,i){var o=i||e.getNormalMatrix(r),a=this.coplanarPoint(t).applyMatrix4(r),s=this.normal.applyMatrix3(o).normalize();return this.constant=-a.dot(s),this}}(),translate:function t(e){return this.constant-=e.dot(this.normal),this},equals:function t(e){return e.normal.equals(this.normal)&&e.constant===this.constant}}),Object.assign(ct.prototype,{set:function t(e,n,r,i,o,a){var s=this.planes;return s[0].copy(e),s[1].copy(n),s[2].copy(r),s[3].copy(i),s[4].copy(o),s[5].copy(a),this},clone:function t(){return(new this.constructor).copy(this)},copy:function t(e){for(var n=this.planes,r=0;r<6;r++)n[r].copy(e.planes[r]);return this},setFromMatrix:function t(e){var n=this.planes,r=e.elements,i=r[0],o=r[1],a=r[2],s=r[3],c=r[4],u=r[5],h=r[6],l=r[7],d=r[8],p=r[9],f=r[10],m=r[11],v=r[12],g=r[13],y=r[14],x=r[15];return n[0].setComponents(s-i,l-c,m-d,x-v).normalize(),n[1].setComponents(s+i,l+c,m+d,x+v).normalize(),n[2].setComponents(s+o,l+u,m+p,x+g).normalize(),n[3].setComponents(s-o,l-u,m-p,x-g).normalize(),n[4].setComponents(s-a,l-h,m-f,x-y).normalize(),n[5].setComponents(s+a,l+h,m+f,x+y).normalize(),this},intersectsObject:function(){var t=new at;return function e(n){var r=n.geometry;return null===r.boundingSphere&&r.computeBoundingSphere(),t.copy(r.boundingSphere).applyMatrix4(n.matrixWorld),this.intersectsSphere(t)}}(),intersectsSprite:function(){var t=new at;return function e(n){return t.center.set(0,0,0),t.radius=.7071067811865476,t.applyMatrix4(n.matrixWorld),this.intersectsSphere(t)}}(),intersectsSphere:function t(e){for(var n=this.planes,r=e.center,i=-e.radius,o=0;o<6;o++){var a;if(n[o].distanceToPoint(r)<i)return!1}return!0},intersectsBox:function(){var t=new l,e=new l;return function n(r){for(var i=this.planes,o=0;o<6;o++){var a=i[o];t.x=a.normal.x>0?r.min.x:r.max.x,e.x=a.normal.x>0?r.max.x:r.min.x,t.y=a.normal.y>0?r.min.y:r.max.y,e.y=a.normal.y>0?r.max.y:r.min.y,t.z=a.normal.z>0?r.min.z:r.max.z,e.z=a.normal.z>0?r.max.z:r.min.z;var s=a.distanceToPoint(t),c=a.distanceToPoint(e);if(s<0&&c<0)return!1}return!0}}(),containsPoint:function t(e){for(var n=this.planes,r=0;r<6;r++)if(n[r].distanceToPoint(e)<0)return!1;return!0}}),lt.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],lt.DefaultOrder="XYZ",Object.defineProperties(lt.prototype,{x:{get:function t(){return this._x},set:function t(e){this._x=e,this.onChangeCallback()}},y:{get:function t(){return this._y},set:function t(e){this._y=e,this.onChangeCallback()}},z:{get:function t(){return this._z},set:function t(e){this._z=e,this.onChangeCallback()}},order:{get:function t(){return this._order},set:function t(e){this._order=e,this.onChangeCallback()}}}),Object.assign(lt.prototype,{isEuler:!0,set:function t(e,n,r,i){return this._x=e,this._y=n,this._z=r,this._order=i||this._order,this.onChangeCallback(),this},clone:function t(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function t(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this.onChangeCallback(),this},setFromRotationMatrix:function t(e,n,r){var i=Ry.clamp,o=e.elements,a=o[0],s=o[4],c=o[8],u=o[1],h=o[5],l=o[9],d=o[2],p=o[6],f=o[10];return"XYZ"===(n=n||this._order)?(this._y=Math.asin(i(c,-1,1)),Math.abs(c)<.99999?(this._x=Math.atan2(-l,f),this._z=Math.atan2(-s,a)):(this._x=Math.atan2(p,h),this._z=0)):"YXZ"===n?(this._x=Math.asin(-i(l,-1,1)),Math.abs(l)<.99999?(this._y=Math.atan2(c,f),this._z=Math.atan2(u,h)):(this._y=Math.atan2(-d,a),this._z=0)):"ZXY"===n?(this._x=Math.asin(i(p,-1,1)),Math.abs(p)<.99999?(this._y=Math.atan2(-d,f),this._z=Math.atan2(-s,h)):(this._y=0,this._z=Math.atan2(u,a))):"ZYX"===n?(this._y=Math.asin(-i(d,-1,1)),Math.abs(d)<.99999?(this._x=Math.atan2(p,f),this._z=Math.atan2(u,a)):(this._x=0,this._z=Math.atan2(-s,h))):"YZX"===n?(this._z=Math.asin(i(u,-1,1)),Math.abs(u)<.99999?(this._x=Math.atan2(-l,h),this._y=Math.atan2(-d,a)):(this._x=0,this._y=Math.atan2(c,f))):"XZY"===n?(this._z=Math.asin(-i(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(p,h),this._y=Math.atan2(c,a)):(this._x=Math.atan2(-l,f),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+n),this._order=n,!1!==r&&this.onChangeCallback(),this},setFromQuaternion:function(){var t=new u;return function e(n,r,i){return t.makeRotationFromQuaternion(n),this.setFromRotationMatrix(t,r,i)}}(),setFromVector3:function t(e,n){return this.set(e.x,e.y,e.z,n||this._order)},reorder:function(){var t=new h;return function e(n){return t.setFromEuler(this),this.setFromQuaternion(t,n)}}(),equals:function t(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function t(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this.onChangeCallback(),this},toArray:function t(e,n){return void 0===e&&(e=[]),void 0===n&&(n=0),e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e},toVector3:function t(e){return e?e.set(this._x,this._y,this._z):new l(this._x,this._y,this._z)},onChange:function t(e){return this.onChangeCallback=e,this},onChangeCallback:function t(){}}),Object.assign(dt.prototype,{set:function t(e){this.mask=1<<e|0},enable:function t(e){this.mask|=1<<e|0},toggle:function t(e){this.mask^=1<<e|0},disable:function t(e){this.mask&=~(1<<e|0)},test:function t(e){return 0!=(this.mask&e.mask)}});var Yb=0;pt.DefaultUp=new l(0,1,0),pt.DefaultMatrixAutoUpdate=!0,pt.prototype=Object.assign(Object.create(s.prototype),{constructor:pt,isObject3D:!0,onBeforeRender:function t(){},onAfterRender:function t(){},applyMatrix:function t(e){this.matrix.multiplyMatrices(e,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function t(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function t(e,n){this.quaternion.setFromAxisAngle(e,n)},setRotationFromEuler:function t(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function t(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function t(e){this.quaternion.copy(e)},rotateOnAxis:function(){var t=new h;return function e(n,r){return t.setFromAxisAngle(n,r),this.quaternion.multiply(t),this}}(),rotateOnWorldAxis:function(){var t=new h;return function e(n,r){return t.setFromAxisAngle(n,r),this.quaternion.premultiply(t),this}}(),rotateX:function(){var t=new l(1,0,0);return function e(n){return this.rotateOnAxis(t,n)}}(),rotateY:function(){var t=new l(0,1,0);return function e(n){return this.rotateOnAxis(t,n)}}(),rotateZ:function(){var t=new l(0,0,1);return function e(n){return this.rotateOnAxis(t,n)}}(),translateOnAxis:function(){var t=new l;return function e(n,r){return t.copy(n).applyQuaternion(this.quaternion),this.position.add(t.multiplyScalar(r)),this}}(),translateX:function(){var t=new l(1,0,0);return function e(n){return this.translateOnAxis(t,n)}}(),translateY:function(){var t=new l(0,1,0);return function e(n){return this.translateOnAxis(t,n)}}(),translateZ:function(){var t=new l(0,0,1);return function e(n){return this.translateOnAxis(t,n)}}(),localToWorld:function t(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var t=new u;return function e(n){return n.applyMatrix4(t.getInverse(this.matrixWorld))}}(),lookAt:function(){var t=new u,e=new l;return function n(r,i,o){r.isVector3?e.copy(r):e.set(r,i,o),this.isCamera?t.lookAt(this.position,e,this.up):t.lookAt(e,this.position,this.up),this.quaternion.setFromRotationMatrix(t)}}(),add:function t(e){if(arguments.length>1){for(var n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,e.dispatchEvent({type:"added"}),this.children.push(e)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function t(e){if(arguments.length>1){for(var n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}var r=this.children.indexOf(e);return-1!==r&&(e.parent=null,e.dispatchEvent({type:"removed"}),this.children.splice(r,1)),this},getObjectById:function t(e){return this.getObjectByProperty("id",e)},getObjectByName:function t(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function t(e,n){if(this[e]===n)return this;for(var r=0,i=this.children.length;r<i;r++){var o,a=this.children[r].getObjectByProperty(e,n);if(void 0!==a)return a}},getWorldPosition:function t(e){var n=e||new l;return this.updateMatrixWorld(!0),n.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var t=new l,e=new l;return function n(r){var i=r||new h;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,i,e),i}}(),getWorldRotation:function(){var t=new h;return function e(n){var r=n||new lt;return this.getWorldQuaternion(t),r.setFromQuaternion(t,this.rotation.order,!1)}}(),getWorldScale:function(){var t=new l,e=new h;return function n(r){var i=r||new l;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,e,i),i}}(),getWorldDirection:function(){var t=new h;return function e(n){var r=n||new l;return this.getWorldQuaternion(t),r.set(0,0,1).applyQuaternion(t)}}(),raycast:function t(){},traverse:function t(e){e(this);for(var n=this.children,r=0,i=n.length;r<i;r++)n[r].traverse(e)},traverseVisible:function t(e){if(!1!==this.visible){e(this);for(var n=this.children,r=0,i=n.length;r<i;r++)n[r].traverseVisible(e)}},traverseAncestors:function t(e){var n=this.parent;null!==n&&(e(n),n.traverseAncestors(e))},updateMatrix:function t(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function t(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var n=this.children,r=0,i=n.length;r<i;r++)n[r].updateMatrixWorld(e)},toJSON:function t(e){function n(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}function r(t){var e=[];for(var n in t){var r=t[n];delete r.metadata,e.push(r)}return e}var i=void 0===e||"string"==typeof e,o={};i&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},o.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var a={};if(a.uuid=this.uuid,a.type=this.type,""!==this.name&&(a.name=this.name),!0===this.castShadow&&(a.castShadow=!0),!0===this.receiveShadow&&(a.receiveShadow=!0),!1===this.visible&&(a.visible=!1),"{}"!==JSON.stringify(this.userData)&&(a.userData=this.userData),a.matrix=this.matrix.toArray(),void 0!==this.geometry){a.geometry=n(e.geometries,this.geometry);var s=this.geometry.parameters;if(void 0!==s&&void 0!==s.shapes){var c=s.shapes;if(Array.isArray(c))for(var u=0,h=c.length;u<h;u++){var l=c[u];n(e.shapes,l)}else n(e.shapes,c)}}if(void 0!==this.material)if(Array.isArray(this.material)){for(var d=[],u=0,h=this.material.length;u<h;u++)d.push(n(e.materials,this.material[u]));a.material=d}else a.material=n(e.materials,this.material);if(this.children.length>0){a.children=[];for(var u=0;u<this.children.length;u++)a.children.push(this.children[u].toJSON(e).object)}if(i){var p=r(e.geometries),f=r(e.materials),m=r(e.textures),v=r(e.images),c=r(e.shapes);p.length>0&&(o.geometries=p),f.length>0&&(o.materials=f),m.length>0&&(o.textures=m),v.length>0&&(o.images=v),c.length>0&&(o.shapes=c)}return o.object=a,o},clone:function t(e){return(new this.constructor).copy(this,e)},copy:function t(e,n){if(void 0===n&&(n=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===n)for(var r=0;r<e.children.length;r++){var i=e.children[r];this.add(i.clone())}return this}}),ft.prototype=Object.assign(Object.create(pt.prototype),{constructor:ft,isCamera:!0,copy:function t(e,n){return pt.prototype.copy.call(this,e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this},getWorldDirection:function(){var t=new h;return function e(n){var r=n||new l;return this.getWorldQuaternion(t),r.set(0,0,-1).applyQuaternion(t)}}(),updateMatrixWorld:function t(e){pt.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function t(){return(new this.constructor).copy(this)}}),mt.prototype=Object.assign(Object.create(ft.prototype),{constructor:mt,isOrthographicCamera:!0,copy:function t(e,n){return ft.prototype.copy.call(this,e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},setViewOffset:function t(e,n,r,i,o,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=r,this.view.offsetY=i,this.view.width=o,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function t(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function t(){var e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2,o=r-e,a=r+e,s=i+n,c=i-n;if(null!==this.view&&this.view.enabled){var u=this.zoom/(this.view.width/this.view.fullWidth),h=this.zoom/(this.view.height/this.view.fullHeight),l=(this.right-this.left)/this.view.width,d=(this.top-this.bottom)/this.view.height;a=(o+=l*(this.view.offsetX/u))+l*(this.view.width/u),c=(s-=d*(this.view.offsetY/h))-d*(this.view.height/h)}this.projectionMatrix.makeOrthographic(o,a,s,c,this.near,this.far)},toJSON:function t(e){var n=pt.prototype.toJSON.call(this,e);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,null!==this.view&&(n.object.view=Object.assign({},this.view)),n}}),Object.assign(vt.prototype,{clone:function t(){return(new this.constructor).copy(this)},copy:function t(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var n=0,r=e.vertexNormals.length;n<r;n++)this.vertexNormals[n]=e.vertexNormals[n].clone();for(var n=0,r=e.vertexColors.length;n<r;n++)this.vertexColors[n]=e.vertexColors[n].clone();return this}});var Xb=0;gt.prototype=Object.assign(Object.create(s.prototype),{constructor:gt,isGeometry:!0,applyMatrix:function t(e){for(var n=(new d).getNormalMatrix(e),r=0,i=this.vertices.length;r<i;r++){var o;this.vertices[r].applyMatrix4(e)}for(var r=0,i=this.faces.length;r<i;r++){var a=this.faces[r];a.normal.applyMatrix3(n).normalize();for(var s=0,c=a.vertexNormals.length;s<c;s++)a.vertexNormals[s].applyMatrix3(n).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var t=new u;return function e(n){return t.makeRotationX(n),this.applyMatrix(t),this}}(),rotateY:function(){var t=new u;return function e(n){return t.makeRotationY(n),this.applyMatrix(t),this}}(),rotateZ:function(){var t=new u;return function e(n){return t.makeRotationZ(n),this.applyMatrix(t),this}}(),translate:function(){var t=new u;return function e(n,r,i){return t.makeTranslation(n,r,i),this.applyMatrix(t),this}}(),scale:function(){var t=new u;return function e(n,r,i){return t.makeScale(n,r,i),this.applyMatrix(t),this}}(),lookAt:function(){var t=new pt;return function e(n){t.lookAt(n),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),fromBufferGeometry:function t(e){function n(t,e,n,i){var o,a,c=new vt(t,e,n,void 0!==s?[p[t].clone(),p[e].clone(),p[n].clone()]:[],void 0!==u?[r.colors[t].clone(),r.colors[e].clone(),r.colors[n].clone()]:[],i);r.faces.push(c),void 0!==h&&r.faceVertexUvs[0].push([f[t].clone(),f[e].clone(),f[n].clone()]),void 0!==d&&r.faceVertexUvs[1].push([m[t].clone(),m[e].clone(),m[n].clone()])}var r=this,i=null!==e.index?e.index.array:void 0,o=e.attributes,a=o.position.array,s=void 0!==o.normal?o.normal.array:void 0,u=void 0!==o.color?o.color.array:void 0,h=void 0!==o.uv?o.uv.array:void 0,d=void 0!==o.uv2?o.uv2.array:void 0;void 0!==d&&(this.faceVertexUvs[1]=[]);for(var p=[],f=[],m=[],v=0,g=0;v<a.length;v+=3,g+=2)r.vertices.push(new l(a[v],a[v+1],a[v+2])),void 0!==s&&p.push(new l(s[v],s[v+1],s[v+2])),void 0!==u&&r.colors.push(new $(u[v],u[v+1],u[v+2])),void 0!==h&&f.push(new c(h[g],h[g+1])),void 0!==d&&m.push(new c(d[g],d[g+1]));var y=e.groups;if(y.length>0)for(var v=0;v<y.length;v++)for(var x=y[v],b=x.start,w,g=b,_=b+x.count;g<_;g+=3)void 0!==i?n(i[g],i[g+1],i[g+2],x.materialIndex):n(g,g+1,g+2,x.materialIndex);else if(void 0!==i)for(var v=0;v<i.length;v+=3)n(i[v],i[v+1],i[v+2]);else for(var v=0;v<a.length/3;v+=3)n(v,v+1,v+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function t(){this.computeBoundingBox();var e=this.boundingBox.getCenter().negate();return this.translate(e.x,e.y,e.z),e},normalize:function t(){this.computeBoundingSphere();var e=this.boundingSphere.center,n=this.boundingSphere.radius,r=0===n?1:1/n,i=new u;return i.set(r,0,0,-r*e.x,0,r,0,-r*e.y,0,0,r,-r*e.z,0,0,0,1),this.applyMatrix(i),this},computeFaceNormals:function t(){for(var e=new l,n=new l,r=0,i=this.faces.length;r<i;r++){var o=this.faces[r],a=this.vertices[o.a],s=this.vertices[o.b],c=this.vertices[o.c];e.subVectors(c,s),n.subVectors(a,s),e.cross(n),e.normalize(),o.normal.copy(e)}},computeVertexNormals:function t(e){void 0===e&&(e=!0);var n,r,i,o,a,s;for(s=new Array(this.vertices.length),n=0,r=this.vertices.length;n<r;n++)s[n]=new l;if(e){var c,u,h,d=new l,p=new l;for(i=0,o=this.faces.length;i<o;i++)a=this.faces[i],c=this.vertices[a.a],u=this.vertices[a.b],h=this.vertices[a.c],d.subVectors(h,u),p.subVectors(c,u),d.cross(p),s[a.a].add(d),s[a.b].add(d),s[a.c].add(d)}else for(this.computeFaceNormals(),i=0,o=this.faces.length;i<o;i++)s[(a=this.faces[i]).a].add(a.normal),s[a.b].add(a.normal),s[a.c].add(a.normal);for(n=0,r=this.vertices.length;n<r;n++)s[n].normalize();for(i=0,o=this.faces.length;i<o;i++){var f=(a=this.faces[i]).vertexNormals;3===f.length?(f[0].copy(s[a.a]),f[1].copy(s[a.b]),f[2].copy(s[a.c])):(f[0]=s[a.a].clone(),f[1]=s[a.b].clone(),f[2]=s[a.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function t(){var e,n,r;for(this.computeFaceNormals(),e=0,n=this.faces.length;e<n;e++){var i=(r=this.faces[e]).vertexNormals;3===i.length?(i[0].copy(r.normal),i[1].copy(r.normal),i[2].copy(r.normal)):(i[0]=r.normal.clone(),i[1]=r.normal.clone(),i[2]=r.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function t(){var e,n,r,i,o;for(r=0,i=this.faces.length;r<i;r++)for((o=this.faces[r]).__originalFaceNormal?o.__originalFaceNormal.copy(o.normal):o.__originalFaceNormal=o.normal.clone(),o.__originalVertexNormals||(o.__originalVertexNormals=[]),e=0,n=o.vertexNormals.length;e<n;e++)o.__originalVertexNormals[e]?o.__originalVertexNormals[e].copy(o.vertexNormals[e]):o.__originalVertexNormals[e]=o.vertexNormals[e].clone();var a=new gt;for(a.faces=this.faces,e=0,n=this.morphTargets.length;e<n;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var s=this.morphNormals[e].faceNormals,c=this.morphNormals[e].vertexNormals,u,h;for(r=0,i=this.faces.length;r<i;r++)u=new l,h={a:new l,b:new l,c:new l},s.push(u),c.push(h)}var d=this.morphNormals[e];a.vertices=this.morphTargets[e].vertices,a.computeFaceNormals(),a.computeVertexNormals();var u,h;for(r=0,i=this.faces.length;r<i;r++)o=this.faces[r],u=d.faceNormals[r],h=d.vertexNormals[r],u.copy(o.normal),h.a.copy(o.vertexNormals[0]),h.b.copy(o.vertexNormals[1]),h.c.copy(o.vertexNormals[2])}for(r=0,i=this.faces.length;r<i;r++)(o=this.faces[r]).normal=o.__originalFaceNormal,o.vertexNormals=o.__originalVertexNormals},computeLineDistances:function t(){for(var e=0,n=this.vertices,r=0,i=n.length;r<i;r++)r>0&&(e+=n[r].distanceTo(n[r-1])),this.lineDistances[r]=e},computeBoundingBox:function t(){null===this.boundingBox&&(this.boundingBox=new ot),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function t(){null===this.boundingSphere&&(this.boundingSphere=new at),this.boundingSphere.setFromPoints(this.vertices)},merge:function t(e,n,r){if(e&&e.isGeometry){var i,o=this.vertices.length,a=this.vertices,s=e.vertices,c=this.faces,u=e.faces,h=this.faceVertexUvs[0],l=e.faceVertexUvs[0],p=this.colors,f=e.colors;void 0===r&&(r=0),void 0!==n&&(i=(new d).getNormalMatrix(n));for(var m=0,v=s.length;m<v;m++){var g,y=s[m].clone();void 0!==n&&y.applyMatrix4(n),a.push(y)}for(var m=0,v=f.length;m<v;m++)p.push(f[m].clone());for(m=0,v=u.length;m<v;m++){var x=u[m],b,w,_,S=x.vertexNormals,M=x.vertexColors;(b=new vt(x.a+o,x.b+o,x.c+o)).normal.copy(x.normal),void 0!==i&&b.normal.applyMatrix3(i).normalize();for(var E=0,T=S.length;E<T;E++)w=S[E].clone(),void 0!==i&&w.applyMatrix3(i).normalize(),b.vertexNormals.push(w);b.color.copy(x.color);for(var E=0,T=M.length;E<T;E++)_=M[E],b.vertexColors.push(_.clone());b.materialIndex=x.materialIndex+r,c.push(b)}for(m=0,v=l.length;m<v;m++){var L=l[m],A=[];if(void 0!==L){for(var E=0,T=L.length;E<T;E++)A.push(L[E].clone());h.push(A)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e)},mergeMesh:function t(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function t(){var e={},n=[],r=[],i,o,a=4,s=Math.pow(10,4),c,u,h,l,d,p;for(c=0,u=this.vertices.length;c<u;c++)i=this.vertices[c],void 0===e[o=Math.round(i.x*s)+"_"+Math.round(i.y*s)+"_"+Math.round(i.z*s)]?(e[o]=c,n.push(this.vertices[c]),r[c]=n.length-1):r[c]=r[e[o]];var f=[];for(c=0,u=this.faces.length;c<u;c++){(h=this.faces[c]).a=r[h.a],h.b=r[h.b],h.c=r[h.c],l=[h.a,h.b,h.c];for(var m=0;m<3;m++)if(l[m]===l[(m+1)%3]){f.push(c);break}}for(c=f.length-1;c>=0;c--){var v=f[c];for(this.faces.splice(v,1),d=0,p=this.faceVertexUvs.length;d<p;d++)this.faceVertexUvs[d].splice(v,1)}var g=this.vertices.length-n.length;return this.vertices=n,g},setFromPoints:function t(e){this.vertices=[];for(var n=0,r=e.length;n<r;n++){var i=e[n];this.vertices.push(new l(i.x,i.y,i.z||0))}return this},sortFacesByMaterialIndex:function t(){function e(t,e){return t.materialIndex-e.materialIndex}for(var n=this.faces,r=n.length,i=0;i<r;i++)n[i]._id=i;n.sort(e);var o=this.faceVertexUvs[0],a=this.faceVertexUvs[1],s,c;o&&o.length===r&&(s=[]),a&&a.length===r&&(c=[]);for(var i=0;i<r;i++){var u=n[i]._id;s&&s.push(o[u]),c&&c.push(a[u])}s&&(this.faceVertexUvs[0]=s),c&&(this.faceVertexUvs[1]=c)},toJSON:function t(){function e(t,e,n){return n?t|1<<e:t&~(1<<e)}function n(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==p[e]?p[e]:(p[e]=d.length/3,d.push(t.x,t.y,t.z),p[e])}function r(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==m[e]?m[e]:(m[e]=f.length,f.push(t.getHex()),m[e])}function i(t){var e=t.x.toString()+t.y.toString();return void 0!==g[e]?g[e]:(g[e]=v.length/2,v.push(t.x,t.y),g[e])}var o={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(o.uuid=this.uuid,o.type=this.type,""!==this.name&&(o.name=this.name),void 0!==this.parameters){var a=this.parameters;for(var s in a)void 0!==a[s]&&(o[s]=a[s]);return o}for(var c=[],u=0;u<this.vertices.length;u++){var h=this.vertices[u];c.push(h.x,h.y,h.z)}for(var l=[],d=[],p={},f=[],m={},v=[],g={},u=0;u<this.faces.length;u++){var y=this.faces[u],x=!0,b=!1,w=void 0!==this.faceVertexUvs[0][u],_=y.normal.length()>0,S=y.vertexNormals.length>0,M=1!==y.color.r||1!==y.color.g||1!==y.color.b,E=y.vertexColors.length>0,T=0;if(T=e(T,0,0),T=e(T,1,!0),T=e(T,2,!1),T=e(T,3,w),T=e(T,4,_),T=e(T,5,S),T=e(T,6,M),T=e(T,7,E),l.push(T),l.push(y.a,y.b,y.c),l.push(y.materialIndex),w){var L=this.faceVertexUvs[0][u];l.push(i(L[0]),i(L[1]),i(L[2]))}if(_&&l.push(n(y.normal)),S){var A=y.vertexNormals;l.push(n(A[0]),n(A[1]),n(A[2]))}if(M&&l.push(r(y.color)),E){var P=y.vertexColors;l.push(r(P[0]),r(P[1]),r(P[2]))}}return o.data={},o.data.vertices=c,o.data.normals=d,f.length>0&&(o.data.colors=f),v.length>0&&(o.data.uvs=[v]),o.data.faces=l,o},clone:function t(){return(new gt).copy(this)},copy:function t(e){var n,r,i,o,a,s;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var c=e.vertices;for(n=0,r=c.length;n<r;n++)this.vertices.push(c[n].clone());var u=e.colors;for(n=0,r=u.length;n<r;n++)this.colors.push(u[n].clone());var h=e.faces;for(n=0,r=h.length;n<r;n++)this.faces.push(h[n].clone());for(n=0,r=e.faceVertexUvs.length;n<r;n++){var l=e.faceVertexUvs[n];for(void 0===this.faceVertexUvs[n]&&(this.faceVertexUvs[n]=[]),i=0,o=l.length;i<o;i++){var d=l[i],p=[];for(a=0,s=d.length;a<s;a++){var f=d[a];p.push(f.clone())}this.faceVertexUvs[n].push(p)}}var m=e.morphTargets;for(n=0,r=m.length;n<r;n++){var v={};if(v.name=m[n].name,void 0!==m[n].vertices)for(v.vertices=[],i=0,o=m[n].vertices.length;i<o;i++)v.vertices.push(m[n].vertices[i].clone());if(void 0!==m[n].normals)for(v.normals=[],i=0,o=m[n].normals.length;i<o;i++)v.normals.push(m[n].normals[i].clone());this.morphTargets.push(v)}var g=e.morphNormals;for(n=0,r=g.length;n<r;n++){var y={};if(void 0!==g[n].vertexNormals)for(y.vertexNormals=[],i=0,o=g[n].vertexNormals.length;i<o;i++){var x=g[n].vertexNormals[i],b={};b.a=x.a.clone(),b.b=x.b.clone(),b.c=x.c.clone(),y.vertexNormals.push(b)}if(void 0!==g[n].faceNormals)for(y.faceNormals=[],i=0,o=g[n].faceNormals.length;i<o;i++)y.faceNormals.push(g[n].faceNormals[i].clone());this.morphNormals.push(y)}var w=e.skinWeights;for(n=0,r=w.length;n<r;n++)this.skinWeights.push(w[n].clone());var _=e.skinIndices;for(n=0,r=_.length;n<r;n++)this.skinIndices.push(_[n].clone());var S=e.lineDistances;for(n=0,r=S.length;n<r;n++)this.lineDistances.push(S[n]);var M=e.boundingBox;null!==M&&(this.boundingBox=M.clone());var E=e.boundingSphere;return null!==E&&(this.boundingSphere=E.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function t(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(yt.prototype,"needsUpdate",{set:function t(e){!0===e&&this.version++}}),Object.assign(yt.prototype,{isBufferAttribute:!0,setArray:function t(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==e?e.length/this.itemSize:0,this.array=e},setDynamic:function t(e){return this.dynamic=e,this},copy:function t(e){return this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.dynamic=e.dynamic,this},copyAt:function t(e,n,r){e*=this.itemSize,r*=n.itemSize;for(var i=0,o=this.itemSize;i<o;i++)this.array[e+i]=n.array[r+i];return this},copyArray:function t(e){return this.array.set(e),this},copyColorsArray:function t(e){for(var n=this.array,r=0,i=0,o=e.length;i<o;i++){var a=e[i];void 0===a&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),a=new $),n[r++]=a.r,n[r++]=a.g,n[r++]=a.b}return this},copyIndicesArray:function t(e){for(var n=this.array,r=0,i=0,o=e.length;i<o;i++){var a=e[i];n[r++]=a.a,n[r++]=a.b,n[r++]=a.c}return this},copyVector2sArray:function t(e){for(var n=this.array,r=0,i=0,o=e.length;i<o;i++){var a=e[i];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),a=new c),n[r++]=a.x,n[r++]=a.y}return this},copyVector3sArray:function t(e){for(var n=this.array,r=0,i=0,o=e.length;i<o;i++){var a=e[i];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),a=new l),n[r++]=a.x,n[r++]=a.y,n[r++]=a.z}return this},copyVector4sArray:function t(e){for(var n=this.array,r=0,i=0,o=e.length;i<o;i++){var a=e[i];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),a=new f),n[r++]=a.x,n[r++]=a.y,n[r++]=a.z,n[r++]=a.w}return this},set:function t(e,n){return void 0===n&&(n=0),this.array.set(e,n),this},getX:function t(e){return this.array[e*this.itemSize]},setX:function t(e,n){return this.array[e*this.itemSize]=n,this},getY:function t(e){return this.array[e*this.itemSize+1]},setY:function t(e,n){return this.array[e*this.itemSize+1]=n,this},getZ:function t(e){return this.array[e*this.itemSize+2]},setZ:function t(e,n){return this.array[e*this.itemSize+2]=n,this},getW:function t(e){return this.array[e*this.itemSize+3]},setW:function t(e,n){return this.array[e*this.itemSize+3]=n,this},setXY:function t(e,n,r){return e*=this.itemSize,this.array[e+0]=n,this.array[e+1]=r,this},setXYZ:function t(e,n,r,i){return e*=this.itemSize,this.array[e+0]=n,this.array[e+1]=r,this.array[e+2]=i,this},setXYZW:function t(e,n,r,i,o){return e*=this.itemSize,this.array[e+0]=n,this.array[e+1]=r,this.array[e+2]=i,this.array[e+3]=o,this},onUpload:function t(e){return this.onUploadCallback=e,this},clone:function t(){return new this.constructor(this.array,this.itemSize).copy(this)}}),xt.prototype=Object.create(yt.prototype),xt.prototype.constructor=xt,bt.prototype=Object.create(yt.prototype),bt.prototype.constructor=bt,wt.prototype=Object.create(yt.prototype),wt.prototype.constructor=wt,_t.prototype=Object.create(yt.prototype),_t.prototype.constructor=_t,St.prototype=Object.create(yt.prototype),St.prototype.constructor=St,Mt.prototype=Object.create(yt.prototype),Mt.prototype.constructor=Mt,Et.prototype=Object.create(yt.prototype),Et.prototype.constructor=Et,Tt.prototype=Object.create(yt.prototype),Tt.prototype.constructor=Tt,Lt.prototype=Object.create(yt.prototype),Lt.prototype.constructor=Lt,Object.assign(At.prototype,{computeGroups:function t(e){for(var n,r=[],i=void 0,o=e.faces,a=0;a<o.length;a++){var s=o[a];s.materialIndex!==i&&(i=s.materialIndex,void 0!==n&&(n.count=3*a-n.start,r.push(n)),n={start:3*a,materialIndex:i})}void 0!==n&&(n.count=3*a-n.start,r.push(n)),this.groups=r},fromGeometry:function t(e){var n=e.faces,r=e.vertices,i=e.faceVertexUvs,o=i[0]&&i[0].length>0,a=i[1]&&i[1].length>0,s=e.morphTargets,u=s.length,h;if(u>0){h=[];for(var l=0;l<u;l++)h[l]=[];this.morphTargets.position=h}var d=e.morphNormals,p=d.length,f;if(p>0){f=[];for(var l=0;l<p;l++)f[l]=[];this.morphTargets.normal=f}for(var m=e.skinIndices,v=e.skinWeights,g=m.length===r.length,y=v.length===r.length,l=0;l<n.length;l++){var x=n[l];this.vertices.push(r[x.a],r[x.b],r[x.c]);var b=x.vertexNormals;if(3===b.length)this.normals.push(b[0],b[1],b[2]);else{var w=x.normal;this.normals.push(w,w,w)}var _=x.vertexColors;if(3===_.length)this.colors.push(_[0],_[1],_[2]);else{var S=x.color;this.colors.push(S,S,S)}if(!0===o){var M;void 0!==(M=i[0][l])?this.uvs.push(M[0],M[1],M[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",l),this.uvs.push(new c,new c,new c))}if(!0===a){var M;void 0!==(M=i[1][l])?this.uvs2.push(M[0],M[1],M[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",l),this.uvs2.push(new c,new c,new c))}for(var E=0;E<u;E++){var T=s[E].vertices;h[E].push(T[x.a],T[x.b],T[x.c])}for(var E=0;E<p;E++){var L=d[E].vertexNormals[l];f[E].push(L.a,L.b,L.c)}g&&this.skinIndices.push(m[x.a],m[x.b],m[x.c]),y&&this.skinWeights.push(v[x.a],v[x.b],v[x.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}});var qb=1;Rt.prototype=Object.assign(Object.create(s.prototype),{constructor:Rt,isBufferGeometry:!0,getIndex:function t(){return this.index},setIndex:function t(e){Array.isArray(e)?this.index=new(Pt(e)>65535?Et:St)(e,1):this.index=e},addAttribute:function t(e,n){return n&&n.isBufferAttribute||n&&n.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),void this.setIndex(n)):(this.attributes[e]=n,this):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),void this.addAttribute(e,new yt(arguments[1],arguments[2])))},getAttribute:function t(e){return this.attributes[e]},removeAttribute:function t(e){return delete this.attributes[e],this},addGroup:function t(e,n,r){this.groups.push({start:e,count:n,materialIndex:void 0!==r?r:0})},clearGroups:function t(){this.groups=[]},setDrawRange:function t(e,n){this.drawRange.start=e,this.drawRange.count=n},applyMatrix:function t(e){var n=this.attributes.position;void 0!==n&&(e.applyToBufferAttribute(n),n.needsUpdate=!0);var r=this.attributes.normal;if(void 0!==r){var i;(new d).getNormalMatrix(e).applyToBufferAttribute(r),r.needsUpdate=!0}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var t=new u;return function e(n){return t.makeRotationX(n),this.applyMatrix(t),this}}(),rotateY:function(){var t=new u;return function e(n){return t.makeRotationY(n),this.applyMatrix(t),this}}(),rotateZ:function(){var t=new u;return function e(n){return t.makeRotationZ(n),this.applyMatrix(t),this}}(),translate:function(){var t=new u;return function e(n,r,i){return t.makeTranslation(n,r,i),this.applyMatrix(t),this}}(),scale:function(){var t=new u;return function e(n,r,i){return t.makeScale(n,r,i),this.applyMatrix(t),this}}(),lookAt:function(){var t=new pt;return function e(n){t.lookAt(n),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),center:function t(){this.computeBoundingBox();var e=this.boundingBox.getCenter().negate();return this.translate(e.x,e.y,e.z),e},setFromObject:function t(e){var n=e.geometry;if(e.isPoints||e.isLine){var r=new Tt(3*n.vertices.length,3),i=new Tt(3*n.colors.length,3);if(this.addAttribute("position",r.copyVector3sArray(n.vertices)),this.addAttribute("color",i.copyColorsArray(n.colors)),n.lineDistances&&n.lineDistances.length===n.vertices.length){var o=new Tt(n.lineDistances.length,1);this.addAttribute("lineDistance",o.copyArray(n.lineDistances))}null!==n.boundingSphere&&(this.boundingSphere=n.boundingSphere.clone()),null!==n.boundingBox&&(this.boundingBox=n.boundingBox.clone())}else e.isMesh&&n&&n.isGeometry&&this.fromGeometry(n);return this},setFromPoints:function t(e){for(var n=[],r=0,i=e.length;r<i;r++){var o=e[r];n.push(o.x,o.y,o.z||0)}return this.addAttribute("position",new Tt(n,3)),this},updateFromObject:function t(e){var n=e.geometry;if(e.isMesh){var r=n.__directGeometry;if(!0===n.elementsNeedUpdate&&(r=void 0,n.elementsNeedUpdate=!1),void 0===r)return this.fromGeometry(n);r.verticesNeedUpdate=n.verticesNeedUpdate,r.normalsNeedUpdate=n.normalsNeedUpdate,r.colorsNeedUpdate=n.colorsNeedUpdate,r.uvsNeedUpdate=n.uvsNeedUpdate,r.groupsNeedUpdate=n.groupsNeedUpdate,n.verticesNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.groupsNeedUpdate=!1,n=r}var i;return!0===n.verticesNeedUpdate&&(void 0!==(i=this.attributes.position)&&(i.copyVector3sArray(n.vertices),i.needsUpdate=!0),n.verticesNeedUpdate=!1),!0===n.normalsNeedUpdate&&(void 0!==(i=this.attributes.normal)&&(i.copyVector3sArray(n.normals),i.needsUpdate=!0),n.normalsNeedUpdate=!1),!0===n.colorsNeedUpdate&&(void 0!==(i=this.attributes.color)&&(i.copyColorsArray(n.colors),i.needsUpdate=!0),n.colorsNeedUpdate=!1),n.uvsNeedUpdate&&(void 0!==(i=this.attributes.uv)&&(i.copyVector2sArray(n.uvs),i.needsUpdate=!0),n.uvsNeedUpdate=!1),n.lineDistancesNeedUpdate&&(void 0!==(i=this.attributes.lineDistance)&&(i.copyArray(n.lineDistances),i.needsUpdate=!0),n.lineDistancesNeedUpdate=!1),n.groupsNeedUpdate&&(n.computeGroups(e.geometry),this.groups=n.groups,n.groupsNeedUpdate=!1),this},fromGeometry:function t(e){return e.__directGeometry=(new At).fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function t(e){var n=new Float32Array(3*e.vertices.length);if(this.addAttribute("position",new yt(n,3).copyVector3sArray(e.vertices)),e.normals.length>0){var r=new Float32Array(3*e.normals.length);this.addAttribute("normal",new yt(r,3).copyVector3sArray(e.normals))}if(e.colors.length>0){var i=new Float32Array(3*e.colors.length);this.addAttribute("color",new yt(i,3).copyColorsArray(e.colors))}if(e.uvs.length>0){var o=new Float32Array(2*e.uvs.length);this.addAttribute("uv",new yt(o,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){var a=new Float32Array(2*e.uvs2.length);this.addAttribute("uv2",new yt(a,2).copyVector2sArray(e.uvs2))}if(e.indices.length>0){var s,c=new(Pt(e.indices)>65535?Uint32Array:Uint16Array)(3*e.indices.length);this.setIndex(new yt(c,1).copyIndicesArray(e.indices))}this.groups=e.groups;for(var u in e.morphTargets){for(var h=[],l=e.morphTargets[u],d=0,p=l.length;d<p;d++){var f=l[d],m=new Tt(3*f.length,3);h.push(m.copyVector3sArray(f))}this.morphAttributes[u]=h}if(e.skinIndices.length>0){var v=new Tt(4*e.skinIndices.length,4);this.addAttribute("skinIndex",v.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){var g=new Tt(4*e.skinWeights.length,4);this.addAttribute("skinWeight",g.copyVector4sArray(e.skinWeights))}return null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function t(){null===this.boundingBox&&(this.boundingBox=new ot);var e=this.attributes.position;void 0!==e?this.boundingBox.setFromBufferAttribute(e):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var t=new ot,e=new l;return function n(){null===this.boundingSphere&&(this.boundingSphere=new at);var r=this.attributes.position;if(r){var i=this.boundingSphere.center;t.setFromBufferAttribute(r),t.getCenter(i);for(var o=0,a=0,s=r.count;a<s;a++)e.x=r.getX(a),e.y=r.getY(a),e.z=r.getZ(a),o=Math.max(o,i.distanceToSquared(e));this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function t(){},computeVertexNormals:function t(){var e=this.index,n=this.attributes,r=this.groups;if(n.position){var i=n.position.array;if(void 0===n.normal)this.addAttribute("normal",new yt(new Float32Array(i.length),3));else for(var o=n.normal.array,a=0,s=o.length;a<s;a++)o[a]=0;var c=n.normal.array,u,h,d,p=new l,f=new l,m=new l,v=new l,g=new l;if(e){var y=e.array;0===r.length&&this.addGroup(0,y.length);for(var x=0,b=r.length;x<b;++x)for(var w=r[x],_=w.start,S,a=_,s=_+w.count;a<s;a+=3)u=3*y[a+0],h=3*y[a+1],d=3*y[a+2],p.fromArray(i,u),f.fromArray(i,h),m.fromArray(i,d),v.subVectors(m,f),g.subVectors(p,f),v.cross(g),c[u]+=v.x,c[u+1]+=v.y,c[u+2]+=v.z,c[h]+=v.x,c[h+1]+=v.y,c[h+2]+=v.z,c[d]+=v.x,c[d+1]+=v.y,c[d+2]+=v.z}else for(var a=0,s=i.length;a<s;a+=9)p.fromArray(i,a),f.fromArray(i,a+3),m.fromArray(i,a+6),v.subVectors(m,f),g.subVectors(p,f),v.cross(g),c[a]=v.x,c[a+1]=v.y,c[a+2]=v.z,c[a+3]=v.x,c[a+4]=v.y,c[a+5]=v.z,c[a+6]=v.x,c[a+7]=v.y,c[a+8]=v.z;this.normalizeNormals(),n.normal.needsUpdate=!0}},merge:function t(e,n){if(e&&e.isBufferGeometry){void 0===n&&(n=0);var r=this.attributes;for(var i in r)if(void 0!==e.attributes[i])for(var o,a=r[i].array,s=e.attributes[i],c=s.array,u,h=0,l=s.itemSize*n;h<c.length;h++,l++)a[l]=c[h];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:function(){var t=new l;return function e(){for(var n=this.attributes.normal,r=0,i=n.count;r<i;r++)t.x=n.getX(r),t.y=n.getY(r),t.z=n.getZ(r),t.normalize(),n.setXYZ(r,t.x,t.y,t.z)}}(),toNonIndexed:function t(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var e=new Rt,n=this.index.array,r=this.attributes;for(var i in r){for(var o=r[i],a=o.array,s=o.itemSize,c=new a.constructor(n.length*s),u=0,h=0,l=0,d=n.length;l<d;l++){u=n[l]*s;for(var p=0;p<s;p++)c[h++]=a[u++]}e.addAttribute(i,new yt(c,s))}return e},toJSON:function t(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var n=this.parameters;for(var r in n)void 0!==n[r]&&(e[r]=n[r]);return e}e.data={attributes:{}};var i=this.index;if(null!==i){var o=Array.prototype.slice.call(i.array);e.data.index={type:i.array.constructor.name,array:o}}var a=this.attributes;for(var r in a){var s=a[r],o=Array.prototype.slice.call(s.array);e.data.attributes[r]={itemSize:s.itemSize,type:s.array.constructor.name,array:o,normalized:s.normalized}}var c=this.groups;c.length>0&&(e.data.groups=JSON.parse(JSON.stringify(c)));var u=this.boundingSphere;return null!==u&&(e.data.boundingSphere={center:u.center.toArray(),radius:u.radius}),e},clone:function t(){return(new Rt).copy(this)},copy:function t(e){var n,r,i;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var o=e.index;null!==o&&this.setIndex(o.clone());var a=e.attributes;for(n in a){var s=a[n];this.addAttribute(n,s.clone())}var c=e.morphAttributes;for(n in c){var u=[],h=c[n];for(r=0,i=h.length;r<i;r++)u.push(h[r].clone());this.morphAttributes[n]=u}var l=e.groups;for(r=0,i=l.length;r<i;r++){var d=l[r];this.addGroup(d.start,d.count,d.materialIndex)}var p=e.boundingBox;null!==p&&(this.boundingBox=p.clone());var f=e.boundingSphere;return null!==f&&(this.boundingSphere=f.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this},dispose:function t(){this.dispatchEvent({type:"dispose"})}}),It.prototype=Object.create(gt.prototype),It.prototype.constructor=It,Ct.prototype=Object.create(Rt.prototype),Ct.prototype.constructor=Ct,Ot.prototype=Object.create(gt.prototype),Ot.prototype.constructor=Ot,Nt.prototype=Object.create(Rt.prototype),Nt.prototype.constructor=Nt,Ft.prototype=Object.create(nt.prototype),Ft.prototype.constructor=Ft,Ft.prototype.isMeshBasicMaterial=!0,Ft.prototype.copy=function(t){return nt.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this},Dt.prototype=Object.create(nt.prototype),Dt.prototype.constructor=Dt,Dt.prototype.isShaderMaterial=!0,Dt.prototype.copy=function(t){return nt.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=ky.clone(t.uniforms),this.defines=t.defines,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this},Dt.prototype.toJSON=function(t){var e=nt.prototype.toJSON.call(this,t);return e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e},Object.assign(Ut.prototype,{set:function t(e,n){return this.origin.copy(e),this.direction.copy(n),this},clone:function t(){return(new this.constructor).copy(this)},copy:function t(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function t(e,n){var r;return(n||new l).copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function t(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(){var t=new l;return function e(n){return this.origin.copy(this.at(n,t)),this}}(),closestPointToPoint:function t(e,n){var r=n||new l;r.subVectors(e,this.origin);var i=r.dot(this.direction);return i<0?r.copy(this.origin):r.copy(this.direction).multiplyScalar(i).add(this.origin)},distanceToPoint:function t(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(){var t=new l;return function e(n){var r=t.subVectors(n,this.origin).dot(this.direction);return r<0?this.origin.distanceToSquared(n):(t.copy(this.direction).multiplyScalar(r).add(this.origin),t.distanceToSquared(n))}}(),distanceSqToSegment:function(){var t=new l,e=new l,n=new l;return function r(i,o,a,s){t.copy(i).add(o).multiplyScalar(.5),e.copy(o).sub(i).normalize(),n.copy(this.origin).sub(t);var c=.5*i.distanceTo(o),u=-this.direction.dot(e),h=n.dot(this.direction),l=-n.dot(e),d=n.lengthSq(),p=Math.abs(1-u*u),f,m,v,g;if(p>0)if(f=u*l-h,m=u*h-l,g=c*p,f>=0)if(m>=-g)if(m<=g){var y=1/p;v=(f*=y)*(f+u*(m*=y)+2*h)+m*(u*f+m+2*l)+d}else m=c,v=-(f=Math.max(0,-(u*m+h)))*f+m*(m+2*l)+d;else m=-c,v=-(f=Math.max(0,-(u*m+h)))*f+m*(m+2*l)+d;else m<=-g?v=-(f=Math.max(0,-(-u*c+h)))*f+(m=f>0?-c:Math.min(Math.max(-c,-l),c))*(m+2*l)+d:m<=g?(f=0,v=(m=Math.min(Math.max(-c,-l),c))*(m+2*l)+d):v=-(f=Math.max(0,-(u*c+h)))*f+(m=f>0?c:Math.min(Math.max(-c,-l),c))*(m+2*l)+d;else m=u>0?-c:c,v=-(f=Math.max(0,-(u*m+h)))*f+m*(m+2*l)+d;return a&&a.copy(this.direction).multiplyScalar(f).add(this.origin),s&&s.copy(e).multiplyScalar(m).add(t),v}}(),intersectSphere:function(){var t=new l;return function e(n,r){t.subVectors(n.center,this.origin);var i=t.dot(this.direction),o=t.dot(t)-i*i,a=n.radius*n.radius;if(o>a)return null;var s=Math.sqrt(a-o),c=i-s,u=i+s;return c<0&&u<0?null:c<0?this.at(u,r):this.at(c,r)}}(),intersectsSphere:function t(e){return this.distanceToPoint(e.center)<=e.radius},distanceToPlane:function t(e){var n=e.normal.dot(this.direction);if(0===n)return 0===e.distanceToPoint(this.origin)?0:null;var r=-(this.origin.dot(e.normal)+e.constant)/n;return r>=0?r:null},intersectPlane:function t(e,n){var r=this.distanceToPlane(e);return null===r?null:this.at(r,n)},intersectsPlane:function t(e){var n=e.distanceToPoint(this.origin);if(0===n)return!0;var r;return e.normal.dot(this.direction)*n<0},intersectBox:function t(e,n){var r,i,o,a,s,c,u=1/this.direction.x,h=1/this.direction.y,l=1/this.direction.z,d=this.origin;return u>=0?(r=(e.min.x-d.x)*u,i=(e.max.x-d.x)*u):(r=(e.max.x-d.x)*u,i=(e.min.x-d.x)*u),h>=0?(o=(e.min.y-d.y)*h,a=(e.max.y-d.y)*h):(o=(e.max.y-d.y)*h,a=(e.min.y-d.y)*h),r>a||o>i?null:((o>r||r!=r)&&(r=o),(a<i||i!=i)&&(i=a),l>=0?(s=(e.min.z-d.z)*l,c=(e.max.z-d.z)*l):(s=(e.max.z-d.z)*l,c=(e.min.z-d.z)*l),r>c||s>i?null:((s>r||r!=r)&&(r=s),(c<i||i!=i)&&(i=c),i<0?null:this.at(r>=0?r:i,n)))},intersectsBox:function(){var t=new l;return function e(n){return null!==this.intersectBox(n,t)}}(),intersectTriangle:function(){var t=new l,e=new l,n=new l,r=new l;return function i(o,a,s,c,u){e.subVectors(a,o),n.subVectors(s,o),r.crossVectors(e,n);var h=this.direction.dot(r),l;if(h>0){if(c)return null;l=1}else{if(!(h<0))return null;l=-1,h=-h}t.subVectors(this.origin,o);var d=l*this.direction.dot(n.crossVectors(t,n));if(d<0)return null;var p=l*this.direction.dot(e.cross(t));if(p<0)return null;if(d+p>h)return null;var f=-l*t.dot(r);return f<0?null:this.at(f/h,u)}}(),applyMatrix4:function t(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function t(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}}),Object.assign(Bt.prototype,{set:function t(e,n){return this.start.copy(e),this.end.copy(n),this},clone:function t(){return(new this.constructor).copy(this)},copy:function t(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function t(e){var n;return(e||new l).addVectors(this.start,this.end).multiplyScalar(.5)},delta:function t(e){var n;return(e||new l).subVectors(this.end,this.start)},distanceSq:function t(){return this.start.distanceToSquared(this.end)},distance:function t(){return this.start.distanceTo(this.end)},at:function t(e,n){var r=n||new l;return this.delta(r).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(){var t=new l,e=new l;return function n(r,i){t.subVectors(r,this.start),e.subVectors(this.end,this.start);var o=e.dot(e),a,s=e.dot(t)/o;return i&&(s=Ry.clamp(s,0,1)),s}}(),closestPointToPoint:function t(e,n,r){var i=this.closestPointToPointParameter(e,n),o=r||new l;return this.delta(o).multiplyScalar(i).add(this.start)},applyMatrix4:function t(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function t(e){return e.start.equals(this.start)&&e.end.equals(this.end)}}),Object.assign(zt,{normal:function(){var t=new l;return function e(n,r,i,o){var a=o||new l;a.subVectors(i,r),t.subVectors(n,r),a.cross(t);var s=a.lengthSq();return s>0?a.multiplyScalar(1/Math.sqrt(s)):a.set(0,0,0)}}(),barycoordFromPoint:function(){var t=new l,e=new l,n=new l;return function r(i,o,a,s,c){t.subVectors(s,o),e.subVectors(a,o),n.subVectors(i,o);var u=t.dot(t),h=t.dot(e),d=t.dot(n),p=e.dot(e),f=e.dot(n),m=u*p-h*h,v=c||new l;if(0===m)return v.set(-2,-1,-1);var g=1/m,y=(p*d-h*f)*g,x=(u*f-h*d)*g;return v.set(1-y-x,x,y)}}(),containsPoint:function(){var t=new l;return function e(n,r,i,o){var a=zt.barycoordFromPoint(n,r,i,o,t);return a.x>=0&&a.y>=0&&a.x+a.y<=1}}()}),Object.assign(zt.prototype,{set:function t(e,n,r){return this.a.copy(e),this.b.copy(n),this.c.copy(r),this},setFromPointsAndIndices:function t(e,n,r,i){return this.a.copy(e[n]),this.b.copy(e[r]),this.c.copy(e[i]),this},clone:function t(){return(new this.constructor).copy(this)},copy:function t(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},area:function(){var t=new l,e=new l;return function n(){return t.subVectors(this.c,this.b),e.subVectors(this.a,this.b),.5*t.cross(e).length()}}(),midpoint:function t(e){var n;return(e||new l).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function t(e){return zt.normal(this.a,this.b,this.c,e)},plane:function t(e){var n;return(e||new st).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function t(e,n){return zt.barycoordFromPoint(e,this.a,this.b,this.c,n)},containsPoint:function t(e){return zt.containsPoint(e,this.a,this.b,this.c)},intersectsBox:function t(e){return e.intersectsTriangle(this)},closestPointToPoint:function(){var t=new st,e=[new Bt,new Bt,new Bt],n=new l,r=new l;return function i(o,a){var s=a||new l,c=1/0;if(t.setFromCoplanarPoints(this.a,this.b,this.c),t.projectPoint(o,n),!0===this.containsPoint(n))s.copy(n);else{e[0].set(this.a,this.b),e[1].set(this.b,this.c),e[2].set(this.c,this.a);for(var u=0;u<e.length;u++){e[u].closestPointToPoint(n,!0,r);var h=n.distanceToSquared(r);h<c&&(c=h,s.copy(r))}}return s}}(),equals:function t(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}),Gt.prototype=Object.assign(Object.create(pt.prototype),{constructor:Gt,isMesh:!0,setDrawMode:function t(e){this.drawMode=e},copy:function t(e){return pt.prototype.copy.call(this,e),this.drawMode=e.drawMode,void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this},updateMorphTargets:function t(){var e=this.geometry,n,r,i;if(e.isBufferGeometry){var o=e.morphAttributes,a=Object.keys(o);if(a.length>0){var s=o[a[0]];if(void 0!==s)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},n=0,r=s.length;n<r;n++)i=s[n].name||String(n),this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=n}}else{var c=e.morphTargets;if(void 0!==c&&c.length>0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},n=0,r=c.length;n<r;n++)i=c[n].name||String(n),this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=n}},raycast:function(){function t(t,e,n,r,i,o,a){return zt.barycoordFromPoint(t,e,n,r,y),i.multiplyScalar(y.x),o.multiplyScalar(y.y),a.multiplyScalar(y.z),i.add(o).add(a),i.clone()}function e(t,e,n,r,i,o,a,s){var c;if(null===(c=e.side===fv?r.intersectTriangle(a,o,i,!0,s):r.intersectTriangle(i,o,a,e.side!==mv,s)))return null;b.copy(s),b.applyMatrix4(t.matrixWorld);var u=n.ray.origin.distanceTo(b);return u<n.near||u>n.far?null:{distance:u,point:b.clone(),object:t}}function n(n,r,i,o,c,u,l,d){a.fromBufferAttribute(o,u),s.fromBufferAttribute(o,l),h.fromBufferAttribute(o,d);var p=e(n,n.material,r,i,a,s,h,x);return p&&(c&&(m.fromBufferAttribute(c,u),v.fromBufferAttribute(c,l),g.fromBufferAttribute(c,d),p.uv=t(x,a,s,h,m,v,g)),p.face=new vt(u,l,d,zt.normal(a,s,h)),p.faceIndex=u),p}var r=new u,i=new Ut,o=new at,a=new l,s=new l,h=new l,d=new l,p=new l,f=new l,m=new c,v=new c,g=new c,y=new l,x=new l,b=new l;return function c(u,l){var y=this.geometry,b=this.material,w=this.matrixWorld;if(void 0!==b&&(null===y.boundingSphere&&y.computeBoundingSphere(),o.copy(y.boundingSphere),o.applyMatrix4(w),!1!==u.ray.intersectsSphere(o)&&(r.getInverse(w),i.copy(u.ray).applyMatrix4(r),null===y.boundingBox||!1!==i.intersectsBox(y.boundingBox)))){var _;if(y.isBufferGeometry){var S,M,E,T=y.index,L=y.attributes.position,A=y.attributes.uv,P,R;if(null!==T)for(P=0,R=T.count;P<R;P+=3)S=T.getX(P),M=T.getX(P+1),E=T.getX(P+2),(_=n(this,u,i,L,A,S,M,E))&&(_.faceIndex=Math.floor(P/3),l.push(_));else if(void 0!==L)for(P=0,R=L.count;P<R;P+=3)(_=n(this,u,i,L,A,S=P,M=P+1,E=P+2))&&(_.index=S,l.push(_))}else if(y.isGeometry){var I,C,O,N=Array.isArray(b),F=y.vertices,D=y.faces,U,B=y.faceVertexUvs[0];B.length>0&&(U=B);for(var z=0,G=D.length;z<G;z++){var k=D[z],j=N?b[k.materialIndex]:b;if(void 0!==j){if(I=F[k.a],C=F[k.b],O=F[k.c],!0===j.morphTargets){var V=y.morphTargets,H=this.morphTargetInfluences;a.set(0,0,0),s.set(0,0,0),h.set(0,0,0);for(var W=0,Y=V.length;W<Y;W++){var X=H[W];if(0!==X){var q=V[W].vertices;a.addScaledVector(d.subVectors(q[k.a],I),X),s.addScaledVector(p.subVectors(q[k.b],C),X),h.addScaledVector(f.subVectors(q[k.c],O),X)}}a.add(I),s.add(C),h.add(O),I=a,C=s,O=h}if(_=e(this,j,u,i,I,C,O,x)){if(U&&U[z]){var Z=U[z];m.copy(Z[0]),v.copy(Z[1]),g.copy(Z[2]),_.uv=t(x,I,C,O,m,v,g)}_.face=k,_.faceIndex=z,l.push(_)}}}}}}}(),clone:function t(){return new this.constructor(this.geometry,this.material).copy(this)}});var Zb=0;xe.prototype=Object.assign(Object.create(ft.prototype),{constructor:xe,isPerspectiveCamera:!0,copy:function t(e,n){return ft.prototype.copy.call(this,e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function t(e){var n=.5*this.getFilmHeight()/e;this.fov=2*Ry.RAD2DEG*Math.atan(n),this.updateProjectionMatrix()},getFocalLength:function t(){var e=Math.tan(.5*Ry.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function t(){return 2*Ry.RAD2DEG*Math.atan(Math.tan(.5*Ry.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function t(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function t(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function t(e,n,r,i,o,a){this.aspect=e/n,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=r,this.view.offsetY=i,this.view.width=o,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function t(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function t(){var e=this.near,n=e*Math.tan(.5*Ry.DEG2RAD*this.fov)/this.zoom,r=2*n,i=this.aspect*r,o=-.5*i,a=this.view;if(null!==this.view&&this.view.enabled){var s=a.fullWidth,c=a.fullHeight;o+=a.offsetX*i/s,n-=a.offsetY*r/c,i*=a.width/s,r*=a.height/c}var u=this.filmOffset;0!==u&&(o+=e*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+i,n,n-r,e,this.far)},toJSON:function t(e){var n=pt.prototype.toJSON.call(this,e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,null!==this.view&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}}),be.prototype=Object.assign(Object.create(xe.prototype),{constructor:be,isArrayCamera:!0}),Te.prototype.isFogExp2=!0,Te.prototype.clone=function(){return new Te(this.color.getHex(),this.density)},Te.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},Le.prototype.isFog=!0,Le.prototype.clone=function(){return new Le(this.color.getHex(),this.near,this.far)},Le.prototype.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},Ae.prototype=Object.assign(Object.create(pt.prototype),{constructor:Ae,copy:function t(e,n){return pt.prototype.copy.call(this,e,n),null!==e.background&&(this.background=e.background.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function t(e){var n=pt.prototype.toJSON.call(this,e);return null!==this.background&&(n.object.background=this.background.toJSON(e)),null!==this.fog&&(n.object.fog=this.fog.toJSON()),n}}),Pe.prototype=Object.create(nt.prototype),Pe.prototype.constructor=Pe,Pe.prototype.isSpriteMaterial=!0,Pe.prototype.copy=function(t){return nt.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.rotation=t.rotation,this},Re.prototype=Object.assign(Object.create(pt.prototype),{constructor:Re,isSprite:!0,raycast:function(){var t=new l,e=new l,n=new l;return function r(i,o){e.setFromMatrixPosition(this.matrixWorld),i.ray.closestPointToPoint(e,t),n.setFromMatrixScale(this.matrixWorld);var a=n.x*n.y/4;if(!(e.distanceToSquared(t)>a)){var s=i.ray.origin.distanceTo(t);s<i.near||s>i.far||o.push({distance:s,point:t.clone(),face:null,object:this})}}}(),clone:function t(){return new this.constructor(this.material).copy(this)},copy:function t(e){return pt.prototype.copy.call(this,e),void 0!==e.center&&this.center.copy(e.center),this}}),Ie.prototype=Object.assign(Object.create(pt.prototype),{constructor:Ie,copy:function t(e){pt.prototype.copy.call(this,e,!1);for(var n=e.levels,r=0,i=n.length;r<i;r++){var o=n[r];this.addLevel(o.object.clone(),o.distance)}return this},addLevel:function t(e,n){void 0===n&&(n=0),n=Math.abs(n);for(var r=this.levels,i=0;i<r.length&&!(n<r[i].distance);i++);r.splice(i,0,{distance:n,object:e}),this.add(e)},getObjectForDistance:function t(e){for(var n=this.levels,r=1,i=n.length;r<i&&!(e<n[r].distance);r++);return n[r-1].object},raycast:function(){var t=new l;return function e(n,r){t.setFromMatrixPosition(this.matrixWorld);var i=n.ray.origin.distanceTo(t);this.getObjectForDistance(i).raycast(n,r)}}(),update:function(){var t=new l,e=new l;return function n(r){var i=this.levels;if(i.length>1){t.setFromMatrixPosition(r.matrixWorld),e.setFromMatrixPosition(this.matrixWorld);var o=t.distanceTo(e);i[0].object.visible=!0;for(var a=1,s=i.length;a<s&&o>=i[a].distance;a++)i[a-1].object.visible=!1,i[a].object.visible=!0;for(;a<s;a++)i[a].object.visible=!1}}}(),toJSON:function t(e){var n=pt.prototype.toJSON.call(this,e);n.object.levels=[];for(var r=this.levels,i=0,o=r.length;i<o;i++){var a=r[i];n.object.levels.push({object:a.object.uuid,distance:a.distance})}return n}}),Object.assign(Ce.prototype,{calculateInverses:function t(){this.boneInverses=[];for(var e=0,n=this.bones.length;e<n;e++){var r=new u;this.bones[e]&&r.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(r)}},pose:function t(){var e,n,r;for(n=0,r=this.bones.length;n<r;n++)(e=this.bones[n])&&e.matrixWorld.getInverse(this.boneInverses[n]);for(n=0,r=this.bones.length;n<r;n++)(e=this.bones[n])&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:function(){var t=new u,e=new u;return function n(){for(var r=this.bones,i=this.boneInverses,o=this.boneMatrices,a=this.boneTexture,s=0,c=r.length;s<c;s++){var u=r[s]?r[s].matrixWorld:e;t.multiplyMatrices(u,i[s]),t.toArray(o,16*s)}void 0!==a&&(a.needsUpdate=!0)}}(),clone:function t(){return new Ce(this.bones,this.boneInverses)},getBoneByName:function t(e){for(var n=0,r=this.bones.length;n<r;n++){var i=this.bones[n];if(i.name===e)return i}}}),Oe.prototype=Object.assign(Object.create(pt.prototype),{constructor:Oe,isBone:!0}),Ne.prototype=Object.assign(Object.create(Gt.prototype),{constructor:Ne,isSkinnedMesh:!0,initBones:function t(){var e=[],n,r,i,o;if(this.geometry&&void 0!==this.geometry.bones){for(i=0,o=this.geometry.bones.length;i<o;i++)r=this.geometry.bones[i],n=new Oe,e.push(n),n.name=r.name,n.position.fromArray(r.pos),n.quaternion.fromArray(r.rotq),void 0!==r.scl&&n.scale.fromArray(r.scl);for(i=0,o=this.geometry.bones.length;i<o;i++)-1!==(r=this.geometry.bones[i]).parent&&null!==r.parent&&void 0!==e[r.parent]?e[r.parent].add(e[i]):this.add(e[i])}return this.updateMatrixWorld(!0),e},bind:function t(e,n){this.skeleton=e,void 0===n&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),n=this.matrixWorld),this.bindMatrix.copy(n),this.bindMatrixInverse.getInverse(n)},pose:function t(){this.skeleton.pose()},normalizeSkinWeights:function t(){var e,n;if(this.geometry&&this.geometry.isGeometry)for(n=0;n<this.geometry.skinWeights.length;n++){var r=this.geometry.skinWeights[n];(e=1/r.manhattanLength())!==1/0?r.multiplyScalar(e):r.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry){var i=new f,o=this.geometry.attributes.skinWeight;for(n=0;n<o.count;n++)i.x=o.getX(n),i.y=o.getY(n),i.z=o.getZ(n),i.w=o.getW(n),(e=1/i.manhattanLength())!==1/0?i.multiplyScalar(e):i.set(1,0,0,0),o.setXYZW(n,i.x,i.y,i.z,i.w)}},updateMatrixWorld:function t(e){Gt.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function t(){return new this.constructor(this.geometry,this.material).copy(this)}}),Fe.prototype=Object.create(nt.prototype),Fe.prototype.constructor=Fe,Fe.prototype.isLineBasicMaterial=!0,Fe.prototype.copy=function(t){return nt.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this},De.prototype=Object.assign(Object.create(pt.prototype),{constructor:De,isLine:!0,raycast:function(){var t=new u,e=new Ut,n=new at;return function r(i,o){var a=i.linePrecision,s=a*a,c=this.geometry,u=this.matrixWorld;if(null===c.boundingSphere&&c.computeBoundingSphere(),n.copy(c.boundingSphere),n.applyMatrix4(u),!1!==i.ray.intersectsSphere(n)){t.getInverse(u),e.copy(i.ray).applyMatrix4(t);var h=new l,d=new l,p=new l,f=new l,m=this&&this.isLineSegments?2:1;if(c.isBufferGeometry){var v=c.index,g,y=c.attributes.position.array;if(null!==v)for(var x=v.array,b=0,w=x.length-1;b<w;b+=m){var _=x[b],S=x[b+1];h.fromArray(y,3*_),d.fromArray(y,3*S);var M;if(!((M=e.distanceSqToSegment(h,d,f,p))>s)){f.applyMatrix4(this.matrixWorld);var E;(E=i.ray.origin.distanceTo(f))<i.near||E>i.far||o.push({distance:E,point:p.clone().applyMatrix4(this.matrixWorld),index:b,face:null,faceIndex:null,object:this})}}else for(var b=0,w=y.length/3-1;b<w;b+=m){h.fromArray(y,3*b),d.fromArray(y,3*b+3);var M;if(!((M=e.distanceSqToSegment(h,d,f,p))>s)){f.applyMatrix4(this.matrixWorld);var E;(E=i.ray.origin.distanceTo(f))<i.near||E>i.far||o.push({distance:E,point:p.clone().applyMatrix4(this.matrixWorld),index:b,face:null,faceIndex:null,object:this})}}}else if(c.isGeometry)for(var T=c.vertices,L=T.length,b=0;b<L-1;b+=m){var M;if(!((M=e.distanceSqToSegment(T[b],T[b+1],f,p))>s)){f.applyMatrix4(this.matrixWorld);var E;(E=i.ray.origin.distanceTo(f))<i.near||E>i.far||o.push({distance:E,point:p.clone().applyMatrix4(this.matrixWorld),index:b,face:null,faceIndex:null,object:this})}}}}}(),clone:function t(){return new this.constructor(this.geometry,this.material).copy(this)}}),Ue.prototype=Object.assign(Object.create(De.prototype),{constructor:Ue,isLineSegments:!0}),Be.prototype=Object.assign(Object.create(De.prototype),{constructor:Be,isLineLoop:!0}),ze.prototype=Object.create(nt.prototype),ze.prototype.constructor=ze,ze.prototype.isPointsMaterial=!0,ze.prototype.copy=function(t){return nt.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this},Ge.prototype=Object.assign(Object.create(pt.prototype),{constructor:Ge,isPoints:!0,raycast:function(){var t=new u,e=new Ut,n=new at;return function r(i,o){function a(t,n){var r=e.distanceSqToPoint(t);if(r<p){var a=e.closestPointToPoint(t);a.applyMatrix4(u);var c=i.ray.origin.distanceTo(a);if(c<i.near||c>i.far)return;o.push({distance:c,distanceToRay:Math.sqrt(r),point:a.clone(),index:n,face:null,object:s})}}var s=this,c=this.geometry,u=this.matrixWorld,h=i.params.Points.threshold;if(null===c.boundingSphere&&c.computeBoundingSphere(),n.copy(c.boundingSphere),n.applyMatrix4(u),n.radius+=h,!1!==i.ray.intersectsSphere(n)){t.getInverse(u),e.copy(i.ray).applyMatrix4(t);var d=h/((this.scale.x+this.scale.y+this.scale.z)/3),p=d*d,f=new l;if(c.isBufferGeometry){var m=c.index,v,g=c.attributes.position.array;if(null!==m)for(var y=m.array,x=0,b=y.length;x<b;x++){var w=y[x];f.fromArray(g,3*w),a(f,w)}else for(var x=0,_=g.length/3;x<_;x++)f.fromArray(g,3*x),a(f,x)}else for(var S=c.vertices,x=0,_=S.length;x<_;x++)a(S[x],x)}}}(),clone:function t(){return new this.constructor(this.geometry,this.material).copy(this)}}),ke.prototype=Object.assign(Object.create(pt.prototype),{constructor:ke,isGroup:!0}),je.prototype=Object.assign(Object.create(p.prototype),{constructor:je,isVideoTexture:!0,update:function t(){var e=this.image;e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),Ve.prototype=Object.create(p.prototype),Ve.prototype.constructor=Ve,Ve.prototype.isCompressedTexture=!0,He.prototype=Object.create(p.prototype),He.prototype.constructor=He,He.prototype.isDepthTexture=!0,We.prototype=Object.create(Rt.prototype),We.prototype.constructor=We,Ye.prototype=Object.create(gt.prototype),Ye.prototype.constructor=Ye,Xe.prototype=Object.create(Rt.prototype),Xe.prototype.constructor=Xe,qe.prototype=Object.create(gt.prototype),qe.prototype.constructor=qe,Ze.prototype=Object.create(Rt.prototype),Ze.prototype.constructor=Ze,Je.prototype=Object.create(gt.prototype),Je.prototype.constructor=Je,Qe.prototype=Object.create(Ze.prototype),Qe.prototype.constructor=Qe,Ke.prototype=Object.create(gt.prototype),Ke.prototype.constructor=Ke,$e.prototype=Object.create(Ze.prototype),$e.prototype.constructor=$e,tn.prototype=Object.create(gt.prototype),tn.prototype.constructor=tn,en.prototype=Object.create(Ze.prototype),en.prototype.constructor=en,nn.prototype=Object.create(gt.prototype),nn.prototype.constructor=nn,rn.prototype=Object.create(Ze.prototype),rn.prototype.constructor=rn,on.prototype=Object.create(gt.prototype),on.prototype.constructor=on,an.prototype=Object.create(Rt.prototype),an.prototype.constructor=an,sn.prototype=Object.create(gt.prototype),sn.prototype.constructor=sn,cn.prototype=Object.create(Rt.prototype),cn.prototype.constructor=cn,un.prototype=Object.create(gt.prototype),un.prototype.constructor=un,hn.prototype=Object.create(Rt.prototype),hn.prototype.constructor=hn;var Jb=function t(e,n,r){r=r||2;var i=n&&n.length,o=i?n[0]*r:e.length,a=ln(e,0,o,r,!0),s=[];if(!a)return s;var c,u,h,l,d,p,f;if(i&&(a=yn(e,n,a,r)),e.length>80*r){c=h=e[0],u=l=e[1];for(var m=r;m<o;m+=r)d=e[m],p=e[m+1],d<c&&(c=d),p<u&&(u=p),d>h&&(h=d),p>l&&(l=p);f=0!==(f=Math.max(h-c,l-u))?1/f:0}return pn(a,s,r,c,u,f),s},Qb={area:function t(e){for(var n=e.length,r=0,i=n-1,o=0;o<n;i=o++)r+=e[i].x*e[o].y-e[o].x*e[i].y;return.5*r},isClockWise:function t(e){return Qb.area(e)<0},triangulateShape:function t(e,n){var r=[],i=[],o=[];zn(e),Gn(r,e);var a=e.length;n.forEach(zn);for(var s=0;s<n.length;s++)i.push(a),a+=n[s].length,Gn(r,n[s]);for(var c=Jb(r,i),s=0;s<c.length;s+=3)o.push(c.slice(s,s+3));return o}};kn.prototype=Object.create(gt.prototype),kn.prototype.constructor=kn,jn.prototype=Object.create(Rt.prototype),jn.prototype.constructor=jn,jn.prototype.getArrays=function(){var t=this.getAttribute("position"),e=t?Array.prototype.slice.call(t.array):[],n=this.getAttribute("uv"),r=n?Array.prototype.slice.call(n.array):[],i=this.index,o;return{position:e,uv:r,index:i?Array.prototype.slice.call(i.array):[]}},jn.prototype.addShapeList=function(t,e){var n=t.length;e.arrays=this.getArrays();for(var r=0;r<n;r++){var i=t[r];this.addShape(i,e)}this.setIndex(e.arrays.index),this.addAttribute("position",new Tt(e.arrays.position,3)),this.addAttribute("uv",new Tt(e.arrays.uv,2))},jn.prototype.addShape=function(t,e){function n(t,e,n){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(n).add(t)}function r(t,e,n){var r,i,o,a=t.x-e.x,s=t.y-e.y,u=n.x-t.x,h=n.y-t.y,l=a*a+s*s,d=a*h-s*u;if(Math.abs(d)>Number.EPSILON){var p=Math.sqrt(l),f=Math.sqrt(u*u+h*h),m=e.x-s/p,v=e.y+a/p,g,y,x=((n.x-h/f-m)*h-(n.y+u/f-v)*u)/(a*h-s*u),b=(r=m+a*x-t.x)*r+(i=v+s*x-t.y)*i;if(b<=2)return new c(r,i);o=Math.sqrt(b/2)}else{var w=!1;a>Number.EPSILON?u>Number.EPSILON&&(w=!0):a<-Number.EPSILON?u<-Number.EPSILON&&(w=!0):Math.sign(s)===Math.sign(h)&&(w=!0),w?(r=-s,i=a,o=Math.sqrt(l)):(r=a,i=s,o=Math.sqrt(l/2))}return new c(r/o,i/o)}function i(){var t=m.length/3;if(S){var n=0,r=Z*n;for($=0;$<Q;$++)u((J=j[$])[2]+r,J[1]+r,J[0]+r);for(r=Z*(n=E+2*_),$=0;$<Q;$++)u((J=j[$])[0]+r,J[1]+r,J[2]+r)}else{for($=0;$<Q;$++)u((J=j[$])[2],J[1],J[0]);for($=0;$<Q;$++)u((J=j[$])[0]+Z*E,J[1]+Z*E,J[2]+Z*E)}U.addGroup(t,m.length/3-t,void 0!==e.material?e.material:0)}function o(){var t=m.length/3,n=0;for(a(V,n),n+=V.length,F=0,D=G.length;F<D;F++)a(N=G[F],n),n+=N.length;U.addGroup(t,m.length/3-t,void 0!==e.extrudeMaterial?e.extrudeMaterial:1)}function a(t,e){var n,r;for($=t.length;--$>=0;){n=$,(r=$-1)<0&&(r=t.length-1);var i=0,o=E+2*_;for(i=0;i<o;i++){var a=Z*i,s=Z*(i+1),c,u,l,d;h(e+n+a,e+r+a,e+r+s,e+n+s)}}}function s(t,e,n){y.push(t),y.push(e),y.push(n)}function u(t,e,n){d(t),d(e),d(n);var r=m.length/3,i=P.generateTopUV(U,m,r-3,r-2,r-1);p(i[0]),p(i[1]),p(i[2])}function h(t,e,n,r){d(t),d(e),d(r),d(e),d(n),d(r);var i=m.length/3,o=P.generateSideWallUV(U,m,i-6,i-3,i-2,i-1);p(o[0]),p(o[1]),p(o[3]),p(o[1]),p(o[2]),p(o[3])}function d(t){v.push(m.length/3),m.push(y[3*t+0]),m.push(y[3*t+1]),m.push(y[3*t+2])}function p(t){g.push(t.x),g.push(t.y)}var f=e.arrays?e.arrays:this.getArrays(),m=f.position,v=f.index,g=f.uv,y=[],x=void 0!==e.amount?e.amount:100,b=void 0!==e.bevelThickness?e.bevelThickness:6,w=void 0!==e.bevelSize?e.bevelSize:b-2,_=void 0!==e.bevelSegments?e.bevelSegments:3,S=void 0===e.bevelEnabled||e.bevelEnabled,M=void 0!==e.curveSegments?e.curveSegments:12,E=void 0!==e.steps?e.steps:1,T=e.extrudePath,L,A=!1,P=void 0!==e.UVGenerator?e.UVGenerator:kn.WorldUVGenerator,R,I,C,O;T&&(L=T.getSpacedPoints(E),A=!0,S=!1,R=void 0!==e.frames?e.frames:T.computeFrenetFrames(E,!1),I=new l,C=new l,O=new l),S||(_=0,b=0,w=0);var N,F,D,U=this,B=t.extractPoints(M),z=B.shape,G=B.holes,k;if(!Qb.isClockWise(z))for(z=z.reverse(),F=0,D=G.length;F<D;F++)N=G[F],Qb.isClockWise(N)&&(G[F]=N.reverse());var j=Qb.triangulateShape(z,G),V=z;for(F=0,D=G.length;F<D;F++)N=G[F],z=z.concat(N);for(var H,W,Y,X,q,Z=z.length,J,Q=j.length,K=[],$=0,tt=V.length,et=tt-1,nt=$+1;$<tt;$++,et++,nt++)et===tt&&(et=0),nt===tt&&(nt=0),K[$]=r(V[$],V[et],V[nt]);var rt=[],it,ot=K.concat();for(F=0,D=G.length;F<D;F++){for(N=G[F],it=[],$=0,et=(tt=N.length)-1,nt=$+1;$<tt;$++,et++,nt++)et===tt&&(et=0),nt===tt&&(nt=0),it[$]=r(N[$],N[et],N[nt]);rt.push(it),ot=ot.concat(it)}for(H=0;H<_;H++){for(Y=H/_,X=b*Math.cos(Y*Math.PI/2),W=w*Math.sin(Y*Math.PI/2),$=0,tt=V.length;$<tt;$++)s((q=n(V[$],K[$],W)).x,q.y,-X);for(F=0,D=G.length;F<D;F++)for(N=G[F],it=rt[F],$=0,tt=N.length;$<tt;$++)s((q=n(N[$],it[$],W)).x,q.y,-X)}for(W=w,$=0;$<Z;$++)q=S?n(z[$],ot[$],W):z[$],A?(C.copy(R.normals[0]).multiplyScalar(q.x),I.copy(R.binormals[0]).multiplyScalar(q.y),O.copy(L[0]).add(C).add(I),s(O.x,O.y,O.z)):s(q.x,q.y,0);var at;for(at=1;at<=E;at++)for($=0;$<Z;$++)q=S?n(z[$],ot[$],W):z[$],A?(C.copy(R.normals[at]).multiplyScalar(q.x),I.copy(R.binormals[at]).multiplyScalar(q.y),O.copy(L[at]).add(C).add(I),s(O.x,O.y,O.z)):s(q.x,q.y,x/E*at);for(H=_-1;H>=0;H--){for(Y=H/_,X=b*Math.cos(Y*Math.PI/2),W=w*Math.sin(Y*Math.PI/2),$=0,tt=V.length;$<tt;$++)s((q=n(V[$],K[$],W)).x,q.y,x+X);for(F=0,D=G.length;F<D;F++)for(N=G[F],it=rt[F],$=0,tt=N.length;$<tt;$++)q=n(N[$],it[$],W),A?s(q.x,q.y+L[E-1].y,L[E-1].x+X):s(q.x,q.y,x+X)}i(),o(),e.arrays||(this.setIndex(v),this.addAttribute("position",new Tt(m,3)),this.addAttribute("uv",new Tt(g,2)))},kn.WorldUVGenerator={generateTopUV:function t(e,n,r,i,o){var a=n[3*r],s=n[3*r+1],u=n[3*i],h=n[3*i+1],l=n[3*o],d=n[3*o+1];return[new c(a,s),new c(u,h),new c(l,d)]},generateSideWallUV:function t(e,n,r,i,o,a){var s=n[3*r],u=n[3*r+1],h=n[3*r+2],l=n[3*i],d=n[3*i+1],p=n[3*i+2],f=n[3*o],m=n[3*o+1],v=n[3*o+2],g=n[3*a],y=n[3*a+1],x=n[3*a+2];return Math.abs(u-d)<.01?[new c(s,1-h),new c(l,1-p),new c(f,1-v),new c(g,1-x)]:[new c(u,1-h),new c(d,1-p),new c(m,1-v),new c(y,1-x)]}},Vn.prototype=Object.create(gt.prototype),Vn.prototype.constructor=Vn,Hn.prototype=Object.create(jn.prototype),Hn.prototype.constructor=Hn,Wn.prototype=Object.create(gt.prototype),Wn.prototype.constructor=Wn,Yn.prototype=Object.create(Rt.prototype),Yn.prototype.constructor=Yn,Xn.prototype=Object.create(gt.prototype),Xn.prototype.constructor=Xn,qn.prototype=Object.create(Rt.prototype),qn.prototype.constructor=qn,Zn.prototype=Object.create(gt.prototype),Zn.prototype.constructor=Zn,Jn.prototype=Object.create(Rt.prototype),Jn.prototype.constructor=Jn;var Kb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$b=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},tw=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();Qn.prototype=Object.create(gt.prototype),Qn.prototype.constructor=Qn,Qn.prototype.toJSON=function(){var t=gt.prototype.toJSON.call(this),e;return $n(this.parameters.shapes,t)},Kn.prototype=Object.create(Rt.prototype),Kn.prototype.constructor=Kn,Kn.prototype.toJSON=function(){var t=Rt.prototype.toJSON.call(this),e;return $n(this.parameters.shapes,t)},tr.prototype=Object.create(Rt.prototype),tr.prototype.constructor=tr,er.prototype=Object.create(gt.prototype),er.prototype.constructor=er,nr.prototype=Object.create(Rt.prototype),nr.prototype.constructor=nr,rr.prototype=Object.create(er.prototype),rr.prototype.constructor=rr,ir.prototype=Object.create(nr.prototype),ir.prototype.constructor=ir,or.prototype=Object.create(gt.prototype),or.prototype.constructor=or,ar.prototype=Object.create(Rt.prototype),ar.prototype.constructor=ar;var ew=Object.freeze({WireframeGeometry:We,ParametricGeometry:Ye,ParametricBufferGeometry:Xe,TetrahedronGeometry:Je,TetrahedronBufferGeometry:Qe,OctahedronGeometry:Ke,OctahedronBufferGeometry:$e,IcosahedronGeometry:tn,IcosahedronBufferGeometry:en,DodecahedronGeometry:nn,DodecahedronBufferGeometry:rn,PolyhedronGeometry:qe,PolyhedronBufferGeometry:Ze,TubeGeometry:on,TubeBufferGeometry:an,TorusKnotGeometry:sn,TorusKnotBufferGeometry:cn,TorusGeometry:un,TorusBufferGeometry:hn,TextGeometry:Vn,TextBufferGeometry:Hn,SphereGeometry:Wn,SphereBufferGeometry:Yn,RingGeometry:Xn,RingBufferGeometry:qn,PlaneGeometry:Ot,PlaneBufferGeometry:Nt,LatheGeometry:Zn,LatheBufferGeometry:Jn,ShapeGeometry:Qn,ShapeBufferGeometry:Kn,ExtrudeGeometry:kn,ExtrudeBufferGeometry:jn,EdgesGeometry:tr,ConeGeometry:rr,ConeBufferGeometry:ir,CylinderGeometry:er,CylinderBufferGeometry:nr,CircleGeometry:or,CircleBufferGeometry:ar,BoxGeometry:It,BoxBufferGeometry:Ct});sr.prototype=Object.create(nt.prototype),sr.prototype.constructor=sr,sr.prototype.isShadowMaterial=!0,cr.prototype=Object.create(Dt.prototype),cr.prototype.constructor=cr,cr.prototype.isRawShaderMaterial=!0,ur.prototype=Object.create(nt.prototype),ur.prototype.constructor=ur,ur.prototype.isMeshStandardMaterial=!0,ur.prototype.copy=function(t){return nt.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},hr.prototype=Object.create(ur.prototype),hr.prototype.constructor=hr,hr.prototype.isMeshPhysicalMaterial=!0,hr.prototype.copy=function(t){return ur.prototype.copy.call(this,t),this.defines={PHYSICAL:""},this.reflectivity=t.reflectivity,this.clearCoat=t.clearCoat,this.clearCoatRoughness=t.clearCoatRoughness,this},lr.prototype=Object.create(nt.prototype),lr.prototype.constructor=lr,lr.prototype.isMeshPhongMaterial=!0,lr.prototype.copy=function(t){return nt.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},dr.prototype=Object.create(lr.prototype),dr.prototype.constructor=dr,dr.prototype.isMeshToonMaterial=!0,dr.prototype.copy=function(t){return lr.prototype.copy.call(this,t),this.gradientMap=t.gradientMap,this},pr.prototype=Object.create(nt.prototype),pr.prototype.constructor=pr,pr.prototype.isMeshNormalMaterial=!0,pr.prototype.copy=function(t){return nt.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},fr.prototype=Object.create(nt.prototype),fr.prototype.constructor=fr,fr.prototype.isMeshLambertMaterial=!0,fr.prototype.copy=function(t){return nt.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},mr.prototype=Object.create(Fe.prototype),mr.prototype.constructor=mr,mr.prototype.isLineDashedMaterial=!0,mr.prototype.copy=function(t){return Fe.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var nw=Object.freeze({ShadowMaterial:sr,SpriteMaterial:Pe,RawShaderMaterial:cr,ShaderMaterial:Dt,PointsMaterial:ze,MeshPhysicalMaterial:hr,MeshStandardMaterial:ur,MeshPhongMaterial:lr,MeshToonMaterial:dr,MeshNormalMaterial:pr,MeshLambertMaterial:fr,MeshDepthMaterial:rt,MeshDistanceMaterial:it,MeshBasicMaterial:Ft,LineDashedMaterial:mr,LineBasicMaterial:Fe,Material:nt}),rw={enabled:!1,files:{},add:function t(e,n){!1!==this.enabled&&(this.files[e]=n)},get:function t(e){if(!1!==this.enabled)return this.files[e]},remove:function t(e){delete this.files[e]},clear:function t(){this.files={}}},iw=new vr,ow={};Object.assign(gr.prototype,{load:function t(e,n,r,i){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var o=this,a=rw.get(e);if(void 0!==a)return o.manager.itemStart(e),setTimeout(function(){n&&n(a),o.manager.itemEnd(e)},0),a;if(void 0===ow[e]){var s=/^data:(.*?)(;base64)?,(.*)$/,c=e.match(s);if(c){var u=c[1],h=!!c[2],l=c[3];l=window.decodeURIComponent(l),h&&(l=window.atob(l));try{var d,p=(this.responseType||"").toLowerCase();switch(p){case"arraybuffer":case"blob":for(var f=new Uint8Array(l.length),m=0;m<l.length;m++)f[m]=l.charCodeAt(m);d="blob"===p?new Blob([f.buffer],{type:u}):f.buffer;break;case"document":var v=new DOMParser;d=v.parseFromString(l,u);break;case"json":d=JSON.parse(l);break;default:d=l}window.setTimeout(function(){n&&n(d),o.manager.itemEnd(e)},0)}catch(t){window.setTimeout(function(){i&&i(t),o.manager.itemEnd(e),o.manager.itemError(e)},0)}}else{ow[e]=[],ow[e].push({onLoad:n,onProgress:r,onError:i});var g=new XMLHttpRequest;g.open("GET",e,!0),g.addEventListener("load",function(t){var n=this.response;rw.add(e,n);var r=ow[e];if(delete ow[e],200===this.status){for(var i=0,a=r.length;i<a;i++){var s;(s=r[i]).onLoad&&s.onLoad(n)}o.manager.itemEnd(e)}else if(0===this.status){console.warn("THREE.FileLoader: HTTP Status 0 received.");for(var i=0,a=r.length;i<a;i++){var s;(s=r[i]).onLoad&&s.onLoad(n)}o.manager.itemEnd(e)}else{for(var i=0,a=r.length;i<a;i++){var s;(s=r[i]).onError&&s.onError(t)}o.manager.itemEnd(e),o.manager.itemError(e)}},!1),g.addEventListener("progress",function(t){for(var n=ow[e],r=0,i=n.length;r<i;r++){var o=n[r];o.onProgress&&o.onProgress(t)}},!1),g.addEventListener("error",function(t){var n=ow[e];delete ow[e];for(var r=0,i=n.length;r<i;r++){var a=n[r];a.onError&&a.onError(t)}o.manager.itemEnd(e),o.manager.itemError(e)},!1),void 0!==this.responseType&&(g.responseType=this.responseType),void 0!==this.withCredentials&&(g.withCredentials=this.withCredentials),g.overrideMimeType&&g.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(var y in this.requestHeader)g.setRequestHeader(y,this.requestHeader[y]);g.send(null)}return o.manager.itemStart(e),g}ow[e].push({onLoad:n,onProgress:r,onError:i})},setPath:function t(e){return this.path=e,this},setResponseType:function t(e){return this.responseType=e,this},setWithCredentials:function t(e){return this.withCredentials=e,this},setMimeType:function t(e){return this.mimeType=e,this},setRequestHeader:function t(e){return this.requestHeader=e,this}}),Object.assign(yr.prototype,{load:function t(e,n,r,i){function o(t){u.load(e[t],function(e){var r=a._parser(e,!0);s[t]={width:r.width,height:r.height,format:r.format,mipmaps:r.mipmaps},6===(h+=1)&&(1===r.mipmapCount&&(c.minFilter=yg),c.format=r.format,c.needsUpdate=!0,n&&n(c))},r,i)}var a=this,s=[],c=new Ve;c.image=s;var u=new gr(this.manager);if(u.setPath(this.path),u.setResponseType("arraybuffer"),Array.isArray(e))for(var h=0,l=0,d=e.length;l<d;++l)o(l);else u.load(e,function(t){var e=a._parser(t,!0);if(e.isCubemap)for(var r=e.mipmaps.length/e.mipmapCount,i=0;i<r;i++){s[i]={mipmaps:[]};for(var o=0;o<e.mipmapCount;o++)s[i].mipmaps.push(e.mipmaps[i*e.mipmapCount+o]),s[i].format=e.format,s[i].width=e.width,s[i].height=e.height}else c.image.width=e.width,c.image.height=e.height,c.mipmaps=e.mipmaps;1===e.mipmapCount&&(c.minFilter=yg),c.format=e.format,c.needsUpdate=!0,n&&n(c)},r,i);return c},setPath:function t(e){return this.path=e,this}}),Object.assign(xr.prototype,{load:function t(e,n,r,i){var o=this,a=new g,s=new gr(this.manager);return s.setResponseType("arraybuffer"),s.load(e,function(t){var e=o._parser(t);e&&(void 0!==e.image?a.image=e.image:void 0!==e.data&&(a.image.width=e.width,a.image.height=e.height,a.image.data=e.data),a.wrapS=void 0!==e.wrapS?e.wrapS:pg,a.wrapT=void 0!==e.wrapT?e.wrapT:pg,a.magFilter=void 0!==e.magFilter?e.magFilter:yg,a.minFilter=void 0!==e.minFilter?e.minFilter:bg,a.anisotropy=void 0!==e.anisotropy?e.anisotropy:1,void 0!==e.format&&(a.format=e.format),void 0!==e.type&&(a.type=e.type),void 0!==e.mipmaps&&(a.mipmaps=e.mipmaps),1===e.mipmapCount&&(a.minFilter=yg),a.needsUpdate=!0,n&&n(a,e))},r,i),a}}),Object.assign(br.prototype,{crossOrigin:"Anonymous",load:function t(e,n,r,i){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var o=this,a=rw.get(e);if(void 0!==a)return o.manager.itemStart(e),setTimeout(function(){n&&n(a),o.manager.itemEnd(e)},0),a;var s=document.createElementNS("http://www.w3.org/1999/xhtml","img");return s.addEventListener("load",function(){rw.add(e,this),n&&n(this),o.manager.itemEnd(e)},!1),s.addEventListener("error",function(t){i&&i(t),o.manager.itemEnd(e),o.manager.itemError(e)},!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(s.crossOrigin=this.crossOrigin),o.manager.itemStart(e),s.src=e,s},setCrossOrigin:function t(e){return this.crossOrigin=e,this},setPath:function t(e){return this.path=e,this}}),Object.assign(wr.prototype,{crossOrigin:"Anonymous",load:function t(e,n,r,i){function o(t){s.load(e[t],function(e){a.images[t]=e,6===++c&&(a.needsUpdate=!0,n&&n(a))},void 0,i)}var a=new y,s=new br(this.manager);s.setCrossOrigin(this.crossOrigin),s.setPath(this.path);for(var c=0,u=0;u<e.length;++u)o(u);return a},setCrossOrigin:function t(e){return this.crossOrigin=e,this},setPath:function t(e){return this.path=e,this}}),Object.assign(_r.prototype,{crossOrigin:"Anonymous",load:function t(e,n,r,i){var o=new p,a=new br(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(t){o.image=t;var r=e.search(/\.(jpg|jpeg)$/)>0||0===e.search(/^data\:image\/jpeg/);o.format=r?Ng:Fg,o.needsUpdate=!0,void 0!==n&&n(o)},r,i),o},setCrossOrigin:function t(e){return this.crossOrigin=e,this},setPath:function t(e){return this.path=e,this}}),Object.assign(Sr.prototype,{getPoint:function t(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function t(e,n){var r=this.getUtoTmapping(e);return this.getPoint(r,n)},getPoints:function t(e){void 0===e&&(e=5);for(var n=[],r=0;r<=e;r++)n.push(this.getPoint(r/e));return n},getSpacedPoints:function t(e){void 0===e&&(e=5);for(var n=[],r=0;r<=e;r++)n.push(this.getPointAt(r/e));return n},getLength:function t(){var e=this.getLengths();return e[e.length-1]},getLengths:function t(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var n=[],r,i=this.getPoint(0),o,a=0;for(n.push(0),o=1;o<=e;o++)a+=(r=this.getPoint(o/e)).distanceTo(i),n.push(a),i=r;return this.cacheArcLengths=n,n},updateArcLengths:function t(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function t(e,n){var r=this.getLengths(),i=0,o=r.length,a;a=n||e*r[o-1];for(var s=0,c=o-1,u;s<=c;)if(i=Math.floor(s+(c-s)/2),(u=r[i]-a)<0)s=i+1;else{if(!(u>0)){c=i;break}c=i-1}if(i=c,r[i]===a)return i/(o-1);var h=r[i],l,d,p,f;return(i+(a-h)/(r[i+1]-h))/(o-1)},getTangent:function t(e){var n=1e-4,r=e-1e-4,i=e+1e-4;r<0&&(r=0),i>1&&(i=1);var o=this.getPoint(r),a,s;return this.getPoint(i).clone().sub(o).normalize()},getTangentAt:function t(e){var n=this.getUtoTmapping(e);return this.getTangent(n)},computeFrenetFrames:function t(e,n){var r=new l,i=[],o=[],a=[],s=new l,c=new u,h,d,p;for(h=0;h<=e;h++)d=h/e,i[h]=this.getTangentAt(d),i[h].normalize();o[0]=new l,a[0]=new l;var f=Number.MAX_VALUE,m=Math.abs(i[0].x),v=Math.abs(i[0].y),g=Math.abs(i[0].z);for(m<=f&&(f=m,r.set(1,0,0)),v<=f&&(f=v,r.set(0,1,0)),g<=f&&r.set(0,0,1),s.crossVectors(i[0],r).normalize(),o[0].crossVectors(i[0],s),a[0].crossVectors(i[0],o[0]),h=1;h<=e;h++)o[h]=o[h-1].clone(),a[h]=a[h-1].clone(),s.crossVectors(i[h-1],i[h]),s.length()>Number.EPSILON&&(s.normalize(),p=Math.acos(Ry.clamp(i[h-1].dot(i[h]),-1,1)),o[h].applyMatrix4(c.makeRotationAxis(s,p))),a[h].crossVectors(i[h],o[h]);if(!0===n)for(p=Math.acos(Ry.clamp(o[0].dot(o[e]),-1,1)),p/=e,i[0].dot(s.crossVectors(o[0],o[e]))>0&&(p=-p),h=1;h<=e;h++)o[h].applyMatrix4(c.makeRotationAxis(i[h],p*h)),a[h].crossVectors(i[h],o[h]);return{tangents:i,normals:o,binormals:a}},clone:function t(){return(new this.constructor).copy(this)},copy:function t(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function t(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function t(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}),Mr.prototype=Object.create(Sr.prototype),Mr.prototype.constructor=Mr,Mr.prototype.isEllipseCurve=!0,Mr.prototype.getPoint=function(t,e){for(var n=e||new c,r=2*Math.PI,i=this.aEndAngle-this.aStartAngle,o=Math.abs(i)<Number.EPSILON;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=o?0:r),!0!==this.aClockwise||o||(i===r?i=-r:i-=r);var a=this.aStartAngle+t*i,s=this.aX+this.xRadius*Math.cos(a),u=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){var h=Math.cos(this.aRotation),l=Math.sin(this.aRotation),d=s-this.aX,p=u-this.aY;s=d*h-p*l+this.aX,u=d*l+p*h+this.aY}return n.set(s,u)},Mr.prototype.copy=function(t){return Sr.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Mr.prototype.toJSON=function(){var t=Sr.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},Mr.prototype.fromJSON=function(t){return Sr.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Er.prototype=Object.create(Mr.prototype),Er.prototype.constructor=Er,Er.prototype.isArcCurve=!0;var aw=new l,sw=new Tr,cw=new Tr,uw=new Tr;Lr.prototype=Object.create(Sr.prototype),Lr.prototype.constructor=Lr,Lr.prototype.isCatmullRomCurve3=!0,Lr.prototype.getPoint=function(t,e){var n=e||new l,r=this.points,i=r.length,o=(i-(this.closed?0:1))*t,a=Math.floor(o),s=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/r.length)+1)*r.length:0===s&&a===i-1&&(a=i-2,s=1);var c,u,h,d;if(this.closed||a>0?c=r[(a-1)%i]:(aw.subVectors(r[0],r[1]).add(r[0]),c=aw),u=r[a%i],h=r[(a+1)%i],this.closed||a+2<i?d=r[(a+2)%i]:(aw.subVectors(r[i-1],r[i-2]).add(r[i-1]),d=aw),"centripetal"===this.curveType||"chordal"===this.curveType){var p="chordal"===this.curveType?.5:.25,f=Math.pow(c.distanceToSquared(u),p),m=Math.pow(u.distanceToSquared(h),p),v=Math.pow(h.distanceToSquared(d),p);m<1e-4&&(m=1),f<1e-4&&(f=m),v<1e-4&&(v=m),sw.initNonuniformCatmullRom(c.x,u.x,h.x,d.x,f,m,v),cw.initNonuniformCatmullRom(c.y,u.y,h.y,d.y,f,m,v),uw.initNonuniformCatmullRom(c.z,u.z,h.z,d.z,f,m,v)}else"catmullrom"===this.curveType&&(sw.initCatmullRom(c.x,u.x,h.x,d.x,this.tension),cw.initCatmullRom(c.y,u.y,h.y,d.y,this.tension),uw.initCatmullRom(c.z,u.z,h.z,d.z,this.tension));return n.set(sw.calc(s),cw.calc(s),uw.calc(s)),n},Lr.prototype.copy=function(t){Sr.prototype.copy.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push(r.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},Lr.prototype.toJSON=function(){var t=Sr.prototype.toJSON.call(this);t.points=[];for(var e=0,n=this.points.length;e<n;e++){var r=this.points[e];t.points.push(r.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},Lr.prototype.fromJSON=function(t){Sr.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push((new l).fromArray(r))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},Br.prototype=Object.create(Sr.prototype),Br.prototype.constructor=Br,Br.prototype.isCubicBezierCurve=!0,Br.prototype.getPoint=function(t,e){var n=e||new c,r=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set(Ur(t,r.x,i.x,o.x,a.x),Ur(t,r.y,i.y,o.y,a.y)),n},Br.prototype.copy=function(t){return Sr.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},Br.prototype.toJSON=function(){var t=Sr.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},Br.prototype.fromJSON=function(t){return Sr.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},zr.prototype=Object.create(Sr.prototype),zr.prototype.constructor=zr,zr.prototype.isCubicBezierCurve3=!0,zr.prototype.getPoint=function(t,e){var n=e||new l,r=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set(Ur(t,r.x,i.x,o.x,a.x),Ur(t,r.y,i.y,o.y,a.y),Ur(t,r.z,i.z,o.z,a.z)),n},zr.prototype.copy=function(t){return Sr.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},zr.prototype.toJSON=function(){var t=Sr.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},zr.prototype.fromJSON=function(t){return Sr.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},Gr.prototype=Object.create(Sr.prototype),Gr.prototype.constructor=Gr,Gr.prototype.isLineCurve=!0,Gr.prototype.getPoint=function(t,e){var n=e||new c;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n},Gr.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},Gr.prototype.getTangent=function(){var t;return this.v2.clone().sub(this.v1).normalize()},Gr.prototype.copy=function(t){return Sr.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Gr.prototype.toJSON=function(){var t=Sr.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Gr.prototype.fromJSON=function(t){return Sr.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},kr.prototype=Object.create(Sr.prototype),kr.prototype.constructor=kr,kr.prototype.isLineCurve3=!0,kr.prototype.getPoint=function(t,e){var n=e||new l;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n},kr.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},kr.prototype.copy=function(t){return Sr.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},kr.prototype.toJSON=function(){var t=Sr.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},kr.prototype.fromJSON=function(t){return Sr.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},jr.prototype=Object.create(Sr.prototype),jr.prototype.constructor=jr,jr.prototype.isQuadraticBezierCurve=!0,jr.prototype.getPoint=function(t,e){var n=e||new c,r=this.v0,i=this.v1,o=this.v2;return n.set(Cr(t,r.x,i.x,o.x),Cr(t,r.y,i.y,o.y)),n},jr.prototype.copy=function(t){return Sr.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},jr.prototype.toJSON=function(){var t=Sr.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},jr.prototype.fromJSON=function(t){return Sr.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},Vr.prototype=Object.create(Sr.prototype),Vr.prototype.constructor=Vr,Vr.prototype.isQuadraticBezierCurve3=!0,Vr.prototype.getPoint=function(t,e){var n=e||new l,r=this.v0,i=this.v1,o=this.v2;return n.set(Cr(t,r.x,i.x,o.x),Cr(t,r.y,i.y,o.y),Cr(t,r.z,i.z,o.z)),n},Vr.prototype.copy=function(t){return Sr.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Vr.prototype.toJSON=function(){var t=Sr.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Vr.prototype.fromJSON=function(t){return Sr.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},Hr.prototype=Object.create(Sr.prototype),Hr.prototype.constructor=Hr,Hr.prototype.isSplineCurve=!0,Hr.prototype.getPoint=function(t,e){var n=e||new c,r=this.points,i=(r.length-1)*t,o=Math.floor(i),a=i-o,s=r[0===o?o:o-1],u=r[o],h=r[o>r.length-2?r.length-1:o+1],l=r[o>r.length-3?r.length-1:o+2];return n.set(Ar(a,s.x,u.x,h.x,l.x),Ar(a,s.y,u.y,h.y,l.y)),n},Hr.prototype.copy=function(t){Sr.prototype.copy.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push(r.clone())}return this},Hr.prototype.toJSON=function(){var t=Sr.prototype.toJSON.call(this);t.points=[];for(var e=0,n=this.points.length;e<n;e++){var r=this.points[e];t.points.push(r.toArray())}return t},Hr.prototype.fromJSON=function(t){Sr.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push((new c).fromArray(r))}return this};var hw=Object.freeze({ArcCurve:Er,CatmullRomCurve3:Lr,CubicBezierCurve:Br,CubicBezierCurve3:zr,EllipseCurve:Mr,LineCurve:Gr,LineCurve3:kr,QuadraticBezierCurve:jr,QuadraticBezierCurve3:Vr,SplineCurve:Hr});Wr.prototype=Object.assign(Object.create(Sr.prototype),{constructor:Wr,add:function t(e){this.curves.push(e)},closePath:function t(){var e=this.curves[0].getPoint(0),n=this.curves[this.curves.length-1].getPoint(1);e.equals(n)||this.curves.push(new Gr(n,e))},getPoint:function t(e){for(var n=e*this.getLength(),r=this.getCurveLengths(),i=0;i<r.length;){if(r[i]>=n){var o=r[i]-n,a=this.curves[i],s=a.getLength(),c=0===s?0:1-o/s;return a.getPointAt(c)}i++}return null},getLength:function t(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function t(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function t(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],n=0,r=0,i=this.curves.length;r<i;r++)n+=this.curves[r].getLength(),e.push(n);return this.cacheLengths=e,e},getSpacedPoints:function t(e){void 0===e&&(e=40);for(var n=[],r=0;r<=e;r++)n.push(this.getPoint(r/e));return this.autoClose&&n.push(n[0]),n},getPoints:function t(e){e=e||12;for(var n=[],r,i=0,o=this.curves;i<o.length;i++)for(var a=o[i],s=a&&a.isEllipseCurve?2*e:a&&a.isLineCurve?1:a&&a.isSplineCurve?e*a.points.length:e,c=a.getPoints(s),u=0;u<c.length;u++){var h=c[u];r&&r.equals(h)||(n.push(h),r=h)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},copy:function t(e){Sr.prototype.copy.call(this,e),this.curves=[];for(var n=0,r=e.curves.length;n<r;n++){var i=e.curves[n];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this},toJSON:function t(){var e=Sr.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var n=0,r=this.curves.length;n<r;n++){var i=this.curves[n];e.curves.push(i.toJSON())}return e},fromJSON:function t(e){Sr.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var n=0,r=e.curves.length;n<r;n++){var i=e.curves[n];this.curves.push((new hw[i.type]).fromJSON(i))}return this}}),Yr.prototype=Object.assign(Object.create(Wr.prototype),{constructor:Yr,setFromPoints:function t(e){this.moveTo(e[0].x,e[0].y);for(var n=1,r=e.length;n<r;n++)this.lineTo(e[n].x,e[n].y)},moveTo:function t(e,n){this.currentPoint.set(e,n)},lineTo:function t(e,n){var r=new Gr(this.currentPoint.clone(),new c(e,n));this.curves.push(r),this.currentPoint.set(e,n)},quadraticCurveTo:function t(e,n,r,i){var o=new jr(this.currentPoint.clone(),new c(e,n),new c(r,i));this.curves.push(o),this.currentPoint.set(r,i)},bezierCurveTo:function t(e,n,r,i,o,a){var s=new Br(this.currentPoint.clone(),new c(e,n),new c(r,i),new c(o,a));this.curves.push(s),this.currentPoint.set(o,a)},splineThru:function t(e){var n,r=new Hr([this.currentPoint.clone()].concat(e));this.curves.push(r),this.currentPoint.copy(e[e.length-1])},arc:function t(e,n,r,i,o,a){var s=this.currentPoint.x,c=this.currentPoint.y;this.absarc(e+s,n+c,r,i,o,a)},absarc:function t(e,n,r,i,o,a){this.absellipse(e,n,r,r,i,o,a)},ellipse:function t(e,n,r,i,o,a,s,c){var u=this.currentPoint.x,h=this.currentPoint.y;this.absellipse(e+u,n+h,r,i,o,a,s,c)},absellipse:function t(e,n,r,i,o,a,s,c){var u=new Mr(e,n,r,i,o,a,s,c);if(this.curves.length>0){var h=u.getPoint(0);h.equals(this.currentPoint)||this.lineTo(h.x,h.y)}this.curves.push(u);var l=u.getPoint(1);this.currentPoint.copy(l)},copy:function t(e){return Wr.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function t(){var e=Wr.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function t(e){return Wr.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}),Xr.prototype=Object.assign(Object.create(Yr.prototype),{constructor:Xr,getPointsHoles:function t(e){for(var n=[],r=0,i=this.holes.length;r<i;r++)n[r]=this.holes[r].getPoints(e);return n},extractPoints:function t(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function t(e){Yr.prototype.copy.call(this,e),this.holes=[];for(var n=0,r=e.holes.length;n<r;n++){var i=e.holes[n];this.holes.push(i.clone())}return this},toJSON:function t(){var e=Yr.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var n=0,r=this.holes.length;n<r;n++){var i=this.holes[n];e.holes.push(i.toJSON())}return e},fromJSON:function t(e){Yr.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var n=0,r=e.holes.length;n<r;n++){var i=e.holes[n];this.holes.push((new Yr).fromJSON(i))}return this}}),qr.prototype=Object.assign(Object.create(pt.prototype),{constructor:qr,isLight:!0,copy:function t(e){return pt.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function t(e){var n=pt.prototype.toJSON.call(this,e);return n.object.color=this.color.getHex(),n.object.intensity=this.intensity,void 0!==this.groundColor&&(n.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(n.object.distance=this.distance),void 0!==this.angle&&(n.object.angle=this.angle),void 0!==this.decay&&(n.object.decay=this.decay),void 0!==this.penumbra&&(n.object.penumbra=this.penumbra),void 0!==this.shadow&&(n.object.shadow=this.shadow.toJSON()),n}}),Zr.prototype=Object.assign(Object.create(qr.prototype),{constructor:Zr,isHemisphereLight:!0,copy:function t(e){return qr.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),Object.assign(Jr.prototype,{copy:function t(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function t(){return(new this.constructor).copy(this)},toJSON:function t(){var e={};return 0!==this.bias&&(e.bias=this.bias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),Qr.prototype=Object.assign(Object.create(Jr.prototype),{constructor:Qr,isSpotLightShadow:!0,update:function t(e){var n=this.camera,r=2*Ry.RAD2DEG*e.angle,i=this.mapSize.width/this.mapSize.height,o=e.distance||n.far;r===n.fov&&i===n.aspect&&o===n.far||(n.fov=r,n.aspect=i,n.far=o,n.updateProjectionMatrix())}}),Kr.prototype=Object.assign(Object.create(qr.prototype),{constructor:Kr,isSpotLight:!0,copy:function t(e){return qr.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),$r.prototype=Object.assign(Object.create(qr.prototype),{constructor:$r,isPointLight:!0,copy:function t(e){return qr.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),ti.prototype=Object.assign(Object.create(Jr.prototype),{constructor:ti}),ei.prototype=Object.assign(Object.create(qr.prototype),{constructor:ei,isDirectionalLight:!0,copy:function t(e){return qr.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),ni.prototype=Object.assign(Object.create(qr.prototype),{constructor:ni,isAmbientLight:!0}),ri.prototype=Object.assign(Object.create(qr.prototype),{constructor:ri,isRectAreaLight:!0,copy:function t(e){return qr.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function t(e){var n=qr.prototype.toJSON.call(this,e);return n.object.width=this.width,n.object.height=this.height,n}}),ii.prototype=Object.assign(Object.create(fi.prototype),{constructor:ii,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),oi.prototype=Object.assign(Object.create(fi.prototype),{constructor:oi,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Object.assign(ai.prototype,{evaluate:function t(e){var n=this.parameterPositions,r=this._cachedIndex,i=n[r],o=n[r-1];t:{e:{var a;n:{r:if(!(e<i)){for(var s=r+2;;){if(void 0===i){if(e<o)break r;return r=n.length,this._cachedIndex=r,this.afterEnd_(r-1,e,o)}if(r===s)break;if(o=i,i=n[++r],e<i)break e}a=n.length;break n}{if(e>=o)break t;var c=n[1];e<c&&(r=2,o=c);for(var s=r-2;;){if(void 0===o)return this._cachedIndex=0,this.beforeStart_(0,e,i);if(r===s)break;if(i=o,o=n[--r-1],e>=o)break e}a=r,r=0}}for(;r<a;){var u=r+a>>>1;e<n[u]?a=u:r=u+1}if(i=n[r],void 0===(o=n[r-1]))return this._cachedIndex=0,this.beforeStart_(0,e,i);if(void 0===i)return r=n.length,this._cachedIndex=r,this.afterEnd_(r-1,o,e)}this._cachedIndex=r,this.intervalChanged_(r,o,i)}return this.interpolate_(r,o,e,i)},settings:null,DefaultSettings_:{},getSettings_:function t(){return this.settings||this.DefaultSettings_},copySampleValue_:function t(e){for(var n=this.resultBuffer,r=this.sampleValues,i=this.valueSize,o=e*i,a=0;a!==i;++a)n[a]=r[o+a];return n},interpolate_:function t(){throw new Error("call to abstract method")},intervalChanged_:function t(){}}),Object.assign(ai.prototype,{beforeStart_:ai.prototype.copySampleValue_,afterEnd_:ai.prototype.copySampleValue_}),si.prototype=Object.assign(Object.create(ai.prototype),{constructor:si,interpolate_:function t(e,n,r,i){for(var o=this.resultBuffer,a=this.sampleValues,s=this.valueSize,c=e*s,u=(r-n)/(i-n),l=c+s;c!==l;c+=4)h.slerpFlat(o,0,a,c-s,a,c,u);return o}}),ci.prototype=Object.assign(Object.create(fi.prototype),{constructor:ci,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function t(e){return new si(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),ui.prototype=Object.assign(Object.create(fi.prototype),{constructor:ui,ValueTypeName:"color"}),hi.prototype=Object.assign(Object.create(fi.prototype),{constructor:hi,ValueTypeName:"number"}),li.prototype=Object.assign(Object.create(ai.prototype),{constructor:li,DefaultSettings_:{endingStart:my,endingEnd:my},intervalChanged_:function t(e,n,r){var i=this.parameterPositions,o=e-2,a=e+1,s=i[o],c=i[a];if(void 0===s)switch(this.getSettings_().endingStart){case 2401:o=e,s=2*n-r;break;case 2402:s=n+i[o=i.length-2]-i[o+1];break;default:o=e,s=r}if(void 0===c)switch(this.getSettings_().endingEnd){case 2401:a=e,c=2*r-n;break;case 2402:a=1,c=r+i[1]-i[0];break;default:a=e-1,c=n}var u=.5*(r-n),h=this.valueSize;this._weightPrev=u/(n-s),this._weightNext=u/(c-r),this._offsetPrev=o*h,this._offsetNext=a*h},interpolate_:function t(e,n,r,i){for(var o=this.resultBuffer,a=this.sampleValues,s=this.valueSize,c=e*s,u=c-s,h=this._offsetPrev,l=this._offsetNext,d=this._weightPrev,p=this._weightNext,f=(r-n)/(i-n),m=f*f,v=m*f,g=-d*v+2*d*m-d*f,y=(1+d)*v+(-1.5-2*d)*m+(-.5+d)*f+1,x=(-1-p)*v+(1.5+p)*m+.5*f,b=p*v-p*m,w=0;w!==s;++w)o[w]=g*a[h+w]+y*a[u+w]+x*a[c+w]+b*a[l+w];return o}}),di.prototype=Object.assign(Object.create(ai.prototype),{constructor:di,interpolate_:function t(e,n,r,i){for(var o=this.resultBuffer,a=this.sampleValues,s=this.valueSize,c=e*s,u=c-s,h=(r-n)/(i-n),l=1-h,d=0;d!==s;++d)o[d]=a[u+d]*l+a[c+d]*h;return o}}),pi.prototype=Object.assign(Object.create(ai.prototype),{constructor:pi,interpolate_:function t(e){return this.copySampleValue_(e-1)}});var lw={arraySlice:function t(e,n,r){return lw.isTypedArray(e)?new e.constructor(e.subarray(n,void 0!==r?r:e.length)):e.slice(n,r)},convertArray:function t(e,n,r){return!e||!r&&e.constructor===n?e:"number"==typeof n.BYTES_PER_ELEMENT?new n(e):Array.prototype.slice.call(e)},isTypedArray:function t(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function t(e){function n(t,n){return e[t]-e[n]}for(var r=e.length,i=new Array(r),o=0;o!==r;++o)i[o]=o;return i.sort(n),i},sortedArray:function t(e,n,r){for(var i=e.length,o=new e.constructor(i),a=0,s=0;s!==i;++a)for(var c=r[a]*n,u=0;u!==n;++u)o[s++]=e[c+u];return o},flattenJSON:function t(e,n,r,i){for(var o=1,a=e[0];void 0!==a&&void 0===a[i];)a=e[o++];if(void 0!==a){var s=a[i];if(void 0!==s)if(Array.isArray(s))do{void 0!==(s=a[i])&&(n.push(a.time),r.push.apply(r,s)),a=e[o++]}while(void 0!==a);else if(void 0!==s.toArray)do{void 0!==(s=a[i])&&(n.push(a.time),s.toArray(r,r.length)),a=e[o++]}while(void 0!==a);else do{void 0!==(s=a[i])&&(n.push(a.time),r.push(s)),a=e[o++]}while(void 0!==a)}}};Object.assign(fi,{parse:function t(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var n=fi._getTrackTypeForValueTypeName(e.type);if(void 0===e.times){var r=[],i=[];lw.flattenJSON(e.keys,r,i,"value"),e.times=r,e.values=i}return void 0!==n.parse?n.parse(e):new n(e.name,e.times,e.values,e.interpolation)},toJSON:function t(e){var n=e.constructor,r;if(void 0!==n.toJSON)r=n.toJSON(e);else{r={name:e.name,times:lw.convertArray(e.times,Array),values:lw.convertArray(e.values,Array)};var i=e.getInterpolation();i!==e.DefaultInterpolation&&(r.interpolation=i)}return r.type=e.ValueTypeName,r},_getTrackTypeForValueTypeName:function t(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return hi;case"vector":case"vector2":case"vector3":case"vector4":return mi;case"color":return ui;case"quaternion":return ci;case"bool":case"boolean":return oi;case"string":return ii}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}}),Object.assign(fi.prototype,{constructor:fi,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function t(e){return new pi(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function t(e){return new di(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function t(e){return new li(this.times,this.values,this.getValueSize(),e)},setInterpolation:function t(e){var n;switch(e){case 2300:n=this.InterpolantFactoryMethodDiscrete;break;case 2301:n=this.InterpolantFactoryMethodLinear;break;case 2302:n=this.InterpolantFactoryMethodSmooth}if(void 0!==n)this.createInterpolant=n;else{var r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(r);this.setInterpolation(this.DefaultInterpolation)}console.warn("THREE.KeyframeTrack:",r)}},getInterpolation:function t(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function t(){return this.values.length/this.times.length},shift:function t(e){if(0!==e)for(var n=this.times,r=0,i=n.length;r!==i;++r)n[r]+=e;return this},scale:function t(e){if(1!==e)for(var n=this.times,r=0,i=n.length;r!==i;++r)n[r]*=e;return this},trim:function t(e,n){for(var r=this.times,i=r.length,o=0,a=i-1;o!==i&&r[o]<e;)++o;for(;-1!==a&&r[a]>n;)--a;if(++a,0!==o||a!==i){o>=a&&(a=Math.max(a,1),o=a-1);var s=this.getValueSize();this.times=lw.arraySlice(r,o,a),this.values=lw.arraySlice(this.values,o*s,a*s)}return this},validate:function t(){var e=!0,n=this.getValueSize();n-Math.floor(n)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var r=this.times,i=this.values,o=r.length;0===o&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var a=null,s=0;s!==o;s++){var c=r[s];if("number"==typeof c&&isNaN(c)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,s,c),e=!1;break}if(null!==a&&a>c){console.error("THREE.KeyframeTrack: Out of order keys.",this,s,c,a),e=!1;break}a=c}if(void 0!==i&&lw.isTypedArray(i))for(var s=0,u=i.length;s!==u;++s){var h=i[s];if(isNaN(h)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,s,h),e=!1;break}}return e},optimize:function t(){for(var e=this.times,n=this.values,r=this.getValueSize(),i=2302===this.getInterpolation(),o=1,a=e.length-1,s=1;s<a;++s){var c=!1,u=e[s],h;if(u!==e[s+1]&&(1!==s||u!==u[0]))if(i)c=!0;else for(var l=s*r,d=l-r,p=l+r,f=0;f!==r;++f){var m=n[l+f];if(m!==n[d+f]||m!==n[p+f]){c=!0;break}}if(c){if(s!==o){e[o]=e[s];for(var v=s*r,g=o*r,f=0;f!==r;++f)n[g+f]=n[v+f]}++o}}if(a>0){e[o]=e[a];for(var v=a*r,g=o*r,f=0;f!==r;++f)n[g+f]=n[v+f];++o}return o!==e.length&&(this.times=lw.arraySlice(e,0,o),this.values=lw.arraySlice(n,0,o*r)),this}}),mi.prototype=Object.assign(Object.create(fi.prototype),{constructor:mi,ValueTypeName:"vector"}),Object.assign(vi,{parse:function t(e){for(var n=[],r=e.tracks,i=1/(e.fps||1),o=0,a=r.length;o!==a;++o)n.push(fi.parse(r[o]).scale(i));return new vi(e.name,e.duration,n)},toJSON:function t(e){for(var n=[],r=e.tracks,i={name:e.name,duration:e.duration,tracks:n},o=0,a=r.length;o!==a;++o)n.push(fi.toJSON(r[o]));return i},CreateFromMorphTargetSequence:function t(e,n,r,i){for(var o=n.length,a=[],s=0;s<o;s++){var c=[],u=[];c.push((s+o-1)%o,s,(s+1)%o),u.push(0,1,0);var h=lw.getKeyframeOrder(c);c=lw.sortedArray(c,1,h),u=lw.sortedArray(u,1,h),i||0!==c[0]||(c.push(o),u.push(u[0])),a.push(new hi(".morphTargetInfluences["+n[s].name+"]",c,u).scale(1/r))}return new vi(e,-1,a)},findByName:function t(e,n){var r=e;if(!Array.isArray(e)){var i=e;r=i.geometry&&i.geometry.animations||i.animations}for(var o=0;o<r.length;o++)if(r[o].name===n)return r[o];return null},CreateClipsFromMorphTargetSequences:function t(e,n,r){for(var i={},o=/^([\w-]*?)([\d]+)$/,a=0,s=e.length;a<s;a++){var c=e[a],u=c.name.match(o);if(u&&u.length>1){var h,l=i[h=u[1]];l||(i[h]=l=[]),l.push(c)}}var d=[];for(var h in i)d.push(vi.CreateFromMorphTargetSequence(h,i[h],n,r));return d},parseAnimation:function t(e,n){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var r=function t(e,n,r,i,o){if(0!==r.length){var a=[],s=[];lw.flattenJSON(r,a,s,i),0!==a.length&&o.push(new e(n,a,s))}},i=[],o=e.name||"default",a=e.length||-1,s=e.fps||30,c=e.hierarchy||[],u=0;u<c.length;u++){var h=c[u].keys;if(h&&0!==h.length)if(h[0].morphTargets){for(var l={},d=0;d<h.length;d++)if(h[d].morphTargets)for(var p=0;p<h[d].morphTargets.length;p++)l[h[d].morphTargets[p]]=-1;for(var f in l){for(var m=[],v=[],p=0;p!==h[d].morphTargets.length;++p){var g=h[d];m.push(g.time),v.push(g.morphTarget===f?1:0)}i.push(new hi(".morphTargetInfluence["+f+"]",m,v))}a=l.length*(s||1)}else{var y=".bones["+n[u].name+"]";r(mi,y+".position",h,"pos",i),r(ci,y+".quaternion",h,"rot",i),r(mi,y+".scale",h,"scl",i)}}if(0===i.length)return null;var x;return new vi(o,a,i)}}),Object.assign(vi.prototype,{resetDuration:function t(){for(var e,n=0,r=0,i=this.tracks.length;r!==i;++r){var o=this.tracks[r];n=Math.max(n,o.times[o.times.length-1])}this.duration=n},trim:function t(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},optimize:function t(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}}),Object.assign(gi.prototype,{load:function t(e,n,r,i){var o=this,a;new gr(o.manager).load(e,function(t){n(o.parse(JSON.parse(t)))},r,i)},setTextures:function t(e){this.textures=e},parse:function t(e){function n(t){return void 0===r[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),r[t]}var r=this.textures,i=new nw[e.type];if(void 0!==e.uuid&&(i.uuid=e.uuid),void 0!==e.name&&(i.name=e.name),void 0!==e.color&&i.color.setHex(e.color),void 0!==e.roughness&&(i.roughness=e.roughness),void 0!==e.metalness&&(i.metalness=e.metalness),void 0!==e.emissive&&i.emissive.setHex(e.emissive),void 0!==e.specular&&i.specular.setHex(e.specular),void 0!==e.shininess&&(i.shininess=e.shininess),void 0!==e.clearCoat&&(i.clearCoat=e.clearCoat),void 0!==e.clearCoatRoughness&&(i.clearCoatRoughness=e.clearCoatRoughness),void 0!==e.uniforms&&(i.uniforms=e.uniforms),void 0!==e.vertexShader&&(i.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(i.fragmentShader=e.fragmentShader),void 0!==e.vertexColors&&(i.vertexColors=e.vertexColors),void 0!==e.fog&&(i.fog=e.fog),void 0!==e.flatShading&&(i.flatShading=e.flatShading),void 0!==e.blending&&(i.blending=e.blending),void 0!==e.side&&(i.side=e.side),void 0!==e.opacity&&(i.opacity=e.opacity),void 0!==e.transparent&&(i.transparent=e.transparent),void 0!==e.alphaTest&&(i.alphaTest=e.alphaTest),void 0!==e.depthTest&&(i.depthTest=e.depthTest),void 0!==e.depthWrite&&(i.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(i.colorWrite=e.colorWrite),void 0!==e.wireframe&&(i.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(i.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(i.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(i.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(i.rotation=e.rotation),1!==e.linewidth&&(i.linewidth=e.linewidth),void 0!==e.dashSize&&(i.dashSize=e.dashSize),void 0!==e.gapSize&&(i.gapSize=e.gapSize),void 0!==e.scale&&(i.scale=e.scale),void 0!==e.skinning&&(i.skinning=e.skinning),void 0!==e.morphTargets&&(i.morphTargets=e.morphTargets),void 0!==e.dithering&&(i.dithering=e.dithering),void 0!==e.visible&&(i.visible=e.visible),void 0!==e.userData&&(i.userData=e.userData),void 0!==e.shading&&(i.flatShading=1===e.shading),void 0!==e.size&&(i.size=e.size),void 0!==e.sizeAttenuation&&(i.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(i.map=n(e.map)),void 0!==e.alphaMap&&(i.alphaMap=n(e.alphaMap),i.transparent=!0),void 0!==e.bumpMap&&(i.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(i.bumpScale=e.bumpScale),void 0!==e.normalMap&&(i.normalMap=n(e.normalMap)),void 0!==e.normalScale){var o=e.normalScale;!1===Array.isArray(o)&&(o=[o,o]),i.normalScale=(new c).fromArray(o)}return void 0!==e.displacementMap&&(i.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(i.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(i.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(i.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(i.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(i.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(i.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(i.specularMap=n(e.specularMap)),void 0!==e.envMap&&(i.envMap=n(e.envMap)),void 0!==e.reflectivity&&(i.reflectivity=e.reflectivity),void 0!==e.lightMap&&(i.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(i.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(i.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(i.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(i.gradientMap=n(e.gradientMap)),i}}),Object.assign(yi.prototype,{load:function t(e,n,r,i){var o=this,a;new gr(o.manager).load(e,function(t){n(o.parse(JSON.parse(t)))},r,i)},parse:function t(e){var n=new Rt,r=e.data.index;if(void 0!==r){var i=new dw[r.type](r.array);n.setIndex(new yt(i,1))}var o=e.data.attributes;for(var a in o){var s=o[a],i=new dw[s.type](s.array);n.addAttribute(a,new yt(i,s.itemSize,s.normalized))}var c=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==c)for(var u=0,h=c.length;u!==h;++u){var d=c[u];n.addGroup(d.start,d.count,d.materialIndex)}var p=e.data.boundingSphere;if(void 0!==p){var f=new l;void 0!==p.center&&f.fromArray(p.center),n.boundingSphere=new at(f,p.radius)}return n}});var dw={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};xi.Handlers={handlers:[],add:function t(e,n){this.handlers.push(e,n)},get:function t(e){for(var n=this.handlers,r=0,i=n.length;r<i;r+=2){var o=n[r],a=n[r+1];if(o.test(e))return a}return null}},Object.assign(xi.prototype,{crossOrigin:void 0,initMaterials:function t(e,n,r){for(var i=[],o=0;o<e.length;++o)i[o]=this.createMaterial(e[o],n,r);return i},createMaterial:function(){var t={NoBlending:bv,NormalBlending:wv,AdditiveBlending:_v,SubtractiveBlending:Sv,MultiplyBlending:Mv,CustomBlending:Ev},e=new $,n=new _r,r=new gi;return function i(o,a,s){function c(t,e,r,i,o){var c=a+t,h=xi.Handlers.get(c),l;null!==h?l=h.load(c):(n.setCrossOrigin(s),l=n.load(c)),void 0!==e&&(l.repeat.fromArray(e),1!==e[0]&&(l.wrapS=dg),1!==e[1]&&(l.wrapT=dg)),void 0!==r&&l.offset.fromArray(r),void 0!==i&&("repeat"===i[0]&&(l.wrapS=dg),"mirror"===i[0]&&(l.wrapS=fg),"repeat"===i[1]&&(l.wrapT=dg),"mirror"===i[1]&&(l.wrapT=fg)),void 0!==o&&(l.anisotropy=o);var d=Ry.generateUUID();return u[d]=l,d}var u={},h={uuid:Ry.generateUUID(),type:"MeshLambertMaterial"};for(var l in o){var d=o[l];switch(l){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":h.name=d;break;case"blending":h.blending=t[d];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",l,"is no longer supported.");break;case"colorDiffuse":h.color=e.fromArray(d).getHex();break;case"colorSpecular":h.specular=e.fromArray(d).getHex();break;case"colorEmissive":h.emissive=e.fromArray(d).getHex();break;case"specularCoef":h.shininess=d;break;case"shading":"basic"===d.toLowerCase()&&(h.type="MeshBasicMaterial"),"phong"===d.toLowerCase()&&(h.type="MeshPhongMaterial"),"standard"===d.toLowerCase()&&(h.type="MeshStandardMaterial");break;case"mapDiffuse":h.map=c(d,o.mapDiffuseRepeat,o.mapDiffuseOffset,o.mapDiffuseWrap,o.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":h.emissiveMap=c(d,o.mapEmissiveRepeat,o.mapEmissiveOffset,o.mapEmissiveWrap,o.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":h.lightMap=c(d,o.mapLightRepeat,o.mapLightOffset,o.mapLightWrap,o.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":h.aoMap=c(d,o.mapAORepeat,o.mapAOOffset,o.mapAOWrap,o.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":h.bumpMap=c(d,o.mapBumpRepeat,o.mapBumpOffset,o.mapBumpWrap,o.mapBumpAnisotropy);break;case"mapBumpScale":h.bumpScale=d;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":h.normalMap=c(d,o.mapNormalRepeat,o.mapNormalOffset,o.mapNormalWrap,o.mapNormalAnisotropy);break;case"mapNormalFactor":h.normalScale=[d,d];break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":h.specularMap=c(d,o.mapSpecularRepeat,o.mapSpecularOffset,o.mapSpecularWrap,o.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":h.metalnessMap=c(d,o.mapMetalnessRepeat,o.mapMetalnessOffset,o.mapMetalnessWrap,o.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":h.roughnessMap=c(d,o.mapRoughnessRepeat,o.mapRoughnessOffset,o.mapRoughnessWrap,o.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":h.alphaMap=c(d,o.mapAlphaRepeat,o.mapAlphaOffset,o.mapAlphaWrap,o.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":h.side=fv;break;case"doubleSided":h.side=mv;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),h.opacity=d;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":h[l]=d;break;case"vertexColors":!0===d&&(h.vertexColors=xv),"face"===d&&(h.vertexColors=yv);break;default:console.error("THREE.Loader.createMaterial: Unsupported",l,d)}}return"MeshBasicMaterial"===h.type&&delete h.emissive,"MeshPhongMaterial"!==h.type&&delete h.specular,h.opacity<1&&(h.transparent=!0),r.setTextures(u),r.parse(h)}}()});var pw={decodeText:function t(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);for(var n="",r=0,i=e.length;r<i;r++)n+=String.fromCharCode(e[r]);return decodeURIComponent(escape(n))},extractUrlBase:function t(e){var n=e.split("/");return 1===n.length?"./":(n.pop(),n.join("/")+"/")}};Object.assign(bi.prototype,{load:function t(e,n,r,i){var o=this,a=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:pw.extractUrlBase(e),s=new gr(this.manager);s.setWithCredentials(this.withCredentials),s.load(e,function(t){var r=JSON.parse(t),i=r.metadata;if(void 0!==i){var s=i.type;if(void 0!==s){if("object"===s.toLowerCase())return void console.error("THREE.JSONLoader: "+e+" should be loaded with THREE.ObjectLoader instead.");if("scene"===s.toLowerCase())return void console.error("THREE.JSONLoader: "+e+" should be loaded with THREE.SceneLoader instead.")}}var c=o.parse(r,a);n(c.geometry,c.materials)},r,i)},setTexturePath:function t(e){this.texturePath=e},parse:function(){function t(t,e){function n(t,e){return t&1<<e}var r,i,o,a,s,u,h,d,p,f,m,v,g,y,x,b,w,_,S,M,E,T,L,A,P,R,I,C=t.faces,O=t.vertices,N=t.normals,F=t.colors,D=t.scale,U=0;if(void 0!==t.uvs){for(r=0;r<t.uvs.length;r++)t.uvs[r].length&&U++;for(r=0;r<U;r++)e.faceVertexUvs[r]=[]}for(a=0,s=O.length;a<s;)(_=new l).x=O[a++]*D,_.y=O[a++]*D,_.z=O[a++]*D,e.vertices.push(_);for(a=0,s=C.length;a<s;)if(f=C[a++],m=n(f,0),v=n(f,1),g=n(f,3),y=n(f,4),x=n(f,5),b=n(f,6),w=n(f,7),m){if(M=new vt,M.a=C[a],M.b=C[a+1],M.c=C[a+3],E=new vt,E.a=C[a+1],E.b=C[a+2],E.c=C[a+3],a+=4,v&&(p=C[a++],M.materialIndex=p,E.materialIndex=p),o=e.faces.length,g)for(r=0;r<U;r++)for(A=t.uvs[r],e.faceVertexUvs[r][o]=[],e.faceVertexUvs[r][o+1]=[],i=0;i<4;i++)P=new c(R=A[2*(d=C[a++])],I=A[2*d+1]),2!==i&&e.faceVertexUvs[r][o].push(P),0!==i&&e.faceVertexUvs[r][o+1].push(P);if(y&&(h=3*C[a++],M.normal.set(N[h++],N[h++],N[h]),E.normal.copy(M.normal)),x)for(r=0;r<4;r++)h=3*C[a++],L=new l(N[h++],N[h++],N[h]),2!==r&&M.vertexNormals.push(L),0!==r&&E.vertexNormals.push(L);if(b&&(T=F[u=C[a++]],M.color.setHex(T),E.color.setHex(T)),w)for(r=0;r<4;r++)T=F[u=C[a++]],2!==r&&M.vertexColors.push(new $(T)),0!==r&&E.vertexColors.push(new $(T));e.faces.push(M),e.faces.push(E)}else{if(S=new vt,S.a=C[a++],S.b=C[a++],S.c=C[a++],v&&(p=C[a++],S.materialIndex=p),o=e.faces.length,g)for(r=0;r<U;r++)for(A=t.uvs[r],e.faceVertexUvs[r][o]=[],i=0;i<3;i++)P=new c(R=A[2*(d=C[a++])],I=A[2*d+1]),e.faceVertexUvs[r][o].push(P);if(y&&(h=3*C[a++],S.normal.set(N[h++],N[h++],N[h])),x)for(r=0;r<3;r++)h=3*C[a++],L=new l(N[h++],N[h++],N[h]),S.vertexNormals.push(L);if(b&&(u=C[a++],S.color.setHex(F[u])),w)for(r=0;r<3;r++)u=C[a++],S.vertexColors.push(new $(F[u]));e.faces.push(S)}}function e(t,e){var n=void 0!==t.influencesPerVertex?t.influencesPerVertex:2;if(t.skinWeights)for(var r=0,i=t.skinWeights.length;r<i;r+=n){var o=t.skinWeights[r],a=n>1?t.skinWeights[r+1]:0,s=n>2?t.skinWeights[r+2]:0,c=n>3?t.skinWeights[r+3]:0;e.skinWeights.push(new f(o,a,s,c))}if(t.skinIndices)for(var r=0,i=t.skinIndices.length;r<i;r+=n){var u=t.skinIndices[r],h=n>1?t.skinIndices[r+1]:0,l=n>2?t.skinIndices[r+2]:0,d=n>3?t.skinIndices[r+3]:0;e.skinIndices.push(new f(u,h,l,d))}e.bones=t.bones,e.bones&&e.bones.length>0&&(e.skinWeights.length!==e.skinIndices.length||e.skinIndices.length!==e.vertices.length)&&console.warn("When skinning, number of vertices ("+e.vertices.length+"), skinIndices ("+e.skinIndices.length+"), and skinWeights ("+e.skinWeights.length+") should match.")}function n(t,e){var n=t.scale;if(void 0!==t.morphTargets)for(var r=0,i=t.morphTargets.length;r<i;r++){e.morphTargets[r]={},e.morphTargets[r].name=t.morphTargets[r].name,e.morphTargets[r].vertices=[];for(var o=e.morphTargets[r].vertices,a=t.morphTargets[r].vertices,s=0,c=a.length;s<c;s+=3){var u=new l;u.x=a[s]*n,u.y=a[s+1]*n,u.z=a[s+2]*n,o.push(u)}}if(void 0!==t.morphColors&&t.morphColors.length>0){console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');for(var h=e.faces,d=t.morphColors[0].colors,r=0,i=h.length;r<i;r++)h[r].color.fromArray(d,3*r)}}function r(t,e){var n=[],r=[];void 0!==t.animation&&r.push(t.animation),void 0!==t.animations&&(t.animations.length?r=r.concat(t.animations):r.push(t.animations));for(var i=0;i<r.length;i++){var o=vi.parseAnimation(r[i],e.bones);o&&n.push(o)}if(e.morphTargets){var a=vi.CreateClipsFromMorphTargetSequences(e.morphTargets,10);n=n.concat(a)}n.length>0&&(e.animations=n)}return function i(o,a){void 0!==o.data&&(o=o.data),void 0!==o.scale?o.scale=1/o.scale:o.scale=1;var s=new gt;if(t(o,s),e(o,s),n(o,s),r(o,s),s.computeFaceNormals(),s.computeBoundingSphere(),void 0===o.materials||0===o.materials.length)return{geometry:s};var c;return{geometry:s,materials:xi.prototype.initMaterials(o.materials,a,this.crossOrigin)}}}()}),Object.assign(wi.prototype,{load:function t(e,n,r,i){""===this.texturePath&&(this.texturePath=e.substring(0,e.lastIndexOf("/")+1));var o=this,a;new gr(o.manager).load(e,function(t){var r=null;try{r=JSON.parse(t)}catch(t){return void 0!==i&&i(t),void console.error("THREE:ObjectLoader: Can't parse "+e+".",t.message)}var a=r.metadata;void 0!==a&&void 0!==a.type&&"geometry"!==a.type.toLowerCase()?o.parse(r,n):console.error("THREE.ObjectLoader: Can't load "+e+". Use THREE.JSONLoader instead.")},r,i)},setTexturePath:function t(e){this.texturePath=e},setCrossOrigin:function t(e){this.crossOrigin=e},parse:function t(e,n){var r=this.parseShape(e.shapes),i=this.parseGeometries(e.geometries,r),o=this.parseImages(e.images,function(){void 0!==n&&n(c)}),a=this.parseTextures(e.textures,o),s=this.parseMaterials(e.materials,a),c=this.parseObject(e.object,i,s);return e.animations&&(c.animations=this.parseAnimations(e.animations)),void 0!==e.images&&0!==e.images.length||void 0!==n&&n(c),c},parseShape:function t(e){var n={};if(void 0!==e)for(var r=0,i=e.length;r<i;r++){var o=(new Xr).fromJSON(e[r]);n[o.uuid]=o}return n},parseGeometries:function t(e,n){var r={};if(void 0!==e)for(var i=new bi,o=new yi,a=0,s=e.length;a<s;a++){var c,u=e[a];switch(u.type){case"PlaneGeometry":case"PlaneBufferGeometry":c=new ew[u.type](u.width,u.height,u.widthSegments,u.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":c=new ew[u.type](u.width,u.height,u.depth,u.widthSegments,u.heightSegments,u.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":c=new ew[u.type](u.radius,u.segments,u.thetaStart,u.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":c=new ew[u.type](u.radiusTop,u.radiusBottom,u.height,u.radialSegments,u.heightSegments,u.openEnded,u.thetaStart,u.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":c=new ew[u.type](u.radius,u.height,u.radialSegments,u.heightSegments,u.openEnded,u.thetaStart,u.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":c=new ew[u.type](u.radius,u.widthSegments,u.heightSegments,u.phiStart,u.phiLength,u.thetaStart,u.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":c=new ew[u.type](u.radius,u.detail);break;case"RingGeometry":case"RingBufferGeometry":c=new ew[u.type](u.innerRadius,u.outerRadius,u.thetaSegments,u.phiSegments,u.thetaStart,u.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":c=new ew[u.type](u.radius,u.tube,u.radialSegments,u.tubularSegments,u.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":c=new ew[u.type](u.radius,u.tube,u.tubularSegments,u.radialSegments,u.p,u.q);break;case"LatheGeometry":case"LatheBufferGeometry":c=new ew[u.type](u.points,u.segments,u.phiStart,u.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":c=new ew[u.type](u.vertices,u.indices,u.radius,u.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var h=[],a=0,s=u.shapes.length;a<s;a++){var l=n[u.shapes[a]];h.push(l)}c=new ew[u.type](h,u.curveSegments);break;case"BufferGeometry":c=o.parse(u);break;case"Geometry":c=i.parse(u,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+u.type+'"');continue}c.uuid=u.uuid,void 0!==u.name&&(c.name=u.name),r[u.uuid]=c}return r},parseMaterials:function t(e,n){var r={};if(void 0!==e){var i=new gi;i.setTextures(n);for(var o=0,a=e.length;o<a;o++){var s=e[o];if("MultiMaterial"===s.type){for(var c=[],u=0;u<s.materials.length;u++)c.push(i.parse(s.materials[u]));r[s.uuid]=c}else r[s.uuid]=i.parse(s)}}return r},parseAnimations:function t(e){for(var n=[],r=0;r<e.length;r++){var i=vi.parse(e[r]);n.push(i)}return n},parseImages:function t(e,n){function r(t){return i.manager.itemStart(t),s.load(t,function(){i.manager.itemEnd(t)},void 0,function(){i.manager.itemEnd(t),i.manager.itemError(t)})}var i=this,o={};if(void 0!==e&&e.length>0){var a,s=new br(new vr(n));s.setCrossOrigin(this.crossOrigin);for(var c=0,u=e.length;c<u;c++){var h=e[c],l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(h.url)?h.url:i.texturePath+h.url;o[h.uuid]=r(l)}}return o},parseTextures:function t(e,n){function r(t,e){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}var i={};if(void 0!==e)for(var o=0,a=e.length;o<a;o++){var s=e[o];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===n[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image);var c=new p(n[s.image]);c.needsUpdate=!0,c.uuid=s.uuid,void 0!==s.name&&(c.name=s.name),void 0!==s.mapping&&(c.mapping=r(s.mapping,fw)),void 0!==s.offset&&c.offset.fromArray(s.offset),void 0!==s.repeat&&c.repeat.fromArray(s.repeat),void 0!==s.center&&c.center.fromArray(s.center),void 0!==s.rotation&&(c.rotation=s.rotation),void 0!==s.wrap&&(c.wrapS=r(s.wrap[0],mw),c.wrapT=r(s.wrap[1],mw)),void 0!==s.minFilter&&(c.minFilter=r(s.minFilter,vw)),void 0!==s.magFilter&&(c.magFilter=r(s.magFilter,vw)),void 0!==s.anisotropy&&(c.anisotropy=s.anisotropy),void 0!==s.flipY&&(c.flipY=s.flipY),i[s.uuid]=c}return i},parseObject:function t(e,n,r){function i(t){return void 0===n[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),n[t]}function o(t){if(void 0!==t){if(Array.isArray(t)){for(var e=[],n=0,i=t.length;n<i;n++){var o=t[n];void 0===r[o]&&console.warn("THREE.ObjectLoader: Undefined material",o),e.push(r[o])}return e}return void 0===r[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),r[t]}}var a;switch(e.type){case"Scene":a=new Ae,void 0!==e.background&&Number.isInteger(e.background)&&(a.background=new $(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?a.fog=new Le(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(a.fog=new Te(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":a=new xe(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(a.focus=e.focus),void 0!==e.zoom&&(a.zoom=e.zoom),void 0!==e.filmGauge&&(a.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(a.filmOffset=e.filmOffset),void 0!==e.view&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new mt(e.left,e.right,e.top,e.bottom,e.near,e.far);break;case"AmbientLight":a=new ni(e.color,e.intensity);break;case"DirectionalLight":a=new ei(e.color,e.intensity);break;case"PointLight":a=new $r(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":a=new ri(e.color,e.intensity,e.width,e.height);break;case"SpotLight":a=new Kr(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":a=new Zr(e.color,e.groundColor,e.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var s=i(e.geometry),c=o(e.material);a=s.bones&&s.bones.length>0?new Ne(s,c):new Gt(s,c);break;case"LOD":a=new Ie;break;case"Line":a=new De(i(e.geometry),o(e.material),e.mode);break;case"LineLoop":a=new Be(i(e.geometry),o(e.material));break;case"LineSegments":a=new Ue(i(e.geometry),o(e.material));break;case"PointCloud":case"Points":a=new Ge(i(e.geometry),o(e.material));break;case"Sprite":a=new Re(o(e.material));break;case"Group":a=new ke;break;default:a=new pt}if(a.uuid=e.uuid,void 0!==e.name&&(a.name=e.name),void 0!==e.matrix?(a.matrix.fromArray(e.matrix),a.matrix.decompose(a.position,a.quaternion,a.scale)):(void 0!==e.position&&a.position.fromArray(e.position),void 0!==e.rotation&&a.rotation.fromArray(e.rotation),void 0!==e.quaternion&&a.quaternion.fromArray(e.quaternion),void 0!==e.scale&&a.scale.fromArray(e.scale)),void 0!==e.castShadow&&(a.castShadow=e.castShadow),void 0!==e.receiveShadow&&(a.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(a.shadow.bias=e.shadow.bias),void 0!==e.shadow.radius&&(a.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&a.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(a.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(a.visible=e.visible),void 0!==e.userData&&(a.userData=e.userData),void 0!==e.children)for(var u=e.children,h=0;h<u.length;h++)a.add(this.parseObject(u[h],n,r));if("LOD"===e.type)for(var l=e.levels,d=0;d<l.length;d++){var p=l[d],f=a.getObjectByProperty("uuid",p.object);void 0!==f&&a.addLevel(f,p.distance)}return a}});var fw={UVMapping:300,CubeReflectionMapping:og,CubeRefractionMapping:ag,EquirectangularReflectionMapping:sg,EquirectangularRefractionMapping:cg,SphericalReflectionMapping:ug,CubeUVReflectionMapping:hg,CubeUVRefractionMapping:lg},mw={RepeatWrapping:dg,ClampToEdgeWrapping:pg,MirroredRepeatWrapping:fg},vw={NearestFilter:mg,NearestMipMapNearestFilter:vg,NearestMipMapLinearFilter:gg,LinearFilter:yg,LinearMipMapNearestFilter:xg,LinearMipMapLinearFilter:bg};Object.assign(_i.prototype,{moveTo:function t(e,n){this.currentPath=new Yr,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,n)},lineTo:function t(e,n){this.currentPath.lineTo(e,n)},quadraticCurveTo:function t(e,n,r,i){this.currentPath.quadraticCurveTo(e,n,r,i)},bezierCurveTo:function t(e,n,r,i,o,a){this.currentPath.bezierCurveTo(e,n,r,i,o,a)},splineThru:function t(e){this.currentPath.splineThru(e)},toShapes:function t(e,n){function r(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n],o=new Xr;o.curves=i.curves,e.push(o)}return e}function i(t,e){for(var n=e.length,r=!1,i=n-1,o=0;o<n;i=o++){var a=e[i],s=e[o],c=s.x-a.x,u=s.y-a.y;if(Math.abs(u)>Number.EPSILON){if(u<0&&(a=e[o],c=-c,s=e[i],u=-u),t.y<a.y||t.y>s.y)continue;if(t.y===a.y){if(t.x===a.x)return!0}else{var h=u*(t.x-a.x)-c*(t.y-a.y);if(0===h)return!0;if(h<0)continue;r=!r}}else{if(t.y!==a.y)continue;if(s.x<=t.x&&t.x<=a.x||a.x<=t.x&&t.x<=s.x)return!0}}return r}var o=Qb.isClockWise,a=this.subPaths;if(0===a.length)return[];if(!0===n)return r(a);var s,c,u,h=[];if(1===a.length)return c=a[0],u=new Xr,u.curves=c.curves,h.push(u),h;var l=!o(a[0].getPoints());l=e?!l:l;var d=[],p=[],f=[],m=0,v;p[m]=void 0,f[m]=[];for(var g=0,y=a.length;g<y;g++)s=o(v=(c=a[g]).getPoints()),(s=e?!s:s)?(!l&&p[m]&&m++,p[m]={s:new Xr,p:v},p[m].s.curves=c.curves,l&&m++,f[m]=[]):f[m].push({h:c,p:v[0]});if(!p[0])return r(a);if(p.length>1){for(var x=!1,b=[],w=0,_=p.length;w<_;w++)d[w]=[];for(var w=0,_=p.length;w<_;w++)for(var S=f[w],M=0;M<S.length;M++){for(var E=S[M],T=!0,L=0;L<p.length;L++)i(E.p,p[L].p)&&(w!==L&&b.push({froms:w,tos:L,hole:M}),T?(T=!1,d[L].push(E)):x=!0);T&&d[w].push(E)}b.length>0&&(x||(f=d))}for(var A,g=0,P=p.length;g<P;g++){u=p[g].s,h.push(u);for(var R=0,I=(A=f[g]).length;R<I;R++)u.holes.push(A[R].h)}return h}}),Object.assign(Si.prototype,{isFont:!0,generateShapes:function t(e,n,r){void 0===n&&(n=100),void 0===r&&(r=4);for(var i=[],o=Mi(e,n,r,this.data),a=0,s=o.length;a<s;a++)Array.prototype.push.apply(i,o[a].toShapes());return i}}),Object.assign(Ti.prototype,{load:function t(e,n,r,i){var o=this,a=new gr(this.manager);a.setPath(this.path),a.load(e,function(t){var e;try{e=JSON.parse(t)}catch(n){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),e=JSON.parse(t.substring(65,t.length-2))}var r=o.parse(e);n&&n(r)},r,i)},parse:function t(e){return new Si(e)},setPath:function t(e){return this.path=e,this}});var gw,yw={getContext:function t(){return void 0===gw&&(gw=new(window.AudioContext||window.webkitAudioContext)),gw},setContext:function t(e){gw=e}};Object.assign(Li.prototype,{load:function t(e,n,r,i){var o=new gr(this.manager);o.setResponseType("arraybuffer"),o.load(e,function(t){var e;yw.getContext().decodeAudioData(t,function(t){n(t)})},r,i)}}),Object.assign(Ai.prototype,{update:function(){var t,e,n,r,i,o,a,s,c=new u,h=new u;return function u(l){var d;if(t!==this||e!==l.focus||n!==l.fov||r!==l.aspect*this.aspect||i!==l.near||o!==l.far||a!==l.zoom||s!==this.eyeSep){t=this,e=l.focus,n=l.fov,r=l.aspect*this.aspect,i=l.near,o=l.far,a=l.zoom;var p=l.projectionMatrix.clone(),f=(s=this.eyeSep/2)*i/e,m=i*Math.tan(Ry.DEG2RAD*n*.5)/a,v,g;h.elements[12]=-s,c.elements[12]=s,v=-m*r+f,g=m*r+f,p.elements[0]=2*i/(g-v),p.elements[8]=(g+v)/(g-v),this.cameraL.projectionMatrix.copy(p),v=-m*r-f,g=m*r-f,p.elements[0]=2*i/(g-v),p.elements[8]=(g+v)/(g-v),this.cameraR.projectionMatrix.copy(p)}this.cameraL.matrixWorld.copy(l.matrixWorld).multiply(h),this.cameraR.matrixWorld.copy(l.matrixWorld).multiply(c)}}()}),Pi.prototype=Object.create(pt.prototype),Pi.prototype.constructor=Pi,Ri.prototype=Object.assign(Object.create(pt.prototype),{constructor:Ri,getInput:function t(){return this.gain},removeFilter:function t(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function t(){return this.filter},setFilter:function t(e){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},getMasterVolume:function t(){return this.gain.gain.value},setMasterVolume:function t(e){this.gain.gain.value=e},updateMatrixWorld:function(){var t=new l,e=new h,n=new l,r=new l;return function i(o){pt.prototype.updateMatrixWorld.call(this,o);var a=this.context.listener,s=this.up;this.matrixWorld.decompose(t,e,n),r.set(0,0,-1).applyQuaternion(e),a.positionX?(a.positionX.setValueAtTime(t.x,this.context.currentTime),a.positionY.setValueAtTime(t.y,this.context.currentTime),a.positionZ.setValueAtTime(t.z,this.context.currentTime),a.forwardX.setValueAtTime(r.x,this.context.currentTime),a.forwardY.setValueAtTime(r.y,this.context.currentTime),a.forwardZ.setValueAtTime(r.z,this.context.currentTime),a.upX.setValueAtTime(s.x,this.context.currentTime),a.upY.setValueAtTime(s.y,this.context.currentTime),a.upZ.setValueAtTime(s.z,this.context.currentTime)):(a.setPosition(t.x,t.y,t.z),a.setOrientation(r.x,r.y,r.z,s.x,s.y,s.z))}}()}),Ii.prototype=Object.assign(Object.create(pt.prototype),{constructor:Ii,getOutput:function t(){return this.gain},setNodeSource:function t(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setBuffer:function t(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function t(){if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){var e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.onended=this.onEnded.bind(this),e.playbackRate.setValueAtTime(this.playbackRate,this.startTime),this.startTime=this.context.currentTime,e.start(this.startTime,this.offset),this.isPlaying=!0,this.source=e,this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function t(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this.source.stop(),this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function t(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.offset=0,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function t(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var e=1,n=this.filters.length;e<n;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function t(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var e=1,n=this.filters.length;e<n;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function t(){return this.filters},setFilters:function t(e){return e||(e=[]),!0===this.isPlaying?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},getFilter:function t(){return this.getFilters()[0]},setFilter:function t(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function t(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function t(){return this.playbackRate},onEnded:function t(){this.isPlaying=!1},getLoop:function t(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function t(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},getVolume:function t(){return this.gain.gain.value},setVolume:function t(e){return this.gain.gain.value=e,this}}),Ci.prototype=Object.assign(Object.create(Ii.prototype),{constructor:Ci,getOutput:function t(){return this.panner},getRefDistance:function t(){return this.panner.refDistance},setRefDistance:function t(e){this.panner.refDistance=e},getRolloffFactor:function t(){return this.panner.rolloffFactor},setRolloffFactor:function t(e){this.panner.rolloffFactor=e},getDistanceModel:function t(){return this.panner.distanceModel},setDistanceModel:function t(e){this.panner.distanceModel=e},getMaxDistance:function t(){return this.panner.maxDistance},setMaxDistance:function t(e){this.panner.maxDistance=e},updateMatrixWorld:function(){var t=new l;return function e(n){pt.prototype.updateMatrixWorld.call(this,n),t.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(t.x,t.y,t.z)}}()}),Object.assign(Oi.prototype,{getFrequencyData:function t(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function t(){for(var e=0,n=this.getFrequencyData(),r=0;r<n.length;r++)e+=n[r];return e/n.length}}),Object.assign(Ni.prototype,{accumulate:function t(e,n){var r=this.buffer,i=this.valueSize,o=e*i+i,a=this.cumulativeWeight;if(0===a){for(var s=0;s!==i;++s)r[o+s]=r[s];a=n}else{var c=n/(a+=n);this._mixBufferRegion(r,o,0,c,i)}this.cumulativeWeight=a},apply:function t(e){var n=this.valueSize,r=this.buffer,i=e*n+n,o=this.cumulativeWeight,a=this.binding;if(this.cumulativeWeight=0,o<1){var s=3*n;this._mixBufferRegion(r,i,s,1-o,n)}for(var c=n,u=n+n;c!==u;++c)if(r[c]!==r[c+n]){a.setValue(r,i);break}},saveOriginalState:function t(){var e=this.binding,n=this.buffer,r=this.valueSize,i=3*r;e.getValue(n,i);for(var o=r,a=i;o!==a;++o)n[o]=n[i+o%r];this.cumulativeWeight=0},restoreOriginalState:function t(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)},_select:function t(e,n,r,i,o){if(i>=.5)for(var a=0;a!==o;++a)e[n+a]=e[r+a]},_slerp:function t(e,n,r,i){h.slerpFlat(e,n,e,n,e,r,i)},_lerp:function t(e,n,r,i,o){for(var a=1-i,s=0;s!==o;++s){var c=n+s;e[c]=e[c]*a+e[r+s]*i}}});var xw="\\[\\]\\.:\\/";Object.assign(Fi.prototype,{getValue:function t(e,n){this.bind();var r=this._targetGroup.nCachedObjects_,i=this._bindings[r];void 0!==i&&i.getValue(e,n)},setValue:function t(e,n){for(var r=this._bindings,i=this._targetGroup.nCachedObjects_,o=r.length;i!==o;++i)r[i].setValue(e,n)},bind:function t(){for(var e=this._bindings,n=this._targetGroup.nCachedObjects_,r=e.length;n!==r;++n)e[n].bind()},unbind:function t(){for(var e=this._bindings,n=this._targetGroup.nCachedObjects_,r=e.length;n!==r;++n)e[n].unbind()}}),Object.assign(Di,{Composite:Fi,create:function t(e,n,r){return e&&e.isAnimationObjectGroup?new Di.Composite(e,n,r):new Di(e,n,r)},sanitizeNodeName:function(){var t=new RegExp("["+xw+"]","g");return function e(n){return n.replace(/\s/g,"_").replace(t,"")}}(),parseTrackName:function(){var t="[^"+xw+"]",e="[^"+xw.replace("\\.","")+"]",n=/((?:WC+[\/:])*)/.source.replace("WC",t),r=/(WCOD+)?/.source.replace("WCOD",e),i=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",t),o=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",t),a=new RegExp("^"+n+r+i+o+"$"),s=["material","materials","bones"];return function t(e){var n=a.exec(e);if(!n)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var r={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},i=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i){var o=r.nodeName.substring(i+1);-1!==s.indexOf(o)&&(r.nodeName=r.nodeName.substring(0,i),r.objectName=o)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}}(),findNode:function t(e,n){if(!n||""===n||"root"===n||"."===n||-1===n||n===e.name||n===e.uuid)return e;if(e.skeleton){var r=e.skeleton.getBoneByName(n);if(void 0!==r)return r}if(e.children){var i,o=function t(e){for(var r=0;r<e.length;r++){var i=e[r];if(i.name===n||i.uuid===n)return i;var o=t(i.children);if(o)return o}return null}(e.children);if(o)return o}return null}}),Object.assign(Di.prototype,{_getValue_unavailable:function t(){},_setValue_unavailable:function t(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function t(e,n){e[n]=this.node[this.propertyName]},function t(e,n){for(var r=this.resolvedProperty,i=0,o=r.length;i!==o;++i)e[n++]=r[i]},function t(e,n){e[n]=this.resolvedProperty[this.propertyIndex]},function t(e,n){this.resolvedProperty.toArray(e,n)}],SetterByBindingTypeAndVersioning:[[function t(e,n){this.targetObject[this.propertyName]=e[n]},function t(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.needsUpdate=!0},function t(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}],[function t(e,n){for(var r=this.resolvedProperty,i=0,o=r.length;i!==o;++i)r[i]=e[n++]},function t(e,n){for(var r=this.resolvedProperty,i=0,o=r.length;i!==o;++i)r[i]=e[n++];this.targetObject.needsUpdate=!0},function t(e,n){for(var r=this.resolvedProperty,i=0,o=r.length;i!==o;++i)r[i]=e[n++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function t(e,n){this.resolvedProperty[this.propertyIndex]=e[n]},function t(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.needsUpdate=!0},function t(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}],[function t(e,n){this.resolvedProperty.fromArray(e,n)},function t(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.needsUpdate=!0},function t(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function t(e,n){this.bind(),this.getValue(e,n)},setValue:function t(e,n){this.bind(),this.setValue(e,n)},bind:function t(){var e=this.node,n=this.parsedPath,r=n.objectName,i=n.propertyName,o=n.propertyIndex;if(e||(e=Di.findNode(this.rootNode,n.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(r){var a=n.objectIndex;switch(r){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(var s=0;s<e.length;s++)if(e[s].name===a){a=s;break}break;default:if(void 0===e[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[r]}if(void 0!==a){if(void 0===e[a])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[a]}}var c=e[i];if(void 0!==c){var u=this.Versioning.None;void 0!==e.needsUpdate?(u=this.Versioning.NeedsUpdate,this.targetObject=e):void 0!==e.matrixWorldNeedsUpdate&&(u=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=e);var h=this.BindingType.Direct;if(void 0!==o){if("morphTargetInfluences"===i){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(var s=0;s<this.node.geometry.morphAttributes.position.length;s++)if(e.geometry.morphAttributes.position[s].name===o){o=s;break}}else{if(!e.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(var s=0;s<this.node.geometry.morphTargets.length;s++)if(e.geometry.morphTargets[s].name===o){o=s;break}}}h=this.BindingType.ArrayElement,this.resolvedProperty=c,this.propertyIndex=o}else void 0!==c.fromArray&&void 0!==c.toArray?(h=this.BindingType.HasFromToArray,this.resolvedProperty=c):Array.isArray(c)?(h=this.BindingType.EntireArray,this.resolvedProperty=c):this.propertyName=i;this.getValue=this.GetterByBindingType[h],this.setValue=this.SetterByBindingTypeAndVersioning[h][u]}else{var l=n.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+l+"."+i+" but it wasn't found.",e)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function t(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(Di.prototype,{_getValue_unbound:Di.prototype.getValue,_setValue_unbound:Di.prototype.setValue}),Object.assign(Ui.prototype,{isAnimationObjectGroup:!0,add:function t(){for(var e=this._objects,n=e.length,r=this.nCachedObjects_,i=this._indicesByUUID,o=this._paths,a=this._parsedPaths,s=this._bindings,c=s.length,u=void 0,h=0,l=arguments.length;h!==l;++h){var d=arguments[h],p=d.uuid,f=i[p];if(void 0===f){f=n++,i[p]=f,e.push(d);for(var m=0,v=c;m!==v;++m)s[m].push(new Di(d,o[m],a[m]))}else if(f<r){u=e[f];var g=--r,y=e[g];i[y.uuid]=f,e[f]=y,i[p]=g,e[g]=d;for(var m=0,v=c;m!==v;++m){var x=s[m],b=x[g],w=x[f];x[f]=b,void 0===w&&(w=new Di(d,o[m],a[m])),x[g]=w}}else e[f]!==u&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=r},remove:function t(){for(var e=this._objects,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._bindings,o=i.length,a=0,s=arguments.length;a!==s;++a){var c=arguments[a],u=c.uuid,h=r[u];if(void 0!==h&&h>=n){var l=n++,d=e[l];r[d.uuid]=h,e[h]=d,r[u]=l,e[l]=c;for(var p=0,f=o;p!==f;++p){var m=i[p],v=m[l],g=m[h];m[h]=v,m[l]=g}}}this.nCachedObjects_=n},uncache:function t(){for(var e=this._objects,n=e.length,r=this.nCachedObjects_,i=this._indicesByUUID,o=this._bindings,a=o.length,s=0,c=arguments.length;s!==c;++s){var u,h=arguments[s].uuid,l=i[h];if(void 0!==l)if(delete i[h],l<r){var d=--r,p=e[d],f,m=e[f=--n];i[p.uuid]=l,e[l]=p,i[m.uuid]=d,e[d]=m,e.pop();for(var v=0,g=a;v!==g;++v){var y,x=(y=o[v])[d],b=y[f];y[l]=x,y[d]=b,y.pop()}}else{var f,m;i[(m=e[f=--n]).uuid]=l,e[l]=m,e.pop();for(var v=0,g=a;v!==g;++v){var y;(y=o[v])[l]=y[f],y.pop()}}}this.nCachedObjects_=r},subscribe_:function t(e,n){var r=this._bindingsIndicesByPath,i=r[e],o=this._bindings;if(void 0!==i)return o[i];var a=this._paths,s=this._parsedPaths,c=this._objects,u=c.length,h=this.nCachedObjects_,l=new Array(u);i=o.length,r[e]=i,a.push(e),s.push(n),o.push(l);for(var d=h,p=c.length;d!==p;++d){var f=c[d];l[d]=new Di(f,e,n)}return l},unsubscribe_:function t(e){var n=this._bindingsIndicesByPath,r=n[e];if(void 0!==r){var i=this._paths,o=this._parsedPaths,a=this._bindings,s=a.length-1,c=a[s],u;n[e[s]]=r,a[r]=c,a.pop(),o[r]=o[s],o.pop(),i[r]=i[s],i.pop()}}}),Object.assign(Bi.prototype,{play:function t(){return this._mixer._activateAction(this),this},stop:function t(){return this._mixer._deactivateAction(this),this.reset()},reset:function t(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function t(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function t(){return this._mixer._isActiveAction(this)},startAt:function t(e){return this._startTime=e,this},setLoop:function t(e,n){return this.loop=e,this.repetitions=n,this},setEffectiveWeight:function t(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function t(){return this._effectiveWeight},fadeIn:function t(e){return this._scheduleFading(e,0,1)},fadeOut:function t(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function t(e,n,r){if(e.fadeOut(n),this.fadeIn(n),r){var i=this._clip.duration,o=e._clip.duration,a=o/i,s=i/o;e.warp(1,a,n),this.warp(s,1,n)}return this},crossFadeTo:function t(e,n,r){return e.crossFadeFrom(this,n,r)},stopFading:function t(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function t(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function t(){return this._effectiveTimeScale},setDuration:function t(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function t(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function t(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function t(e,n,r){var i=this._mixer,o=i.time,a=this._timeScaleInterpolant,s=this.timeScale;null===a&&(a=i._lendControlInterpolant(),this._timeScaleInterpolant=a);var c=a.parameterPositions,u=a.sampleValues;return c[0]=o,c[1]=o+r,u[0]=e/s,u[1]=n/s,this},stopWarping:function t(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function t(){return this._mixer},getClip:function t(){return this._clip},getRoot:function t(){return this._localRoot||this._mixer._root},_update:function t(e,n,r,i){if(this.enabled){var o=this._startTime;if(null!==o){var a=(e-o)*r;if(a<0||0===r)return;this._startTime=null,n=r*a}n*=this._updateTimeScale(e);var s=this._updateTime(n),c=this._updateWeight(e);if(c>0)for(var u=this._interpolants,h=this._propertyBindings,l=0,d=u.length;l!==d;++l)u[l].evaluate(s),h[l].accumulate(i,c)}else this._updateWeight(e)},_updateWeight:function t(e){var n=0;if(this.enabled){n=this.weight;var r=this._weightInterpolant;if(null!==r){var i=r.evaluate(e)[0];n*=i,e>r.parameterPositions[1]&&(this.stopFading(),0===i&&(this.enabled=!1))}}return this._effectiveWeight=n,n},_updateTimeScale:function t(e){var n=0;if(!this.paused){n=this.timeScale;var r=this._timeScaleInterpolant;if(null!==r){var i;n*=r.evaluate(e)[0],e>r.parameterPositions[1]&&(this.stopWarping(),0===n?this.paused=!0:this.timeScale=n)}}return this._effectiveTimeScale=n,n},_updateTime:function t(e){var n=this.time+e;if(0===e)return n;var r=this._clip.duration,i=this.loop,o=this._loopCount;if(2200===i){-1===o&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(n>=r)n=r;else{if(!(n<0))break t;n=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{var a=2202===i;if(-1===o&&(e>=0?(o=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),n>=r||n<0){var s=Math.floor(n/r);n-=r*s,o+=Math.abs(s);var c=this.repetitions-o;if(c<0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,n=e>0?r:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(0===c){var u=e<0;this._setEndings(u,!u,a)}else this._setEndings(!1,!1,a);this._loopCount=o,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:s})}}if(a&&1==(1&o))return this.time=n,r-n}return this.time=n,n},_setEndings:function t(e,n,r){var i=this._interpolantSettings;r?(i.endingStart=2401,i.endingEnd=2401):(i.endingStart=e?this.zeroSlopeAtStart?2401:my:2402,i.endingEnd=n?this.zeroSlopeAtEnd?2401:my:2402)},_scheduleFading:function t(e,n,r){var i=this._mixer,o=i.time,a=this._weightInterpolant;null===a&&(a=i._lendControlInterpolant(),this._weightInterpolant=a);var s=a.parameterPositions,c=a.sampleValues;return s[0]=o,c[0]=n,s[1]=o+e,c[1]=r,this}}),zi.prototype=Object.assign(Object.create(s.prototype),{constructor:zi,_bindAction:function t(e,n){var r=e._localRoot||this._root,i=e._clip.tracks,o=i.length,a=e._propertyBindings,s=e._interpolants,c=r.uuid,u=this._bindingsByRootAndName,h=u[c];void 0===h&&(h={},u[c]=h);for(var l=0;l!==o;++l){var d=i[l],p=d.name,f=h[p];if(void 0!==f)a[l]=f;else{if(void 0!==(f=a[l])){null===f._cacheIndex&&(++f.referenceCount,this._addInactiveBinding(f,c,p));continue}var m=n&&n._propertyBindings[l].binding.parsedPath;++(f=new Ni(Di.create(r,p,m),d.ValueTypeName,d.getValueSize())).referenceCount,this._addInactiveBinding(f,c,p),a[l]=f}s[l].resultBuffer=f.buffer}},_activateAction:function t(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var n=(e._localRoot||this._root).uuid,r=e._clip.uuid,i=this._actionsByClip[r];this._bindAction(e,i&&i.knownActions[0]),this._addInactiveAction(e,r,n)}for(var o=e._propertyBindings,a=0,s=o.length;a!==s;++a){var c=o[a];0==c.useCount++&&(this._lendBinding(c),c.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function t(e){if(this._isActiveAction(e)){for(var n=e._propertyBindings,r=0,i=n.length;r!==i;++r){var o=n[r];0==--o.useCount&&(o.restoreOriginalState(),this._takeBackBinding(o))}this._takeBackAction(e)}},_initMemoryManager:function t(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function t(e){var n=e._cacheIndex;return null!==n&&n<this._nActiveActions},_addInactiveAction:function t(e,n,r){var i=this._actions,o=this._actionsByClip,a=o[n];if(void 0===a)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,o[n]=a;else{var s=a.knownActions;e._byClipCacheIndex=s.length,s.push(e)}e._cacheIndex=i.length,i.push(e),a.actionByRoot[r]=e},_removeInactiveAction:function t(e){var n=this._actions,r=n[n.length-1],i=e._cacheIndex;r._cacheIndex=i,n[i]=r,n.pop(),e._cacheIndex=null;var o=e._clip.uuid,a=this._actionsByClip,s=a[o],c=s.knownActions,u=c[c.length-1],h=e._byClipCacheIndex;u._byClipCacheIndex=h,c[h]=u,c.pop(),e._byClipCacheIndex=null;var l,d;delete s.actionByRoot[(e._localRoot||this._root).uuid],0===c.length&&delete a[o],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function t(e){for(var n=e._propertyBindings,r=0,i=n.length;r!==i;++r){var o=n[r];0==--o.referenceCount&&this._removeInactiveBinding(o)}},_lendAction:function t(e){var n=this._actions,r=e._cacheIndex,i=this._nActiveActions++,o=n[i];e._cacheIndex=i,n[i]=e,o._cacheIndex=r,n[r]=o},_takeBackAction:function t(e){var n=this._actions,r=e._cacheIndex,i=--this._nActiveActions,o=n[i];e._cacheIndex=i,n[i]=e,o._cacheIndex=r,n[r]=o},_addInactiveBinding:function t(e,n,r){var i=this._bindingsByRootAndName,o=i[n],a=this._bindings;void 0===o&&(o={},i[n]=o),o[r]=e,e._cacheIndex=a.length,a.push(e)},_removeInactiveBinding:function t(e){var n=this._bindings,r=e.binding,i=r.rootNode.uuid,o=r.path,a=this._bindingsByRootAndName,s=a[i],c=n[n.length-1],u=e._cacheIndex;c._cacheIndex=u,n[u]=c,n.pop(),delete s[o];t:{for(var h in s)break t;delete a[i]}},_lendBinding:function t(e){var n=this._bindings,r=e._cacheIndex,i=this._nActiveBindings++,o=n[i];e._cacheIndex=i,n[i]=e,o._cacheIndex=r,n[r]=o},_takeBackBinding:function t(e){var n=this._bindings,r=e._cacheIndex,i=--this._nActiveBindings,o=n[i];e._cacheIndex=i,n[i]=e,o._cacheIndex=r,n[r]=o},_lendControlInterpolant:function t(){var e=this._controlInterpolants,n=this._nActiveControlInterpolants++,r=e[n];return void 0===r&&((r=new di(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=n,e[n]=r),r},_takeBackControlInterpolant:function t(e){var n=this._controlInterpolants,r=e.__cacheIndex,i=--this._nActiveControlInterpolants,o=n[i];e.__cacheIndex=i,n[i]=e,o.__cacheIndex=r,n[r]=o},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function t(e,n){var r=n||this._root,i=r.uuid,o="string"==typeof e?vi.findByName(r,e):e,a=null!==o?o.uuid:e,s=this._actionsByClip[a],c=null;if(void 0!==s){var u=s.actionByRoot[i];if(void 0!==u)return u;c=s.knownActions[0],null===o&&(o=c._clip)}if(null===o)return null;var h=new Bi(this,o,n);return this._bindAction(h,c),this._addInactiveAction(h,a,i),h},existingAction:function t(e,n){var r=n||this._root,i=r.uuid,o="string"==typeof e?vi.findByName(r,e):e,a=o?o.uuid:e,s=this._actionsByClip[a];return void 0!==s?s.actionByRoot[i]||null:null},stopAllAction:function t(){var e=this._actions,n=this._nActiveActions,r=this._bindings,i=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var o=0;o!==n;++o)e[o].reset();for(var o=0;o!==i;++o)r[o].useCount=0;return this},update:function t(e){e*=this.timeScale;for(var n=this._actions,r=this._nActiveActions,i=this.time+=e,o=Math.sign(e),a=this._accuIndex^=1,s=0;s!==r;++s){var c;n[s]._update(i,e,o,a)}for(var u=this._bindings,h=this._nActiveBindings,s=0;s!==h;++s)u[s].apply(a);return this},getRoot:function t(){return this._root},uncacheClip:function t(e){var n=this._actions,r=e.uuid,i=this._actionsByClip,o=i[r];if(void 0!==o){for(var a=o.knownActions,s=0,c=a.length;s!==c;++s){var u=a[s];this._deactivateAction(u);var h=u._cacheIndex,l=n[n.length-1];u._cacheIndex=null,u._byClipCacheIndex=null,l._cacheIndex=h,n[h]=l,n.pop(),this._removeInactiveBindingsForAction(u)}delete i[r]}},uncacheRoot:function t(e){var n=e.uuid,r=this._actionsByClip;for(var i in r){var o,a=r[i].actionByRoot[n];void 0!==a&&(this._deactivateAction(a),this._removeInactiveAction(a))}var s,c=this._bindingsByRootAndName[n];if(void 0!==c)for(var u in c){var h=c[u];h.restoreOriginalState(),this._removeInactiveBinding(h)}},uncacheAction:function t(e,n){var r=this.existingAction(e,n);null!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}}),Gi.prototype.clone=function(){return new Gi(void 0===this.value.clone?this.value:this.value.clone())},ki.prototype=Object.assign(Object.create(Rt.prototype),{constructor:ki,isInstancedBufferGeometry:!0,copy:function t(e){return Rt.prototype.copy.call(this,e),this.maxInstancedCount=e.maxInstancedCount,this},clone:function t(){return(new this.constructor).copy(this)}}),Object.defineProperties(ji.prototype,{count:{get:function t(){return this.data.count}},array:{get:function t(){return this.data.array}}}),Object.assign(ji.prototype,{isInterleavedBufferAttribute:!0,setX:function t(e,n){return this.data.array[e*this.data.stride+this.offset]=n,this},setY:function t(e,n){return this.data.array[e*this.data.stride+this.offset+1]=n,this},setZ:function t(e,n){return this.data.array[e*this.data.stride+this.offset+2]=n,this},setW:function t(e,n){return this.data.array[e*this.data.stride+this.offset+3]=n,this},getX:function t(e){return this.data.array[e*this.data.stride+this.offset]},getY:function t(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function t(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function t(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function t(e,n,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=n,this.data.array[e+1]=r,this},setXYZ:function t(e,n,r,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=n,this.data.array[e+1]=r,this.data.array[e+2]=i,this},setXYZW:function t(e,n,r,i,o){return e=e*this.data.stride+this.offset,this.data.array[e+0]=n,this.data.array[e+1]=r,this.data.array[e+2]=i,this.data.array[e+3]=o,this}}),Object.defineProperty(Vi.prototype,"needsUpdate",{set:function t(e){!0===e&&this.version++}}),Object.assign(Vi.prototype,{isInterleavedBuffer:!0,setArray:function t(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==e?e.length/this.stride:0,this.array=e},setDynamic:function t(e){return this.dynamic=e,this},copy:function t(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.dynamic=e.dynamic,this},copyAt:function t(e,n,r){e*=this.stride,r*=n.stride;for(var i=0,o=this.stride;i<o;i++)this.array[e+i]=n.array[r+i];return this},set:function t(e,n){return void 0===n&&(n=0),this.array.set(e,n),this},clone:function t(){return(new this.constructor).copy(this)},onUpload:function t(e){return this.onUploadCallback=e,this}}),Hi.prototype=Object.assign(Object.create(Vi.prototype),{constructor:Hi,isInstancedInterleavedBuffer:!0,copy:function t(e){return Vi.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Wi.prototype=Object.assign(Object.create(yt.prototype),{constructor:Wi,isInstancedBufferAttribute:!0,copy:function t(e){return yt.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Object.assign(Yi.prototype,{linePrecision:1,set:function t(e,n){this.ray.set(e,n)},setFromCamera:function t(e,n){n&&n.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(n.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(n).sub(this.ray.origin).normalize()):n&&n.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(n.near+n.far)/(n.near-n.far)).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function t(e,n){var r=[];return qi(e,this,r,n),r.sort(Xi),r},intersectObjects:function t(e,n){var r=[];if(!1===Array.isArray(e))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),r;for(var i=0,o=e.length;i<o;i++)qi(e[i],this,r,n);return r.sort(Xi),r}}),Object.assign(Zi.prototype,{start:function t(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function t(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function t(){return this.getDelta(),this.elapsedTime},getDelta:function t(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var n=("undefined"==typeof performance?Date:performance).now();e=(n-this.oldTime)/1e3,this.oldTime=n,this.elapsedTime+=e}return e}}),Object.assign(Ji.prototype,{set:function t(e,n,r){return this.radius=e,this.phi=n,this.theta=r,this},clone:function t(){return(new this.constructor).copy(this)},copy:function t(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function t(){var e=1e-6;return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function t(e){return this.radius=e.length(),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e.x,e.z),this.phi=Math.acos(Ry.clamp(e.y/this.radius,-1,1))),this}}),Object.assign(Qi.prototype,{set:function t(e,n,r){return this.radius=e,this.theta=n,this.y=r,this},clone:function t(){return(new this.constructor).copy(this)},copy:function t(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function t(e){return this.radius=Math.sqrt(e.x*e.x+e.z*e.z),this.theta=Math.atan2(e.x,e.z),this.y=e.y,this}}),Object.assign(Ki.prototype,{set:function t(e,n){return this.min.copy(e),this.max.copy(n),this},setFromPoints:function t(e){this.makeEmpty();for(var n=0,r=e.length;n<r;n++)this.expandByPoint(e[n]);return this},setFromCenterAndSize:function(){var t=new c;return function e(n,r){var i=t.copy(r).multiplyScalar(.5);return this.min.copy(n).sub(i),this.max.copy(n).add(i),this}}(),clone:function t(){return(new this.constructor).copy(this)},copy:function t(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function t(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function t(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function t(e){var n=e||new c;return this.isEmpty()?n.set(0,0):n.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function t(e){var n=e||new c;return this.isEmpty()?n.set(0,0):n.subVectors(this.max,this.min)},expandByPoint:function t(e){return this.min.min(e),this.max.max(e),this},expandByVector:function t(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function t(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function t(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function t(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function t(e,n){var r;return(n||new c).set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function t(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function t(e,n){var r;return(n||new c).copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var t=new c;return function e(n){var r;return t.copy(n).clamp(this.min,this.max).sub(n).length()}}(),intersect:function t(e){return this.min.max(e.min),this.max.min(e.max),this},union:function t(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function t(e){return this.min.add(e),this.max.add(e),this},equals:function t(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),$i.prototype=Object.create(pt.prototype),$i.prototype.constructor=$i,$i.prototype.isImmediateRenderObject=!0,to.prototype=Object.create(Ue.prototype),to.prototype.constructor=to,to.prototype.update=function(){var t=new l,e=new l,n=new d;return function r(){var i=["a","b","c"];this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);var o=this.object.matrixWorld,a=this.geometry.attributes.position,s=this.object.geometry;if(s&&s.isGeometry)for(var c=s.vertices,u=s.faces,h=0,l=0,d=u.length;l<d;l++)for(var p=u[l],f=0,m=p.vertexNormals.length;f<m;f++){var v=c[p[i[f]]],g=p.vertexNormals[f];t.copy(v).applyMatrix4(o),e.copy(g).applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),a.setXYZ(h,t.x,t.y,t.z),h+=1,a.setXYZ(h,e.x,e.y,e.z),h+=1}else if(s&&s.isBufferGeometry)for(var y=s.attributes.position,x=s.attributes.normal,h=0,f=0,m=y.count;f<m;f++)t.set(y.getX(f),y.getY(f),y.getZ(f)).applyMatrix4(o),e.set(x.getX(f),x.getY(f),x.getZ(f)),e.applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),a.setXYZ(h,t.x,t.y,t.z),h+=1,a.setXYZ(h,e.x,e.y,e.z),h+=1;a.needsUpdate=!0}}(),eo.prototype=Object.create(pt.prototype),eo.prototype.constructor=eo,eo.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},eo.prototype.update=function(){var t=new l,e=new l;return function n(){this.light.updateMatrixWorld();var r=this.light.distance?this.light.distance:1e3,i=r*Math.tan(this.light.angle);this.cone.scale.set(i,i,r),t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(e.sub(t)),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}(),ro.prototype=Object.create(Ue.prototype),ro.prototype.constructor=ro,ro.prototype.updateMatrixWorld=function(){var t=new l,e=new u,n=new u;return function r(i){var o=this.bones,a=this.geometry,s=a.getAttribute("position");n.getInverse(this.root.matrixWorld);for(var c=0,u=0;c<o.length;c++){var h=o[c];h.parent&&h.parent.isBone&&(e.multiplyMatrices(n,h.matrixWorld),t.setFromMatrixPosition(e),s.setXYZ(u,t.x,t.y,t.z),e.multiplyMatrices(n,h.parent.matrixWorld),t.setFromMatrixPosition(e),s.setXYZ(u+1,t.x,t.y,t.z),u+=2)}a.getAttribute("position").needsUpdate=!0,pt.prototype.updateMatrixWorld.call(this,i)}}(),io.prototype=Object.create(Gt.prototype),io.prototype.constructor=io,io.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},io.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},oo.prototype=Object.create(pt.prototype),oo.prototype.constructor=oo,oo.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},oo.prototype.update=function(){var t=.5*this.light.width,e=.5*this.light.height,n=this.line.geometry.attributes.position,r=n.array;r[0]=t,r[1]=-e,r[2]=0,r[3]=t,r[4]=e,r[5]=0,r[6]=-t,r[7]=e,r[8]=0,r[9]=-t,r[10]=-e,r[11]=0,r[12]=t,r[13]=-e,r[14]=0,n.needsUpdate=!0,void 0!==this.color?this.line.material.color.set(this.color):this.line.material.color.copy(this.light.color)},ao.prototype=Object.create(pt.prototype),ao.prototype.constructor=ao,ao.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},ao.prototype.update=function(){var t=new l,e=new $,n=new $;return function r(){var i=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var o=i.geometry.getAttribute("color");e.copy(this.light.color),n.copy(this.light.groundColor);for(var a=0,s=o.count;a<s;a++){var c=a<s/2?e:n;o.setXYZ(a,c.r,c.g,c.b)}o.needsUpdate=!0}i.lookAt(t.setFromMatrixPosition(this.light.matrixWorld).negate())}}(),so.prototype=Object.create(Ue.prototype),so.prototype.constructor=so,co.prototype=Object.create(Ue.prototype),co.prototype.constructor=co,uo.prototype=Object.create(Ue.prototype),uo.prototype.constructor=uo,uo.prototype.update=function(){var t=new l,e=new l,n=new d;return function r(){this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);for(var i=this.object.matrixWorld,o=this.geometry.attributes.position,a=this.object.geometry,s=a.vertices,c=a.faces,u=0,h=0,l=c.length;h<l;h++){var d=c[h],p=d.normal;t.copy(s[d.a]).add(s[d.b]).add(s[d.c]).divideScalar(3).applyMatrix4(i),e.copy(p).applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),o.setXYZ(u,t.x,t.y,t.z),u+=1,o.setXYZ(u,e.x,e.y,e.z),u+=1}o.needsUpdate=!0}}(),ho.prototype=Object.create(pt.prototype),ho.prototype.constructor=ho,ho.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},ho.prototype.update=function(){var t=new l,e=new l,n=new l;return function r(){t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),n.subVectors(e,t),this.lightPlane.lookAt(n),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(n),this.targetLine.scale.z=n.length()}}(),lo.prototype=Object.create(Ue.prototype),lo.prototype.constructor=lo,lo.prototype.update=function(){function t(t,o,a,s){r.set(o,a,s).unproject(i);var c=n[t];if(void 0!==c)for(var u=e.getAttribute("position"),h=0,l=c.length;h<l;h++)u.setXYZ(c[h],r.x,r.y,r.z)}var e,n,r=new l,i=new ft;return function r(){e=this.geometry,n=this.pointMap;var o=1,a=1;i.projectionMatrix.copy(this.camera.projectionMatrix),t("c",0,0,-1),t("t",0,0,1),t("n1",-1,-1,-1),t("n2",1,-1,-1),t("n3",-1,1,-1),t("n4",1,1,-1),t("f1",-1,-1,1),t("f2",1,-1,1),t("f3",-1,1,1),t("f4",1,1,1),t("u1",.7,1.1,-1),t("u2",-.7,1.1,-1),t("u3",0,2,-1),t("cf1",-1,0,1),t("cf2",1,0,1),t("cf3",0,-1,1),t("cf4",0,1,1),t("cn1",-1,0,-1),t("cn2",1,0,-1),t("cn3",0,-1,-1),t("cn4",0,1,-1),e.getAttribute("position").needsUpdate=!0}}(),po.prototype=Object.create(Ue.prototype),po.prototype.constructor=po,po.prototype.update=function(){var t=new ot;return function e(n){if(void 0!==n&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&t.setFromObject(this.object),!t.isEmpty()){var r=t.min,i=t.max,o=this.geometry.attributes.position,a=o.array;a[0]=i.x,a[1]=i.y,a[2]=i.z,a[3]=r.x,a[4]=i.y,a[5]=i.z,a[6]=r.x,a[7]=r.y,a[8]=i.z,a[9]=i.x,a[10]=r.y,a[11]=i.z,a[12]=i.x,a[13]=i.y,a[14]=r.z,a[15]=r.x,a[16]=i.y,a[17]=r.z,a[18]=r.x,a[19]=r.y,a[20]=r.z,a[21]=i.x,a[22]=r.y,a[23]=r.z,o.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),po.prototype.setFromObject=function(t){return this.object=t,this.update(),this},fo.prototype=Object.create(Ue.prototype),fo.prototype.constructor=fo,fo.prototype.updateMatrixWorld=function(t){var e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),pt.prototype.updateMatrixWorld.call(this,t))},mo.prototype=Object.create(De.prototype),mo.prototype.constructor=mo,mo.prototype.updateMatrixWorld=function(t){var e=-this.plane.constant;Math.abs(e)<1e-8&&(e=1e-8),this.scale.set(.5*this.size,.5*this.size,e),this.lookAt(this.plane.normal),pt.prototype.updateMatrixWorld.call(this,t)};var bw,ww;vo.prototype=Object.create(pt.prototype),vo.prototype.constructor=vo,vo.prototype.setDirection=function(){var t=new l,e;return function n(r){r.y>.99999?this.quaternion.set(0,0,0,1):r.y<-.99999?this.quaternion.set(1,0,0,0):(t.set(r.z,0,-r.x).normalize(),e=Math.acos(r.y),this.quaternion.setFromAxisAngle(t,e))}}(),vo.prototype.setLength=function(t,e,n){void 0===e&&(e=.2*t),void 0===n&&(n=.2*e),this.line.scale.set(1,Math.max(0,t-e),1),this.line.updateMatrix(),this.cone.scale.set(n,e,n),this.cone.position.y=t,this.cone.updateMatrix()},vo.prototype.setColor=function(t){this.line.material.color.copy(t),this.cone.material.color.copy(t)},go.prototype=Object.create(Ue.prototype),go.prototype.constructor=go,Sr.create=function(t,e){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(Sr.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},Object.assign(Wr.prototype,{createPointsGeometry:function t(e){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var n=this.getPoints(e);return this.createGeometry(n)},createSpacedPointsGeometry:function t(e){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var n=this.getSpacedPoints(e);return this.createGeometry(n)},createGeometry:function t(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var n=new gt,r=0,i=e.length;r<i;r++){var o=e[r];n.vertices.push(new l(o.x,o.y,o.z||0))}return n}}),Object.assign(Yr.prototype,{fromPoints:function t(e){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}}),yo.prototype=Object.create(Lr.prototype),Object.assign(yo.prototype,{initFromArray:function t(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function t(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function t(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),so.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},ro.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(xi.prototype,{extractUrlBase:function t(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),pw.extractUrlBase(e)}}),Object.assign(Ki.prototype,{center:function t(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function t(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function t(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function t(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(ot.prototype,{center:function t(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function t(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function t(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function t(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function t(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),Bt.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},Object.assign(Ry,{random16:function t(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function t(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Ry.floorPowerOfTwo(e)},nextPowerOfTwo:function t(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Ry.ceilPowerOfTwo(e)}}),Object.assign(d.prototype,{flattenToArrayOffset:function t(e,n){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,n)},multiplyVector3:function t(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function t(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function t(e){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function t(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(u.prototype,{extractPosition:function t(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function t(e,n){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,n)},getPosition:function(){var t;return function e(){return void 0===t&&(t=new l),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),t.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function t(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function t(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function t(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function t(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function t(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function t(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function t(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function t(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function t(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function t(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function t(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function t(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function t(e){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function t(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function t(e,n,r,i,o,a){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,n,i,r,o,a)}}),st.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},h.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},Object.assign(Ut.prototype,{isIntersectionBox:function t(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function t(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function t(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(Xr.prototype,{extractAllPoints:function t(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function t(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new kn(this,e)},makeGeometry:function t(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Qn(this,e)}}),Object.assign(c.prototype,{fromAttribute:function t(e,n,r){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,n,r)},distanceToManhattan:function t(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function t(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(l.prototype,{setEulerFromRotationMatrix:function t(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function t(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function t(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function t(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function t(e,n){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(n,e)},applyProjection:function t(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function t(e,n,r){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,n,r)},distanceToManhattan:function t(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function t(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(f.prototype,{fromAttribute:function t(e,n,r){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,n,r)},lengthManhattan:function t(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),gt.prototype.computeTangents=function(){console.warn("THREE.Geometry: .computeTangents() has been removed.")},Object.assign(pt.prototype,{getChildByName:function t(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function t(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function t(e,n){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(n,e)}}),Object.defineProperties(pt.prototype,{eulerOrder:{get:function t(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function t(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function t(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function t(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(Ie.prototype,{objects:{get:function t(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Ce.prototype,"useVertexTexture",{get:function t(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function t(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Object.defineProperty(Sr.prototype,"__arcLengthDivisions",{get:function t(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function t(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),xe.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(qr.prototype,{onlyShadow:{set:function t(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function t(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function t(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function t(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function t(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function t(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function t(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function t(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function t(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function t(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function t(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function t(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function t(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(yt.prototype,{length:{get:function t(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}}}),Object.assign(Rt.prototype,{addIndex:function t(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addDrawCall:function t(e,n,r){void 0!==r&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,n)},clearDrawCalls:function t(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function t(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function t(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(Rt.prototype,{drawcalls:{get:function t(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function t(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Gi.prototype,{dynamic:{set:function t(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function t(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(nt.prototype,{wrapAround:{get:function t(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function t(){console.warn("THREE.Material: .wrapAround has been removed.")}},wrapRGB:{get:function t(){return console.warn("THREE.Material: .wrapRGB has been removed."),new $}},shading:{get:function t(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function t(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===e}}}),Object.defineProperties(lr.prototype,{metal:{get:function t(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function t(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(Dt.prototype,{derivatives:{get:function t(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function t(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(Ee.prototype,{getCurrentRenderTarget:function t(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function t(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function t(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function t(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function t(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function t(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function t(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function t(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function t(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function t(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function t(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function t(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function t(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function t(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function t(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function t(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function t(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")}}),Object.defineProperties(Ee.prototype,{shadowMapEnabled:{get:function t(){return this.shadowMap.enabled},set:function t(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function t(){return this.shadowMap.type},set:function t(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function t(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function t(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(ut.prototype,{cullFace:{get:function t(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function t(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function t(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function t(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function t(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function t(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(m.prototype,{wrapS:{get:function t(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function t(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function t(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function t(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function t(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function t(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function t(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function t(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function t(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function t(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function t(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function t(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function t(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function t(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function t(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function t(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function t(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function t(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function t(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function t(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Object.assign(we.prototype,{getStandingMatrix:function t(){console.warn("THREE.WebVRManager: .getStandingMatrix() has been removed.")}}),Object.defineProperties(we.prototype,{standing:{set:function t(){console.warn("THREE.WebVRManager: .standing has been removed.")}}}),Ii.prototype.load=function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var e=this,n;return(new Li).load(t,function(t){e.setBuffer(t)}),this},Oi.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Pi.prototype.updateCubeMap=function(t,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,e)};var _w=void 0,Sw=void 0,Mw=void 0,Ew=void 0,Tw=void 0;wo.prototype=Object.create(s.prototype),wo.prototype.constructor=wo,Object.assign(_o.prototype,{load:function t(e,n,r,i){var o=this,a=pw.extractUrlBase(e),s=new gr(this.manager);s.setResponseType("arraybuffer"),s.load(e,function(t){try{var r=o.parse(t,a);n(r)}catch(t){window.setTimeout(function(){i&&i(t),o.manager.itemError(e)},0)}},r,i)},parse:function t(e,n){var r=void 0;if(xa(e))r=(new va).parse(e);else{var i=Ea(e);if(!ba(i))throw new Error("FBXLoader: Unknown format.");if(wa(i)<7e3)throw new Error("FBXLoader: FBX version not supported, FileVersion: "+wa(i));r=(new ma).parse(i)}var o=So(r),a=Mo(r),s,c=Po(r,To(r,new _r(this.manager).setPath(n),a,o),o),u=Oo(r,o),h,l;return Wo(r,o,u,Fo(r,o,u),c)}});var Lw=[],Aw={ByPolygonVertex:{Direct:function t(e,n,r,i){var o=e*i.dataSize,a=e*i.dataSize+i.dataSize;return La(Lw,i.buffer,o,a)},IndexToDirect:function t(e,n,r,i){var o=i.indices[e],a=o*i.dataSize,s=o*i.dataSize+i.dataSize;return La(Lw,i.buffer,a,s)}},ByPolygon:{Direct:function t(e,n,r,i){var o=n*i.dataSize,a=n*i.dataSize+i.dataSize;return La(Lw,i.buffer,o,a)},IndexToDirect:function t(e,n,r,i){var o=i.indices[n],a=o*i.dataSize,s=o*i.dataSize+i.dataSize;return La(Lw,i.buffer,a,s)}},ByVertice:{Direct:function t(e,n,r,i){var o=r*i.dataSize,a=r*i.dataSize+i.dataSize;return La(Lw,i.buffer,o,a)}},AllSame:{IndexToDirect:function t(e,n,r,i){var o=i.indices[0]*i.dataSize,a=i.indices[0]*i.dataSize+i.dataSize;return La(Lw,i.buffer,o,a)}}};Object.assign(ma.prototype,{getPrevNode:function t(){return this.nodeStack[this.currentIndent-2]},getCurrentNode:function t(){return this.nodeStack[this.currentIndent-1]},getCurrentProp:function t(){return this.currentProp},pushStack:function t(e){this.nodeStack.push(e),this.currentIndent+=1},popStack:function t(){this.nodeStack.pop(),this.currentIndent-=1},setCurrentProp:function t(e,n){this.currentProp=e,this.currentPropName=n},parse:function t(e){this.currentIndent=0,this.allNodes=new ya,this.nodeStack=[],this.currentProp=[],this.currentPropName="";var n=this,r=e.split("\n");return r.forEach(function(t,e){var i=t.match(/^[\s\t]*;/),o=t.match(/^[\s\t]*$/);if(!i&&!o){var a=t.match("^\\t{"+n.currentIndent+"}(\\w+):(.*){",""),s=t.match("^\\t{"+n.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),c=t.match("^\\t{"+(n.currentIndent-1)+"}}");a?n.parseNodeBegin(t,a):s?n.parseNodeProperty(t,s,r[++e]):c?n.popStack():t.match(/^[^\s\t}]/)&&n.parseNodePropertyContinued(t)}}),this.allNodes},parseNodeBegin:function t(e,n){var r=n[1].trim().replace(/^"/,"").replace(/"$/,""),i=n[2].split(",").map(function(t){return t.trim().replace(/^"/,"").replace(/"$/,"")}),o={name:r},a=this.parseNodeAttr(i),s=this.getCurrentNode();0===this.currentIndent?this.allNodes.add(r,o):r in s?("PoseNode"===r?s.PoseNode.push(o):void 0!==s[r].id&&(s[r]={},s[r][s[r].id]=s[r]),""!==a.id&&(s[r][a.id]=o)):"number"==typeof a.id?(s[r]={},s[r][a.id]=o):"Properties70"!==r&&(s[r]="PoseNode"===r?[o]:o),"number"==typeof a.id&&(o.id=a.id),""!==a.name&&(o.attrName=a.name),""!==a.type&&(o.attrType=a.type),this.pushStack(o)},parseNodeAttr:function t(e){var n=e[0];""!==e[0]&&(n=parseInt(e[0]),isNaN(n)&&(n=e[0]));var r="",i="";return e.length>1&&(r=e[1].replace(/^(\w+)::/,""),i=e[2]),{id:n,name:r,type:i}},parseNodeProperty:function t(e,n,r){var i=n[1].replace(/^"/,"").replace(/"$/,"").trim(),o=n[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===i&&","===o&&(o=r.replace(/"/g,"").replace(/,$/,"").trim());var a=this.getCurrentNode(),s;if("Properties70"!==a.name){if("C"===i){var c=o.split(",").slice(1),u=parseInt(c[0]),h=parseInt(c[1]),l=o.split(",").slice(3);i="connections",Ta(o=[u,h],l=l.map(function(t){return t.trim().replace(/^"/,"")})),void 0===a[i]&&(a[i]=[])}"Node"===i&&(a.id=o),i in a&&Array.isArray(a[i])?a[i].push(o):"a"!==i?a[i]=o:a.a=o,this.setCurrentProp(a,i),"a"===i&&","!==o.slice(-1)&&(a.a=Sa(o))}else this.parseNodeSpecialProperty(e,i,o)},parseNodePropertyContinued:function t(e){var n=this.getCurrentNode();n.a+=e,","!==e.slice(-1)&&(n.a=Sa(n.a))},parseNodeSpecialProperty:function t(e,n,r){var i=r.split('",').map(function(t){return t.trim().replace(/^\"/,"").replace(/\s/,"_")}),o=i[0],a=i[1],s=i[2],c=i[3],u=i[4];switch(a){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":u=parseFloat(u);break;case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":u=Sa(u)}this.getPrevNode()[o]={type:a,type2:s,flag:c,value:u},this.setCurrentProp(this.getPrevNode(),o)}}),Object.assign(va.prototype,{parse:function t(e){var n=new ga(e);n.skip(23);var r=n.getUint32();console.log("FBXLoader: FBX binary version: "+r);for(var i=new ya;!this.endOfContent(n);){var o=this.parseNode(n,r);null!==o&&i.add(o.name,o)}return i},endOfContent:function t(e){return e.size()%16==0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()},parseNode:function t(e,n){var r={},i=n>=7500?e.getUint64():e.getUint32(),o=n>=7500?e.getUint64():e.getUint32(),a=n>=7500?e.getUint64():e.getUint32(),s=e.getUint8(),c=e.getString(s);if(0===i)return null;for(var u=[],h=0;h<o;h++)u.push(this.parseProperty(e));var l=u.length>0?u[0]:"",d=u.length>1?u[1]:"",p=u.length>2?u[2]:"";for(r.singleProperty=!(1!==o||e.getOffset()!==i);i>e.getOffset();){var f=this.parseNode(e,n);null!==f&&this.parseSubNode(c,r,f)}return r.propertyList=u,"number"==typeof l&&(r.id=l),""!==d&&(r.attrName=d),""!==p&&(r.attrType=p),""!==c&&(r.name=c),r},parseSubNode:function t(e,n,r){if(!0===r.singleProperty){var i=r.propertyList[0];Array.isArray(i)?(n[r.name]=r,r.a=i):n[r.name]=i}else if("Connections"===e&&"C"===r.name){var o=[];r.propertyList.forEach(function(t,e){0!==e&&o.push(t)}),void 0===n.connections&&(n.connections=[]),n.connections.push(o)}else if("Properties70"===r.name){var a;Object.keys(r).forEach(function(t){n[t]=r[t]})}else if("Properties70"===e&&"P"===r.name){var s=r.propertyList[0],c=r.propertyList[1],u=r.propertyList[2],h=r.propertyList[3],l=void 0;0===s.indexOf("Lcl ")&&(s=s.replace("Lcl ","Lcl_")),0===c.indexOf("Lcl ")&&(c=c.replace("Lcl ","Lcl_")),l="ColorRGB"===c||"Vector"===c||"Vector3D"===c||0===c.indexOf("Lcl_")?[r.propertyList[4],r.propertyList[5],r.propertyList[6]]:r.propertyList[4],n[s]={type:c,type2:u,flag:h,value:l}}else void 0===n[r.name]?"number"==typeof r.id?(n[r.name]={},n[r.name][r.id]=r):n[r.name]=r:"PoseNode"===r.name?(Array.isArray(n[r.name])||(n[r.name]=[n[r.name]]),n[r.name].push(r)):void 0===n[r.name][r.id]&&(n[r.name][r.id]=r)},parseProperty:function t(e){var n=e.getString(1);switch(n){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":var r=e.getUint32();return e.getArrayBuffer(r);case"S":var r=e.getUint32();return e.getString(r);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":var i=e.getUint32(),o=e.getUint32(),a=e.getUint32();if(0===o)switch(n){case"b":case"c":return e.getBooleanArray(i);case"d":return e.getFloat64Array(i);case"f":return e.getFloat32Array(i);case"i":return e.getInt32Array(i);case"l":return e.getInt64Array(i)}if(void 0===window.Zlib)throw new Error("FBXLoader: External library Inflate.min.js required, obtain or import from https://github.com/imaya/zlib.js");var s,c=new ga(new Zlib.Inflate(new Uint8Array(e.getArrayBuffer(a))).decompress().buffer);switch(n){case"b":case"c":return c.getBooleanArray(i);case"d":return c.getFloat64Array(i);case"f":return c.getFloat32Array(i);case"i":return c.getInt32Array(i);case"l":return c.getInt64Array(i)}default:throw new Error("FBXLoader: Unknown property type "+n)}}}),Object.assign(ga.prototype,{getOffset:function t(){return this.offset},size:function t(){return this.dv.buffer.byteLength},skip:function t(e){this.offset+=e},getBoolean:function t(){return 1==(1&this.getUint8())},getBooleanArray:function t(e){for(var n=[],r=0;r<e;r++)n.push(this.getBoolean());return n},getUint8:function t(){var e=this.dv.getUint8(this.offset);return this.offset+=1,e},getInt16:function t(){var e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e},getInt32:function t(){var e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e},getInt32Array:function t(e){for(var n=[],r=0;r<e;r++)n.push(this.getInt32());return n},getUint32:function t(){var e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e},getInt64:function t(){var e=void 0,n=void 0;return this.littleEndian?(e=this.getUint32(),n=this.getUint32()):(n=this.getUint32(),e=this.getUint32()),2147483648&n?(n=4294967295&~n,4294967295===(e=4294967295&~e)&&(n=n+1&4294967295),e=e+1&4294967295,-(4294967296*n+e)):4294967296*n+e},getInt64Array:function t(e){for(var n=[],r=0;r<e;r++)n.push(this.getInt64());return n},getUint64:function t(){var e=void 0,n=void 0;return this.littleEndian?(e=this.getUint32(),n=this.getUint32()):(n=this.getUint32(),e=this.getUint32()),4294967296*n+e},getFloat32:function t(){var e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e},getFloat32Array:function t(e){for(var n=[],r=0;r<e;r++)n.push(this.getFloat32());return n},getFloat64:function t(){var e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e},getFloat64Array:function t(e){for(var n=[],r=0;r<e;r++)n.push(this.getFloat64());return n},getArrayBuffer:function t(e){var n=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,n},getString:function t(e){for(var n=new Uint8Array(e),r=0;r<e;r++)n[r]=this.getUint8();var i=n.indexOf(0);return i>=0&&(n=n.slice(0,i)),pw.decodeText(n)}}),Object.assign(ya.prototype,{add:function t(e,n){this[e]=n}});var Pw=document.querySelector("#canvas"),Rw=document.querySelector("#container"),Iw={bar:document.querySelector("#loading-bar"),overlay:document.querySelector("#loading-overlay"),revealOnLoad:document.querySelectorAll(".reveal-on-load"),hideOnLoad:document.querySelectorAll(".hide-on-load"),progress:document.querySelector("#progress")},Cw={selectedFrameMessages:document.querySelectorAll(".selected-frame-message"),selectedGroupMessages:document.querySelectorAll(".selected-group-message")},Ow={elem:document.querySelector("#controls"),frames:{section:document.querySelector("#frame-controls"),table:document.querySelector("#frames"),thead:document.querySelector("#frames-thead"),createButton:document.querySelector("#create-frame-button")},groups:{table:document.querySelector("#groups"),createButton:document.querySelector("#create-group-button")},dance:{framerate:document.querySelector("#framerate"),advancedControlToggle:document.querySelector("#advanced-control-toggle"),advancedControlSection:document.querySelector("#advanced-control"),advancedControlInput:document.querySelector("#advanced-control-input"),table:document.querySelector("#dance-details"),addFrameButton:document.querySelector("#add-frame-to-dance"),addGroupButton:document.querySelector("#add-group-to-dance"),playButton:document.querySelector("#dance-button"),playSymbol:document.querySelector("#play-symbol"),resetButton:document.querySelector("#reset-dance")},music:{uploadMP3Button:document.querySelector("#upload-mp3-button"),uploadMP3Input:document.querySelector("#upload-mp3-input"),tracks:document.querySelector("#loaded-tracks"),play:document.querySelector("#play-music"),stop:document.querySelector("#stop-music")},file:{save:document.querySelector("#save-dance"),load:document.querySelector("#load-dance"),fileInput:document.querySelector("#file-input"),examples:document.querySelector("#examples"),loadExample:document.querySelector("#load-example"),resetButton:document.querySelector("#reset-all")}},Nw=function(){function t(){$b(this,t)}return tw(t,null,[{key:"setInitialState",value:function t(){}},{key:"setOnLoadStartState",value:function t(){Iw.bar.classList.remove("hide")}},{key:"setOnLoadEndState",value:function t(){Iw.overlay.classList.add("hide");for(var e=0;e<Iw.hideOnLoad.length;e++)Iw.hideOnLoad[e].classList.add("hide");for(var n=0;n<Iw.revealOnLoad.length;n++)Iw.revealOnLoad[n].classList.remove("hide")}},{key:"setSelectedFrameMessage",value:function t(e){for(var n=0;n<Cw.selectedFrameMessages.length;n++)Cw.selectedFrameMessages[n].innerHTML=e}},{key:"setSelectedGroupMessage",value:function t(e){for(var n=0;n<Cw.selectedGroupMessages.length;n++)Cw.selectedGroupMessages[n].innerHTML=e}}]),t}();Nw.canvas=Pw,Nw.container=Rw,Nw.loading=Iw,Nw.controls=Ow;var Fw=new vr,Dw=0,Uw=null;Fw.onStart=function(){null===Uw&&(Nw.setOnLoadStartState(),Uw=setInterval(function(){(Dw+=5)>=100?clearInterval(Uw):Nw.loading.progress.style.width=Dw+"%"},100))},Fw.onLoad=function(){clearInterval(Uw)},Fw.onProgress=function(){Dw>=100||(Dw+=5,Nw.loading.progress.style.width=Dw+"%")},Fw.onError=function(t){t instanceof String&&""===t||(console.error("LoadingManager error: "+t),clearInterval(Uw))};var Bw=null,zw=null,Gw=function t(e){console.log(e)},kw=function t(e){return function(t){return new Promise(function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Gw;e.load(t,n,Fw.onProgress,r)})}},jw,Vw=new function t(){return $b(this,t),{get fbxLoader(){return null===Bw&&(Bw=kw(new _o(Fw))),Bw},get audioLoader(){return null===zw&&(zw=kw(new Li(Fw))),zw}}},Hw=function(){function t(e){$b(this,t),this.model=e,this.initParts(),this.initConstraints(),this.initDefaultPose()}return tw(t,[{key:"initDefaultPose",value:function t(){this.headInitialQuaternion=this.head.quaternion.clone(),this.leftShoulderInitialQuaternion=this.leftShoulder.quaternion.clone(),this.rightShoulderInitialQuaternion=this.rightShoulder.quaternion.clone(),this.leftElbowInitialQuaternion=this.leftElbow.quaternion.clone(),this.rightElbowInitialQuaternion=this.rightElbow.quaternion.clone()}},{key:"initParts",value:function t(){this.head=this.model.getObjectByName("head"),this.leftShoulder=this.model.getObjectByName("leftShoulder"),this.rightShoulder=this.model.getObjectByName("rightShoulder"),this.leftElbow=this.model.getObjectByName("leftElbow"),this.rightElbow=this.model.getObjectByName("rightElbow")}},{key:"initConstraints",value:function t(){this.constraints={headPitchMin:-38.4,headPitchMax:29.5,headYawMin:-119.5,headYawMax:119.5,shoulderPitchMin:-119.5,shoulderPitchMax:119.5,shoulderYawMin:.5,shoulderYawMax:94.5,elbowPitchMin:.5,elbowPitchMax:89.5,elbowYawMin:-119.5,elbowYawMax:119.5}}},{key:"reset",value:function t(){this.head.quaternion.copy(this.headInitialQuaternion),this.leftShoulder.quaternion.copy(this.leftShoulderInitialQuaternion),this.rightShoulder.quaternion.copy(this.rightShoulderInitialQuaternion),this.leftElbow.quaternion.copy(this.leftElbowInitialQuaternion),this.rightElbow.quaternion.copy(this.rightElbowInitialQuaternion)}}]),t}(),Ww=document.createElement("a");Ww.style.display="none",document.body.appendChild(Ww);var Yw=function t(e,n){Ww.href=URL.createObjectURL(e),Ww.download=n||"data.json",Ww.click()},Xw=function t(e,n){Yw(new Blob([e],{type:"text/plain"}),n)},qw=function t(e){var n=JSON.stringify(e,null,"\t");Xw(n,"dance.json")},Zw=function(){function t(e,n,r){$b(this,t),this.frames=e,this.groups=n,this.dance=r,this.initSaveButton(),this.initLoadButton(),this.initExamples(),this.initResetButton()}return tw(t,[{key:"load",value:function t(e){e.metadata&&"Nao Dance File"===e.metadata.type?(this.resetAll(),this.frames.fromJSON(e.frames),this.groups.fromJSON(e.groups),this.dance.fromJSON(e.dance)):console.error("Wrong JSON format - cannot load dance!")}},{key:"initSaveButton",value:function t(){var e=this;Nw.controls.file.save.addEventListener("click",function(t){t.preventDefault();var n={metadata:{type:"Nao Dance File",generator:"Blackthread design",version:"1"}};n.frames=e.frames.toJSON(),n.groups=e.groups.toJSON(),n.dance=e.dance.toJSON(),qw(n)})}},{key:"initLoadButton",value:function t(){var e=this;Nw.controls.file.load.addEventListener("click",function(t){t.preventDefault(),Nw.controls.file.fileInput.click()}),Nw.controls.file.fileInput.addEventListener("change",function(t){var n=t.target.files[0],r=new FileReader;r.readAsText(n),r.onload=function(t){try{var r=JSON.parse(t.target.result);e.load(r)}catch(t){console.error("Error while trying to read "+n.name+" as JSON: "+t)}},Nw.controls.file.fileInput.value=""})}},{key:"initResetButton",value:function t(){var e=this;Nw.controls.file.resetButton.addEventListener("click",function(t){t.preventDefault(),confirm("This will reset everything! Are you sure?")&&e.resetAll()})}},{key:"resetAll",value:function t(){this.frames.reset(),this.groups.reset(),this.dance.reset(),Nw.controls.music.stop.click(),this.frames.createInitialFrames(),this.groups.newGroupButton.click()}},{key:"initExamples",value:function t(){var e=this,n=Nw.controls.file.examples;Nw.controls.file.loadExample.addEventListener("click",function(t){t.preventDefault();var r="/assets/models/robot_dance/examples/"+n.options[n.selectedIndex].value+".json";fetch(r).then(function(t){return t.json()}).then(function(t){return e.load(t)}).catch(function(t){return console.log(t)})})}}]),t}(),Jw=function(){function t(e,n){var r=this;$b(this,t),this.isPlaying=!1,this.isPaused=!1,this.audioDirectory="/assets/audio/robot_dance/",this.playButton=Nw.controls.music.play,this.stopButton=Nw.controls.music.stop,this.listener=new Ri,this.listener.setMasterVolume(10),n.add(this.listener),this.soundsEmitters=[],this.buffers={},e.forEach(function(t){var e=new Ci(r.listener);e.setRefDistance(30),e.setRolloffFactor(1.5),e.setDistanceModel("inverse"),r.soundsEmitters.push(e),t.add(e)}),this.initPlayButton(),this.initStopButton(),this.initUploadButton(),this.initSelectionMenu(),this.loadExamples()}return tw(t,[{key:"load",value:function t(e){var n=this;Vw.audioLoader(this.audioDirectory+e).then(function(t){n.buffers[e]=t;var r=document.createElement("option");r.value=e,r.innerHTML=e.replace(/_/g," ").replace(".mp3",""),Nw.controls.music.tracks.appendChild(r),n.playButton.disabled=!1})}},{key:"loadExamples",value:function t(){var e=this,n;["Chinese_Man_Miss_Chang","DJ_Kormac_Rainstorm","Gramatik_Day_Of_The_So_Called_Glory","Lindsey_Stirling_Crystalize"].forEach(function(t){e.load(t+".mp3")})}},{key:"play",value:function t(){if(void 0===this.soundsEmitters[0].source){var e=Nw.controls.music.tracks.options[Nw.controls.music.tracks.selectedIndex];void 0!==e&&this.setTrack(e.value)}this.soundsEmitters.forEach(function(t){t.play()}),this.playButton.innerHTML="Pause",this.isPlaying=!0,this.isPaused=!1}},{key:"pause",value:function t(){this.isPlaying&&(this.soundsEmitters.forEach(function(t){t.pause()}),this.playButton.innerHTML="Play",this.isPaused=!0)}},{key:"reset",value:function t(){this.playButton.innerHTML="Play",this.soundsEmitters.forEach(function(t){void 0!==t.source&&t.stop()}),this.isPlaying=!1,this.isPaused=!1}},{key:"setTrack",value:function t(e){this.reset();var n=this.buffers[e];this.soundsEmitters.forEach(function(t){t.setBuffer(n)})}},{key:"initPlayButton",value:function t(){var e=this;this.playButton.addEventListener("click",function(t){t.preventDefault(),!e.isPaused&&e.isPlaying?e.pause():e.play()})}},{key:"initStopButton",value:function t(){var e=this;this.stopButton.addEventListener("click",function(t){t.preventDefault(),e.reset()})}},{key:"initUploadButton",value:function t(){var e=this;Nw.controls.music.uploadMP3Button.addEventListener("click",function(t){t.preventDefault(),Nw.controls.music.uploadMP3Input.click()}),Nw.controls.music.uploadMP3Input.addEventListener("change",function(t){var n=t.target.files[0],r=n.name,i=document.createElement("option");i.value=r,i.disabled=!0,i.innerHTML=r.replace(".mp3",""),Nw.controls.music.tracks.appendChild(i),Nw.controls.music.tracks.value=r;var o=new FileReader;o.readAsArrayBuffer(n),o.onload=function(t){var n;yw.getContext().decodeAudioData(t.target.result,function(t){e.buffers[r]=t,i.disabled=!1})}})}},{key:"initSelectionMenu",value:function t(){var e=this;Nw.controls.music.tracks.addEventListener("input",function(t){t.preventDefault();var n=t.target.options[t.target.selectedIndex].value;e.setTrack(n)})}}]),t}(),Qw=function t(e,n){$b(this,t);var r=document.createElement("td");return e.appendChild(r),r.innerHTML=n,r},Kw=function t(e,n,r,i,o){$b(this,t);var a=document.createElement("span");a.innerHTML=o[0].toUpperCase()+o.substr(1,o.length)+": ";var s=document.createElement("input");return s.type="number",s.min=r,s.max=i,s.step=1,s.value="",a.appendChild(s),n.appendChild(a),s.addEventListener("mousedown",function(){e.click()}),s},$w=function(){function t(e){var n=this;$b(this,t);var r=document.createElement("td");this.button=document.createElement("button"),this.button.innerHTML='<span class="fa fa-lg fa-undo" aria-hidden="true"></span>',r.appendChild(this.button),e.appendChild(r),this.onClick=function(){},this.click=function(t){t&&t.preventDefault(),n.onClick()},this.button.addEventListener("click",this.click)}return tw(t,[{key:"disabled",set:function t(e){this.button.disabled=!0}}]),t}(),t_=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];$b(this,t),this.type="frame",this.num=n,this.robot=e,this._selected=!1,r?this.setFlags(!0):(this.createTableEntry(n),this.initControlFunctions(),this.setFlags(!1)),this.initQuaternions(),this.setValues(0)}return tw(t,[{key:"createTableEntry",value:function t(e){var n=this,r=this.robot.constraints;this.row=document.createElement("tr"),new Qw(this.row,e+1);var i=document.createElement("td");this.row.appendChild(i),this.headPitchInput=new Kw(this.row,i,r.headPitchMin,r.headPitchMax,"pitch"),this.headYawInput=new Kw(this.row,i,r.headYawMin,r.headYawMax,"yaw");var o=document.createElement("td");this.row.appendChild(o),this.leftShoulderPitchInput=new Kw(this.row,o,r.shoulderPitchMin,r.shoulderPitchMax,"pitch"),this.leftShoulderYawInput=new Kw(this.row,o,r.shoulderYawMin,r.shoulderYawMax,"yaw");var a=document.createElement("td");this.row.appendChild(a),this.rightShoulderPitchInput=new Kw(this.row,a,r.shoulderPitchMin,r.shoulderPitchMax,"pitch"),this.rightShoulderYawInput=new Kw(this.row,a,r.shoulderYawMin,r.shoulderYawMax,"yaw");var s=document.createElement("td");this.row.appendChild(s),this.leftElbowPitchInput=new Kw(this.row,s,r.elbowPitchMin,r.elbowPitchMax,"pitch"),this.leftElbowYawInput=new Kw(this.row,s,r.elbowYawMin,r.elbowYawMax,"yaw");var c=document.createElement("td");this.row.appendChild(c),this.rightElbowPitchInput=new Kw(this.row,c,r.elbowPitchMin,r.elbowPitchMax,"pitch"),this.rightElbowYawInput=new Kw(this.row,c,r.elbowYawMin,r.elbowYawMax,"yaw"),this.resetButton=new $w(this.row);var u=function t(){n.reset()};this.resetButton.onClick=u}},{key:"addEventListeners",value:function t(){this.headPitchInput.addEventListener("input",this.controlFunctions.headPitch),this.headYawInput.addEventListener("input",this.controlFunctions.headYaw),this.leftShoulderPitchInput.addEventListener("input",this.controlFunctions.leftShoulderPitch),this.leftShoulderYawInput.addEventListener("input",this.controlFunctions.leftShoulderYaw),this.rightShoulderPitchInput.addEventListener("input",this.controlFunctions.rightShoulderPitch),this.rightShoulderYawInput.addEventListener("input",this.controlFunctions.rightShoulderYaw),this.leftElbowPitchInput.addEventListener("input",this.controlFunctions.leftElbowPitch),this.leftElbowYawInput.addEventListener("input",this.controlFunctions.leftElbowYaw),this.rightElbowPitchInput.addEventListener("input",this.controlFunctions.rightElbowPitch),this.rightElbowYawInput.addEventListener("input",this.controlFunctions.rightElbowYaw)}},{key:"removeEventListeners",value:function t(){this.headPitchInput.removeEventListener("input",this.controlFunctions.headPitch),this.headYawInput.removeEventListener("input",this.controlFunctions.headYaw),this.leftShoulderPitchInput.removeEventListener("input",this.controlFunctions.leftShoulderPitch),this.leftShoulderYawInput.removeEventListener("input",this.controlFunctions.leftShoulderYaw),this.rightShoulderPitchInput.removeEventListener("input",this.controlFunctions.rightShoulderPitch),this.rightShoulderYawInput.removeEventListener("input",this.controlFunctions.rightShoulderYaw),this.leftElbowPitchInput.removeEventListener("input",this.controlFunctions.leftElbowPitch),this.leftElbowYawInput.removeEventListener("input",this.controlFunctions.leftElbowYaw),this.rightElbowPitchInput.removeEventListener("input",this.controlFunctions.rightElbowPitch),this.rightElbowYawInput.removeEventListener("input",this.controlFunctions.rightElbowYaw)}},{key:"setFlags",value:function t(e){this.headPitchSet=e,this.headYawSet=e,this.leftShoulderPitchSet=e,this.leftShoulderYawSet=e,this.rightShoulderPitchSet=e,this.rightShoulderYawSet=e,this.leftElbowPitchSet=e,this.leftElbowYawSet=e,this.rightElbowPitchSet=e,this.rightElbowYawSet=e}},{key:"initQuaternions",value:function t(){this.headQuaternion=this.robot.headInitialQuaternion.clone(),this.leftShoulderQuaternion=this.robot.leftShoulderInitialQuaternion.clone(),this.rightShoulderQuaternion=this.robot.rightShoulderInitialQuaternion.clone(),this.leftElbowQuaternion=this.robot.leftElbowInitialQuaternion.clone(),this.rightElbowQuaternion=this.robot.rightElbowInitialQuaternion.clone()}},{key:"setValues",value:function t(e){e=e||0,this.headPitchValue=e,this.headYawValue=e,this.leftShoulderPitchValue=e,this.leftShoulderYawValue=e,this.rightShoulderPitchValue=e,this.rightShoulderYawValue=e,this.leftElbowPitchValue=e,this.leftElbowYawValue=e,this.rightElbowPitchValue=e,this.rightElbowYawValue=e}},{key:"initControlFunctions",value:function t(){var e=this,n=new l(1,0,0),r=new l(0,1,0),i=new l(0,0,1),o=function t(n,r,i,o,a){var s=void 0;""!==n&&(n instanceof Event?(n.preventDefault(),s=Ry.degToRad(i*n.target.value)):s=Ry.degToRad(i*n),e.robot[r].rotateOnAxis(a,e[r+o+"Value"]-s),e[r+o+"Value"]=s,e[r+o+"Set"]=!0,e[r+"Quaternion"].copy(e.robot[r].quaternion))};this.controlFunctions={headPitch:function t(e){return o(e,"head",1,"Pitch",i)},headYaw:function t(e){return o(e,"head",1,"Yaw",n)},leftShoulderPitch:function t(e){return o(e,"leftShoulder",-1,"Pitch",i)},leftShoulderYaw:function t(e){return o(e,"leftShoulder",-1,"Yaw",r)},rightShoulderPitch:function t(e){return o(e,"rightShoulder",-1,"Pitch",i)},rightShoulderYaw:function t(e){return o(e,"rightShoulder",1,"Yaw",r)},leftElbowPitch:function t(e){return o(e,"leftElbow",1,"Pitch",r)},leftElbowYaw:function t(e){return o(e,"leftElbow",-1,"Yaw",i)},rightElbowPitch:function t(e){return o(e,"rightElbow",-1,"Pitch",r)},rightElbowYaw:function t(e){return o(e,"rightElbow",-1,"Yaw",i)}}}},{key:"setRotations",value:function t(){this.robot.head.quaternion.copy(this.headQuaternion),this.robot.leftShoulder.quaternion.copy(this.leftShoulderQuaternion),this.robot.rightShoulder.quaternion.copy(this.rightShoulderQuaternion),this.robot.leftElbow.quaternion.copy(this.leftElbowQuaternion),this.robot.rightElbow.quaternion.copy(this.rightElbowQuaternion)}},{key:"setValuesAndQuaternionsFromInputs",value:function t(){this.controlFunctions.headPitch(this.headPitchInput.value),this.controlFunctions.headYaw(this.headYawInput.value),this.controlFunctions.leftShoulderPitch(this.leftShoulderPitchInput.value),this.controlFunctions.leftShoulderYaw(this.leftShoulderYawInput.value),this.controlFunctions.rightShoulderPitch(this.rightShoulderPitchInput.value),this.controlFunctions.rightShoulderYaw(this.rightShoulderYawInput.value),this.controlFunctions.leftElbowPitch(this.leftElbowPitchInput.value),this.controlFunctions.leftElbowYaw(this.leftElbowYawInput.value),this.controlFunctions.rightElbowPitch(this.rightElbowPitchInput.value),this.controlFunctions.rightElbowYaw(this.rightElbowYawInput.value)}},{key:"reset",value:function t(){this.headPitchInput.value="",this.headYawInput.value="",this.leftShoulderPitchInput.value="",this.leftShoulderYawInput.value="",this.rightShoulderPitchInput.value="",this.rightShoulderYawInput.value="",this.leftElbowPitchInput.value="",this.leftElbowYawInput.value="",this.rightElbowPitchInput.value="",this.rightElbowYawInput.value="",this.setFlags(!1),this.setValues(),this.initQuaternions(),this.setRotations()}},{key:"fromJSON",value:function t(e){this.reset(),this.headPitchInput.value=e.headPitch,this.headYawInput.value=e.headYaw,this.leftShoulderPitchInput.value=e.leftShoulderPitch,this.leftShoulderYawInput.value=e.leftShoulderYaw,this.rightShoulderPitchInput.value=e.rightShoulderPitch,this.rightShoulderYawInput.value=e.rightShoulderYaw,this.leftElbowPitchInput.value=e.leftElbowPitch,this.leftElbowYawInput.value=e.leftElbowYaw,this.rightElbowPitchInput.value=e.rightElbowPitch,this.rightElbowYawInput.value=e.rightElbowYaw,this.headPitchSet=""!==this.headPitchInput.value,this.headYawSet=""!==this.headYawInput.value,this.leftShoulderPitchSet=""!==this.leftShoulderPitchInput.value,this.leftShoulderYawSet=""!==this.leftShoulderYawInput.value,this.rightShoulderPitchSet=""!==this.rightShoulderPitchInput.value,this.rightShoulderYawSet=""!==this.rightShoulderYawInput.value,this.leftElbowPitchSet=""!==this.leftElbowPitchInput.value,this.leftElbowYawSet=""!==this.leftElbowYawInput.value,this.rightElbowPitchSet=""!==this.rightElbowPitchInput.value,this.rightElbowYawSet=""!==this.headPitchInput.value,this.setValuesAndQuaternionsFromInputs()}},{key:"toJSON",value:function t(){return{headPitch:this.headPitchInput.value,headYaw:this.headYawInput.value,leftShoulderPitch:this.leftShoulderPitchInput.value,leftShoulderYaw:this.leftShoulderYawInput.value,rightShoulderPitch:this.rightShoulderPitchInput.value,rightShoulderYaw:this.rightShoulderYawInput.value,leftElbowPitch:this.leftElbowPitchInput.value,leftElbowYaw:this.leftElbowYawInput.value,rightElbowPitch:this.rightElbowPitchInput.value,rightElbowYaw:this.rightElbowYawInput.value}}},{key:"selected",set:function t(e){this._selected!==e&&(!0===e?(this.row&&this.row.classList.add("selected"),this.setRotations(),this.addEventListeners(),this._selected=!0):(this.row&&this.row.classList.remove("selected"),this.removeEventListeners(),this._selected=!1))}}]),t}(),e_=1,n_,r_=new(function(){function t(){var e=this;$b(this,t),this.defaultFrame=null,this.frames=null,this.groups=null,this.dance=null,this.actions=[],Nw.controls.dance.framerate.addEventListener("input",function(t){t.preventDefault(),e.framerate=t.target.value}),this.onFinish=function(){}}return tw(t,[{key:"setDance",value:function t(e){return this.dance=e,this.frames=e.frames,this.groups=e.groups,this}},{key:"initMixer",value:function t(e){var n=this;this.mixer=new zi(e),this.mixer.addEventListener("finished",function(){n.onFinish()})}},{key:"onUpdate",value:function t(e){this.mixer&&this.mixer.update(e*e_)}},{key:"createAnimation",value:function t(e){if(this.reset(),!(e.length<2)){for(var n=[e[0].headQuaternion.x,e[0].headQuaternion.y,e[0].headQuaternion.z,e[0].headQuaternion.w],r=[e[0].leftShoulderQuaternion.x,e[0].leftShoulderQuaternion.y,e[0].leftShoulderQuaternion.z,e[0].leftShoulderQuaternion.w],i=[e[0].rightShoulderQuaternion.x,e[0].rightShoulderQuaternion.y,e[0].rightShoulderQuaternion.z,e[0].rightShoulderQuaternion.w],o=[e[0].leftElbowQuaternion.x,e[0].leftElbowQuaternion.y,e[0].leftElbowQuaternion.z,e[0].leftElbowQuaternion.w],a=[e[0].rightElbowQuaternion.x,e[0].rightElbowQuaternion.y,e[0].rightElbowQuaternion.z,e[0].rightElbowQuaternion.w],s=[0],c=1;c<e.length;c++)s.push(c),n.push(e[c].headQuaternion.x,e[c].headQuaternion.y,e[c].headQuaternion.z,e[c].headQuaternion.w),r.push(e[c].leftShoulderQuaternion.x,e[c].leftShoulderQuaternion.y,e[c].leftShoulderQuaternion.z,e[c].leftShoulderQuaternion.w),i.push(e[c].rightShoulderQuaternion.x,e[c].rightShoulderQuaternion.y,e[c].rightShoulderQuaternion.z,e[c].rightShoulderQuaternion.w),o.push(e[c].leftElbowQuaternion.x,e[c].leftElbowQuaternion.y,e[c].leftElbowQuaternion.z,e[c].leftElbowQuaternion.w),a.push(e[c].rightElbowQuaternion.x,e[c].rightElbowQuaternion.y,e[c].rightElbowQuaternion.z,e[c].rightElbowQuaternion.w);var u=[new ci("head.quaternion",s,n),new ci("leftShoulder.quaternion",s,r),new ci("rightShoulder.quaternion",s,i),new ci("leftElbow.quaternion",s,o),new ci("rightElbow.quaternion",s,a)];this.createAction("headControl.quaternion",u)}}},{key:"createAction",value:function t(e,n){var r=new vi(e,-1,n);return this.action=this.mixer.clipAction(r),this.action.clampWhenFinished=!0,this.action.loop=2200,this.action.name=r.name,this.action}},{key:"play",value:function t(){this.action&&this.action.play()}},{key:"reset",value:function t(){this.action&&(this.action.stop(),this.action=null,this.frames.robot.reset())}},{key:"framerate",set:function t(e){e_=e},get:function t(){return e_}}]),t}()),i_=function(){function t(e){$b(this,t),this.robot=e,this.defaultFrame=new t_(this.robot,!0),this.currentFrameNum=0,this.selectedFrameNum=-1,this.frames=[],this.framesTable=Nw.controls.frames.table,this.newFrameButton=Nw.controls.frames.createButton,this.initNewFrameButton()}return tw(t,[{key:"removeFrame",value:function t(e){Nw.controls.frames.table.removeChild(e.row),e.reset(),e.removeEventListeners()}},{key:"createFrame",value:function t(e){var n=this,r=new t_(this.robot,this.currentFrameNum);return void 0!==e&&r.fromJSON(e),this.frames[this.currentFrameNum]=r,this.framesTable.appendChild(r.row),this.select(this.currentFrameNum),r.row.addEventListener("click",function(t){t.preventDefault(),n.select(r.num)}),this.currentFrameNum++,r}},{key:"createInitialFrames",value:function t(){this.newFrameButton.click(),this.newFrameButton.click(),this.newFrameButton.click(),this.select(0)}},{key:"initNewFrameButton",value:function t(){var e=this;this.newFrameButton.addEventListener("click",function(t){t.preventDefault(),e.createFrame(),e.currentFrameNum>=30&&(e.newFrameButton.innerHTML="Limit Reached!",e.newFrameButton.disabled=!0)}),this.createInitialFrames()}},{key:"select",value:function t(e){r_.reset();var n=this.frames[e];void 0!==n&&(n.selected=!0),this.selectedFrameNum=e;for(var r=0;r<this.frames.length;r++)r!==e&&(this.frames[r].selected=!1);-1===e?Nw.setSelectedFrameMessage("No frame selected"):Nw.setSelectedFrameMessage("Frame "+(e+1)+" is selected")}},{key:"deselectAll",value:function t(){this.select(-1),this.defaultFrame.selected=!0}},{key:"reset",value:function t(){var e=this;this.frames.forEach(function(t){e.removeFrame(t)}),this.selectedFrameNum=-1,this.currentFrameNum=0,this.frames=[]}},{key:"fromJSON",value:function t(e){this.reset();for(var n in e)this.createFrame(e[n]);this.deselectAll()}},{key:"toJSON",value:function t(){for(var e={},n=0;n<this.frames.length;n++){var r=this.frames[n];e[n]=null!==r?r.toJSON():null}return e}}]),t}(),o_=function(){function t(e,n){var r=this;$b(this,t);var i=document.createElement("td");this.button=document.createElement("button"),void 0!==n&&(this.button.title=n),this.button.innerHTML='<span class="fa fa-lg fa-trash-o" aria-hidden="true"></span>',i.appendChild(this.button),e.appendChild(i),this.onClick=function(){},this.click=function(t){t&&t.preventDefault(),r.onClick()},this.button.addEventListener("click",this.click)}return tw(t,[{key:"disabled",set:function t(e){this.button.disabled=!0}}]),t}(),a_=function(){function t(e,n){$b(this,t),this.type="group",this.frames=n,this.robot=n.robot,this.valid=!1,this.num=e,this.initTableRow(),this.initAddFrameButton(),this._selected=!1}return tw(t,[{key:"initTableRow",value:function t(){var e=this;this.row=document.createElement("tr"),new Qw(this.row,this.num+1);var n=new Qw(this.row,"<h4>Frames in Group</h4>");this.addFrameButton=document.createElement("button"),this.addFrameButton.classList.add("add-selected-frame-button"),this.addFrameButton.innerHTML="Add Selected Frame",n.appendChild(this.addFrameButton);var r=document.createElement("table");this.framesInGroup=document.createElement("tbody"),this.framesInGroup.classList.add("frames-in-group"),r.appendChild(this.framesInGroup),n.appendChild(r),this.resetButton=new o_(this.row,"Remove all frames from group"),this.resetButton.onClick=function(){return e.reset()}}},{key:"addFrame",value:function t(e){var n=this,r=document.createElement("tr");r.dataset.frameNumber=e.num,this.framesInGroup.appendChild(r),new Qw(r,"Frame #"+(e.num+1));var i;new o_(r).onClick=function(){n.framesInGroup.contains(r)&&n.framesInGroup.removeChild(r),n.lastAddedFrameNum===e.num&&(n.lastAddedFrameNum=null),n.createAnimation()},this.selected=!0}},{key:"initAddFrameButton",value:function t(){var e=this;this.lastAddedFrameNum=null,this.addFrameButton.addEventListener("click",function(t){t.preventDefault();var n=e.frames.frames[e.frames.selectedFrameNum];void 0!==n&&null!==n&&(e.lastAddedFrameNum=n,e.addFrame(n),e.createAnimation(),r_.play())})}},{key:"getFrames",value:function t(){var e=this,n=[];return this.framesInGroup.childNodes.forEach(function(t){"TR"===t.nodeName&&n.push(e.frames.frames[t.dataset.frameNumber])}),n}},{key:"createAnimation",value:function t(){r_.createAnimation(this.getFrames())}},{key:"reset",value:function t(){for(;this.framesInGroup.firstChild;)this.framesInGroup.removeChild(this.framesInGroup.firstChild);r_.reset(),this.selected=!1}},{key:"fromJSON",value:function t(e){this.reset();for(var n in e){var r=e[n];this.addFrame(this.frames.frames[parseInt(r.frameNum)])}this.createAnimation()}},{key:"toJSON",value:function t(){var e={},n=0;return this.framesInGroup.childNodes.forEach(function(t){"TR"===t.nodeName&&(e[n]={frameNum:t.dataset.frameNumber},n++)}),e}},{key:"selected",set:function t(e){this._selected!==e&&(!0===e?(this.row.classList.add("selected"),this.createAnimation(),r_.play(),this._selected=!0):(this.row.classList.remove("selected"),this._selected=!1))}}]),t}(),s_=function(){function t(e){$b(this,t),this.frames=e,this.robot=e.robot,this.currentGroupNum=0,this.selectedGroup=null,this.groups=[],this.groupsTable=Nw.controls.groups.table,this.newGroupButton=Nw.controls.groups.createButton,this.initNewGroupButton()}return tw(t,[{key:"removeGroup",value:function t(e){this.groupsTable.removeChild(e.row),this.groups[e.num]=null,e.reset(),this.selectedGroup===e&&(this.selectedGroup=null)}},{key:"createGroup",value:function t(e,n){var r=this;this.currentGroupNum+=1;var i=new a_(e,this.frames);void 0!==n&&i.fromJSON(n),this.groups.push(i),this.groupsTable.appendChild(i.row),this.select(i);var o=function t(e){e.preventDefault(),r.select(i)};i.row.addEventListener("click",o)}},{key:"initNewGroupButton",value:function t(){var e=this;this.newGroupButton.addEventListener("click",function(t){t.preventDefault(),e.createGroup(e.currentGroupNum),e.currentGroupNum>=29&&(e.newGroupButton.innerHTML="Limit Reached!",e.newGroupButton.disabled=!0)}),this.newGroupButton.click()}},{key:"select",value:function t(e){e.selected=!0,this.selectedGroup=e,this.groups.forEach(function(t){null!==t&&t.num!==e.num&&(t.selected=!1)}),Nw.setSelectedGroupMessage("Group "+(e.num+1)+" is selected")}},{key:"deselectAll",value:function t(){this.groups.forEach(function(t){null!==t&&(t.selected=!1)}),Nw.setSelectedGroupMessage("No Group is selected")}},{key:"reset",value:function t(){var e=this;this.groups.forEach(function(t){null!==t&&e.removeGroup(t)}),this.currentGroupNum=0,this.selectedGroup=null,this.groups=[]}},{key:"fromJSON",value:function t(e){this.reset();for(var n in e){var r=e[n];null===r?this.frames[n]=null:(this.createGroup(n,r),this.currentFrameNum=n)}this.deselectAll()}},{key:"toJSON",value:function t(){for(var e={},n=0;n<this.groups.length;n++){var r=this.groups[n];e[n]=null!==r?r.toJSON():null}return e}}]),t}(),c_=function t(e,n){var r=this;$b(this,t),n=n||1;var i=document.createElement("td");i.innerHTML="Loop ",e.appendChild(i);var o=document.createElement("input");i.appendChild(o),o.type="number",o.min="0",o.value=n,o.step="1";var a=document.createElement("span");a.style.width="8em",a.style.textAlign="left",a.style.marginLeft="0.25em",a.innerHTML=" time",i.appendChild(a),this.onInput=function(){},o.addEventListener("input",function(t){t.preventDefault();var n=parseInt(t.target.value,10);e.style.backgroundColor=0===n?"darkgrey":"initial",1!==n?a.innerHTML=" times":a.nodeValue=a.innerHTML=" time",r.onInput(n)})},u_=function(){function t(e){$b(this,t),this.groups=e,this.frames=e.frames,this.robot=this.frames.robot,this.valid=!1,this.lastAddedType=null,this.table=Nw.controls.dance.table,this.initAdvancedControls(),this.initAddSelectedFrameButton(),this.initAddSelectedGroupButton(),this.initDanceButton(),this.initResetButton(),this.initFramerateInput(),this.onDanceFinish()}return tw(t,[{key:"calculateTime",value:function t(){var e,n;parseFloat(Nw.controls.dance.advancedControlInput.value)===this.calculateTotalFrames()*r_.framerate?(this.correctTimeCalculated=!0,Nw.controls.dance.advancedControlInput.style.backgroundColor="aquamarine"):(this.correctTimeCalculated=!1,Nw.controls.dance.advancedControlInput.style.backgroundColor="#ffaaaa")}},{key:"initAdvancedControls",value:function t(){var e=this;this.advancedControlsEnabled=!1,this.correctTimeCalculated=!1,Nw.controls.dance.advancedControlToggle.addEventListener("change",function(t){t.preventDefault(),e.advancedControlsEnabled?Nw.controls.dance.advancedControlSection.classList.add("hide"):Nw.controls.dance.advancedControlSection.classList.remove("hide"),e.advancedControlsEnabled=!e.advancedControlsEnabled,e.checkDanceIsValid()}),Nw.controls.dance.advancedControlInput.addEventListener("input",function(t){t.preventDefault(),e.calculateTime()})}},{key:"add",value:function t(e,n){var r=this,i=n||1,o=document.createElement("tr");if(o.dataset.type=e.type,o.dataset.loops=i,o.dataset.number=e.num,this.table.appendChild(o),new Qw(o,e.type),new Qw(o,e.num),"group"===e.type){var a;new c_(o,n).onInput=function(t){o.dataset.loops=t,r.checkDanceIsValid()}}else o.appendChild(document.createElement("td"));var s;new o_(o).onClick=function(){r.table.contains(o)&&r.table.removeChild(o),"group"===e.type&&e.num===r.lastAddedGroupNum&&(r.lastAddedGroupNum=-1),"frame"===e.type&&e.num===r.lastAddedFrameNum&&(r.lastAddedFrameNum=-1),r.checkDanceIsValid()},this.checkDanceIsValid(),Nw.controls.dance.resetButton.disabled=!1}},{key:"initAddSelectedFrameButton",value:function t(){var e=this;this.lastAddedFrameNum=null,Nw.controls.dance.addFrameButton.addEventListener("click",function(t){t.preventDefault();var n=e.frames.frames[e.frames.selectedFrameNum];e.groups.deselectAll(),r_.reset(),null===n||n.num===e.lastAddedFrameNum&&"frame"===e.lastAddedType||(e.add(n),e.lastAddedFrameNum=n.num,e.lastAddedType="frame")})}},{key:"initAddSelectedGroupButton",value:function t(){var e=this;this.lastAddedGroupNum=null,Nw.controls.dance.addGroupButton.addEventListener("click",function(t){t.preventDefault();var n=e.groups.selectedGroup;e.groups.deselectAll(),r_.reset(),null===n||n.num===e.lastAddedGroupNum&&"group"===e.lastAddedType||(e.add(n),e.lastAddedGroupNum=n.num,e.lastAddedType="group")})}},{key:"initFramerateInput",value:function t(){var e=this;Nw.controls.dance.framerate.addEventListener("input",function(t){e.groups.deselectAll(),e.framerate=t.target.value})}},{key:"setFramerate",value:function t(e){(e<.1||e>10)&&(console.warn("Attempting to set frame rate outside of allowed range [0.1, 10]!"),e=1),Nw.controls.dance.framerate.value=e,this.framerate=e}},{key:"onDanceFinish",value:function t(){var e=this;r_.onFinish=function(){Nw.controls.music.stop.click(),Nw.controls.dance.playSymbol.classList.remove("fa-stop"),Nw.controls.dance.playSymbol.classList.add("fa-play"),e.robot.reset()}}},{key:"initDanceButton",value:function t(){var e=this,n=function t(){e.groups.deselectAll(),r_.reset(),e.createAnimation(),r_.play(),Nw.controls.music.stop.click(),Nw.controls.music.play.click(),Nw.controls.dance.playSymbol.classList.remove("fa-play"),Nw.controls.dance.playSymbol.classList.add("fa-stop")},r=function t(){r_.reset(),Nw.controls.music.stop.click(),Nw.controls.dance.playSymbol.classList.remove("fa-stop"),Nw.controls.dance.playSymbol.classList.add("fa-play")};Nw.controls.dance.playButton.addEventListener("click",function(t){t.preventDefault(),-1!==Nw.controls.dance.playSymbol.classList.contains("fa-play")?e.advancedControlsEnabled&&!e.correctTimeCalculated?alert("Hint: multiply the frame rate by the total number of frames in the dance"):n():r()})}},{key:"initResetButton",value:function t(){var e=this;Nw.controls.dance.resetButton.addEventListener("click",function(t){t.preventDefault(),e.groups.deselectAll(),r_.reset(),e.reset()})}},{key:"createAnimation",value:function t(){var e=this,n=[];this.table.childNodes.forEach(function(t){if("TR"===t.nodeName){var r=t.dataset.number;if("group"===t.dataset.type)for(var i=0;i<t.dataset.loops;i++)n=n.concat(e.groups.groups[r].getFrames());else n.push(e.frames.frames[r])}}),this.actions=r_.createAnimation(n)}},{key:"calculateTotalFrames",value:function t(){var e=this,n=0;return this.table.childNodes.forEach(function(t){if("TR"===t.nodeName){var r=t.dataset.number;if("group"===t.dataset.type)for(var i=0;i<t.dataset.loops;i++)n+=e.groups.groups[r].getFrames().length;else n++}}),n}},{key:"checkDanceIsValid",value:function t(){this.valid=this.calculateTotalFrames()>1,Nw.controls.dance.playButton.disabled=!this.valid,Nw.controls.dance.advancedControlInput.placeholder=this.valid?"0.0":"Not enough frames in dance!"}},{key:"reset",value:function t(){for(;this.table.firstChild;)this.table.removeChild(this.table.firstChild);this.valid=!1,Nw.controls.dance.playButton.disabled=!0,Nw.controls.dance.resetButton.disabled=!0,this.framerate=1,this.lastAddedGroupNum=-1,this.lastAddedFrameNum=-1,Nw.controls.dance.playSymbol.classList.add("fa-play"),Nw.controls.dance.playSymbol.classList.remove("fa-stop")}},{key:"fromJSON",value:function t(e){this.reset(),this.setFramerate(e.framerate||1);for(var n in e){var r=e[n];"frame"===r.type?this.add(this.frames.frames[r.num]):"group"===r.type?this.add(this.groups.groups[r.num],r.loopAmount):"framerate"===n&&(Nw.controls.dance.framerate.value=r)}}},{key:"toJSON",value:function t(){var e={framerate:this.framerate},n=0;return this.table.childNodes.forEach(function(t){"TR"===t.nodeName&&(e[n]={type:t.dataset.type,num:t.dataset.number,loopAmount:t.dataset.loops},n++)}),e}},{key:"framerate",set:function t(e){r_.framerate=e,this.calculateTime()}}]),t}();rw.enabled=!0;var h_;new(function(){function t(){$b(this,t),this.init(),this.preLoad(),this.load(),this.postLoad()}return tw(t,[{key:"init",value:function t(){this.app=new bo(Nw.canvas),this.app.renderer.setClearColor(16250871,1),this.app.renderer.shadowMap.enabled=!0,this.app.renderer.shadowMap.type=lv,this.app.onUpdate=function(){var t=this.delta/1e3;r_.onUpdate(t)}}},{key:"preLoad",value:function t(){this.animations={},this.loadingPromises=[]}},{key:"load",value:function t(){var e=this;console.time("Loading time");var n=Vw.fbxLoader("/assets/models/robot_dance/stage_camera_lights.fbx").then(function(t){e.stage=t.getObjectByName("Stage"),e.camera=t.getObjectByName("Camera"),e.spotLight=t.getObjectByName("Spot_stage_center_high"),e.soundSourceLeft=t.getObjectByName("Stage_Left_Sound"),e.soundSourceRight=t.getObjectByName("Stage_Right_Sound"),e.sceneCentre=(new ot).setFromObject(t).getCenter(),e.sceneCentre.y-=5}),r=Vw.fbxLoader("/assets/models/robot_dance/nao.fbx").then(function(t){e.robot=new Hw(t),t.position.z+=10});this.loadingPromises.push(r,n)}},{key:"postLoad",value:function t(){var e=this;Promise.all(this.loadingPromises).then(function(){Nw.setOnLoadEndState(),console.timeEnd("Loading time"),e.app.scene.add(e.stage),e.app.scene.add(e.robot.model),e.initBackground(),e.initLighting(),e.initShadows(),e.initCamera(),e.initCameraControl(),r_.initMixer(e.robot.model);var t=new i_(e.robot),n=new s_(t),r=new u_(n);r_.setDance(r),new Jw([e.soundSourceLeft,e.soundSourceRight],e.app.camera),new Zw(t,n,r),e.app.play()})}},{key:"initShadows",value:function t(){this.stage.traverse(function(t){"scene"!==t.name&&"curtains_top"!==t.name||(t.receiveShadow=!0),"side"!==t.name&&"speaker_cone"!==t.name&&"speaker_cone_edge"!==t.name&&"speaker_cone_outer"!==t.name&&"Speaker_body"!==t.name&&"tassle04"!==t.name&&"tassle02"!==t.name||(t.castShadow=!0)}),this.robot.model.traverse(function(t){"R_shin"!==t.name&&"R_thigh"!==t.name&&"L_thigh"!==t.name&&"L_shin"!==t.name&&"fingers18"!==t.name&&"fingers11"!==t.name&&"fingers21"!==t.name&&"fingers20"!==t.name&&"fingers14"!==t.name&&"fingers12"!==t.name&&"fingers16"!==t.name&&"fingers15"!==t.name&&"fingers13"!==t.name&&"fingers13"!==t.name&&"fingers19"!==t.name&&"L_forearm"!==t.name&&"L_elbow"!==t.name&&"L_shoulder"!==t.name&&"L_arm_upper"!==t.name&&"fingers05"!==t.name&&"fingers06"!==t.name&&"fingers08"!==t.name&&"fingers10"!==t.name&&"fingers00"!==t.name&&"fingers02"!==t.name&&"fingers04"!==t.name&&"fingers03"!==t.name&&"fingers07"!==t.name&&"fingers09"!==t.name&&"fingers01"!==t.name&&"R_elbow"!==t.name&&"R_shoulder"!==t.name&&"R_arm_upper"!==t.name&&"R_hand"!==t.name&&"R_wrist"!==t.name&&"body"!==t.name&&"neck"!==t.name&&"head"!==t.name&&"L_hip"!==t.name&&"R_hip"!==t.name&&"L_hand"!==t.name||(t.castShadow=!0)})}},{key:"initLighting",value:function t(){var e=new ni(16777215,.3);this.app.scene.add(e),this.spotLight.castShadow=!0,this.spotLight.shadow.mapSize.width=1024,this.spotLight.shadow.mapSize.height=1024,this.spotLight.shadow.camera.near=80,this.spotLight.shadow.camera.far=300,this.spotLight.penumbra=.45,this.spotLight.angle=.45,this.spotLight.distance=300;var n=this.spotLight.clone();n.intensity=.9,n.position.x-=100,n.position.y+=20,n.shadow.radius=1.5;var r=this.spotLight.clone();r.intensity=1.2,r.position.x+=25,r.shadow.radius=1.75,this.app.scene.add(n,r)}},{key:"initCamera",value:function t(){this.app.camera.far=800,this.app.camera.fov=35,this.app.camera.position.set(0,50,160),this.app.camera.updateProjectionMatrix()}},{key:"initCameraControl",value:function t(){this.app.controls=new wo(this.app.camera,this.app.canvas),this.app.controls.enableKeys=!1,this.app.controls.enableZoom=!1,this.app.controls.minPolarAngle=.1*Math.PI,this.app.controls.maxPolarAngle=.45*Math.PI,this.app.controls.minDistance=60,this.app.controls.maxDistance=400,this.app.controls.minAzimuthAngle=.5*-Math.PI,this.app.controls.maxAzimuthAngle=.5*Math.PI,this.app.controls.enableDamping=!0,this.app.controls.dampingFactor=.2,this.app.controls.target.copy(this.sceneCentre),this.app.controls.update()}},{key:"initBackground",value:function t(){this.app.scene.fog=new Le(16250871,400,700);var e,n,r=new Gt(new Nt(2e4,2e4),new Ft({color:11184810}));r.position.set(0,-5,0),r.rotation.x=-Math.PI/2,this.app.scene.add(r)}}]),t}())}();