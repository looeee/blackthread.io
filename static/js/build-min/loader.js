this.loader=this.loader||{},function(){"use strict";function e(){var e=void 0,t=0,n=0;this.running=!1,this.paused=!1;var i=1,o=0,r=0;Object.defineProperties(this,{now:{get:function e(){return(performance||Date).now()}},timeScale:{get:function e(){return i},set:function e(t){o=this.totalTime,r=this.now,i=t}},unscaledTotalTime:{get:function e(){return this.running?this.now-n:0}},totalTime:{get:function e(){var t=(this.now-r)*this.timeScale;return this.running?o+t:0}},unscaledDelta:{get:function e(){var n=this.now-t;return t=this.now,n}},delta:{get:function e(){return this.unscaledDelta*this.timeScale}}}),this.start=function(){if(this.paused){var i=this.now-e;n+=i,t+=i,r+=i}else this.running||(n=t=r=this.now,o=0);this.running=!0,this.paused=!1},this.stop=function(){n=0,o=0,this.running=!1},this.pause=function(){e=this.now,this.paused=!0}}function t(t){var n=this;void 0!==t&&(R=t),this.autoRender=!0,this.autoResize=!0,this.frameCount=0,this.delta=0,this.isPlaying=!1,this.isPaused=!1,this.time=new e;var i=function e(){A.setSize(R.clientWidth,R.clientHeight,!1)},o=function e(){B.aspect=R.clientWidth/R.clientHeight,B.updateProjectionMatrix()};this.onWindowResize=function(){};var r=function e(){n.autoResize?B&&("PerspectiveCamera"===B.type?(o(),i(),n.onWindowResize()):console.warn("App: AutoResize only works with PerspectiveCamera")):n.onWindowResize()};window.addEventListener("resize",r,!1),Object.defineProperties(this,{canvas:{get:function e(){return void 0===R&&((R=document.body.appendChild(document.createElement("canvas"))).style.position="absolute",R.style.width=R.style.height="100%"),R},set:function e(t){R=t}},camera:{get:function e(){return void 0===B&&(B=new THREE.PerspectiveCamera(50,this.canvas.clientWidth/this.canvas.clientHeight,.1,1e3)),B},set:function e(t){B=t,o()}},scene:{get:function e(){return void 0===k&&(k=new THREE.Scene),k},set:function e(t){k=t}},renderer:{get:function e(){return void 0===A&&((A=new THREE.WebGLRenderer({canvas:this.canvas,antialias:!0})).setPixelRatio(window.devicePixelRatio),A.setSize(this.canvas.clientWidth,this.canvas.clientHeight,!1)),A},set:function e(t){A=t,i()}},averageFrameTime:{get:function e(){return 0!==this.frameCount?this.time.unscaledTotalTime/this.frameCount:0}}}),this.play=function(){function e(){n.frameCount++,n.delta=n.time.delta,n.onUpdate(),n.controls&&n.controls.enableDamping&&n.controls.update(),n.autoRender&&n.renderer.render(n.scene,n.camera),j=requestAnimationFrame(function(){e()})}this.time.start(),this.isPlaying=!0,this.isPaused=!1,e()},this.pause=function(){this.isPaused=!0,this.time.pause(),cancelAnimationFrame(j)},this.stop=function(){this.isPlaying=!1,this.isPaused=!1,this.time.stop(),this.frameCount=0,cancelAnimationFrame(j)},this.onUpdate=function(){},this.toJSON=function(e){if("function"==typeof e.toJSON){var t=e.toJSON();window.open("data:application/json;"+(window.btoa?"base64,"+btoa(JSON.stringify(t)):JSON.stringify(t)))}else console.error("App.toJSON error: object does not have a toJSON function.")},this.initControls=function(){this.controls=new THREE.OrbitControls(this.camera,this.canvas),this.controls.enableDamping=!0,this.controls.dampingFactor=.2},this.fitCameraToObject=function(e,t){t=t||1;var n=new THREE.Box3;n.setFromObject(e);var i=n.getCenter(),o=n.getSize(),r=Math.max(o.x,o.y,o.z),a=this.camera.fov*(Math.PI/180),s=Math.abs(r/4*Math.tan(2*a));s*=t;var l,u=-n.min.z+s,c=3*u;return this.camera.far=c,this.camera.near=c<1?.001:c<100?.01:c<500?.1:1,console.log(c,this.camera.near),this.controls.target.copy(i),this.controls.maxDistance=2*u,this.camera.position.set(i.x,o.y,s),this.camera.updateProjectionMatrix(),this.controls.update(),this.controls.saveState(),n},this.takeScreenshot=function(e,t){var n=new Image;return e>0&&t>0?(this.camera.aspect=e/t,this.camera.updateProjectionMatrix(),this.renderer.setSize(e,t,!1),this.renderer.render(this.scene,this.camera,null,!1),n.src=this.renderer.domElement.toDataURL(),this.camera.aspect=this.canvas.clientWidth/this.canvas.clientHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.canvas.clientWidth,this.canvas.clientHeight,!1)):(this.renderer.render(this.scene,this.camera,null,!1),n.src=this.renderer.domElement.toDataURL()),n}}function n(e,t,n){function i(t){var n=p,i=m;return p=m=void 0,E=t,y=e.apply(i,n)}function r(e){return E=e,g=setTimeout(u,t),w?i(e):y}function a(e){var n,i,o=t-(e-b);return L?W(o,v-(e-E)):o}function l(e){var n=e-b,i;return void 0===b||n>=t||n<0||L&&e-E>=v}function u(){var e=$();if(l(e))return c(e);g=setTimeout(u,a(e))}function c(e){return g=void 0,S&&p?i(e):(p=m=void 0,y)}function d(){void 0!==g&&clearTimeout(g),E=0,p=b=m=g=void 0}function h(){return void 0===g?y:c($())}function f(){var e=$(),n=l(e);if(p=arguments,m=this,b=e,n){if(void 0===g)return r(b);if(L)return g=setTimeout(u,t),i(b)}return void 0===g&&(g=setTimeout(u,t)),y}var p,m,v,y,g,b,E=0,w=!1,L=!1,S=!0;if("function"!=typeof e)throw new TypeError(O);return t=s(t)||0,o(n)&&(w=!!n.leading,v=(L="maxWait"in n)?J(s(n.maxWait)||0,t):v,S="trailing"in n?!!n.trailing:S),f.cancel=d,f.flush=h,f}function i(e,t,i){var r=!0,a=!0;if("function"!=typeof e)throw new TypeError(O);return o(i)&&(r="leading"in i?!!i.leading:r,a="trailing"in i?!!i.trailing:a),n(e,t,{leading:r,maxWait:t,trailing:a})}function o(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function r(e){return!!e&&"object"==typeof e}function a(e){return"symbol"==typeof e||r(e)&&G.call(e)==M}function s(e){if("number"==typeof e)return e;if(a(e))return P;if(o(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=o(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(C,"");var n=D.test(e);return n||q.test(e)?I(e.slice(2),n?2:8):F.test(e)?P:+e}function l(e,t){if(!(e instanceof Blob))throw new TypeError("Must be a File or Blob");return new Promise(function(n,i){var o=new FileReader;o.onload=function(e){n(e.target.result)},o.onerror=function(t){i(new Error("Error reading"+e.name+": "+t.target.result))},o["readAs"+t](e)})}var u=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),d=document.querySelector("#loader-canvas"),h=document.querySelector("#page-content"),f=document.querySelector("#reset"),p=document.querySelector("#export"),m=document.querySelector("#export-anims"),v=document.querySelector("#fullscreen-button"),y={bbDepth:document.querySelector("#bb-depth"),bbWidth:document.querySelector("#bb-width"),bbHeight:document.querySelector("#bb-height"),faces:document.querySelector("#faces"),vertices:document.querySelector("#vertices"),infoBox:document.querySelector("#model-info")},g={slider:document.querySelector("#animation-slider"),playButton:document.querySelector("#play-button"),pauseButton:document.querySelector("#pause-button"),playbackControl:document.querySelector("#playback-control"),clipsSelection:document.querySelector("#animation-clips"),controls:document.querySelector("#animation-controls")},b={input:document.querySelector("#file-upload-input"),button:document.querySelector("#file-upload-button"),form:document.querySelector("#file-upload-form")},E={slider:document.querySelector("#lighting-slider"),symbol:document.querySelector("#light-symbol")},w={bar:document.querySelector("#loading-bar"),overlay:document.querySelector("#loading-overlay"),progress:document.querySelector("#progress")},L={button:document.querySelector("#screenshot-button")},S={links:document.querySelector("#controls").querySelectorAll("span"),toggleGrid:document.querySelector("#toggle-grid"),toggleInfo:document.querySelector("#toggle-info"),toggleBackground:document.querySelector("#toggle-background"),toggleEnvironment:document.querySelector("#toggle-environment"),sliders:document.querySelectorAll("input[type=range]"),exampleDuck:document.querySelector("#example-duck")},T=function(){function e(){u(this,e)}return c(e,null,[{key:"setInitialState",value:function e(){w.overlay.classList.remove("hide"),b.form.classList.remove("hide"),w.bar.classList.add("hide"),w.progress.style.width=0,g.controls.classList.add("hide"),g.playButton.classList.add("hide"),g.pauseButton.classList.remove("hide");var t=g.clipsSelection.children[0];g.clipsSelection.innerHTML="",g.clipsSelection.appendChild(t)}},{key:"setOnLoadStartState",value:function e(){b.form.classList.add("hide"),w.bar.classList.remove("hide")}},{key:"setOnLoadEndState",value:function e(){w.overlay.classList.add("hide")}}]),e}();T.canvas=d,T.container=h,T.reset=f,T.fullscreenButton=v,T.animation=g,T.fileUpload=b,T.lighting=E,T.loading=w,T.screenshot=L,T.controls=S,T.export=p,T.exportAnims=m,T.modelInfo=y;var x=function e(t){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen()};T.fullscreenButton.addEventListener("click",function(e){e.preventDefault(),x(T.container)},!1);var R=void 0,k=void 0,B=void 0,A=void 0,j=void 0,H="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},O="Expected a function",P=NaN,M="[object Symbol]",C=/^\s+|\s+$/g,F=/^[-+]0x[0-9a-f]+$/i,D=/^0b[01]+$/i,q=/^0o[0-7]+$/i,I=parseInt,U="object"==typeof H&&H&&H.Object===Object&&H,_="object"==typeof self&&self&&self.Object===Object&&self,N=U||_||Function("return this")(),z,G=Object.prototype.toString,J=Math.max,W=Math.min,$=function(){return N.Date.now()},X=i,V=document.createElement("a");V.style.display="none",document.body.appendChild(V);var Y=function e(t,n){V.href=URL.createObjectURL(t),V.download=n||"data.json",V.click()},K=function e(t,n){Y(new Blob([t],{type:"text/plain"}),n)},Q=function e(t){var n=JSON.stringify(THREE.AnimationClip.toJSON(t),null,"\t");n=n.replace(/[^{]*/i,"").replace(/\]$/i,""),K(n,"blackThreadAnimations.json")},Z=function(){function e(){u(this,e),this.isPaused=!1,this.pauseButtonActive=!1,this.clips=[],this.mixers=[],this.actions=[],this.animationNames=[],this.initExportAnims()}return c(e,[{key:"reset",value:function e(){this.clips=[],this.mixers=[],this.actions=[],this.animationNames=[],this.currentMixer=null,this.currentAction=null,this.isPaused=!1,this.pauseButtonActive=!1,T.animation.playbackControl.removeEventListener("click",this.playPause,!1),T.animation.slider.removeEventListener("mousedown",this.sliderMouseDownEvent,!1),T.animation.slider.removeEventListener("input",this.sliderInputEvent,!1),T.animation.slider.removeEventListener("mouseup",this.sliderMouseupEvent,!1),T.animation.clipsSelection.removeEventListener("change",this.clipsChangeEvent,!1)}},{key:"update",value:function e(t){this.currentMixer&&this.currentAction&&!this.isPaused&&(this.currentMixer.update(t/1e3),this.setSliderValue(this.currentAction.time))}},{key:"initAnimation",value:function e(t){var n=this;t.animations&&0!==t.animations.length&&(t.animations.forEach(function(e){if(e instanceof THREE.AnimationClip){var i=new THREE.AnimationMixer(t),o=i.clipAction(e);n.clips.push(e),n.mixers.push(i),n.actions.push(o),n.animationNames.push(e.name),T.animation.clipsSelection.appendChild(new Option(e.name,e.name))}else console.warn("Some animations are not valid THREE.AnimationClips. Skipping these.")}),0!==this.animationNames.length&&(this.selectCurrentAnimation(this.animationNames[0]),T.animation.controls.classList.remove("hide"),this.initPlayPauseControls(),this.initSlider(),this.initSelectionMenu()))}},{key:"selectCurrentAnimation",value:function e(t){var n=this.animationNames.indexOf(t);-1===n?console.warn("Animation "+t+" not found."):(this.currentAction&&this.currentAction.stop(),this.currentMixer=this.mixers[n],this.currentAction=this.actions[n],this.currentClip=this.clips[n],T.animation.slider.max=String(this.currentClip.duration),T.animation.slider.step=String(this.currentClip.duration/150),this.currentAction.play())}},{key:"setSliderValue",value:function e(t){T.animation.slider.value=String(t)}},{key:"initPlayPauseControls",value:function e(){var t=this;this.playPause=function(e){e.preventDefault(),t.togglePause()},T.animation.playbackControl.addEventListener("click",this.playPause,!1)}},{key:"togglePause",value:function e(){this.isPaused?(this.pauseButtonActive=!1,this.play()):(this.pauseButtonActive=!0,this.pause())}},{key:"pause",value:function e(){this.isPaused=!0,T.animation.playButton.classList.remove("hide"),T.animation.pauseButton.classList.add("hide")}},{key:"play",value:function e(){this.isPaused=!1,T.animation.playButton.classList.add("hide"),T.animation.pauseButton.classList.remove("hide")}},{key:"initSlider",value:function e(){var t=this;this.sliderMouseDownEvent=function(e){t.pauseButtonActive||t.pause()},T.animation.slider.addEventListener("mousedown",this.sliderMouseDownEvent,!1),this.sliderInputEvent=X(function(e){var n=t.currentMixer.time,i=T.animation.slider.value;t.currentMixer.update(i-n)},17),T.animation.slider.addEventListener("input",this.sliderInputEvent,!1),this.sliderMouseupEvent=function(e){t.pauseButtonActive||t.play()},T.animation.slider.addEventListener("mouseup",this.sliderMouseupEvent,!1)}},{key:"initSelectionMenu",value:function e(){var t=this;T.animation.clipsSelection.selectedIndex=1,this.clipsChangeEvent=function(e){e.preventDefault(),"static"===e.target.value?t.currentAction.stop():t.selectCurrentAnimation(e.target.value)},T.animation.clipsSelection.addEventListener("change",this.clipsChangeEvent,!1)}},{key:"initExportAnims",value:function e(){var t=this;T.exportAnims.addEventListener("click",function(e){e.preventDefault(),0!==t.clips.length&&Q(t.currentClip)},!1)}}]),e}(),ee="#define GLSLIFY 1\nattribute vec3 position;\nvarying vec2 uv;\nvoid main() {\n\tgl_Position = vec4( vec3( position.x, position.y, 1.0 ), 1.0 );\n\tuv = vec2(position.x, position.y) * 0.5;\n}\n",te="precision mediump float;\n#define GLSLIFY 1\nuniform vec3 color1;\nuniform vec3 color2;\nuniform float vignetteAmount;\nuniform float mixAmount;\nuniform vec2 smooth;\nuniform sampler2D noiseTexture;\nvarying vec2 uv;\nvoid main() {\n\tfloat dst = length( uv );\n\tvec3 color = mix( color1, color2, dst );\n  vec2 texSize = vec2( 0.25, 0.25 );\n  vec2 phase = fract(  uv / texSize );\n\tvec3 noise = mix( color, texture2D( noiseTexture, phase ).rgb, mixAmount );\n\tvec4 col = vec4( mix( noise, vec3( vignetteAmount ), dot( uv, uv ) ), 1.0 );\n\tgl_FragColor = col;\n}",ne=function(){function e(t){u(this,e),this.app=t,this.initMaterials(),this.initMesh(),this.initButton(),this.lightControls()}return c(e,[{key:"initMesh",value:function e(){var t=new THREE.PlaneBufferGeometry(2,2,1),n=new THREE.Mesh(t,this.mat);this.app.camera.add(n)}},{key:"initMaterials",value:function e(){var t,n=(new THREE.TextureLoader).load("/assets/images/textures/noise-256.jpg");n.wrapS=n.wrapT=THREE.RepeatWrapping,this.colA=new THREE.Color(16777215),this.colB=new THREE.Color(2635844);var i={color1:{value:this.colA},color2:{value:this.colB},noiseTexture:{value:n},vignetteAmount:{value:0},mixAmount:{value:.08}};this.mat=new THREE.RawShaderMaterial({uniforms:i,depthFunc:THREE.NeverDepth,vertexShader:ee,fragmentShader:te})}},{key:"initButton",value:function e(){var t=this,n=!1;T.controls.toggleBackground.addEventListener("click",function(e){e.preventDefault(),n?(t.mat.uniforms.mixAmount.value=.08,t.mat.uniforms.vignetteAmount.value=0,t.lightControls()):(t.mat.uniforms.mixAmount.value=.8,t.mat.uniforms.vignetteAmount.value=-1.6,t.darkControls()),n=!n},!1)}},{key:"darkControls",value:function e(){T.modelInfo.infoBox.style.color="white";for(var t=0;t<T.controls.links.length;t++)T.controls.links[t].style.color="white";for(var n=0;n<T.controls.sliders.length;n++)T.controls.sliders[n].classList.remove("light-slider"),T.controls.sliders[n].classList.add("dark-slider")}},{key:"lightControls",value:function e(){T.modelInfo.infoBox.style.color="black";for(var t=0;t<T.controls.links.length;t++)T.controls.links[t].style.color="black";for(var n=0;n<T.controls.sliders.length;n++)T.controls.sliders[n].classList.remove("dark-slider"),T.controls.sliders[n].classList.add("light-slider")}}]),e}(),ie=function(){function e(t){u(this,e),this.materials=t,this.loadMaps(),this.initButton()}return c(e,[{key:"loadMaps",value:function e(){this.maps=[];var t,n=(new THREE.TextureLoader).load("/assets/images/textures/env_maps/test_env_map.jpg");n.mapping=THREE.EquirectangularReflectionMapping,n.magFilter=THREE.LinearFilter,n.minFilter=THREE.LinearMipMapLinearFilter,this.maps.push(n);var i="/assets/images/textures/cube_maps/Bridge2/",o=[i+"posx.jpg",i+"negx.jpg",i+"posy.jpg",i+"negy.jpg",i+"posz.jpg",i+"negz.jpg"],r=(new THREE.CubeTextureLoader).load(o);r.format=THREE.RGBFormat,r.mapping=THREE.CubeReflectionMapping,this.maps.push(r)}},{key:"initButton",value:function e(){var t=this,n=0;T.controls.toggleEnvironment.addEventListener("click",function(e){e.preventDefault();var i=t.maps[n%t.maps.length];n++,t.materials.forEach(function(e){void 0!==e.reflectivity&&(e.reflectivity=.5),void 0!==e.envMapIntensity&&(e.envMapIntensity=.5),void 0!==e.envMap&&(e.envMap=i),e.needsUpdate=!0})})}},{key:"default",value:function e(){var t=this;this.materials.forEach(function(e){void 0!==e.reflectivity&&(e.reflectivity=.25),void 0!==e.envMapIntensity&&(e.envMapIntensity=.25),void 0!==e.envMap&&(e.envMap=t.maps[0]),e.needsUpdate=!0})}}]),e}(),oe=function(){function e(t){u(this,e),this.app=t,this.initLights(),this.initSlider(),this.initialStrength=this.light.intensity,T.lighting.slider.value=String(this.light.intensity)}return c(e,[{key:"initLights",value:function e(){var t=new THREE.AmbientLight(16777215,.3);this.app.scene.add(t),this.light=new THREE.PointLight(16777215,1.2),this.app.camera.add(this.light),this.app.scene.add(this.app.camera)}},{key:"initSlider",value:function e(){var t=this;this.sliderInputEvent=X(function(e){e.preventDefault(),t.light.intensity=T.lighting.slider.value},100),T.lighting.slider.addEventListener("input",this.sliderInputEvent,!1),this.symbolClickEvent=X(function(e){e.preventDefault(),t.reset()},100),T.lighting.symbol.addEventListener("click",this.symbolClickEvent,!1)}},{key:"reset",value:function e(){this.light.intensity=this.initialStrength,T.lighting.slider.value=String(this.light.intensity)}}]),e}(),re=function(){function e(t){u(this,e),this.app=t,this.initButton()}return c(e,[{key:"initButton",value:function e(){var t=this;T.screenshot.button.addEventListener("click",X(function(e){e.preventDefault();var n=t.app.takeScreenshot(t.app.canvas.clientWidth,t.app.canvas.clientHeight),i=window.open("");i.document.write("<title>Three.js Loader screenshot</title>"),i.document.write(n.outerHTML)},1e3),!1)}}]),e}(),ae=function(){function e(t){u(this,e),this.app=t,this.size=0,this.gridHelper=new THREE.GridHelper,this.axesHelper=new THREE.AxesHelper,this.helpers=new THREE.Group,this.helpers.add(this.gridHelper,this.axesHelper),this.helpers.visible=!1,this.initButton()}return c(e,[{key:"setSize",value:function e(){this.size=Math.floor(.5*this.app.camera.far),this.size%2!=0&&this.size++,this.updateGrid(),this.updateAxes()}},{key:"updateGrid",value:function e(){var t=new THREE.GridHelper(this.size,10);this.helpers.remove(this.gridHelper),this.gridHelper=t,this.helpers.add(this.gridHelper)}},{key:"updateAxes",value:function e(){var t=new THREE.AxesHelper(this.size/2);this.helpers.remove(this.axesHelper),this.axesHelper=t,this.helpers.add(this.axesHelper)}},{key:"initButton",value:function e(){var t=this;T.controls.toggleGrid.addEventListener("click",function(e){e.preventDefault(),t.setSize(),t.helpers.visible=!t.helpers.visible})}}]),e}(),se=function(){function e(t,n){u(this,e),this.renderer=t.renderer,this.objects=n,this.modelInfo=this.boundingBox=new THREE.Box3,this.initButton()}return c(e,[{key:"update",value:function e(){this.boundingBox.expandByObject(this.objects);var t=Math.abs(this.boundingBox.max.z-this.boundingBox.min.z),n=Math.abs(this.boundingBox.max.x-this.boundingBox.min.x),i=Math.abs(this.boundingBox.max.y-this.boundingBox.min.y);T.modelInfo.bbDepth.innerHTML=t.toPrecision(4),T.modelInfo.bbWidth.innerHTML=n.toPrecision(4),T.modelInfo.bbHeight.innerHTML=i.toPrecision(4),T.modelInfo.faces.innerHTML=this.renderer.info.render.faces,T.modelInfo.vertices.innerHTML=this.renderer.info.render.vertices}},{key:"initButton",value:function e(){T.controls.toggleInfo.addEventListener("click",function(e){e.preventDefault(),T.modelInfo.infoBox.classList.toggle("hide")})}}]),e}();!function(e){function t(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function n(e){return"string"!=typeof e&&(e=String(e)),e}function i(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return y.iterable&&(t[Symbol.iterator]=function(){return t}),t}function o(e){this.map={},e instanceof o?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function r(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function a(e){return new Promise(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function s(e){var t=new FileReader,n=a(t);return t.readAsArrayBuffer(e),n}function l(e){var t=new FileReader,n=a(t);return t.readAsText(e),n}function u(e){for(var t=new Uint8Array(e),n=new Array(t.length),i=0;i<t.length;i++)n[i]=String.fromCharCode(t[i]);return n.join("")}function c(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function d(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(y.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(y.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(y.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(y.arrayBuffer&&y.blob&&b(e))this._bodyArrayBuffer=c(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!y.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!E(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=c(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):y.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},y.blob&&(this.blob=function(){var e=r(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?r(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(s)}),this.text=function(){var e=r(this);if(e)return e;if(this._bodyBlob)return l(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(u(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},y.formData&&(this.formData=function(){return this.text().then(p)}),this.json=function(){return this.text().then(JSON.parse)},this}function h(e){var t=e.toUpperCase();return w.indexOf(t)>-1?t:e}function f(e,t){var n=(t=t||{}).body;if(e instanceof f){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new o(e.headers)),this.method=e.method,this.mode=e.mode,n||null==e._bodyInit||(n=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new o(t.headers)),this.method=h(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function p(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),i=n.shift().replace(/\+/g," "),o=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(i),decodeURIComponent(o))}}),t}function m(e){var t=new o;return e.split(/\r?\n/).forEach(function(e){var n=e.split(":"),i=n.shift().trim();if(i){var o=n.join(":").trim();t.append(i,o)}}),t}function v(e,t){t||(t={}),this.type="default",this.status="status"in t?t.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new o(t.headers),this.url=t.url||"",this._initBody(e)}if(!e.fetch){var y={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(y.arrayBuffer)var g=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],b=function(e){return e&&DataView.prototype.isPrototypeOf(e)},E=ArrayBuffer.isView||function(e){return e&&g.indexOf(Object.prototype.toString.call(e))>-1};o.prototype.append=function(e,i){e=t(e),i=n(i);var o=this.map[e];this.map[e]=o?o+","+i:i},o.prototype.delete=function(e){delete this.map[t(e)]},o.prototype.get=function(e){return e=t(e),this.has(e)?this.map[e]:null},o.prototype.has=function(e){return this.map.hasOwnProperty(t(e))},o.prototype.set=function(e,i){this.map[t(e)]=n(i)},o.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},o.prototype.keys=function(){var e=[];return this.forEach(function(t,n){e.push(n)}),i(e)},o.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),i(e)},o.prototype.entries=function(){var e=[];return this.forEach(function(t,n){e.push([n,t])}),i(e)},y.iterable&&(o.prototype[Symbol.iterator]=o.prototype.entries);var w=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];f.prototype.clone=function(){return new f(this,{body:this._bodyInit})},d.call(f.prototype),d.call(v.prototype),v.prototype.clone=function(){return new v(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new o(this.headers),url:this.url})},v.error=function(){var e=new v(null,{status:0,statusText:""});return e.type="error",e};var L=[301,302,303,307,308];v.redirect=function(e,t){if(-1===L.indexOf(t))throw new RangeError("Invalid status code");return new v(null,{status:t,headers:{location:e}})},e.Headers=o,e.Request=f,e.Response=v,e.fetch=function(e,t){return new Promise(function(n,i){var o=new f(e,t),r=new XMLHttpRequest;r.onload=function(){var e={status:r.status,statusText:r.statusText,headers:m(r.getAllResponseHeaders()||"")};e.url="responseURL"in r?r.responseURL:e.headers.get("X-Request-URL");var t="response"in r?r.response:r.responseText;n(new v(t,e))},r.onerror=function(){i(new TypeError("Network request failed"))},r.ontimeout=function(){i(new TypeError("Network request failed"))},r.open(o.method,o.url,!0),"include"===o.credentials&&(r.withCredentials=!0),"responseType"in r&&y.blob&&(r.responseType="blob"),o.headers.forEach(function(e,t){r.setRequestHeader(t,e)}),r.send(void 0===o._bodyInit?null:o._bodyInit)})},e.fetch.polyfill=!0}}("undefined"!=typeof self?self:void 0);var le=new THREE.LoadingManager,ue=0,ce=null;le.onStart=function(){null===ce&&(T.setOnLoadStartState(),ce=setInterval(function(){(ue+=5)>=100?clearInterval(ce):T.loading.progress.style.width=ue+"%"},100))},le.onLoad=function(){T.setOnLoadEndState(),clearInterval(ce)},le.onProgress=function(){ue>=100||(ue+=5,T.loading.progress.style.width=ue+"%")},le.onError=function(e){console.error(e)},THREE.Loader.Handlers.add(/\.dds$/i,new THREE.DDSLoader);var de=null,he=null,fe=null,pe=null,me=null,ve=null,ye=null,ge=null,be=null,Ee=function e(t){return function(e){return new Promise(function(n,i){t.load(e,n,le.onProgress,i)})}},we,Le=new function e(){return u(this,e),{get objectLoader(){return null===de&&(de=Ee(new THREE.ObjectLoader(le))),de},get bufferGeometryLoader(){return null===he&&(he=Ee(new THREE.BufferGeometryLoader(le))),he},get jsonLoader(){return null===fe&&(fe=Ee(new THREE.JSONLoader(le))),fe},get fbxLoader(){return null===pe&&(pe=Ee(new THREE.FBXLoader(le))),pe},get gltfLoader(){return null===me&&(me=Ee(new THREE.GLTFLoader(le))),me},get objLoader(){return null===be&&(be=new THREE.OBJLoader(le),(ve=Ee(be)).setMaterials=function(e){be.setMaterials(e)}),ve},get mtlLoader(){return null===ye&&(ye=Ee(new THREE.MTLLoader(le))),ye},get colladaLoader(){return null===ge&&(ge=Ee(new THREE.ColladaLoader(le))),ge}}},Se=new THREE.MeshBasicMaterial({wireframe:!0,color:0}),Te=function(){function e(){u(this,e)}return c(e,null,[{key:"onJSONLoad",value:function e(t,n){var i=this,o=JSON.parse(t);if(o.metadata&&o.metadata.type){var r=o.metadata.type.toLowerCase();l(n,"DataURL").then(function(e){"buffergeometry"===r?i.onJSONBufferGeometryLoad(e):"geometry"===r?i.onJSONGeometryLoad(e):"object"===r&&i.onJSONObjectLoad(e)}).catch(function(e){return console.error(e)})}else console.error("Error: Invalid JSON file.")}},{key:"onJSONBufferGeometryLoad",value:function e(t){console.log("Using THREE.BufferGeometryLoader");var n=Le.bufferGeometryLoader(t);return n.then(function(e){console.log(e);var t=new THREE.Mesh(e,Se);qe.addObjectToScene(t)}).catch(function(e){console.log(e)}),n}},{key:"onJSONGeometryLoad",value:function e(t){console.log("Using THREE.JSONLoader");var n=Le.jsonLoader(t);return n.then(function(e){console.log(e);var t=new THREE.Mesh(e,Se);qe.addObjectToScene(t)}).catch(function(e){console.log(e)}),n}},{key:"onJSONObjectLoad",value:function e(t){console.log("Using THREE.ObjectLoader");var n=Le.objectLoader(t);return n.then(function(e){console.log(e),qe.addObjectToScene(e)}).catch(function(e){console.log(e)}),n}},{key:"onFBXLoad",value:function e(t){console.log("Using THREE.FBXLoader");var n=Le.fbxLoader(t);return n.then(function(e){console.log(e),qe.addObjectToScene(e)}).catch(function(e){console.log(e)}),n}},{key:"onGLTFLoad",value:function e(t){var n=new Promise(function(e,t){});return console.log("Using THREE.GLTFLoader"),(n=Le.gltfLoader(t)).then(function(e){console.log(e),e.scenes.length>1?e.scenes.forEach(function(t){e.animations&&(t.animations=e.animations),qe.addObjectToScene(t)}):e.scene?(e.animations&&(e.scene.animations=e.animations),qe.addObjectToScene(e.scene)):console.error("No scene found in GLTF file.")}).catch(function(e){console.log(e)}),n}},{key:"onMTLLoad",value:function e(t){var n=new Promise(function(e,t){});return n=Le.mtlLoader(t)}},{key:"onOBJLoad",value:function e(t,n){var i=new Promise(function(e,t){});return Le.objLoader.setMaterials(n),(i=Le.objLoader(t)).then(function(e){console.log(e),qe.addObjectToScene(e)}).catch(function(e){console.log(e)}),i}},{key:"onDAELoad",value:function e(t){var n=new Promise(function(e){});return(n=Le.colladaLoader(t)).then(function(e){console.log(e);var t=e.scene;e.animations&&e.animations.length>0&&(t.animations=e.animations),qe.addObjectToScene(t)}).catch(function(e){console.log(e)}),n}}]),e}(),xe;(function e(){window.File&&window.FileReader&&window.FileList&&window.Blob||console.error("This loader requires the File API. Please upgrade your browser")})();var Re=function e(t){return new RegExp("(png|jpg|jpeg|gif|bmp|dds|tga|bin|vert|frag|txt|mtl)$").test(t)},ke=function e(t){return new RegExp("(json|js|fbx|gltf|glb|dae|obj)$").test(t)},Be=function e(t){return Re(t)||ke(t)},Ae=[],je={},He=[],Oe=function e(t){var n=t[0],i=t[1],o=t[2];switch(i){case"fbx":le.onStart(),Te.onFBXLoad(n);break;case"gltf":case"glb":le.onStart(),Te.onGLTFLoad(n);break;case"obj":le.onStart(),Te.onMTLLoad(je[o.name.replace(".obj",".mtl")]).then(function(e){Te.onOBJLoad(n,e)}).catch(function(e){return console.error(e)});break;case"dae":le.onStart(),Te.onDAELoad(n);break;case"json":case"js":le.onStart(),Te.onJSONLoad(n,o);break;default:console.error("Unsupported file type "+i+" - please load one of the supported model formats.")}};le.setURLModifier(function(e){if("."===e[e.length-3]||"."===e[e.length-4]){var t=e.split(".").pop().toLowerCase();Re(t)&&(e=(e=(e=e.replace("data:application/","")).split("/"))[e.length-1])}return void 0===je[e]?e:je[e]});var Pe=function e(t){var n=t.name.split(".").pop().toLowerCase();if(Be(n))if("js"===n||"json"===n){var i=l(t,"Text").then(function(e){Ae.push([e,n,t])}).catch(function(e){return console.error(e)});He.push(i)}else{var o=l(t,"DataURL").then(function(e){ke(n)?"obj"===n?Ae.push([e,n,t]):Ae.push([e,n]):Re(n)&&(je[t.name]=e)}).catch(function(e){return console.error(e)});He.push(o)}},Me=function e(t){Ae=[],je={},He=[];for(var n=0;n<t.length;n++)Pe(t[n]);Promise.all(He).then(function(){Ae.forEach(function(e){return Oe(e)})}).catch(function(e){return console.error(e)})},Ce=T.fileUpload.form,Fe=T.fileUpload.button;Fe.addEventListener("click",function(e){e.preventDefault(),T.fileUpload.input.click()},!1),T.fileUpload.input.addEventListener("change",function(e){e.preventDefault();var t=e.target.files;Me(t)},!1),["drag","dragstart","dragend","dragover","dragenter","dragleave","drop"].forEach(function(e){return Ce.addEventListener(e,function(e){e.preventDefault(),e.stopPropagation()})}),["drag","dragstart","dragend","dragover","dragenter","dragleave","drop"].forEach(function(e){return document.addEventListener(e,function(e){e.preventDefault(),e.stopPropagation()})}),["dragover","dragenter"].forEach(function(e){return Ce.addEventListener(e,function(){Ce.classList.add("border"),Fe.classList.add("highlight")})}),["dragend","dragleave","drop"].forEach(function(e){return Ce.addEventListener(e,function(){Ce.classList.remove("border"),Fe.classList.remove("highlight")})}),T.fileUpload.form.addEventListener("drop",function(e){var t=e.dataTransfer.files;Me(t)}),T.controls.exampleDuck.addEventListener("click",function(e){e.preventDefault(),le.onStart(),Te.onGLTFLoad("/assets/models/loader/Duck.gltf")}),THREE.Cache.enabled=!0;var De,qe=new(function(){function e(n){u(this,e);var i=this;this.canvas=n,this.app=new t(this.canvas),this.animationControls=new Z,this.app.onUpdate=function(){i.animationControls.update(i.app.delta)},this.app.onWindowResize=function(){},this.loadedObjects=new THREE.Group,this.loadedMaterials=[],this.app.scene.add(this.loadedObjects),this.lighting=new oe(this.app),this.grid=new ae(this.app),this.background=new ne(this.app),this.environment=new ie(this.loadedMaterials),this.info=new se(this.app,this.loadedObjects),this.app.scene.add(this.grid.helpers),this.app.initControls(),this.screenshotHandler=new re(this.app),this.initReset()}return c(e,[{key:"addObjectToScene",value:function e(t){var n=this;void 0!==t?(this.animationControls.initAnimation(t),this.loadedObjects.add(t),this.app.fitCameraToObject(this.loadedObjects,.9),this.app.play(),this.info.update(),this.loadedObjects.traverse(function(e){void 0!==e.material&&n.loadedMaterials.push(e.material)}),this.environment.default()):console.error("Oops! An unspecified error occurred :(")}},{key:"initReset",value:function e(){var t=this;T.reset.addEventListener("click",function(){for(;t.loadedObjects.children.length>0;){var e=t.loadedObjects.children[0];t.loadedObjects.remove(e),e=null}t.loadedMaterials=[],t.animationControls.reset(),t.lighting.reset(),T.setInitialState()})}}]),e}())(T.canvas)}();